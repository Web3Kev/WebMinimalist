/*! For license information please see main.7e0427d8.js.LICENSE.txt */
(()=>{var e={1944:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Logger=void 0;const n=r(5184),i="awaitqueue";t.Logger=class{constructor(e){e?(this._debug=(0,n.default)("".concat(i,":").concat(e)),this._warn=(0,n.default)("".concat(i,":WARN:").concat(e)),this._error=(0,n.default)("".concat(i,":ERROR:").concat(e))):(this._debug=(0,n.default)(i),this._warn=(0,n.default)("".concat(i,":WARN")),this._error=(0,n.default)("".concat(i,":ERROR"))),this._debug.log=console.info.bind(console),this._warn.log=console.warn.bind(console),this._error.log=console.error.bind(console)}get debug(){return this._debug}get warn(){return this._warn}get error(){return this._error}}},8364:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AwaitQueue=t.AwaitQueueRemovedTaskError=t.AwaitQueueStoppedError=void 0;const n=new(r(1944).Logger);class i extends Error{constructor(e){super(null!==e&&void 0!==e?e:"AwaitQueue stopped"),this.name="AwaitQueueStoppedError","function"===typeof Error.captureStackTrace&&Error.captureStackTrace(this,i)}}t.AwaitQueueStoppedError=i;class a extends Error{constructor(e){super(null!==e&&void 0!==e?e:"AwaitQueue task removed"),this.name="AwaitQueueRemovedTaskError","function"===typeof Error.captureStackTrace&&Error.captureStackTrace(this,a)}}t.AwaitQueueRemovedTaskError=a;t.AwaitQueue=class{constructor(){this.pendingTasks=new Map,this.nextTaskId=0,this.stopping=!1}get size(){return this.pendingTasks.size}async push(e,t){var r;if(t=null!==(r=t)&&void 0!==r?r:e.name,n.debug("push() [name:".concat(t,"]")),"function"!==typeof e)throw new TypeError("given task is not a function");if(t)try{Object.defineProperty(e,"name",{value:t})}catch(i){}return new Promise(((r,i)=>{const a={id:this.nextTaskId++,task:e,name:t,enqueuedAt:Date.now(),executedAt:void 0,completed:!1,resolve:e=>{if(a.completed)return;a.completed=!0,this.pendingTasks.delete(a.id),n.debug("resolving task [name:".concat(a.name,"]")),r(e);const[t]=this.pendingTasks.values();t&&!t.executedAt&&this.execute(t)},reject:e=>{if(!a.completed&&(a.completed=!0,this.pendingTasks.delete(a.id),n.debug("rejecting task [name:".concat(a.name,"]: %s"),String(e)),i(e),!this.stopping)){const[e]=this.pendingTasks.values();e&&!e.executedAt&&this.execute(e)}}};this.pendingTasks.set(a.id,a),1===this.pendingTasks.size&&this.execute(a)}))}stop(){n.debug("stop()"),this.stopping=!0;for(const e of this.pendingTasks.values())n.debug("stop() | stopping task [name:".concat(e.name,"]")),e.reject(new i);this.stopping=!1}remove(e){n.debug("remove() [taskIdx:".concat(e,"]"));const t=Array.from(this.pendingTasks.values())[e];t?t.reject(new a):n.debug("stop() | no task with given idx [taskIdx:".concat(e,"]"))}dump(){const e=Date.now();let t=0;return Array.from(this.pendingTasks.values()).map((r=>({idx:t++,task:r.task,name:r.name,enqueuedTime:r.executedAt?r.executedAt-r.enqueuedAt:e-r.enqueuedAt,executionTime:r.executedAt?e-r.executedAt:0})))}async execute(e){if(n.debug("execute() [name:".concat(e.name,"]")),e.executedAt)throw new Error("task already being executed");e.executedAt=Date.now();try{const t=await e.task();e.resolve(t)}catch(t){e.reject(t)}}}},3928:e=>{!function(){"use strict";e.exports=function(e){return(e instanceof Buffer?e:Buffer.from(e.toString(),"binary")).toString("base64")}}()},5184:(e,t,r)=>{t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const r="color: "+this.color;t.splice(1,0,r,"color: inherit");let n=0,i=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(n++,"%c"===e&&(i=n))})),t.splice(i,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(r){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(r){}!e&&"undefined"!==typeof process&&"env"in process&&(e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.DEBUG);return e},t.useColors=function(){if("undefined"!==typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!==typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!==typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=r(892)(t);const{formatters:n}=e.exports;n.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}},892:(e,t,r)=>{e.exports=function(e){function t(e){let r,i,a,s=null;function o(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];if(!o.enabled)return;const a=o,s=Number(new Date),c=s-(r||s);a.diff=c,a.prev=r,a.curr=s,r=s,n[0]=t.coerce(n[0]),"string"!==typeof n[0]&&n.unshift("%O");let d=0;n[0]=n[0].replace(/%([a-zA-Z%])/g,((e,r)=>{if("%%"===e)return"%";d++;const i=t.formatters[r];if("function"===typeof i){const t=n[d];e=i.call(a,t),n.splice(d,1),d--}return e})),t.formatArgs.call(a,n);(a.log||t.log).apply(a,n)}return o.namespace=e,o.useColors=t.useColors(),o.color=t.selectColor(e),o.extend=n,o.destroy=t.destroy,Object.defineProperty(o,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==s?s:(i!==t.namespaces&&(i=t.namespaces,a=t.enabled(e)),a),set:e=>{s=e}}),"function"===typeof t.init&&t.init(o),o}function n(e,r){const n=t(this.namespace+("undefined"===typeof r?":":r)+e);return n.log=this.log,n}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){const e=[...t.names.map(i),...t.skips.map(i).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let r;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const n=("string"===typeof e?e:"").split(/[\s,]+/),i=n.length;for(r=0;r<i;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(2596),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((r=>{t[r]=e[r]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let r=0;for(let t=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t),r|=0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t}},8380:e=>{"use strict";var t,r="object"===typeof Reflect?Reflect:null,n=r&&"function"===typeof r.apply?r.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};t=r&&"function"===typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!==e};function a(){a.init.call(this)}e.exports=a,e.exports.once=function(e,t){return new Promise((function(r,n){function i(r){e.removeListener(t,a),n(r)}function a(){"function"===typeof e.removeListener&&e.removeListener("error",i),r([].slice.call(arguments))}m(e,t,a,{once:!0}),"error"!==t&&function(e,t,r){"function"===typeof e.on&&m(e,"error",t,r)}(e,i,{once:!0})}))},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var s=10;function o(e){if("function"!==typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function d(e,t,r,n){var i,a,s,d;if(o(r),void 0===(a=e._events)?(a=e._events=Object.create(null),e._eventsCount=0):(void 0!==a.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),a=e._events),s=a[t]),void 0===s)s=a[t]=r,++e._eventsCount;else if("function"===typeof s?s=a[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),(i=c(e))>0&&s.length>i&&!s.warned){s.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=s.length,d=l,console&&console.warn&&console.warn(d)}return e}function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function u(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=l.bind(n);return i.listener=r,n.wrapFn=i,i}function p(e,t,r){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"===typeof i?r?[i.listener||i]:[i]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(i):f(i,i.length)}function h(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"===typeof r)return 1;if(void 0!==r)return r.length}return 0}function f(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function m(e,t,r,n){if("function"===typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!==typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(a){n.once&&e.removeEventListener(t,i),r(a)}))}}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!==typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(e){if("number"!==typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return c(this)},a.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var i="error"===e,a=this._events;if(void 0!==a)i=i&&void 0===a.error;else if(!i)return!1;if(i){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var o=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw o.context=s,o}var c=a[e];if(void 0===c)return!1;if("function"===typeof c)n(c,this,t);else{var d=c.length,l=f(c,d);for(r=0;r<d;++r)n(l[r],this,t)}return!0},a.prototype.addListener=function(e,t){return d(this,e,t,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,t){return d(this,e,t,!0)},a.prototype.once=function(e,t){return o(t),this.on(e,u(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){return o(t),this.prependListener(e,u(this,e,t)),this},a.prototype.removeListener=function(e,t){var r,n,i,a,s;if(o(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0===--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!==typeof r){for(i=-1,a=r.length-1;a>=0;a--)if(r[a]===t||r[a].listener===t){s=r[a].listener,i=a;break}if(i<0)return this;0===i?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,s||t)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0===--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var i,a=Object.keys(r);for(n=0;n<a.length;++n)"removeListener"!==(i=a[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"===typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},a.prototype.listeners=function(e){return p(this,e,!0)},a.prototype.rawListeners=function(e){return p(this,e,!1)},a.listenerCount=function(e,t){return"function"===typeof e.listenerCount?e.listenerCount(t):h.call(e,t)},a.prototype.listenerCount=h,a.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},8332:(e,t,r)=>{const n=r(5184)("h264-profile-level-id"),i=r(5184)("h264-profile-level-id:WARN");n.log=console.info.bind(console),i.log=console.warn.bind(console);t.ProfileConstrainedBaseline=1,t.ProfileBaseline=2,t.ProfileMain=3,t.ProfileConstrainedHigh=4,t.ProfileHigh=5,t.ProfilePredictiveHigh444=6;const a=0,s=10;t.Level1_b=a,t.Level1=s,t.Level1_1=11,t.Level1_2=12,t.Level1_3=13,t.Level2=20,t.Level2_1=21,t.Level2_2=22,t.Level3=30,t.Level3_1=31,t.Level3_2=32,t.Level4=40,t.Level4_1=41,t.Level4_2=42,t.Level5=50,t.Level5_1=51,t.Level5_2=52;class o{constructor(e,t){this.profile=e,this.level=t}}t.ProfileLevelId=o;class c{constructor(e){this._mask=~u("x",e),this._maskedValue=u("1",e)}isMatch(e){return this._maskedValue===(e&this._mask)}}class d{constructor(e,t,r){this.profile_idc=e,this.profile_iop=t,this.profile=r}}const l=[new d(66,new c("x1xx0000"),1),new d(77,new c("1xxx0000"),1),new d(88,new c("11xx0000"),1),new d(66,new c("x0xx0000"),2),new d(88,new c("10xx0000"),2),new d(77,new c("0x0x0000"),3),new d(100,new c("00000000"),5),new d(100,new c("00001100"),4),new d(244,new c("00000000"),6)];function u(e,t){return(t[0]===e)<<7|(t[1]===e)<<6|(t[2]===e)<<5|(t[3]===e)<<4|(t[4]===e)<<3|(t[5]===e)<<2|(t[6]===e)<<1|(t[7]===e)<<0}function p(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})["level-asymmetry-allowed"];return 1===e||"1"===e}t.parseProfileLevelId=function(e){if("string"!==typeof e||6!==e.length)return null;const t=parseInt(e,16);if(0===t)return null;const r=255&t,n=t>>8&255,c=t>>16&255;let d;switch(r){case 11:d=0!==(16&n)?a:11;break;case s:case 12:case 13:case 20:case 21:case 22:case 30:case 31:case 32:case 40:case 41:case 42:case 50:case 51:case 52:d=r;break;default:return i("parseProfileLevelId() | unrecognized level_idc [str:".concat(e,", level_idc:").concat(r,"]")),null}for(const i of l)if(c===i.profile_idc&&i.profile_iop.isMatch(n))return new o(i.profile,d);return i("parseProfileLevelId() | unrecognized profile_idc/profile_iop combination [str:".concat(e,", profile_idc:").concat(c,", profile_iop:").concat(n,"]")),null},t.profileLevelIdToString=function(e){if(e.level==a)switch(e.profile){case 1:return"42f00b";case 2:return"42100b";case 3:return"4d100b";default:return i("profileLevelIdToString() | Level 1_b not is allowed for profile ".concat(e.profile)),null}let t;switch(e.profile){case 1:t="42e0";break;case 2:t="4200";break;case 3:t="4d00";break;case 4:t="640c";break;case 5:t="6400";break;case 6:t="f400";break;default:return i("profileLevelIdToString() | unrecognized profile ".concat(e.profile)),null}let r=e.level.toString(16);return 1===r.length&&(r="0".concat(r)),"".concat(t).concat(r)},t.profileToString=function(e){switch(e){case 1:return"ConstrainedBaseline";case 2:return"Baseline";case 3:return"Main";case 4:return"ConstrainedHigh";case 5:return"High";case 6:return"PredictiveHigh444";default:return i("profileToString() | unrecognized profile ".concat(e)),null}},t.levelToString=function(e){switch(e){case a:return"1b";case s:return"1";case 11:return"1.1";case 12:return"1.2";case 13:return"1.3";case 20:return"2";case 21:return"2.1";case 22:return"2.2";case 30:return"3";case 31:return"3.1";case 32:return"3.2";case 40:return"4";case 41:return"4.1";case 42:return"4.2";case 50:return"5";case 51:return"5.1";case 52:return"5.2";default:return i("levelToString() | unrecognized level ".concat(e)),null}},t.parseSdpProfileLevelId=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const r=new o(1,31),n=e["profile-level-id"];return n?t.parseProfileLevelId(n):r},t.isSameProfile=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=t.parseSdpProfileLevelId(e),i=t.parseSdpProfileLevelId(r);return Boolean(n&&i&&n.profile===i.profile)},t.generateProfileLevelIdForAnswer=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e["profile-level-id"]&&!r["profile-level-id"])return i("generateProfileLevelIdForAnswer() | profile-level-id missing in local and remote params"),null;const c=t.parseSdpProfileLevelId(e),d=t.parseSdpProfileLevelId(r);if(!c)throw new TypeError("invalid local_profile_level_id");if(!d)throw new TypeError("invalid remote_profile_level_id");if(c.profile!==d.profile)throw new TypeError("H264 Profile mismatch");const l=p(e)&&p(r),u=c.level,h=d.level,f=function(e,t){return e===a?t!==s&&t!==a:t===a?e!==s:e<t}(m=u,g=h)?m:g;var m,g;const v=l?u:f;return n("generateProfileLevelIdForAnswer() | result [profile:".concat(c.profile,", level:").concat(v,"]")),t.profileLevelIdToString(new o(c.profile,v))}},8288:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Consumer=void 0;const n=r(56),i=r(2728),a=r(3288),s=new n.Logger("Consumer");class o extends i.EnhancedEventEmitter{constructor(e){let{id:t,localId:r,producerId:n,rtpReceiver:a,track:o,rtpParameters:c,appData:d}=e;super(),this._closed=!1,this._observer=new i.EnhancedEventEmitter,s.debug("constructor()"),this._id=t,this._localId=r,this._producerId=n,this._rtpReceiver=a,this._track=o,this._rtpParameters=c,this._paused=!o.enabled,this._appData=d||{},this.onTrackEnded=this.onTrackEnded.bind(this),this.handleTrack()}get id(){return this._id}get localId(){return this._localId}get producerId(){return this._producerId}get closed(){return this._closed}get kind(){return this._track.kind}get rtpReceiver(){return this._rtpReceiver}get track(){return this._track}get rtpParameters(){return this._rtpParameters}get paused(){return this._paused}get appData(){return this._appData}set appData(e){this._appData=e}get observer(){return this._observer}close(){this._closed||(s.debug("close()"),this._closed=!0,this.destroyTrack(),this.emit("@close"),this._observer.safeEmit("close"))}transportClosed(){this._closed||(s.debug("transportClosed()"),this._closed=!0,this.destroyTrack(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}async getStats(){if(this._closed)throw new a.InvalidStateError("closed");return new Promise(((e,t)=>{this.safeEmit("@getstats",e,t)}))}pause(){s.debug("pause()"),this._closed?s.error("pause() | Consumer closed"):this._paused?s.debug("pause() | Consumer is already paused"):(this._paused=!0,this._track.enabled=!1,this.emit("@pause"),this._observer.safeEmit("pause"))}resume(){s.debug("resume()"),this._closed?s.error("resume() | Consumer closed"):this._paused?(this._paused=!1,this._track.enabled=!0,this.emit("@resume"),this._observer.safeEmit("resume")):s.debug("resume() | Consumer is already resumed")}onTrackEnded(){s.debug('track "ended" event'),this.safeEmit("trackended"),this._observer.safeEmit("trackended")}handleTrack(){this._track.addEventListener("ended",this.onTrackEnded)}destroyTrack(){try{this._track.removeEventListener("ended",this.onTrackEnded),this._track.stop()}catch(e){}}}t.Consumer=o},2352:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DataConsumer=void 0;const n=r(56),i=r(2728),a=new n.Logger("DataConsumer");class s extends i.EnhancedEventEmitter{constructor(e){let{id:t,dataProducerId:r,dataChannel:n,sctpStreamParameters:s,appData:o}=e;super(),this._closed=!1,this._observer=new i.EnhancedEventEmitter,a.debug("constructor()"),this._id=t,this._dataProducerId=r,this._dataChannel=n,this._sctpStreamParameters=s,this._appData=o||{},this.handleDataChannel()}get id(){return this._id}get dataProducerId(){return this._dataProducerId}get closed(){return this._closed}get sctpStreamParameters(){return this._sctpStreamParameters}get readyState(){return this._dataChannel.readyState}get label(){return this._dataChannel.label}get protocol(){return this._dataChannel.protocol}get binaryType(){return this._dataChannel.binaryType}set binaryType(e){this._dataChannel.binaryType=e}get appData(){return this._appData}set appData(e){this._appData=e}get observer(){return this._observer}close(){this._closed||(a.debug("close()"),this._closed=!0,this._dataChannel.close(),this.emit("@close"),this._observer.safeEmit("close"))}transportClosed(){this._closed||(a.debug("transportClosed()"),this._closed=!0,this._dataChannel.close(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}handleDataChannel(){this._dataChannel.addEventListener("open",(()=>{this._closed||(a.debug('DataChannel "open" event'),this.safeEmit("open"))})),this._dataChannel.addEventListener("error",(e=>{if(this._closed)return;let{error:t}=e;t||(t=new Error("unknown DataChannel error")),"sctp-failure"===t.errorDetail?a.error("DataChannel SCTP error [sctpCauseCode:%s]: %s",t.sctpCauseCode,t.message):a.error('DataChannel "error" event: %o',t),this.safeEmit("error",t)})),this._dataChannel.addEventListener("close",(()=>{this._closed||(a.warn('DataChannel "close" event'),this._closed=!0,this.emit("@close"),this.safeEmit("close"),this._observer.safeEmit("close"))})),this._dataChannel.addEventListener("message",(e=>{this._closed||this.safeEmit("message",e.data)}))}}t.DataConsumer=s},9624:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DataProducer=void 0;const n=r(56),i=r(2728),a=r(3288),s=new n.Logger("DataProducer");class o extends i.EnhancedEventEmitter{constructor(e){let{id:t,dataChannel:r,sctpStreamParameters:n,appData:a}=e;super(),this._closed=!1,this._observer=new i.EnhancedEventEmitter,s.debug("constructor()"),this._id=t,this._dataChannel=r,this._sctpStreamParameters=n,this._appData=a||{},this.handleDataChannel()}get id(){return this._id}get closed(){return this._closed}get sctpStreamParameters(){return this._sctpStreamParameters}get readyState(){return this._dataChannel.readyState}get label(){return this._dataChannel.label}get protocol(){return this._dataChannel.protocol}get bufferedAmount(){return this._dataChannel.bufferedAmount}get bufferedAmountLowThreshold(){return this._dataChannel.bufferedAmountLowThreshold}set bufferedAmountLowThreshold(e){this._dataChannel.bufferedAmountLowThreshold=e}get appData(){return this._appData}set appData(e){this._appData=e}get observer(){return this._observer}close(){this._closed||(s.debug("close()"),this._closed=!0,this._dataChannel.close(),this.emit("@close"),this._observer.safeEmit("close"))}transportClosed(){this._closed||(s.debug("transportClosed()"),this._closed=!0,this._dataChannel.close(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}send(e){if(s.debug("send()"),this._closed)throw new a.InvalidStateError("closed");this._dataChannel.send(e)}handleDataChannel(){this._dataChannel.addEventListener("open",(()=>{this._closed||(s.debug('DataChannel "open" event'),this.safeEmit("open"))})),this._dataChannel.addEventListener("error",(e=>{if(this._closed)return;let{error:t}=e;t||(t=new Error("unknown DataChannel error")),"sctp-failure"===t.errorDetail?s.error("DataChannel SCTP error [sctpCauseCode:%s]: %s",t.sctpCauseCode,t.message):s.error('DataChannel "error" event: %o',t),this.safeEmit("error",t)})),this._dataChannel.addEventListener("close",(()=>{this._closed||(s.warn('DataChannel "close" event'),this._closed=!0,this.emit("@close"),this.safeEmit("close"),this._observer.safeEmit("close"))})),this._dataChannel.addEventListener("message",(()=>{this._closed||s.warn('DataChannel "message" event in a DataProducer, message discarded')})),this._dataChannel.addEventListener("bufferedamountlow",(()=>{this._closed||this.safeEmit("bufferedamountlow")}))}}t.DataProducer=o},28:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Device=t.detectDevice=void 0;const s=r(6016),o=r(56),c=r(2728),d=r(3288),l=a(r(6176)),u=a(r(9324)),p=r(5612),h=r(4112),f=r(584),m=r(6660),g=r(8844),v=r(9608),y=r(180),b=r(1436),_=r(6232),w=r(5956),S=r(6404),C=r(2708),k=new o.Logger("Device");function R(){if("object"===typeof navigator&&"ReactNative"===navigator.product)return k.debug("detectDevice() | React-Native detected"),"undefined"===typeof RTCPeerConnection?void k.warn("detectDevice() | unsupported react-native-webrtc without RTCPeerConnection, forgot to call registerGlobals()?"):"undefined"!==typeof RTCRtpTransceiver?(k.debug("detectDevice() | ReactNative UnifiedPlan handler chosen"),"ReactNativeUnifiedPlan"):(k.debug("detectDevice() | ReactNative PlanB handler chosen"),"ReactNative");if("object"!==typeof navigator||"string"!==typeof navigator.userAgent)k.warn("detectDevice() | unknown device");else{var e,t,r,n,i,a,o,c;const d=navigator.userAgent,l=new s.UAParser(d);k.debug("detectDevice() | browser detected [ua:%s, parsed:%o]",d,l.getResult());const u=l.getBrowser(),p=null!==(e=null===(t=u.name)||void 0===t?void 0:t.toLowerCase())&&void 0!==e?e:"",h=parseInt(null!==(r=u.major)&&void 0!==r?r:"0"),f=null!==(n=null===(i=l.getEngine().name)||void 0===i?void 0:i.toLowerCase())&&void 0!==n?n:"",m=l.getOS(),g=null!==(a=null===(o=m.name)||void 0===o?void 0:o.toLowerCase())&&void 0!==a?a:"",v=parseFloat(null!==(c=m.version)&&void 0!==c?c:"0"),y="ios"===g,b=["chrome","chromium","mobile chrome","chrome webview","chrome headless"].includes(p),_=["firefox","mobile firefox","mobile focus"].includes(p),w=["safari","mobile safari"].includes(p),S=["edge"].includes(p);if((b||S)&&!y&&h>=111)return"Chrome111";if(b&&!y&&h>=74||S&&!y&&h>=88)return"Chrome74";if(b&&!y&&h>=70)return"Chrome70";if(b&&!y&&h>=67)return"Chrome67";if(b&&!y&&h>=55)return"Chrome55";if(_&&!y&&h>=60)return"Firefox60";if(_&&y&&v>=14.3)return"Safari12";if(w&&h>=12&&"undefined"!==typeof RTCRtpTransceiver&&RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection"))return"Safari12";if(w&&h>=11)return"Safari11";if(S&&!y&&h>=11&&h<=18)return"Edge11";if("webkit"===f&&y&&v>=14.3&&"undefined"!==typeof RTCRtpTransceiver&&RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection"))return"Safari12";if("blink"===f){const e=d.match(/(?:(?:Chrome|Chromium))[ /](\w+)/i);if(e){const t=Number(e[1]);return t>=111?"Chrome111":t>=74?"Chrome74":t>=70?"Chrome70":t>=67?"Chrome67":"Chrome55"}return"Chrome111"}k.warn("detectDevice() | browser not supported [name:%s, version:%s]",p,h)}}t.detectDevice=R;t.Device=class{constructor(){let{handlerName:e,handlerFactory:t,Handler:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._loaded=!1,this._observer=new c.EnhancedEventEmitter,k.debug("constructor()"),r){if(k.warn("constructor() | Handler option is DEPRECATED, use handlerName or handlerFactory instead"),"string"!==typeof r)throw new TypeError("non string Handler option no longer supported, use handlerFactory instead");e=r}if(e&&t)throw new TypeError("just one of handlerName or handlerInterface can be given");if(t)this._handlerFactory=t;else{if(e)k.debug("constructor() | handler given: %s",e);else{if(e=R(),!e)throw new d.UnsupportedError("device not supported");k.debug("constructor() | detected handler: %s",e)}switch(e){case"Chrome111":this._handlerFactory=h.Chrome111.createFactory();break;case"Chrome74":this._handlerFactory=f.Chrome74.createFactory();break;case"Chrome70":this._handlerFactory=m.Chrome70.createFactory();break;case"Chrome67":this._handlerFactory=g.Chrome67.createFactory();break;case"Chrome55":this._handlerFactory=v.Chrome55.createFactory();break;case"Firefox60":this._handlerFactory=y.Firefox60.createFactory();break;case"Safari12":this._handlerFactory=b.Safari12.createFactory();break;case"Safari11":this._handlerFactory=_.Safari11.createFactory();break;case"Edge11":this._handlerFactory=w.Edge11.createFactory();break;case"ReactNativeUnifiedPlan":this._handlerFactory=S.ReactNativeUnifiedPlan.createFactory();break;case"ReactNative":this._handlerFactory=C.ReactNative.createFactory();break;default:throw new TypeError('unknown handlerName "'.concat(e,'"'))}}const n=this._handlerFactory();this._handlerName=n.name,n.close(),this._extendedRtpCapabilities=void 0,this._recvRtpCapabilities=void 0,this._canProduceByKind={audio:!1,video:!1},this._sctpCapabilities=void 0}get handlerName(){return this._handlerName}get loaded(){return this._loaded}get rtpCapabilities(){if(!this._loaded)throw new d.InvalidStateError("not loaded");return this._recvRtpCapabilities}get sctpCapabilities(){if(!this._loaded)throw new d.InvalidStateError("not loaded");return this._sctpCapabilities}get observer(){return this._observer}async load(e){let t,{routerRtpCapabilities:r}=e;k.debug("load() [routerRtpCapabilities:%o]",r),r=l.clone(r,void 0);try{if(this._loaded)throw new d.InvalidStateError("already loaded");u.validateRtpCapabilities(r),t=this._handlerFactory();const e=await t.getNativeRtpCapabilities();k.debug("load() | got native RTP capabilities:%o",e),u.validateRtpCapabilities(e),this._extendedRtpCapabilities=u.getExtendedRtpCapabilities(e,r),k.debug("load() | got extended RTP capabilities:%o",this._extendedRtpCapabilities),this._canProduceByKind.audio=u.canSend("audio",this._extendedRtpCapabilities),this._canProduceByKind.video=u.canSend("video",this._extendedRtpCapabilities),this._recvRtpCapabilities=u.getRecvRtpCapabilities(this._extendedRtpCapabilities),u.validateRtpCapabilities(this._recvRtpCapabilities),k.debug("load() | got receiving RTP capabilities:%o",this._recvRtpCapabilities),this._sctpCapabilities=await t.getNativeSctpCapabilities(),k.debug("load() | got native SCTP capabilities:%o",this._sctpCapabilities),u.validateSctpCapabilities(this._sctpCapabilities),k.debug("load() succeeded"),this._loaded=!0,t.close()}catch(n){throw t&&t.close(),n}}canProduce(e){if(!this._loaded)throw new d.InvalidStateError("not loaded");if("audio"!==e&&"video"!==e)throw new TypeError('invalid kind "'.concat(e,'"'));return this._canProduceByKind[e]}createSendTransport(e){let{id:t,iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:a,iceServers:s,iceTransportPolicy:o,additionalSettings:c,proprietaryConstraints:d,appData:l}=e;return k.debug("createSendTransport()"),this.createTransport({direction:"send",id:t,iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:a,iceServers:s,iceTransportPolicy:o,additionalSettings:c,proprietaryConstraints:d,appData:l})}createRecvTransport(e){let{id:t,iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:a,iceServers:s,iceTransportPolicy:o,additionalSettings:c,proprietaryConstraints:d,appData:l}=e;return k.debug("createRecvTransport()"),this.createTransport({direction:"recv",id:t,iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:a,iceServers:s,iceTransportPolicy:o,additionalSettings:c,proprietaryConstraints:d,appData:l})}createTransport(e){let{direction:t,id:r,iceParameters:n,iceCandidates:i,dtlsParameters:a,sctpParameters:s,iceServers:o,iceTransportPolicy:c,additionalSettings:l,proprietaryConstraints:u,appData:h}=e;if(!this._loaded)throw new d.InvalidStateError("not loaded");if("string"!==typeof r)throw new TypeError("missing id");if("object"!==typeof n)throw new TypeError("missing iceParameters");if(!Array.isArray(i))throw new TypeError("missing iceCandidates");if("object"!==typeof a)throw new TypeError("missing dtlsParameters");if(s&&"object"!==typeof s)throw new TypeError("wrong sctpParameters");if(h&&"object"!==typeof h)throw new TypeError("if given, appData must be an object");const f=new p.Transport({direction:t,id:r,iceParameters:n,iceCandidates:i,dtlsParameters:a,sctpParameters:s,iceServers:o,iceTransportPolicy:c,additionalSettings:l,proprietaryConstraints:u,appData:h,handlerFactory:this._handlerFactory,extendedRtpCapabilities:this._extendedRtpCapabilities,canProduceByKind:this._canProduceByKind});return this._observer.safeEmit("newtransport",f),f}}},2728:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EnhancedEventEmitter=void 0;const n=r(8380),i=new(r(56).Logger)("EnhancedEventEmitter");class a extends n.EventEmitter{constructor(){super(),this.setMaxListeners(1/0)}emit(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return super.emit(e,...r)}safeEmit(e){const t=super.listenerCount(e);try{for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];return super.emit(e,...n)}catch(s){return i.error("safeEmit() | event listener threw an error [eventName:%s]:%o",e,s),Boolean(t)}}on(e,t){return super.on(e,t),this}off(e,t){return super.off(e,t),this}addListener(e,t){return super.on(e,t),this}prependListener(e,t){return super.prependListener(e,t),this}once(e,t){return super.once(e,t),this}prependOnceListener(e,t){return super.prependOnceListener(e,t),this}removeListener(e,t){return super.off(e,t),this}removeAllListeners(e){return super.removeAllListeners(e),this}listenerCount(e){return super.listenerCount(e)}listeners(e){return super.listeners(e)}rawListeners(e){return super.rawListeners(e)}}t.EnhancedEventEmitter=a},56:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Logger=void 0;const i=n(r(5184)),a="mediasoup-client";t.Logger=class{constructor(e){e?(this._debug=(0,i.default)("".concat(a,":").concat(e)),this._warn=(0,i.default)("".concat(a,":WARN:").concat(e)),this._error=(0,i.default)("".concat(a,":ERROR:").concat(e))):(this._debug=(0,i.default)(a),this._warn=(0,i.default)("".concat(a,":WARN")),this._error=(0,i.default)("".concat(a,":ERROR"))),this._debug.log=console.info.bind(console),this._warn.log=console.warn.bind(console),this._error.log=console.error.bind(console)}get debug(){return this._debug}get warn(){return this._warn}get error(){return this._error}}},9888:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Producer=void 0;const n=r(56),i=r(2728),a=r(3288),s=new n.Logger("Producer");class o extends i.EnhancedEventEmitter{constructor(e){let{id:t,localId:r,rtpSender:n,track:a,rtpParameters:o,stopTracks:c,disableTrackOnPause:d,zeroRtpOnPause:l,appData:u}=e;super(),this._closed=!1,this._observer=new i.EnhancedEventEmitter,s.debug("constructor()"),this._id=t,this._localId=r,this._rtpSender=n,this._track=a,this._kind=a.kind,this._rtpParameters=o,this._paused=!!d&&!a.enabled,this._maxSpatialLayer=void 0,this._stopTracks=c,this._disableTrackOnPause=d,this._zeroRtpOnPause=l,this._appData=u||{},this.onTrackEnded=this.onTrackEnded.bind(this),this.handleTrack()}get id(){return this._id}get localId(){return this._localId}get closed(){return this._closed}get kind(){return this._kind}get rtpSender(){return this._rtpSender}get track(){return this._track}get rtpParameters(){return this._rtpParameters}get paused(){return this._paused}get maxSpatialLayer(){return this._maxSpatialLayer}get appData(){return this._appData}set appData(e){this._appData=e}get observer(){return this._observer}close(){this._closed||(s.debug("close()"),this._closed=!0,this.destroyTrack(),this.emit("@close"),this._observer.safeEmit("close"))}transportClosed(){this._closed||(s.debug("transportClosed()"),this._closed=!0,this.destroyTrack(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}async getStats(){if(this._closed)throw new a.InvalidStateError("closed");return new Promise(((e,t)=>{this.safeEmit("@getstats",e,t)}))}pause(){s.debug("pause()"),this._closed?s.error("pause() | Producer closed"):(this._paused=!0,this._track&&this._disableTrackOnPause&&(this._track.enabled=!1),this._zeroRtpOnPause&&new Promise(((e,t)=>{this.safeEmit("@pause",e,t)})).catch((()=>{})),this._observer.safeEmit("pause"))}resume(){s.debug("resume()"),this._closed?s.error("resume() | Producer closed"):(this._paused=!1,this._track&&this._disableTrackOnPause&&(this._track.enabled=!0),this._zeroRtpOnPause&&new Promise(((e,t)=>{this.safeEmit("@resume",e,t)})).catch((()=>{})),this._observer.safeEmit("resume"))}async replaceTrack(e){let{track:t}=e;if(s.debug("replaceTrack() [track:%o]",t),this._closed){if(t&&this._stopTracks)try{t.stop()}catch(r){}throw new a.InvalidStateError("closed")}if(t&&"ended"===t.readyState)throw new a.InvalidStateError("track ended");t!==this._track?(await new Promise(((e,r)=>{this.safeEmit("@replacetrack",t,e,r)})),this.destroyTrack(),this._track=t,this._track&&this._disableTrackOnPause&&(this._paused?this._paused&&(this._track.enabled=!1):this._track.enabled=!0),this.handleTrack()):s.debug("replaceTrack() | same track, ignored")}async setMaxSpatialLayer(e){if(this._closed)throw new a.InvalidStateError("closed");if("video"!==this._kind)throw new a.UnsupportedError("not a video Producer");if("number"!==typeof e)throw new TypeError("invalid spatialLayer");e!==this._maxSpatialLayer&&(await new Promise(((t,r)=>{this.safeEmit("@setmaxspatiallayer",e,t,r)})).catch((()=>{})),this._maxSpatialLayer=e)}async setRtpEncodingParameters(e){if(this._closed)throw new a.InvalidStateError("closed");if("object"!==typeof e)throw new TypeError("invalid params");await new Promise(((t,r)=>{this.safeEmit("@setrtpencodingparameters",e,t,r)}))}onTrackEnded(){s.debug('track "ended" event'),this.safeEmit("trackended"),this._observer.safeEmit("trackended")}handleTrack(){this._track&&this._track.addEventListener("ended",this.onTrackEnded)}destroyTrack(){if(this._track)try{this._track.removeEventListener("ended",this.onTrackEnded),this._stopTracks&&this._track.stop()}catch(e){}}}t.Producer=o},3200:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},3575:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},5612:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Transport=void 0;const o=r(8364),c=s(r(7376)),d=r(56),l=r(2728),u=r(3288),p=a(r(6176)),h=a(r(9324)),f=r(9888),m=r(8288),g=r(9624),v=r(2352),y=new d.Logger("Transport");class b{constructor(e){this.consumerOptions=e,this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class _ extends l.EnhancedEventEmitter{constructor(e){let{direction:t,id:r,iceParameters:n,iceCandidates:i,dtlsParameters:a,sctpParameters:s,iceServers:c,iceTransportPolicy:d,additionalSettings:u,proprietaryConstraints:h,appData:f,handlerFactory:m,extendedRtpCapabilities:g,canProduceByKind:v}=e;super(),this._closed=!1,this._iceGatheringState="new",this._connectionState="new",this._producers=new Map,this._consumers=new Map,this._dataProducers=new Map,this._dataConsumers=new Map,this._probatorConsumerCreated=!1,this._awaitQueue=new o.AwaitQueue,this._pendingConsumerTasks=[],this._consumerCreationInProgress=!1,this._pendingPauseConsumers=new Map,this._consumerPauseInProgress=!1,this._pendingResumeConsumers=new Map,this._consumerResumeInProgress=!1,this._pendingCloseConsumers=new Map,this._consumerCloseInProgress=!1,this._observer=new l.EnhancedEventEmitter,y.debug("constructor() [id:%s, direction:%s]",r,t),this._id=r,this._direction=t,this._extendedRtpCapabilities=g,this._canProduceByKind=v,this._maxSctpMessageSize=s?s.maxMessageSize:null,u=p.clone(u,{}),delete u.iceServers,delete u.iceTransportPolicy,delete u.bundlePolicy,delete u.rtcpMuxPolicy,delete u.sdpSemantics,this._handler=m(),this._handler.run({direction:t,iceParameters:n,iceCandidates:i,dtlsParameters:a,sctpParameters:s,iceServers:c,iceTransportPolicy:d,additionalSettings:u,proprietaryConstraints:h,extendedRtpCapabilities:g}),this._appData=f||{},this.handleHandler()}get id(){return this._id}get closed(){return this._closed}get direction(){return this._direction}get handler(){return this._handler}get iceGatheringState(){return this._iceGatheringState}get connectionState(){return this._connectionState}get appData(){return this._appData}set appData(e){this._appData=e}get observer(){return this._observer}close(){if(!this._closed){y.debug("close()"),this._closed=!0,this._awaitQueue.stop(),this._handler.close(),this._connectionState="closed";for(const e of this._producers.values())e.transportClosed();this._producers.clear();for(const e of this._consumers.values())e.transportClosed();this._consumers.clear();for(const e of this._dataProducers.values())e.transportClosed();this._dataProducers.clear();for(const e of this._dataConsumers.values())e.transportClosed();this._dataConsumers.clear(),this._observer.safeEmit("close")}}async getStats(){if(this._closed)throw new u.InvalidStateError("closed");return this._handler.getTransportStats()}async restartIce(e){let{iceParameters:t}=e;if(y.debug("restartIce()"),this._closed)throw new u.InvalidStateError("closed");if(!t)throw new TypeError("missing iceParameters");return this._awaitQueue.push((async()=>await this._handler.restartIce(t)),"transport.restartIce()")}async updateIceServers(){let{iceServers:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(y.debug("updateIceServers()"),this._closed)throw new u.InvalidStateError("closed");if(!Array.isArray(e))throw new TypeError("missing iceServers");return this._awaitQueue.push((async()=>this._handler.updateIceServers(e)),"transport.updateIceServers()")}async produce(){let{track:e,encodings:t,codecOptions:r,codec:n,stopTracks:i=!0,disableTrackOnPause:a=!0,zeroRtpOnPause:s=!1,appData:o={}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(y.debug("produce() [track:%o]",e),this._closed)throw new u.InvalidStateError("closed");if(!e)throw new TypeError("missing track");if("send"!==this._direction)throw new u.UnsupportedError("not a sending Transport");if(!this._canProduceByKind[e.kind])throw new u.UnsupportedError("cannot produce ".concat(e.kind));if("ended"===e.readyState)throw new u.InvalidStateError("track ended");if(0===this.listenerCount("connect")&&"new"===this._connectionState)throw new TypeError('no "connect" listener set into this transport');if(0===this.listenerCount("produce"))throw new TypeError('no "produce" listener set into this transport');if(o&&"object"!==typeof o)throw new TypeError("if given, appData must be an object");return this._awaitQueue.push((async()=>{let c;if(t&&!Array.isArray(t))throw TypeError("encodings must be an array");t&&0===t.length?c=void 0:t&&(c=t.map((e=>{const t={active:!0};return!1===e.active&&(t.active=!1),"boolean"===typeof e.dtx&&(t.dtx=e.dtx),"string"===typeof e.scalabilityMode&&(t.scalabilityMode=e.scalabilityMode),"number"===typeof e.scaleResolutionDownBy&&(t.scaleResolutionDownBy=e.scaleResolutionDownBy),"number"===typeof e.maxBitrate&&(t.maxBitrate=e.maxBitrate),"number"===typeof e.maxFramerate&&(t.maxFramerate=e.maxFramerate),"boolean"===typeof e.adaptivePtime&&(t.adaptivePtime=e.adaptivePtime),"string"===typeof e.priority&&(t.priority=e.priority),"string"===typeof e.networkPriority&&(t.networkPriority=e.networkPriority),t})));const{localId:d,rtpParameters:l,rtpSender:u}=await this._handler.send({track:e,encodings:c,codecOptions:r,codec:n});try{h.validateRtpParameters(l);const{id:t}=await new Promise(((t,r)=>{this.safeEmit("produce",{kind:e.kind,rtpParameters:l,appData:o},t,r)})),r=new f.Producer({id:t,localId:d,rtpSender:u,track:e,rtpParameters:l,stopTracks:i,disableTrackOnPause:a,zeroRtpOnPause:s,appData:o});return this._producers.set(r.id,r),this.handleProducer(r),this._observer.safeEmit("newproducer",r),r}catch(p){throw this._handler.stopSending(d).catch((()=>{})),p}}),"transport.produce()").catch((t=>{if(i)try{e.stop()}catch(r){}throw t}))}async consume(e){let{id:t,producerId:r,kind:n,rtpParameters:i,streamId:a,appData:s={}}=e;if(y.debug("consume()"),i=p.clone(i,void 0),this._closed)throw new u.InvalidStateError("closed");if("recv"!==this._direction)throw new u.UnsupportedError("not a receiving Transport");if("string"!==typeof t)throw new TypeError("missing id");if("string"!==typeof r)throw new TypeError("missing producerId");if("audio"!==n&&"video"!==n)throw new TypeError("invalid kind '".concat(n,"'"));if(0===this.listenerCount("connect")&&"new"===this._connectionState)throw new TypeError('no "connect" listener set into this transport');if(s&&"object"!==typeof s)throw new TypeError("if given, appData must be an object");if(!h.canReceive(i,this._extendedRtpCapabilities))throw new u.UnsupportedError("cannot consume this Producer");const o=new b({id:t,producerId:r,kind:n,rtpParameters:i,streamId:a,appData:s});return this._pendingConsumerTasks.push(o),(0,c.default)((()=>{this._closed||!1===this._consumerCreationInProgress&&this.createPendingConsumers()})),o.promise}async produceData(){let{ordered:e=!0,maxPacketLifeTime:t,maxRetransmits:r,label:n="",protocol:i="",appData:a={}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(y.debug("produceData()"),this._closed)throw new u.InvalidStateError("closed");if("send"!==this._direction)throw new u.UnsupportedError("not a sending Transport");if(!this._maxSctpMessageSize)throw new u.UnsupportedError("SCTP not enabled by remote Transport");if(0===this.listenerCount("connect")&&"new"===this._connectionState)throw new TypeError('no "connect" listener set into this transport');if(0===this.listenerCount("producedata"))throw new TypeError('no "producedata" listener set into this transport');if(a&&"object"!==typeof a)throw new TypeError("if given, appData must be an object");return(t||r)&&(e=!1),this._awaitQueue.push((async()=>{const{dataChannel:s,sctpStreamParameters:o}=await this._handler.sendDataChannel({ordered:e,maxPacketLifeTime:t,maxRetransmits:r,label:n,protocol:i});h.validateSctpStreamParameters(o);const{id:c}=await new Promise(((e,t)=>{this.safeEmit("producedata",{sctpStreamParameters:o,label:n,protocol:i,appData:a},e,t)})),d=new g.DataProducer({id:c,dataChannel:s,sctpStreamParameters:o,appData:a});return this._dataProducers.set(d.id,d),this.handleDataProducer(d),this._observer.safeEmit("newdataproducer",d),d}),"transport.produceData()")}async consumeData(e){let{id:t,dataProducerId:r,sctpStreamParameters:n,label:i="",protocol:a="",appData:s={}}=e;if(y.debug("consumeData()"),n=p.clone(n,void 0),this._closed)throw new u.InvalidStateError("closed");if("recv"!==this._direction)throw new u.UnsupportedError("not a receiving Transport");if(!this._maxSctpMessageSize)throw new u.UnsupportedError("SCTP not enabled by remote Transport");if("string"!==typeof t)throw new TypeError("missing id");if("string"!==typeof r)throw new TypeError("missing dataProducerId");if(0===this.listenerCount("connect")&&"new"===this._connectionState)throw new TypeError('no "connect" listener set into this transport');if(s&&"object"!==typeof s)throw new TypeError("if given, appData must be an object");return h.validateSctpStreamParameters(n),this._awaitQueue.push((async()=>{const{dataChannel:e}=await this._handler.receiveDataChannel({sctpStreamParameters:n,label:i,protocol:a}),o=new v.DataConsumer({id:t,dataProducerId:r,dataChannel:e,sctpStreamParameters:n,appData:s});return this._dataConsumers.set(o.id,o),this.handleDataConsumer(o),this._observer.safeEmit("newdataconsumer",o),o}),"transport.consumeData()")}async createPendingConsumers(){this._consumerCreationInProgress=!0,this._awaitQueue.push((async()=>{if(0===this._pendingConsumerTasks.length)return void y.debug("createPendingConsumers() | there is no Consumer to be created");const e=[...this._pendingConsumerTasks];let t;this._pendingConsumerTasks=[];const r=[];for(const i of e){const{id:e,kind:t,rtpParameters:n,streamId:a}=i.consumerOptions;r.push({trackId:e,kind:t,rtpParameters:n,streamId:a})}try{const n=await this._handler.receive(r);for(let r=0;r<n.length;++r){const i=e[r],a=n[r],{id:s,producerId:o,kind:c,rtpParameters:d,appData:l}=i.consumerOptions,{localId:u,rtpReceiver:p,track:h}=a,f=new m.Consumer({id:s,localId:u,producerId:o,rtpReceiver:p,track:h,rtpParameters:d,appData:l});this._consumers.set(f.id,f),this.handleConsumer(f),this._probatorConsumerCreated||t||"video"!==c||(t=f),this._observer.safeEmit("newconsumer",f),i.resolve(f)}}catch(n){for(const t of e)t.reject(n)}if(t)try{const e=h.generateProbatorRtpParameters(t.rtpParameters);await this._handler.receive([{trackId:"probator",kind:"video",rtpParameters:e}]),y.debug("createPendingConsumers() | Consumer for RTP probation created"),this._probatorConsumerCreated=!0}catch(n){y.error("createPendingConsumers() | failed to create Consumer for RTP probation:%o",n)}}),"transport.createPendingConsumers()").then((()=>{this._consumerCreationInProgress=!1,this._pendingConsumerTasks.length>0&&this.createPendingConsumers()})).catch((()=>{}))}pausePendingConsumers(){this._consumerPauseInProgress=!0,this._awaitQueue.push((async()=>{if(0===this._pendingPauseConsumers.size)return void y.debug("pausePendingConsumers() | there is no Consumer to be paused");const e=Array.from(this._pendingPauseConsumers.values());this._pendingPauseConsumers.clear();try{const t=e.map((e=>e.localId));await this._handler.pauseReceiving(t)}catch(t){y.error("pausePendingConsumers() | failed to pause Consumers:",t)}}),"transport.pausePendingConsumers").then((()=>{this._consumerPauseInProgress=!1,this._pendingPauseConsumers.size>0&&this.pausePendingConsumers()})).catch((()=>{}))}resumePendingConsumers(){this._consumerResumeInProgress=!0,this._awaitQueue.push((async()=>{if(0===this._pendingResumeConsumers.size)return void y.debug("resumePendingConsumers() | there is no Consumer to be resumed");const e=Array.from(this._pendingResumeConsumers.values());this._pendingResumeConsumers.clear();try{const t=e.map((e=>e.localId));await this._handler.resumeReceiving(t)}catch(t){y.error("resumePendingConsumers() | failed to resume Consumers:",t)}}),"transport.resumePendingConsumers").then((()=>{this._consumerResumeInProgress=!1,this._pendingResumeConsumers.size>0&&this.resumePendingConsumers()})).catch((()=>{}))}closePendingConsumers(){this._consumerCloseInProgress=!0,this._awaitQueue.push((async()=>{if(0===this._pendingCloseConsumers.size)return void y.debug("closePendingConsumers() | there is no Consumer to be closed");const e=Array.from(this._pendingCloseConsumers.values());this._pendingCloseConsumers.clear();try{await this._handler.stopReceiving(e.map((e=>e.localId)))}catch(t){y.error("closePendingConsumers() | failed to close Consumers:",t)}}),"transport.closePendingConsumers").then((()=>{this._consumerCloseInProgress=!1,this._pendingCloseConsumers.size>0&&this.closePendingConsumers()})).catch((()=>{}))}handleHandler(){const e=this._handler;e.on("@connect",((e,t,r)=>{let{dtlsParameters:n}=e;this._closed?r(new u.InvalidStateError("closed")):this.safeEmit("connect",{dtlsParameters:n},t,r)})),e.on("@icegatheringstatechange",(e=>{e!==this._iceGatheringState&&(y.debug("ICE gathering state changed to %s",e),this._iceGatheringState=e,this._closed||this.safeEmit("icegatheringstatechange",e))})),e.on("@connectionstatechange",(e=>{e!==this._connectionState&&(y.debug("connection state changed to %s",e),this._connectionState=e,this._closed||this.safeEmit("connectionstatechange",e))}))}handleProducer(e){e.on("@close",(()=>{this._producers.delete(e.id),this._closed||this._awaitQueue.push((async()=>await this._handler.stopSending(e.localId)),"producer @close event").catch((e=>y.warn("producer.close() failed:%o",e)))})),e.on("@pause",((t,r)=>{this._awaitQueue.push((async()=>await this._handler.pauseSending(e.localId)),"producer @pause event").then(t).catch(r)})),e.on("@resume",((t,r)=>{this._awaitQueue.push((async()=>await this._handler.resumeSending(e.localId)),"producer @resume event").then(t).catch(r)})),e.on("@replacetrack",((t,r,n)=>{this._awaitQueue.push((async()=>await this._handler.replaceTrack(e.localId,t)),"producer @replacetrack event").then(r).catch(n)})),e.on("@setmaxspatiallayer",((t,r,n)=>{this._awaitQueue.push((async()=>await this._handler.setMaxSpatialLayer(e.localId,t)),"producer @setmaxspatiallayer event").then(r).catch(n)})),e.on("@setrtpencodingparameters",((t,r,n)=>{this._awaitQueue.push((async()=>await this._handler.setRtpEncodingParameters(e.localId,t)),"producer @setrtpencodingparameters event").then(r).catch(n)})),e.on("@getstats",((t,r)=>{if(this._closed)return r(new u.InvalidStateError("closed"));this._handler.getSenderStats(e.localId).then(t).catch(r)}))}handleConsumer(e){e.on("@close",(()=>{this._consumers.delete(e.id),this._pendingPauseConsumers.delete(e.id),this._pendingResumeConsumers.delete(e.id),this._closed||(this._pendingCloseConsumers.set(e.id,e),!1===this._consumerCloseInProgress&&this.closePendingConsumers())})),e.on("@pause",(()=>{this._pendingResumeConsumers.has(e.id)&&this._pendingResumeConsumers.delete(e.id),this._pendingPauseConsumers.set(e.id,e),(0,c.default)((()=>{this._closed||!1===this._consumerPauseInProgress&&this.pausePendingConsumers()}))})),e.on("@resume",(()=>{this._pendingPauseConsumers.has(e.id)&&this._pendingPauseConsumers.delete(e.id),this._pendingResumeConsumers.set(e.id,e),(0,c.default)((()=>{this._closed||!1===this._consumerResumeInProgress&&this.resumePendingConsumers()}))})),e.on("@getstats",((t,r)=>{if(this._closed)return r(new u.InvalidStateError("closed"));this._handler.getReceiverStats(e.localId).then(t).catch(r)}))}handleDataProducer(e){e.on("@close",(()=>{this._dataProducers.delete(e.id)}))}handleDataConsumer(e){e.on("@close",(()=>{this._dataConsumers.delete(e.id)}))}}t.Transport=_},3288:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InvalidStateError=t.UnsupportedError=void 0;class r extends Error{constructor(e){super(e),this.name="UnsupportedError",Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(this,r):this.stack=new Error(e).stack}}t.UnsupportedError=r;class n extends Error{constructor(e){super(e),this.name="InvalidStateError",Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(this,n):this.stack=new Error(e).stack}}t.InvalidStateError=n},4112:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Chrome111=void 0;const s=a(r(7181)),o=r(56),c=a(r(6176)),d=a(r(9324)),l=a(r(6488)),u=a(r(4888)),p=a(r(4788)),h=r(3288),f=r(2356),m=r(992),g=r(2308),v=new o.Logger("Chrome111"),y={OS:1024,MIS:1024};class b extends f.HandlerInterface{static createFactory(){return()=>new b}constructor(){super(),this._closed=!1,this._mapMidTransceiver=new Map,this._sendStream=new MediaStream,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return"Chrome111"}close(){if(v.debug("close()"),!this._closed){if(this._closed=!0,this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}}async getNativeRtpCapabilities(){v.debug("getNativeRtpCapabilities()");const e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"});try{e.addTransceiver("audio"),e.addTransceiver("video");const r=await e.createOffer();try{e.close()}catch(t){}const n=s.parse(r.sdp),i=l.extractRtpCapabilities({sdpObject:n});return p.addNackSuppportForOpus(i),i}catch(t){try{e.close()}catch(r){}throw t}}async getNativeSctpCapabilities(){return v.debug("getNativeSctpCapabilities()"),{numStreams:y}}run(e){let{direction:t,iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:a,iceServers:s,iceTransportPolicy:o,additionalSettings:c,proprietaryConstraints:l,extendedRtpCapabilities:u}=e;this.assertNotClosed(),v.debug("run()"),this._direction=t,this._remoteSdp=new m.RemoteSdp({iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:a}),this._sendingRtpParametersByKind={audio:d.getSendingRtpParameters("audio",u),video:d.getSendingRtpParameters("video",u)},this._sendingRemoteRtpParametersByKind={audio:d.getSendingRemoteRtpParameters("audio",u),video:d.getSendingRemoteRtpParameters("video",u)},i.role&&"auto"!==i.role&&(this._forcedLocalDtlsRole="server"===i.role?"client":"server"),this._pc=new RTCPeerConnection({iceServers:s||[],iceTransportPolicy:o||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan",...c},l),this._pc.addEventListener("icegatheringstatechange",(()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)})),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",(()=>{this.emit("@connectionstatechange",this._pc.connectionState)})):(v.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.addEventListener("iceconnectionstatechange",(()=>{switch(this._pc.iceConnectionState){case"checking":this.emit("@connectionstatechange","connecting");break;case"connected":case"completed":this.emit("@connectionstatechange","connected");break;case"failed":this.emit("@connectionstatechange","failed");break;case"disconnected":this.emit("@connectionstatechange","disconnected");break;case"closed":this.emit("@connectionstatechange","closed")}})))}async updateIceServers(e){this.assertNotClosed(),v.debug("updateIceServers()");const t=this._pc.getConfiguration();t.iceServers=e,this._pc.setConfiguration(t)}async restartIce(e){if(this.assertNotClosed(),v.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),this._transportReady)if("send"===this._direction){const e=await this._pc.createOffer({iceRestart:!0});v.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",e),await this._pc.setLocalDescription(e);const t={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",t),await this._pc.setRemoteDescription(t)}else{const e={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",e),await this._pc.setRemoteDescription(e);const t=await this._pc.createAnswer();v.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",t),await this._pc.setLocalDescription(t)}}async getTransportStats(){return this.assertNotClosed(),this._pc.getStats()}async send(e){let{track:t,encodings:r,codecOptions:n,codec:i}=e;if(this.assertNotClosed(),this.assertSendDirection(),v.debug("send() [kind:%s, track.id:%s]",t.kind,t.id),r&&r.length>1){r.forEach(((e,t)=>{e.rid="r".concat(t)}));let e=1,t=1;for(const n of r){const e=n.scalabilityMode?(0,g.parse)(n.scalabilityMode).temporalLayers:3;e>t&&(t=e)}for(const n of r)n.rid="r".concat(e++),n.scalabilityMode="L1T".concat(t)}const a=c.clone(this._sendingRtpParametersByKind[t.kind],{});a.codecs=d.reduceCodecs(a.codecs,i);const o=c.clone(this._sendingRemoteRtpParametersByKind[t.kind],{});o.codecs=d.reduceCodecs(o.codecs,i);const p=this._remoteSdp.getNextMediaSectionIdx(),h=this._pc.addTransceiver(t,{direction:"sendonly",streams:[this._sendStream],sendEncodings:r}),f=await this._pc.createOffer();let m=s.parse(f.sdp);var y;this._transportReady||await this.setupTransport({localDtlsRole:null!==(y=this._forcedLocalDtlsRole)&&void 0!==y?y:"client",localSdpObject:m});v.debug("send() | calling pc.setLocalDescription() [offer:%o]",f),await this._pc.setLocalDescription(f);const b=h.mid;a.mid=b,m=s.parse(this._pc.localDescription.sdp);const _=m.media[p.idx];if(a.rtcp.cname=l.getCname({offerMediaObject:_}),r)if(1===r.length){const e=u.getRtpEncodings({offerMediaObject:_});Object.assign(e[0],r[0]),a.encodings=e}else a.encodings=r;else a.encodings=u.getRtpEncodings({offerMediaObject:_});this._remoteSdp.send({offerMediaObject:_,reuseMid:p.reuseMid,offerRtpParameters:a,answerRtpParameters:o,codecOptions:n,extmapAllowMixed:!0});const w={type:"answer",sdp:this._remoteSdp.getSdp()};return v.debug("send() | calling pc.setRemoteDescription() [answer:%o]",w),await this._pc.setRemoteDescription(w),this._mapMidTransceiver.set(b,h),{localId:b,rtpParameters:a,rtpSender:h.sender}}async stopSending(e){if(this.assertSendDirection(),v.debug("stopSending() [localId:%s]",e),this._closed)return;const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");t.sender.replaceTrack(null),this._pc.removeTrack(t.sender);if(this._remoteSdp.closeMediaSection(t.mid))try{t.stop()}catch(i){}const r=await this._pc.createOffer();v.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);const n={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n),this._mapMidTransceiver.delete(e)}async pauseSending(e){this.assertNotClosed(),this.assertSendDirection(),v.debug("pauseSending() [localId:%s]",e);const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");t.direction="inactive",this._remoteSdp.pauseMediaSection(e);const r=await this._pc.createOffer();v.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);const n={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}async resumeSending(e){this.assertNotClosed(),this.assertSendDirection(),v.debug("resumeSending() [localId:%s]",e);const t=this._mapMidTransceiver.get(e);if(this._remoteSdp.resumeSendingMediaSection(e),!t)throw new Error("associated RTCRtpTransceiver not found");t.direction="sendonly";const r=await this._pc.createOffer();v.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);const n={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}async replaceTrack(e,t){this.assertNotClosed(),this.assertSendDirection(),t?v.debug("replaceTrack() [localId:%s, track.id:%s]",e,t.id):v.debug("replaceTrack() [localId:%s, no track]",e);const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");await r.sender.replaceTrack(t)}async setMaxSpatialLayer(e,t){this.assertNotClosed(),this.assertSendDirection(),v.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,t);const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");const n=r.sender.getParameters();n.encodings.forEach(((e,r)=>{e.active=r<=t})),await r.sender.setParameters(n),this._remoteSdp.muxMediaSectionSimulcast(e,n.encodings);const i=await this._pc.createOffer();v.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const a={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",a),await this._pc.setRemoteDescription(a)}async setRtpEncodingParameters(e,t){this.assertNotClosed(),this.assertSendDirection(),v.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,t);const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");const n=r.sender.getParameters();n.encodings.forEach(((e,r)=>{n.encodings[r]={...e,...t}})),await r.sender.setParameters(n),this._remoteSdp.muxMediaSectionSimulcast(e,n.encodings);const i=await this._pc.createOffer();v.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const a={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",a),await this._pc.setRemoteDescription(a)}async getSenderStats(e){this.assertNotClosed(),this.assertSendDirection();const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");return t.sender.getStats()}async sendDataChannel(e){let{ordered:t,maxPacketLifeTime:r,maxRetransmits:n,label:i,protocol:a}=e;this.assertNotClosed(),this.assertSendDirection();const o={negotiated:!0,id:this._nextSendSctpStreamId,ordered:t,maxPacketLifeTime:r,maxRetransmits:n,protocol:a};v.debug("sendDataChannel() [options:%o]",o);const c=this._pc.createDataChannel(i,o);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%y.MIS,!this._hasDataChannelMediaSection){const e=await this._pc.createOffer(),t=s.parse(e.sdp),r=t.media.find((e=>"application"===e.type));var d;if(!this._transportReady)await this.setupTransport({localDtlsRole:null!==(d=this._forcedLocalDtlsRole)&&void 0!==d?d:"client",localSdpObject:t});v.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",e),await this._pc.setLocalDescription(e),this._remoteSdp.sendSctpAssociation({offerMediaObject:r});const n={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n),this._hasDataChannelMediaSection=!0}return{dataChannel:c,sctpStreamParameters:{streamId:o.id,ordered:o.ordered,maxPacketLifeTime:o.maxPacketLifeTime,maxRetransmits:o.maxRetransmits}}}async receive(e){this.assertNotClosed(),this.assertRecvDirection();const t=[],r=new Map;for(const s of e){const{trackId:e,kind:t,rtpParameters:n,streamId:i}=s;v.debug("receive() [trackId:%s, kind:%s]",e,t);const a=n.mid||String(this._mapMidTransceiver.size);r.set(e,a),this._remoteSdp.receive({mid:a,kind:t,offerRtpParameters:n,streamId:i||n.rtcp.cname,trackId:e})}const n={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);let i=await this._pc.createAnswer();const a=s.parse(i.sdp);for(const s of e){const{trackId:e,rtpParameters:t}=s,n=r.get(e),i=a.media.find((e=>String(e.mid)===n));l.applyCodecParameters({offerRtpParameters:t,answerMediaObject:i})}var o;(i={type:"answer",sdp:s.write(a)},this._transportReady)||await this.setupTransport({localDtlsRole:null!==(o=this._forcedLocalDtlsRole)&&void 0!==o?o:"client",localSdpObject:a});v.debug("receive() | calling pc.setLocalDescription() [answer:%o]",i),await this._pc.setLocalDescription(i);for(const s of e){const{trackId:e}=s,n=r.get(e),i=this._pc.getTransceivers().find((e=>e.mid===n));if(!i)throw new Error("new RTCRtpTransceiver not found");this._mapMidTransceiver.set(n,i),t.push({localId:n,track:i.receiver.track,rtpReceiver:i.receiver})}return t}async stopReceiving(e){if(this.assertRecvDirection(),this._closed)return;for(const n of e){v.debug("stopReceiving() [localId:%s]",n);const e=this._mapMidTransceiver.get(n);if(!e)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(e.mid)}const t={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const r=await this._pc.createAnswer();v.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",r),await this._pc.setLocalDescription(r);for(const n of e)this._mapMidTransceiver.delete(n)}async pauseReceiving(e){this.assertNotClosed(),this.assertRecvDirection();for(const n of e){v.debug("pauseReceiving() [localId:%s]",n);const e=this._mapMidTransceiver.get(n);if(!e)throw new Error("associated RTCRtpTransceiver not found");e.direction="inactive",this._remoteSdp.pauseMediaSection(n)}const t={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const r=await this._pc.createAnswer();v.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",r),await this._pc.setLocalDescription(r)}async resumeReceiving(e){this.assertNotClosed(),this.assertRecvDirection();for(const n of e){v.debug("resumeReceiving() [localId:%s]",n);const e=this._mapMidTransceiver.get(n);if(!e)throw new Error("associated RTCRtpTransceiver not found");e.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(n)}const t={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const r=await this._pc.createAnswer();v.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",r),await this._pc.setLocalDescription(r)}async getReceiverStats(e){this.assertNotClosed(),this.assertRecvDirection();const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");return t.receiver.getStats()}async receiveDataChannel(e){let{sctpStreamParameters:t,label:r,protocol:n}=e;this.assertNotClosed(),this.assertRecvDirection();const{streamId:i,ordered:a,maxPacketLifeTime:o,maxRetransmits:c}=t,d={negotiated:!0,id:i,ordered:a,maxPacketLifeTime:o,maxRetransmits:c,protocol:n};v.debug("receiveDataChannel() [options:%o]",d);const l=this._pc.createDataChannel(r,d);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const e={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",e),await this._pc.setRemoteDescription(e);const t=await this._pc.createAnswer();if(!this._transportReady){var u;const e=s.parse(t.sdp);await this.setupTransport({localDtlsRole:null!==(u=this._forcedLocalDtlsRole)&&void 0!==u?u:"client",localSdpObject:e})}v.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",t),await this._pc.setLocalDescription(t),this._hasDataChannelMediaSection=!0}return{dataChannel:l}}async setupTransport(e){let{localDtlsRole:t,localSdpObject:r}=e;r||(r=s.parse(this._pc.localDescription.sdp));const n=l.extractDtlsParameters({sdpObject:r});n.role=t,this._remoteSdp.updateDtlsRole("client"===t?"server":"client"),await new Promise(((e,t)=>{this.safeEmit("@connect",{dtlsParameters:n},e,t)})),this._transportReady=!0}assertNotClosed(){if(this._closed)throw new h.InvalidStateError("method called in a closed handler")}assertSendDirection(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}t.Chrome111=b},9608:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Chrome55=void 0;const s=a(r(7181)),o=r(56),c=r(3288),d=a(r(6176)),l=a(r(9324)),u=a(r(6488)),p=a(r(752)),h=r(2356),f=r(992),m=new o.Logger("Chrome55"),g={OS:1024,MIS:1024};class v extends h.HandlerInterface{static createFactory(){return()=>new v}constructor(){super(),this._sendStream=new MediaStream,this._mapSendLocalIdTrack=new Map,this._nextSendLocalId=0,this._mapRecvLocalIdInfo=new Map,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return"Chrome55"}close(){if(m.debug("close()"),this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}async getNativeRtpCapabilities(){m.debug("getNativeRtpCapabilities()");const e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"});try{const r=await e.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});try{e.close()}catch(t){}const n=s.parse(r.sdp);return u.extractRtpCapabilities({sdpObject:n})}catch(t){try{e.close()}catch(r){}throw t}}async getNativeSctpCapabilities(){return m.debug("getNativeSctpCapabilities()"),{numStreams:g}}run(e){let{direction:t,iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:a,iceServers:s,iceTransportPolicy:o,additionalSettings:c,proprietaryConstraints:d,extendedRtpCapabilities:u}=e;m.debug("run()"),this._direction=t,this._remoteSdp=new f.RemoteSdp({iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:a,planB:!0}),this._sendingRtpParametersByKind={audio:l.getSendingRtpParameters("audio",u),video:l.getSendingRtpParameters("video",u)},this._sendingRemoteRtpParametersByKind={audio:l.getSendingRemoteRtpParameters("audio",u),video:l.getSendingRemoteRtpParameters("video",u)},i.role&&"auto"!==i.role&&(this._forcedLocalDtlsRole="server"===i.role?"client":"server"),this._pc=new RTCPeerConnection({iceServers:s||[],iceTransportPolicy:o||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b",...c},d),this._pc.addEventListener("icegatheringstatechange",(()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)})),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",(()=>{this.emit("@connectionstatechange",this._pc.connectionState)})):this._pc.addEventListener("iceconnectionstatechange",(()=>{switch(m.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":this.emit("@connectionstatechange","connecting");break;case"connected":case"completed":this.emit("@connectionstatechange","connected");break;case"failed":this.emit("@connectionstatechange","failed");break;case"disconnected":this.emit("@connectionstatechange","disconnected");break;case"closed":this.emit("@connectionstatechange","closed")}}))}async updateIceServers(e){m.debug("updateIceServers()");const t=this._pc.getConfiguration();t.iceServers=e,this._pc.setConfiguration(t)}async restartIce(e){if(m.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),this._transportReady)if("send"===this._direction){const e=await this._pc.createOffer({iceRestart:!0});m.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",e),await this._pc.setLocalDescription(e);const t={type:"answer",sdp:this._remoteSdp.getSdp()};m.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",t),await this._pc.setRemoteDescription(t)}else{const e={type:"offer",sdp:this._remoteSdp.getSdp()};m.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",e),await this._pc.setRemoteDescription(e);const t=await this._pc.createAnswer();m.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",t),await this._pc.setLocalDescription(t)}}async getTransportStats(){return this._pc.getStats()}async send(e){let{track:t,encodings:r,codecOptions:n,codec:i}=e;this.assertSendDirection(),m.debug("send() [kind:%s, track.id:%s]",t.kind,t.id),i&&m.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(t),this._pc.addStream(this._sendStream);let a,o=await this._pc.createOffer(),c=s.parse(o.sdp);const h=d.clone(this._sendingRtpParametersByKind[t.kind],{});h.codecs=l.reduceCodecs(h.codecs);const f=d.clone(this._sendingRemoteRtpParametersByKind[t.kind],{});var g;(f.codecs=l.reduceCodecs(f.codecs),this._transportReady)||await this.setupTransport({localDtlsRole:null!==(g=this._forcedLocalDtlsRole)&&void 0!==g?g:"client",localSdpObject:c});if("video"===t.kind&&r&&r.length>1&&(m.debug("send() | enabling simulcast"),c=s.parse(o.sdp),a=c.media.find((e=>"video"===e.type)),p.addLegacySimulcast({offerMediaObject:a,track:t,numStreams:r.length}),o={type:"offer",sdp:s.write(c)}),m.debug("send() | calling pc.setLocalDescription() [offer:%o]",o),await this._pc.setLocalDescription(o),c=s.parse(this._pc.localDescription.sdp),a=c.media.find((e=>e.type===t.kind)),h.rtcp.cname=u.getCname({offerMediaObject:a}),h.encodings=p.getRtpEncodings({offerMediaObject:a,track:t}),r)for(let s=0;s<h.encodings.length;++s)r[s]&&Object.assign(h.encodings[s],r[s]);if(h.encodings.length>1&&"video/vp8"===h.codecs[0].mimeType.toLowerCase())for(const s of h.encodings)s.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:a,offerRtpParameters:h,answerRtpParameters:f,codecOptions:n});const v={type:"answer",sdp:this._remoteSdp.getSdp()};m.debug("send() | calling pc.setRemoteDescription() [answer:%o]",v),await this._pc.setRemoteDescription(v);const y=String(this._nextSendLocalId);return this._nextSendLocalId++,this._mapSendLocalIdTrack.set(y,t),{localId:y,rtpParameters:h}}async stopSending(e){this.assertSendDirection(),m.debug("stopSending() [localId:%s]",e);const t=this._mapSendLocalIdTrack.get(e);if(!t)throw new Error("track not found");this._mapSendLocalIdTrack.delete(e),this._sendStream.removeTrack(t),this._pc.addStream(this._sendStream);const r=await this._pc.createOffer();m.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",r);try{await this._pc.setLocalDescription(r)}catch(i){if(0===this._sendStream.getTracks().length)return void m.warn("stopSending() | ignoring expected error due no sending tracks: %s",i.toString());throw i}if("stable"===this._pc.signalingState)return;const n={type:"answer",sdp:this._remoteSdp.getSdp()};m.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}async pauseSending(e){}async resumeSending(e){}async replaceTrack(e,t){throw new c.UnsupportedError("not implemented")}async setMaxSpatialLayer(e,t){throw new c.UnsupportedError(" not implemented")}async setRtpEncodingParameters(e,t){throw new c.UnsupportedError("not supported")}async getSenderStats(e){throw new c.UnsupportedError("not implemented")}async sendDataChannel(e){let{ordered:t,maxPacketLifeTime:r,maxRetransmits:n,label:i,protocol:a}=e;this.assertSendDirection();const o={negotiated:!0,id:this._nextSendSctpStreamId,ordered:t,maxPacketLifeTime:r,maxRetransmitTime:r,maxRetransmits:n,protocol:a};m.debug("sendDataChannel() [options:%o]",o);const c=this._pc.createDataChannel(i,o);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%g.MIS,!this._hasDataChannelMediaSection){const e=await this._pc.createOffer(),t=s.parse(e.sdp),r=t.media.find((e=>"application"===e.type));var d;if(!this._transportReady)await this.setupTransport({localDtlsRole:null!==(d=this._forcedLocalDtlsRole)&&void 0!==d?d:"client",localSdpObject:t});m.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",e),await this._pc.setLocalDescription(e),this._remoteSdp.sendSctpAssociation({offerMediaObject:r});const n={type:"answer",sdp:this._remoteSdp.getSdp()};m.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n),this._hasDataChannelMediaSection=!0}return{dataChannel:c,sctpStreamParameters:{streamId:o.id,ordered:o.ordered,maxPacketLifeTime:o.maxPacketLifeTime,maxRetransmits:o.maxRetransmits}}}async receive(e){this.assertRecvDirection();const t=[];for(const s of e){const{trackId:e,kind:t,rtpParameters:r,streamId:n}=s;m.debug("receive() [trackId:%s, kind:%s]",e,t);const i=t;this._remoteSdp.receive({mid:i,kind:t,offerRtpParameters:r,streamId:n||r.rtcp.cname,trackId:e})}const r={type:"offer",sdp:this._remoteSdp.getSdp()};m.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);let n=await this._pc.createAnswer();const i=s.parse(n.sdp);for(const s of e){const{kind:e,rtpParameters:t}=s,r=e,n=i.media.find((e=>String(e.mid)===r));u.applyCodecParameters({offerRtpParameters:t,answerMediaObject:n})}var a;(n={type:"answer",sdp:s.write(i)},this._transportReady)||await this.setupTransport({localDtlsRole:null!==(a=this._forcedLocalDtlsRole)&&void 0!==a?a:"client",localSdpObject:i});m.debug("receive() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n);for(const s of e){const{kind:e,trackId:r,rtpParameters:n}=s,i=e,a=r,o=s.streamId||n.rtcp.cname,c=this._pc.getRemoteStreams().find((e=>e.id===o)).getTrackById(a);if(!c)throw new Error("remote track not found");this._mapRecvLocalIdInfo.set(a,{mid:i,rtpParameters:n}),t.push({localId:a,track:c})}return t}async stopReceiving(e){this.assertRecvDirection();for(const n of e){m.debug("stopReceiving() [localId:%s]",n);const{mid:e,rtpParameters:t}=this._mapRecvLocalIdInfo.get(n)||{};this._mapRecvLocalIdInfo.delete(n),this._remoteSdp.planBStopReceiving({mid:e,offerRtpParameters:t})}const t={type:"offer",sdp:this._remoteSdp.getSdp()};m.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const r=await this._pc.createAnswer();m.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",r),await this._pc.setLocalDescription(r)}async pauseReceiving(e){}async resumeReceiving(e){}async getReceiverStats(e){throw new c.UnsupportedError("not implemented")}async receiveDataChannel(e){let{sctpStreamParameters:t,label:r,protocol:n}=e;this.assertRecvDirection();const{streamId:i,ordered:a,maxPacketLifeTime:o,maxRetransmits:c}=t,d={negotiated:!0,id:i,ordered:a,maxPacketLifeTime:o,maxRetransmitTime:o,maxRetransmits:c,protocol:n};m.debug("receiveDataChannel() [options:%o]",d);const l=this._pc.createDataChannel(r,d);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0});const e={type:"offer",sdp:this._remoteSdp.getSdp()};m.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",e),await this._pc.setRemoteDescription(e);const t=await this._pc.createAnswer();if(!this._transportReady){var u;const e=s.parse(t.sdp);await this.setupTransport({localDtlsRole:null!==(u=this._forcedLocalDtlsRole)&&void 0!==u?u:"client",localSdpObject:e})}m.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",t),await this._pc.setLocalDescription(t),this._hasDataChannelMediaSection=!0}return{dataChannel:l}}async setupTransport(e){let{localDtlsRole:t,localSdpObject:r}=e;r||(r=s.parse(this._pc.localDescription.sdp));const n=u.extractDtlsParameters({sdpObject:r});n.role=t,this._remoteSdp.updateDtlsRole("client"===t?"server":"client"),await new Promise(((e,t)=>{this.safeEmit("@connect",{dtlsParameters:n},e,t)})),this._transportReady=!0}assertSendDirection(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}t.Chrome55=v},8844:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Chrome67=void 0;const s=a(r(7181)),o=r(56),c=a(r(6176)),d=a(r(9324)),l=a(r(6488)),u=a(r(752)),p=r(2356),h=r(992),f=new o.Logger("Chrome67"),m={OS:1024,MIS:1024};class g extends p.HandlerInterface{static createFactory(){return()=>new g}constructor(){super(),this._sendStream=new MediaStream,this._mapSendLocalIdRtpSender=new Map,this._nextSendLocalId=0,this._mapRecvLocalIdInfo=new Map,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return"Chrome67"}close(){if(f.debug("close()"),this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}async getNativeRtpCapabilities(){f.debug("getNativeRtpCapabilities()");const e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"});try{const r=await e.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});try{e.close()}catch(t){}const n=s.parse(r.sdp);return l.extractRtpCapabilities({sdpObject:n})}catch(t){try{e.close()}catch(r){}throw t}}async getNativeSctpCapabilities(){return f.debug("getNativeSctpCapabilities()"),{numStreams:m}}run(e){let{direction:t,iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:a,iceServers:s,iceTransportPolicy:o,additionalSettings:c,proprietaryConstraints:l,extendedRtpCapabilities:u}=e;f.debug("run()"),this._direction=t,this._remoteSdp=new h.RemoteSdp({iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:a,planB:!0}),this._sendingRtpParametersByKind={audio:d.getSendingRtpParameters("audio",u),video:d.getSendingRtpParameters("video",u)},this._sendingRemoteRtpParametersByKind={audio:d.getSendingRemoteRtpParameters("audio",u),video:d.getSendingRemoteRtpParameters("video",u)},i.role&&"auto"!==i.role&&(this._forcedLocalDtlsRole="server"===i.role?"client":"server"),this._pc=new RTCPeerConnection({iceServers:s||[],iceTransportPolicy:o||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b",...c},l),this._pc.addEventListener("icegatheringstatechange",(()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)})),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",(()=>{this.emit("@connectionstatechange",this._pc.connectionState)})):this._pc.addEventListener("iceconnectionstatechange",(()=>{switch(f.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":this.emit("@connectionstatechange","connecting");break;case"connected":case"completed":this.emit("@connectionstatechange","connected");break;case"failed":this.emit("@connectionstatechange","failed");break;case"disconnected":this.emit("@connectionstatechange","disconnected");break;case"closed":this.emit("@connectionstatechange","closed")}}))}async updateIceServers(e){f.debug("updateIceServers()");const t=this._pc.getConfiguration();t.iceServers=e,this._pc.setConfiguration(t)}async restartIce(e){if(f.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),this._transportReady)if("send"===this._direction){const e=await this._pc.createOffer({iceRestart:!0});f.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",e),await this._pc.setLocalDescription(e);const t={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",t),await this._pc.setRemoteDescription(t)}else{const e={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",e),await this._pc.setRemoteDescription(e);const t=await this._pc.createAnswer();f.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",t),await this._pc.setLocalDescription(t)}}async getTransportStats(){return this._pc.getStats()}async send(e){let{track:t,encodings:r,codecOptions:n,codec:i}=e;this.assertSendDirection(),f.debug("send() [kind:%s, track.id:%s]",t.kind,t.id),i&&f.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(t),this._pc.addTrack(t,this._sendStream);let a,o=await this._pc.createOffer(),p=s.parse(o.sdp);const h=c.clone(this._sendingRtpParametersByKind[t.kind],{});h.codecs=d.reduceCodecs(h.codecs);const m=c.clone(this._sendingRemoteRtpParametersByKind[t.kind],{});var g;(m.codecs=d.reduceCodecs(m.codecs),this._transportReady)||await this.setupTransport({localDtlsRole:null!==(g=this._forcedLocalDtlsRole)&&void 0!==g?g:"client",localSdpObject:p});if("video"===t.kind&&r&&r.length>1&&(f.debug("send() | enabling simulcast"),p=s.parse(o.sdp),a=p.media.find((e=>"video"===e.type)),u.addLegacySimulcast({offerMediaObject:a,track:t,numStreams:r.length}),o={type:"offer",sdp:s.write(p)}),f.debug("send() | calling pc.setLocalDescription() [offer:%o]",o),await this._pc.setLocalDescription(o),p=s.parse(this._pc.localDescription.sdp),a=p.media.find((e=>e.type===t.kind)),h.rtcp.cname=l.getCname({offerMediaObject:a}),h.encodings=u.getRtpEncodings({offerMediaObject:a,track:t}),r)for(let s=0;s<h.encodings.length;++s)r[s]&&Object.assign(h.encodings[s],r[s]);if(h.encodings.length>1&&"video/vp8"===h.codecs[0].mimeType.toLowerCase())for(const s of h.encodings)s.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:a,offerRtpParameters:h,answerRtpParameters:m,codecOptions:n});const v={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("send() | calling pc.setRemoteDescription() [answer:%o]",v),await this._pc.setRemoteDescription(v);const y=String(this._nextSendLocalId);this._nextSendLocalId++;const b=this._pc.getSenders().find((e=>e.track===t));return this._mapSendLocalIdRtpSender.set(y,b),{localId:y,rtpParameters:h,rtpSender:b}}async stopSending(e){this.assertSendDirection(),f.debug("stopSending() [localId:%s]",e);const t=this._mapSendLocalIdRtpSender.get(e);if(!t)throw new Error("associated RTCRtpSender not found");this._pc.removeTrack(t),t.track&&this._sendStream.removeTrack(t.track),this._mapSendLocalIdRtpSender.delete(e);const r=await this._pc.createOffer();f.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",r);try{await this._pc.setLocalDescription(r)}catch(i){if(0===this._sendStream.getTracks().length)return void f.warn("stopSending() | ignoring expected error due no sending tracks: %s",i.toString());throw i}if("stable"===this._pc.signalingState)return;const n={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}async pauseSending(e){}async resumeSending(e){}async replaceTrack(e,t){this.assertSendDirection(),t?f.debug("replaceTrack() [localId:%s, track.id:%s]",e,t.id):f.debug("replaceTrack() [localId:%s, no track]",e);const r=this._mapSendLocalIdRtpSender.get(e);if(!r)throw new Error("associated RTCRtpSender not found");const n=r.track;await r.replaceTrack(t),n&&this._sendStream.removeTrack(n),t&&this._sendStream.addTrack(t)}async setMaxSpatialLayer(e,t){this.assertSendDirection(),f.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,t);const r=this._mapSendLocalIdRtpSender.get(e);if(!r)throw new Error("associated RTCRtpSender not found");const n=r.getParameters();n.encodings.forEach(((e,r)=>{e.active=r<=t})),await r.setParameters(n)}async setRtpEncodingParameters(e,t){this.assertSendDirection(),f.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,t);const r=this._mapSendLocalIdRtpSender.get(e);if(!r)throw new Error("associated RTCRtpSender not found");const n=r.getParameters();n.encodings.forEach(((e,r)=>{n.encodings[r]={...e,...t}})),await r.setParameters(n)}async getSenderStats(e){this.assertSendDirection();const t=this._mapSendLocalIdRtpSender.get(e);if(!t)throw new Error("associated RTCRtpSender not found");return t.getStats()}async sendDataChannel(e){let{ordered:t,maxPacketLifeTime:r,maxRetransmits:n,label:i,protocol:a}=e;this.assertSendDirection();const o={negotiated:!0,id:this._nextSendSctpStreamId,ordered:t,maxPacketLifeTime:r,maxRetransmitTime:r,maxRetransmits:n,protocol:a};f.debug("sendDataChannel() [options:%o]",o);const c=this._pc.createDataChannel(i,o);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%m.MIS,!this._hasDataChannelMediaSection){const e=await this._pc.createOffer(),t=s.parse(e.sdp),r=t.media.find((e=>"application"===e.type));var d;if(!this._transportReady)await this.setupTransport({localDtlsRole:null!==(d=this._forcedLocalDtlsRole)&&void 0!==d?d:"client",localSdpObject:t});f.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",e),await this._pc.setLocalDescription(e),this._remoteSdp.sendSctpAssociation({offerMediaObject:r});const n={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n),this._hasDataChannelMediaSection=!0}return{dataChannel:c,sctpStreamParameters:{streamId:o.id,ordered:o.ordered,maxPacketLifeTime:o.maxPacketLifeTime,maxRetransmits:o.maxRetransmits}}}async receive(e){this.assertRecvDirection();const t=[];for(const s of e){const{trackId:e,kind:t,rtpParameters:r,streamId:n}=s;f.debug("receive() [trackId:%s, kind:%s]",e,t);const i=t;this._remoteSdp.receive({mid:i,kind:t,offerRtpParameters:r,streamId:n||r.rtcp.cname,trackId:e})}const r={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);let n=await this._pc.createAnswer();const i=s.parse(n.sdp);for(const s of e){const{kind:e,rtpParameters:t}=s,r=e,n=i.media.find((e=>String(e.mid)===r));l.applyCodecParameters({offerRtpParameters:t,answerMediaObject:n})}var a;(n={type:"answer",sdp:s.write(i)},this._transportReady)||await this.setupTransport({localDtlsRole:null!==(a=this._forcedLocalDtlsRole)&&void 0!==a?a:"client",localSdpObject:i});f.debug("receive() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n);for(const s of e){const{kind:e,trackId:r,rtpParameters:n}=s,i=r,a=e,o=this._pc.getReceivers().find((e=>e.track&&e.track.id===i));if(!o)throw new Error("new RTCRtpReceiver not");this._mapRecvLocalIdInfo.set(i,{mid:a,rtpParameters:n,rtpReceiver:o}),t.push({localId:i,track:o.track,rtpReceiver:o})}return t}async stopReceiving(e){this.assertRecvDirection();for(const n of e){f.debug("stopReceiving() [localId:%s]",n);const{mid:e,rtpParameters:t}=this._mapRecvLocalIdInfo.get(n)||{};this._mapRecvLocalIdInfo.delete(n),this._remoteSdp.planBStopReceiving({mid:e,offerRtpParameters:t})}const t={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const r=await this._pc.createAnswer();f.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",r),await this._pc.setLocalDescription(r)}async pauseReceiving(e){}async resumeReceiving(e){}async getReceiverStats(e){this.assertRecvDirection();const{rtpReceiver:t}=this._mapRecvLocalIdInfo.get(e)||{};if(!t)throw new Error("associated RTCRtpReceiver not found");return t.getStats()}async receiveDataChannel(e){let{sctpStreamParameters:t,label:r,protocol:n}=e;this.assertRecvDirection();const{streamId:i,ordered:a,maxPacketLifeTime:o,maxRetransmits:c}=t,d={negotiated:!0,id:i,ordered:a,maxPacketLifeTime:o,maxRetransmitTime:o,maxRetransmits:c,protocol:n};f.debug("receiveDataChannel() [options:%o]",d);const l=this._pc.createDataChannel(r,d);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0});const e={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",e),await this._pc.setRemoteDescription(e);const t=await this._pc.createAnswer();if(!this._transportReady){var u;const e=s.parse(t.sdp);await this.setupTransport({localDtlsRole:null!==(u=this._forcedLocalDtlsRole)&&void 0!==u?u:"client",localSdpObject:e})}f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",t),await this._pc.setLocalDescription(t),this._hasDataChannelMediaSection=!0}return{dataChannel:l}}async setupTransport(e){let{localDtlsRole:t,localSdpObject:r}=e;r||(r=s.parse(this._pc.localDescription.sdp));const n=l.extractDtlsParameters({sdpObject:r});n.role=t,this._remoteSdp.updateDtlsRole("client"===t?"server":"client"),await new Promise(((e,t)=>{this.safeEmit("@connect",{dtlsParameters:n},e,t)})),this._transportReady=!0}assertSendDirection(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}t.Chrome67=g},6660:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Chrome70=void 0;const s=a(r(7181)),o=r(56),c=a(r(6176)),d=a(r(9324)),l=a(r(6488)),u=a(r(4888)),p=r(2356),h=r(992),f=r(2308),m=new o.Logger("Chrome70"),g={OS:1024,MIS:1024};class v extends p.HandlerInterface{static createFactory(){return()=>new v}constructor(){super(),this._mapMidTransceiver=new Map,this._sendStream=new MediaStream,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return"Chrome70"}close(){if(m.debug("close()"),this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}async getNativeRtpCapabilities(){m.debug("getNativeRtpCapabilities()");const e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"});try{e.addTransceiver("audio"),e.addTransceiver("video");const r=await e.createOffer();try{e.close()}catch(t){}const n=s.parse(r.sdp);return l.extractRtpCapabilities({sdpObject:n})}catch(t){try{e.close()}catch(r){}throw t}}async getNativeSctpCapabilities(){return m.debug("getNativeSctpCapabilities()"),{numStreams:g}}run(e){let{direction:t,iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:a,iceServers:s,iceTransportPolicy:o,additionalSettings:c,proprietaryConstraints:l,extendedRtpCapabilities:u}=e;m.debug("run()"),this._direction=t,this._remoteSdp=new h.RemoteSdp({iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:a}),this._sendingRtpParametersByKind={audio:d.getSendingRtpParameters("audio",u),video:d.getSendingRtpParameters("video",u)},this._sendingRemoteRtpParametersByKind={audio:d.getSendingRemoteRtpParameters("audio",u),video:d.getSendingRemoteRtpParameters("video",u)},i.role&&"auto"!==i.role&&(this._forcedLocalDtlsRole="server"===i.role?"client":"server"),this._pc=new RTCPeerConnection({iceServers:s||[],iceTransportPolicy:o||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan",...c},l),this._pc.addEventListener("icegatheringstatechange",(()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)})),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",(()=>{this.emit("@connectionstatechange",this._pc.connectionState)})):this._pc.addEventListener("iceconnectionstatechange",(()=>{switch(m.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":this.emit("@connectionstatechange","connecting");break;case"connected":case"completed":this.emit("@connectionstatechange","connected");break;case"failed":this.emit("@connectionstatechange","failed");break;case"disconnected":this.emit("@connectionstatechange","disconnected");break;case"closed":this.emit("@connectionstatechange","closed")}}))}async updateIceServers(e){m.debug("updateIceServers()");const t=this._pc.getConfiguration();t.iceServers=e,this._pc.setConfiguration(t)}async restartIce(e){if(m.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),this._transportReady)if("send"===this._direction){const e=await this._pc.createOffer({iceRestart:!0});m.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",e),await this._pc.setLocalDescription(e);const t={type:"answer",sdp:this._remoteSdp.getSdp()};m.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",t),await this._pc.setRemoteDescription(t)}else{const e={type:"offer",sdp:this._remoteSdp.getSdp()};m.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",e),await this._pc.setRemoteDescription(e);const t=await this._pc.createAnswer();m.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",t),await this._pc.setLocalDescription(t)}}async getTransportStats(){return this._pc.getStats()}async send(e){let{track:t,encodings:r,codecOptions:n,codec:i}=e;this.assertSendDirection(),m.debug("send() [kind:%s, track.id:%s]",t.kind,t.id);const a=c.clone(this._sendingRtpParametersByKind[t.kind],{});a.codecs=d.reduceCodecs(a.codecs,i);const o=c.clone(this._sendingRemoteRtpParametersByKind[t.kind],{});o.codecs=d.reduceCodecs(o.codecs,i);const p=this._remoteSdp.getNextMediaSectionIdx(),h=this._pc.addTransceiver(t,{direction:"sendonly",streams:[this._sendStream]});let g,v=await this._pc.createOffer(),y=s.parse(v.sdp);var b;this._transportReady||await this.setupTransport({localDtlsRole:null!==(b=this._forcedLocalDtlsRole)&&void 0!==b?b:"client",localSdpObject:y});r&&r.length>1&&(m.debug("send() | enabling legacy simulcast"),y=s.parse(v.sdp),g=y.media[p.idx],u.addLegacySimulcast({offerMediaObject:g,numStreams:r.length}),v={type:"offer",sdp:s.write(y)});let _=!1;const w=(0,f.parse)((r||[{}])[0].scalabilityMode);if(r&&1===r.length&&w.spatialLayers>1&&"video/vp9"===a.codecs[0].mimeType.toLowerCase()&&(m.debug("send() | enabling legacy simulcast for VP9 SVC"),_=!0,y=s.parse(v.sdp),g=y.media[p.idx],u.addLegacySimulcast({offerMediaObject:g,numStreams:w.spatialLayers}),v={type:"offer",sdp:s.write(y)}),m.debug("send() | calling pc.setLocalDescription() [offer:%o]",v),await this._pc.setLocalDescription(v),r){m.debug("send() | applying given encodings");const e=h.sender.getParameters();for(let t=0;t<(e.encodings||[]).length;++t){const n=e.encodings[t],i=r[t];if(!i)break;e.encodings[t]=Object.assign(n,i)}await h.sender.setParameters(e)}const S=h.mid;if(a.mid=S,y=s.parse(this._pc.localDescription.sdp),g=y.media[p.idx],a.rtcp.cname=l.getCname({offerMediaObject:g}),a.encodings=u.getRtpEncodings({offerMediaObject:g}),r)for(let s=0;s<a.encodings.length;++s)r[s]&&Object.assign(a.encodings[s],r[s]);if(_&&(a.encodings=[a.encodings[0]]),a.encodings.length>1&&("video/vp8"===a.codecs[0].mimeType.toLowerCase()||"video/h264"===a.codecs[0].mimeType.toLowerCase()))for(const s of a.encodings)s.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:g,reuseMid:p.reuseMid,offerRtpParameters:a,answerRtpParameters:o,codecOptions:n});const C={type:"answer",sdp:this._remoteSdp.getSdp()};return m.debug("send() | calling pc.setRemoteDescription() [answer:%o]",C),await this._pc.setRemoteDescription(C),this._mapMidTransceiver.set(S,h),{localId:S,rtpParameters:a,rtpSender:h.sender}}async stopSending(e){this.assertSendDirection(),m.debug("stopSending() [localId:%s]",e);const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");t.sender.replaceTrack(null),this._pc.removeTrack(t.sender);if(this._remoteSdp.closeMediaSection(t.mid))try{t.stop()}catch(i){}const r=await this._pc.createOffer();m.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);const n={type:"answer",sdp:this._remoteSdp.getSdp()};m.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n),this._mapMidTransceiver.delete(e)}async pauseSending(e){}async resumeSending(e){}async replaceTrack(e,t){this.assertSendDirection(),t?m.debug("replaceTrack() [localId:%s, track.id:%s]",e,t.id):m.debug("replaceTrack() [localId:%s, no track]",e);const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");await r.sender.replaceTrack(t)}async setMaxSpatialLayer(e,t){this.assertSendDirection(),m.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,t);const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");const n=r.sender.getParameters();n.encodings.forEach(((e,r)=>{e.active=r<=t})),await r.sender.setParameters(n),this._remoteSdp.muxMediaSectionSimulcast(e,n.encodings);const i=await this._pc.createOffer();m.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const a={type:"answer",sdp:this._remoteSdp.getSdp()};m.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",a),await this._pc.setRemoteDescription(a)}async setRtpEncodingParameters(e,t){this.assertSendDirection(),m.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,t);const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");const n=r.sender.getParameters();n.encodings.forEach(((e,r)=>{n.encodings[r]={...e,...t}})),await r.sender.setParameters(n),this._remoteSdp.muxMediaSectionSimulcast(e,n.encodings);const i=await this._pc.createOffer();m.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const a={type:"answer",sdp:this._remoteSdp.getSdp()};m.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",a),await this._pc.setRemoteDescription(a)}async getSenderStats(e){this.assertSendDirection();const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");return t.sender.getStats()}async sendDataChannel(e){let{ordered:t,maxPacketLifeTime:r,maxRetransmits:n,label:i,protocol:a}=e;this.assertSendDirection();const o={negotiated:!0,id:this._nextSendSctpStreamId,ordered:t,maxPacketLifeTime:r,maxRetransmitTime:r,maxRetransmits:n,protocol:a};m.debug("sendDataChannel() [options:%o]",o);const c=this._pc.createDataChannel(i,o);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%g.MIS,!this._hasDataChannelMediaSection){const e=await this._pc.createOffer(),t=s.parse(e.sdp),r=t.media.find((e=>"application"===e.type));var d;if(!this._transportReady)await this.setupTransport({localDtlsRole:null!==(d=this._forcedLocalDtlsRole)&&void 0!==d?d:"client",localSdpObject:t});m.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",e),await this._pc.setLocalDescription(e),this._remoteSdp.sendSctpAssociation({offerMediaObject:r});const n={type:"answer",sdp:this._remoteSdp.getSdp()};m.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n),this._hasDataChannelMediaSection=!0}return{dataChannel:c,sctpStreamParameters:{streamId:o.id,ordered:o.ordered,maxPacketLifeTime:o.maxPacketLifeTime,maxRetransmits:o.maxRetransmits}}}async receive(e){this.assertRecvDirection();const t=[],r=new Map;for(const s of e){const{trackId:e,kind:t,rtpParameters:n,streamId:i}=s;m.debug("receive() [trackId:%s, kind:%s]",e,t);const a=n.mid||String(this._mapMidTransceiver.size);r.set(e,a),this._remoteSdp.receive({mid:a,kind:t,offerRtpParameters:n,streamId:i||n.rtcp.cname,trackId:e})}const n={type:"offer",sdp:this._remoteSdp.getSdp()};m.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);let i=await this._pc.createAnswer();const a=s.parse(i.sdp);for(const s of e){const{trackId:e,rtpParameters:t}=s,n=r.get(e),i=a.media.find((e=>String(e.mid)===n));l.applyCodecParameters({offerRtpParameters:t,answerMediaObject:i})}var o;(i={type:"answer",sdp:s.write(a)},this._transportReady)||await this.setupTransport({localDtlsRole:null!==(o=this._forcedLocalDtlsRole)&&void 0!==o?o:"client",localSdpObject:a});m.debug("receive() | calling pc.setLocalDescription() [answer:%o]",i),await this._pc.setLocalDescription(i);for(const s of e){const{trackId:e}=s,n=r.get(e),i=this._pc.getTransceivers().find((e=>e.mid===n));if(!i)throw new Error("new RTCRtpTransceiver not found");this._mapMidTransceiver.set(n,i),t.push({localId:n,track:i.receiver.track,rtpReceiver:i.receiver})}return t}async stopReceiving(e){this.assertRecvDirection();for(const n of e){m.debug("stopReceiving() [localId:%s]",n);const e=this._mapMidTransceiver.get(n);if(!e)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(e.mid)}const t={type:"offer",sdp:this._remoteSdp.getSdp()};m.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const r=await this._pc.createAnswer();m.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",r),await this._pc.setLocalDescription(r);for(const n of e)this._mapMidTransceiver.delete(n)}async pauseReceiving(e){}async resumeReceiving(e){}async getReceiverStats(e){this.assertRecvDirection();const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");return t.receiver.getStats()}async receiveDataChannel(e){let{sctpStreamParameters:t,label:r,protocol:n}=e;this.assertRecvDirection();const{streamId:i,ordered:a,maxPacketLifeTime:o,maxRetransmits:c}=t,d={negotiated:!0,id:i,ordered:a,maxPacketLifeTime:o,maxRetransmitTime:o,maxRetransmits:c,protocol:n};m.debug("receiveDataChannel() [options:%o]",d);const l=this._pc.createDataChannel(r,d);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const e={type:"offer",sdp:this._remoteSdp.getSdp()};m.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",e),await this._pc.setRemoteDescription(e);const t=await this._pc.createAnswer();if(!this._transportReady){var u;const e=s.parse(t.sdp);await this.setupTransport({localDtlsRole:null!==(u=this._forcedLocalDtlsRole)&&void 0!==u?u:"client",localSdpObject:e})}m.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",t),await this._pc.setLocalDescription(t),this._hasDataChannelMediaSection=!0}return{dataChannel:l}}async setupTransport(e){let{localDtlsRole:t,localSdpObject:r}=e;r||(r=s.parse(this._pc.localDescription.sdp));const n=l.extractDtlsParameters({sdpObject:r});n.role=t,this._remoteSdp.updateDtlsRole("client"===t?"server":"client"),await new Promise(((e,t)=>{this.safeEmit("@connect",{dtlsParameters:n},e,t)})),this._transportReady=!0}assertSendDirection(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}t.Chrome70=v},584:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Chrome74=void 0;const s=a(r(7181)),o=r(56),c=a(r(6176)),d=a(r(9324)),l=a(r(6488)),u=a(r(4888)),p=a(r(4788)),h=r(3288),f=r(2356),m=r(992),g=r(2308),v=new o.Logger("Chrome74"),y={OS:1024,MIS:1024};class b extends f.HandlerInterface{static createFactory(){return()=>new b}constructor(){super(),this._closed=!1,this._mapMidTransceiver=new Map,this._sendStream=new MediaStream,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return"Chrome74"}close(){if(v.debug("close()"),!this._closed){if(this._closed=!0,this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}}async getNativeRtpCapabilities(){v.debug("getNativeRtpCapabilities()");const e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"});try{e.addTransceiver("audio"),e.addTransceiver("video");const r=await e.createOffer();try{e.close()}catch(t){}const n=s.parse(r.sdp),i=l.extractRtpCapabilities({sdpObject:n});return p.addNackSuppportForOpus(i),i}catch(t){try{e.close()}catch(r){}throw t}}async getNativeSctpCapabilities(){return v.debug("getNativeSctpCapabilities()"),{numStreams:y}}run(e){let{direction:t,iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:a,iceServers:s,iceTransportPolicy:o,additionalSettings:c,proprietaryConstraints:l,extendedRtpCapabilities:u}=e;v.debug("run()"),this._direction=t,this._remoteSdp=new m.RemoteSdp({iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:a}),this._sendingRtpParametersByKind={audio:d.getSendingRtpParameters("audio",u),video:d.getSendingRtpParameters("video",u)},this._sendingRemoteRtpParametersByKind={audio:d.getSendingRemoteRtpParameters("audio",u),video:d.getSendingRemoteRtpParameters("video",u)},i.role&&"auto"!==i.role&&(this._forcedLocalDtlsRole="server"===i.role?"client":"server"),this._pc=new RTCPeerConnection({iceServers:s||[],iceTransportPolicy:o||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan",...c},l),this._pc.addEventListener("icegatheringstatechange",(()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)})),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",(()=>{this.emit("@connectionstatechange",this._pc.connectionState)})):(v.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.addEventListener("iceconnectionstatechange",(()=>{switch(this._pc.iceConnectionState){case"checking":this.emit("@connectionstatechange","connecting");break;case"connected":case"completed":this.emit("@connectionstatechange","connected");break;case"failed":this.emit("@connectionstatechange","failed");break;case"disconnected":this.emit("@connectionstatechange","disconnected");break;case"closed":this.emit("@connectionstatechange","closed")}})))}async updateIceServers(e){this.assertNotClosed(),v.debug("updateIceServers()");const t=this._pc.getConfiguration();t.iceServers=e,this._pc.setConfiguration(t)}async restartIce(e){if(this.assertNotClosed(),v.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),this._transportReady)if("send"===this._direction){const e=await this._pc.createOffer({iceRestart:!0});v.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",e),await this._pc.setLocalDescription(e);const t={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",t),await this._pc.setRemoteDescription(t)}else{const e={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",e),await this._pc.setRemoteDescription(e);const t=await this._pc.createAnswer();v.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",t),await this._pc.setLocalDescription(t)}}async getTransportStats(){return this.assertNotClosed(),this._pc.getStats()}async send(e){let{track:t,encodings:r,codecOptions:n,codec:i}=e;this.assertNotClosed(),this.assertSendDirection(),v.debug("send() [kind:%s, track.id:%s]",t.kind,t.id),r&&r.length>1&&r.forEach(((e,t)=>{e.rid="r".concat(t)}));const a=c.clone(this._sendingRtpParametersByKind[t.kind],{});a.codecs=d.reduceCodecs(a.codecs,i);const o=c.clone(this._sendingRemoteRtpParametersByKind[t.kind],{});o.codecs=d.reduceCodecs(o.codecs,i);const p=this._remoteSdp.getNextMediaSectionIdx(),h=this._pc.addTransceiver(t,{direction:"sendonly",streams:[this._sendStream],sendEncodings:r});let f,m=await this._pc.createOffer(),y=s.parse(m.sdp);var b;this._transportReady||await this.setupTransport({localDtlsRole:null!==(b=this._forcedLocalDtlsRole)&&void 0!==b?b:"client",localSdpObject:y});let _=!1;const w=(0,g.parse)((r||[{}])[0].scalabilityMode);r&&1===r.length&&w.spatialLayers>1&&"video/vp9"===a.codecs[0].mimeType.toLowerCase()&&(v.debug("send() | enabling legacy simulcast for VP9 SVC"),_=!0,y=s.parse(m.sdp),f=y.media[p.idx],u.addLegacySimulcast({offerMediaObject:f,numStreams:w.spatialLayers}),m={type:"offer",sdp:s.write(y)}),v.debug("send() | calling pc.setLocalDescription() [offer:%o]",m),await this._pc.setLocalDescription(m);const S=h.mid;if(a.mid=S,y=s.parse(this._pc.localDescription.sdp),f=y.media[p.idx],a.rtcp.cname=l.getCname({offerMediaObject:f}),r)if(1===r.length){let e=u.getRtpEncodings({offerMediaObject:f});Object.assign(e[0],r[0]),_&&(e=[e[0]]),a.encodings=e}else a.encodings=r;else a.encodings=u.getRtpEncodings({offerMediaObject:f});if(a.encodings.length>1&&("video/vp8"===a.codecs[0].mimeType.toLowerCase()||"video/h264"===a.codecs[0].mimeType.toLowerCase()))for(const s of a.encodings)s.scalabilityMode?s.scalabilityMode="L1T".concat(w.temporalLayers):s.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:f,reuseMid:p.reuseMid,offerRtpParameters:a,answerRtpParameters:o,codecOptions:n,extmapAllowMixed:!0});const C={type:"answer",sdp:this._remoteSdp.getSdp()};return v.debug("send() | calling pc.setRemoteDescription() [answer:%o]",C),await this._pc.setRemoteDescription(C),this._mapMidTransceiver.set(S,h),{localId:S,rtpParameters:a,rtpSender:h.sender}}async stopSending(e){if(this.assertSendDirection(),v.debug("stopSending() [localId:%s]",e),this._closed)return;const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");t.sender.replaceTrack(null),this._pc.removeTrack(t.sender);if(this._remoteSdp.closeMediaSection(t.mid))try{t.stop()}catch(i){}const r=await this._pc.createOffer();v.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);const n={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n),this._mapMidTransceiver.delete(e)}async pauseSending(e){this.assertNotClosed(),this.assertSendDirection(),v.debug("pauseSending() [localId:%s]",e);const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");t.direction="inactive",this._remoteSdp.pauseMediaSection(e);const r=await this._pc.createOffer();v.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);const n={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}async resumeSending(e){this.assertNotClosed(),this.assertSendDirection(),v.debug("resumeSending() [localId:%s]",e);const t=this._mapMidTransceiver.get(e);if(this._remoteSdp.resumeSendingMediaSection(e),!t)throw new Error("associated RTCRtpTransceiver not found");t.direction="sendonly";const r=await this._pc.createOffer();v.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);const n={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}async replaceTrack(e,t){this.assertNotClosed(),this.assertSendDirection(),t?v.debug("replaceTrack() [localId:%s, track.id:%s]",e,t.id):v.debug("replaceTrack() [localId:%s, no track]",e);const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");await r.sender.replaceTrack(t)}async setMaxSpatialLayer(e,t){this.assertNotClosed(),this.assertSendDirection(),v.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,t);const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");const n=r.sender.getParameters();n.encodings.forEach(((e,r)=>{e.active=r<=t})),await r.sender.setParameters(n),this._remoteSdp.muxMediaSectionSimulcast(e,n.encodings);const i=await this._pc.createOffer();v.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const a={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",a),await this._pc.setRemoteDescription(a)}async setRtpEncodingParameters(e,t){this.assertNotClosed(),this.assertSendDirection(),v.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,t);const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");const n=r.sender.getParameters();n.encodings.forEach(((e,r)=>{n.encodings[r]={...e,...t}})),await r.sender.setParameters(n),this._remoteSdp.muxMediaSectionSimulcast(e,n.encodings);const i=await this._pc.createOffer();v.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const a={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",a),await this._pc.setRemoteDescription(a)}async getSenderStats(e){this.assertNotClosed(),this.assertSendDirection();const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");return t.sender.getStats()}async sendDataChannel(e){let{ordered:t,maxPacketLifeTime:r,maxRetransmits:n,label:i,protocol:a}=e;this.assertNotClosed(),this.assertSendDirection();const o={negotiated:!0,id:this._nextSendSctpStreamId,ordered:t,maxPacketLifeTime:r,maxRetransmits:n,protocol:a};v.debug("sendDataChannel() [options:%o]",o);const c=this._pc.createDataChannel(i,o);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%y.MIS,!this._hasDataChannelMediaSection){const e=await this._pc.createOffer(),t=s.parse(e.sdp),r=t.media.find((e=>"application"===e.type));var d;if(!this._transportReady)await this.setupTransport({localDtlsRole:null!==(d=this._forcedLocalDtlsRole)&&void 0!==d?d:"client",localSdpObject:t});v.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",e),await this._pc.setLocalDescription(e),this._remoteSdp.sendSctpAssociation({offerMediaObject:r});const n={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n),this._hasDataChannelMediaSection=!0}return{dataChannel:c,sctpStreamParameters:{streamId:o.id,ordered:o.ordered,maxPacketLifeTime:o.maxPacketLifeTime,maxRetransmits:o.maxRetransmits}}}async receive(e){this.assertNotClosed(),this.assertRecvDirection();const t=[],r=new Map;for(const s of e){const{trackId:e,kind:t,rtpParameters:n,streamId:i}=s;v.debug("receive() [trackId:%s, kind:%s]",e,t);const a=n.mid||String(this._mapMidTransceiver.size);r.set(e,a),this._remoteSdp.receive({mid:a,kind:t,offerRtpParameters:n,streamId:i||n.rtcp.cname,trackId:e})}const n={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);let i=await this._pc.createAnswer();const a=s.parse(i.sdp);for(const s of e){const{trackId:e,rtpParameters:t}=s,n=r.get(e),i=a.media.find((e=>String(e.mid)===n));l.applyCodecParameters({offerRtpParameters:t,answerMediaObject:i})}var o;(i={type:"answer",sdp:s.write(a)},this._transportReady)||await this.setupTransport({localDtlsRole:null!==(o=this._forcedLocalDtlsRole)&&void 0!==o?o:"client",localSdpObject:a});v.debug("receive() | calling pc.setLocalDescription() [answer:%o]",i),await this._pc.setLocalDescription(i);for(const s of e){const{trackId:e}=s,n=r.get(e),i=this._pc.getTransceivers().find((e=>e.mid===n));if(!i)throw new Error("new RTCRtpTransceiver not found");this._mapMidTransceiver.set(n,i),t.push({localId:n,track:i.receiver.track,rtpReceiver:i.receiver})}return t}async stopReceiving(e){if(this.assertRecvDirection(),this._closed)return;for(const n of e){v.debug("stopReceiving() [localId:%s]",n);const e=this._mapMidTransceiver.get(n);if(!e)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(e.mid)}const t={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const r=await this._pc.createAnswer();v.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",r),await this._pc.setLocalDescription(r);for(const n of e)this._mapMidTransceiver.delete(n)}async pauseReceiving(e){this.assertNotClosed(),this.assertRecvDirection();for(const n of e){v.debug("pauseReceiving() [localId:%s]",n);const e=this._mapMidTransceiver.get(n);if(!e)throw new Error("associated RTCRtpTransceiver not found");e.direction="inactive",this._remoteSdp.pauseMediaSection(n)}const t={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const r=await this._pc.createAnswer();v.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",r),await this._pc.setLocalDescription(r)}async resumeReceiving(e){this.assertNotClosed(),this.assertRecvDirection();for(const n of e){v.debug("resumeReceiving() [localId:%s]",n);const e=this._mapMidTransceiver.get(n);if(!e)throw new Error("associated RTCRtpTransceiver not found");e.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(n)}const t={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const r=await this._pc.createAnswer();v.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",r),await this._pc.setLocalDescription(r)}async getReceiverStats(e){this.assertNotClosed(),this.assertRecvDirection();const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");return t.receiver.getStats()}async receiveDataChannel(e){let{sctpStreamParameters:t,label:r,protocol:n}=e;this.assertNotClosed(),this.assertRecvDirection();const{streamId:i,ordered:a,maxPacketLifeTime:o,maxRetransmits:c}=t,d={negotiated:!0,id:i,ordered:a,maxPacketLifeTime:o,maxRetransmits:c,protocol:n};v.debug("receiveDataChannel() [options:%o]",d);const l=this._pc.createDataChannel(r,d);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const e={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",e),await this._pc.setRemoteDescription(e);const t=await this._pc.createAnswer();if(!this._transportReady){var u;const e=s.parse(t.sdp);await this.setupTransport({localDtlsRole:null!==(u=this._forcedLocalDtlsRole)&&void 0!==u?u:"client",localSdpObject:e})}v.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",t),await this._pc.setLocalDescription(t),this._hasDataChannelMediaSection=!0}return{dataChannel:l}}async setupTransport(e){let{localDtlsRole:t,localSdpObject:r}=e;r||(r=s.parse(this._pc.localDescription.sdp));const n=l.extractDtlsParameters({sdpObject:r});n.role=t,this._remoteSdp.updateDtlsRole("client"===t?"server":"client"),await new Promise(((e,t)=>{this.safeEmit("@connect",{dtlsParameters:n},e,t)})),this._transportReady=!0}assertNotClosed(){if(this._closed)throw new h.InvalidStateError("method called in a closed handler")}assertSendDirection(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}t.Chrome74=b},5956:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Edge11=void 0;const s=r(56),o=r(3288),c=a(r(6176)),d=a(r(9324)),l=a(r(1727)),u=r(2356),p=new s.Logger("Edge11");class h extends u.HandlerInterface{static createFactory(){return()=>new h}constructor(){super(),this._rtpSenders=new Map,this._rtpReceivers=new Map,this._nextSendLocalId=0,this._transportReady=!1}get name(){return"Edge11"}close(){p.debug("close()");try{this._iceGatherer.close()}catch(e){}try{this._iceTransport.stop()}catch(e){}try{this._dtlsTransport.stop()}catch(e){}for(const t of this._rtpSenders.values())try{t.stop()}catch(e){}for(const t of this._rtpReceivers.values())try{t.stop()}catch(e){}this.emit("@close")}async getNativeRtpCapabilities(){return p.debug("getNativeRtpCapabilities()"),l.getCapabilities()}async getNativeSctpCapabilities(){return p.debug("getNativeSctpCapabilities()"),{numStreams:{OS:0,MIS:0}}}run(e){let{direction:t,iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:a,iceServers:s,iceTransportPolicy:o,additionalSettings:l,proprietaryConstraints:u,extendedRtpCapabilities:h}=e;p.debug("run()"),this._sendingRtpParametersByKind={audio:d.getSendingRtpParameters("audio",h),video:d.getSendingRtpParameters("video",h)},this._remoteIceParameters=r,this._remoteIceCandidates=n,this._remoteDtlsParameters=i,this._cname="CNAME-".concat(c.generateRandomNumber()),this.setIceGatherer({iceServers:s,iceTransportPolicy:o}),this.setIceTransport(),this.setDtlsTransport()}async updateIceServers(e){throw new o.UnsupportedError("not supported")}async restartIce(e){if(p.debug("restartIce()"),this._remoteIceParameters=e,this._transportReady){p.debug("restartIce() | calling iceTransport.start()"),this._iceTransport.start(this._iceGatherer,e,"controlling");for(const e of this._remoteIceCandidates)this._iceTransport.addRemoteCandidate(e);this._iceTransport.addRemoteCandidate({})}}async getTransportStats(){return this._iceTransport.getStats()}async send(e){let{track:t,encodings:r,codecOptions:n,codec:i}=e;p.debug("send() [kind:%s, track.id:%s]",t.kind,t.id),this._transportReady||await this.setupTransport({localDtlsRole:"server"}),p.debug("send() | calling new RTCRtpSender()");const a=new RTCRtpSender(t,this._dtlsTransport),s=c.clone(this._sendingRtpParametersByKind[t.kind],{});s.codecs=d.reduceCodecs(s.codecs,i);const o=s.codecs.some((e=>/.+\/rtx$/i.test(e.mimeType)));r||(r=[{}]);for(const d of r)d.ssrc=c.generateRandomNumber(),o&&(d.rtx={ssrc:c.generateRandomNumber()});s.encodings=r,s.rtcp={cname:this._cname,reducedSize:!0,mux:!0};const u=l.mangleRtpParameters(s);p.debug("send() | calling rtpSender.send() [params:%o]",u),await a.send(u);const h=String(this._nextSendLocalId);return this._nextSendLocalId++,this._rtpSenders.set(h,a),{localId:h,rtpParameters:s,rtpSender:a}}async stopSending(e){p.debug("stopSending() [localId:%s]",e);const t=this._rtpSenders.get(e);if(!t)throw new Error("RTCRtpSender not found");this._rtpSenders.delete(e);try{p.debug("stopSending() | calling rtpSender.stop()"),t.stop()}catch(r){throw p.warn("stopSending() | rtpSender.stop() failed:%o",r),r}}async pauseSending(e){}async resumeSending(e){}async replaceTrack(e,t){t?p.debug("replaceTrack() [localId:%s, track.id:%s]",e,t.id):p.debug("replaceTrack() [localId:%s, no track]",e);const r=this._rtpSenders.get(e);if(!r)throw new Error("RTCRtpSender not found");r.setTrack(t)}async setMaxSpatialLayer(e,t){p.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,t);const r=this._rtpSenders.get(e);if(!r)throw new Error("RTCRtpSender not found");const n=r.getParameters();n.encodings.forEach(((e,r)=>{e.active=r<=t})),await r.setParameters(n)}async setRtpEncodingParameters(e,t){p.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,t);const r=this._rtpSenders.get(e);if(!r)throw new Error("RTCRtpSender not found");const n=r.getParameters();n.encodings.forEach(((e,r)=>{n.encodings[r]={...e,...t}})),await r.setParameters(n)}async getSenderStats(e){const t=this._rtpSenders.get(e);if(!t)throw new Error("RTCRtpSender not found");return t.getStats()}async sendDataChannel(e){throw new o.UnsupportedError("not implemented")}async receive(e){const t=[];for(const r of e){const{trackId:e,kind:t}=r;p.debug("receive() [trackId:%s, kind:%s]",e,t)}this._transportReady||await this.setupTransport({localDtlsRole:"server"});for(const r of e){const{trackId:e,kind:n,rtpParameters:i}=r;p.debug("receive() | calling new RTCRtpReceiver()");const a=new RTCRtpReceiver(this._dtlsTransport,n);a.addEventListener("error",(e=>{p.error('rtpReceiver "error" event [event:%o]',e)}));const s=l.mangleRtpParameters(i);p.debug("receive() | calling rtpReceiver.receive() [params:%o]",s),await a.receive(s);const o=e;this._rtpReceivers.set(o,a),t.push({localId:o,track:a.track,rtpReceiver:a})}return t}async stopReceiving(e){for(const r of e){p.debug("stopReceiving() [localId:%s]",r);const e=this._rtpReceivers.get(r);if(!e)throw new Error("RTCRtpReceiver not found");this._rtpReceivers.delete(r);try{p.debug("stopReceiving() | calling rtpReceiver.stop()"),e.stop()}catch(t){p.warn("stopReceiving() | rtpReceiver.stop() failed:%o",t)}}}async pauseReceiving(e){}async resumeReceiving(e){}async getReceiverStats(e){const t=this._rtpReceivers.get(e);if(!t)throw new Error("RTCRtpReceiver not found");return t.getStats()}async receiveDataChannel(e){throw new o.UnsupportedError("not implemented")}setIceGatherer(e){let{iceServers:t,iceTransportPolicy:r}=e;const n=new RTCIceGatherer({iceServers:t||[],gatherPolicy:r||"all"});n.addEventListener("error",(e=>{p.error('iceGatherer "error" event [event:%o]',e)}));try{n.gather()}catch(i){p.debug("setIceGatherer() | iceGatherer.gather() failed: %s",i.toString())}this._iceGatherer=n}setIceTransport(){const e=new RTCIceTransport(this._iceGatherer);e.addEventListener("statechange",(()=>{switch(e.state){case"checking":this.emit("@connectionstatechange","connecting");break;case"connected":case"completed":this.emit("@connectionstatechange","connected");break;case"failed":this.emit("@connectionstatechange","failed");break;case"disconnected":this.emit("@connectionstatechange","disconnected");break;case"closed":this.emit("@connectionstatechange","closed")}})),e.addEventListener("icestatechange",(()=>{switch(e.state){case"checking":this.emit("@connectionstatechange","connecting");break;case"connected":case"completed":this.emit("@connectionstatechange","connected");break;case"failed":this.emit("@connectionstatechange","failed");break;case"disconnected":this.emit("@connectionstatechange","disconnected");break;case"closed":this.emit("@connectionstatechange","closed")}})),e.addEventListener("candidatepairchange",(e=>{p.debug('iceTransport "candidatepairchange" event [pair:%o]',e.pair)})),this._iceTransport=e}setDtlsTransport(){const e=new RTCDtlsTransport(this._iceTransport);e.addEventListener("statechange",(()=>{p.debug('dtlsTransport "statechange" event [state:%s]',e.state)})),e.addEventListener("dtlsstatechange",(()=>{p.debug('dtlsTransport "dtlsstatechange" event [state:%s]',e.state),"closed"===e.state&&this.emit("@connectionstatechange","closed")})),e.addEventListener("error",(e=>{p.error('dtlsTransport "error" event [event:%o]',e)})),this._dtlsTransport=e}async setupTransport(e){let{localDtlsRole:t}=e;p.debug("setupTransport()");const r=this._dtlsTransport.getLocalParameters();r.role=t,await new Promise(((e,t)=>{this.safeEmit("@connect",{dtlsParameters:r},e,t)})),this._iceTransport.start(this._iceGatherer,this._remoteIceParameters,"controlling");for(const n of this._remoteIceCandidates)this._iceTransport.addRemoteCandidate(n);this._iceTransport.addRemoteCandidate({}),this._remoteDtlsParameters.fingerprints=this._remoteDtlsParameters.fingerprints.filter((e=>"sha-256"===e.algorithm||"sha-384"===e.algorithm||"sha-512"===e.algorithm)),this._dtlsTransport.start(this._remoteDtlsParameters),this._transportReady=!0}}t.Edge11=h},180:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Firefox60=void 0;const s=a(r(7181)),o=r(56),c=r(3288),d=a(r(6176)),l=a(r(9324)),u=a(r(6488)),p=a(r(4888)),h=r(2356),f=r(992),m=r(2308),g=new o.Logger("Firefox60"),v={OS:16,MIS:2048};class y extends h.HandlerInterface{static createFactory(){return()=>new y}constructor(){super(),this._closed=!1,this._mapMidTransceiver=new Map,this._sendStream=new MediaStream,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return"Firefox60"}close(){if(g.debug("close()"),!this._closed){if(this._closed=!0,this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}}async getNativeRtpCapabilities(){g.debug("getNativeRtpCapabilities()");const e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"}),t=document.createElement("canvas");t.getContext("2d");const r=t.captureStream().getVideoTracks()[0];try{e.addTransceiver("audio",{direction:"sendrecv"});const i=e.addTransceiver(r,{direction:"sendrecv"}),a=i.sender.getParameters(),o=[{rid:"r0",maxBitrate:1e5},{rid:"r1",maxBitrate:5e5}];a.encodings=o,await i.sender.setParameters(a);const c=await e.createOffer();try{t.remove()}catch(n){}try{r.stop()}catch(n){}try{e.close()}catch(n){}const d=s.parse(c.sdp);return u.extractRtpCapabilities({sdpObject:d})}catch(n){try{t.remove()}catch(i){}try{r.stop()}catch(i){}try{e.close()}catch(i){}throw n}}async getNativeSctpCapabilities(){return g.debug("getNativeSctpCapabilities()"),{numStreams:v}}run(e){let{direction:t,iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:a,iceServers:s,iceTransportPolicy:o,additionalSettings:c,proprietaryConstraints:d,extendedRtpCapabilities:u}=e;this.assertNotClosed(),g.debug("run()"),this._direction=t,this._remoteSdp=new f.RemoteSdp({iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:a}),this._sendingRtpParametersByKind={audio:l.getSendingRtpParameters("audio",u),video:l.getSendingRtpParameters("video",u)},this._sendingRemoteRtpParametersByKind={audio:l.getSendingRemoteRtpParameters("audio",u),video:l.getSendingRemoteRtpParameters("video",u)},this._pc=new RTCPeerConnection({iceServers:s||[],iceTransportPolicy:o||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",...c},d),this._pc.addEventListener("icegatheringstatechange",(()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)})),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",(()=>{this.emit("@connectionstatechange",this._pc.connectionState)})):this._pc.addEventListener("iceconnectionstatechange",(()=>{switch(g.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":this.emit("@connectionstatechange","connecting");break;case"connected":case"completed":this.emit("@connectionstatechange","connected");break;case"failed":this.emit("@connectionstatechange","failed");break;case"disconnected":this.emit("@connectionstatechange","disconnected");break;case"closed":this.emit("@connectionstatechange","closed")}}))}async updateIceServers(e){throw this.assertNotClosed(),new c.UnsupportedError("not supported")}async restartIce(e){if(this.assertNotClosed(),g.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),this._transportReady)if("send"===this._direction){const e=await this._pc.createOffer({iceRestart:!0});g.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",e),await this._pc.setLocalDescription(e);const t={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",t),await this._pc.setRemoteDescription(t)}else{const e={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",e),await this._pc.setRemoteDescription(e);const t=await this._pc.createAnswer();g.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",t),await this._pc.setLocalDescription(t)}}async getTransportStats(){return this.assertNotClosed(),this._pc.getStats()}async send(e){let{track:t,encodings:r,codecOptions:n,codec:i}=e;this.assertNotClosed(),this.assertSendDirection(),g.debug("send() [kind:%s, track.id:%s]",t.kind,t.id),r&&(r=d.clone(r,[]),r.length>1&&(r.forEach(((e,t)=>{e.rid="r".concat(t)})),r.reverse()));const a=d.clone(this._sendingRtpParametersByKind[t.kind],{});a.codecs=l.reduceCodecs(a.codecs,i);const o=d.clone(this._sendingRemoteRtpParametersByKind[t.kind],{});o.codecs=l.reduceCodecs(o.codecs,i);const c=this._pc.addTransceiver(t,{direction:"sendonly",streams:[this._sendStream]});if(r){const e=c.sender.getParameters();e.encodings=r,await c.sender.setParameters(e)}const h=await this._pc.createOffer();let f=s.parse(h.sdp);this._transportReady||await this.setupTransport({localDtlsRole:"client",localSdpObject:f});const v=(0,m.parse)((r||[{}])[0].scalabilityMode);g.debug("send() | calling pc.setLocalDescription() [offer:%o]",h),await this._pc.setLocalDescription(h);const y=c.mid;a.mid=y,f=s.parse(this._pc.localDescription.sdp);const b=f.media[f.media.length-1];if(a.rtcp.cname=u.getCname({offerMediaObject:b}),r)if(1===r.length){const e=p.getRtpEncodings({offerMediaObject:b});Object.assign(e[0],r[0]),a.encodings=e}else a.encodings=r.reverse();else a.encodings=p.getRtpEncodings({offerMediaObject:b});if(a.encodings.length>1&&("video/vp8"===a.codecs[0].mimeType.toLowerCase()||"video/h264"===a.codecs[0].mimeType.toLowerCase()))for(const s of a.encodings)s.scalabilityMode?s.scalabilityMode="L1T".concat(v.temporalLayers):s.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:b,offerRtpParameters:a,answerRtpParameters:o,codecOptions:n,extmapAllowMixed:!0});const _={type:"answer",sdp:this._remoteSdp.getSdp()};return g.debug("send() | calling pc.setRemoteDescription() [answer:%o]",_),await this._pc.setRemoteDescription(_),this._mapMidTransceiver.set(y,c),{localId:y,rtpParameters:a,rtpSender:c.sender}}async stopSending(e){if(this.assertSendDirection(),g.debug("stopSending() [localId:%s]",e),this._closed)return;const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated transceiver not found");t.sender.replaceTrack(null),this._pc.removeTrack(t.sender),this._remoteSdp.disableMediaSection(t.mid);const r=await this._pc.createOffer();g.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);const n={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n),this._mapMidTransceiver.delete(e)}async pauseSending(e){this.assertNotClosed(),this.assertSendDirection(),g.debug("pauseSending() [localId:%s]",e);const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");t.direction="inactive",this._remoteSdp.pauseMediaSection(e);const r=await this._pc.createOffer();g.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);const n={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}async resumeSending(e){this.assertNotClosed(),this.assertSendDirection(),g.debug("resumeSending() [localId:%s]",e);const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");t.direction="sendonly",this._remoteSdp.resumeSendingMediaSection(e);const r=await this._pc.createOffer();g.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);const n={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}async replaceTrack(e,t){this.assertNotClosed(),this.assertSendDirection(),t?g.debug("replaceTrack() [localId:%s, track.id:%s]",e,t.id):g.debug("replaceTrack() [localId:%s, no track]",e);const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");await r.sender.replaceTrack(t)}async setMaxSpatialLayer(e,t){this.assertNotClosed(),this.assertSendDirection(),g.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,t);const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated transceiver not found");const n=r.sender.getParameters();t=n.encodings.length-1-t,n.encodings.forEach(((e,r)=>{e.active=r>=t})),await r.sender.setParameters(n),this._remoteSdp.muxMediaSectionSimulcast(e,n.encodings);const i=await this._pc.createOffer();g.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const a={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",a),await this._pc.setRemoteDescription(a)}async setRtpEncodingParameters(e,t){this.assertNotClosed(),this.assertSendDirection(),g.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,t);const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");const n=r.sender.getParameters();n.encodings.forEach(((e,r)=>{n.encodings[r]={...e,...t}})),await r.sender.setParameters(n),this._remoteSdp.muxMediaSectionSimulcast(e,n.encodings);const i=await this._pc.createOffer();g.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const a={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",a),await this._pc.setRemoteDescription(a)}async getSenderStats(e){this.assertNotClosed(),this.assertSendDirection();const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");return t.sender.getStats()}async sendDataChannel(e){let{ordered:t,maxPacketLifeTime:r,maxRetransmits:n,label:i,protocol:a}=e;this.assertNotClosed(),this.assertSendDirection();const o={negotiated:!0,id:this._nextSendSctpStreamId,ordered:t,maxPacketLifeTime:r,maxRetransmits:n,protocol:a};g.debug("sendDataChannel() [options:%o]",o);const c=this._pc.createDataChannel(i,o);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%v.MIS,!this._hasDataChannelMediaSection){const e=await this._pc.createOffer(),t=s.parse(e.sdp),r=t.media.find((e=>"application"===e.type));this._transportReady||await this.setupTransport({localDtlsRole:"client",localSdpObject:t}),g.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",e),await this._pc.setLocalDescription(e),this._remoteSdp.sendSctpAssociation({offerMediaObject:r});const n={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n),this._hasDataChannelMediaSection=!0}return{dataChannel:c,sctpStreamParameters:{streamId:o.id,ordered:o.ordered,maxPacketLifeTime:o.maxPacketLifeTime,maxRetransmits:o.maxRetransmits}}}async receive(e){this.assertNotClosed(),this.assertRecvDirection();const t=[],r=new Map;for(const s of e){const{trackId:e,kind:t,rtpParameters:n,streamId:i}=s;g.debug("receive() [trackId:%s, kind:%s]",e,t);const a=n.mid||String(this._mapMidTransceiver.size);r.set(e,a),this._remoteSdp.receive({mid:a,kind:t,offerRtpParameters:n,streamId:i||n.rtcp.cname,trackId:e})}const n={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);let i=await this._pc.createAnswer();const a=s.parse(i.sdp);for(const o of e){const{trackId:e,rtpParameters:t}=o,n=r.get(e),c=a.media.find((e=>String(e.mid)===n));u.applyCodecParameters({offerRtpParameters:t,answerMediaObject:c}),i={type:"answer",sdp:s.write(a)}}this._transportReady||await this.setupTransport({localDtlsRole:"client",localSdpObject:a}),g.debug("receive() | calling pc.setLocalDescription() [answer:%o]",i),await this._pc.setLocalDescription(i);for(const s of e){const{trackId:e}=s,n=r.get(e),i=this._pc.getTransceivers().find((e=>e.mid===n));if(!i)throw new Error("new RTCRtpTransceiver not found");this._mapMidTransceiver.set(n,i),t.push({localId:n,track:i.receiver.track,rtpReceiver:i.receiver})}return t}async stopReceiving(e){if(this.assertRecvDirection(),this._closed)return;for(const n of e){g.debug("stopReceiving() [localId:%s]",n);const e=this._mapMidTransceiver.get(n);if(!e)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(e.mid)}const t={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const r=await this._pc.createAnswer();g.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",r),await this._pc.setLocalDescription(r);for(const n of e)this._mapMidTransceiver.delete(n)}async pauseReceiving(e){this.assertNotClosed(),this.assertRecvDirection();for(const n of e){g.debug("pauseReceiving() [localId:%s]",n);const e=this._mapMidTransceiver.get(n);if(!e)throw new Error("associated RTCRtpTransceiver not found");e.direction="inactive",this._remoteSdp.pauseMediaSection(n)}const t={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const r=await this._pc.createAnswer();g.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",r),await this._pc.setLocalDescription(r)}async resumeReceiving(e){this.assertNotClosed(),this.assertRecvDirection();for(const n of e){g.debug("resumeReceiving() [localId:%s]",n);const e=this._mapMidTransceiver.get(n);if(!e)throw new Error("associated RTCRtpTransceiver not found");e.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(n)}const t={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const r=await this._pc.createAnswer();g.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",r),await this._pc.setLocalDescription(r)}async getReceiverStats(e){this.assertRecvDirection();const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");return t.receiver.getStats()}async receiveDataChannel(e){let{sctpStreamParameters:t,label:r,protocol:n}=e;this.assertNotClosed(),this.assertRecvDirection();const{streamId:i,ordered:a,maxPacketLifeTime:o,maxRetransmits:c}=t,d={negotiated:!0,id:i,ordered:a,maxPacketLifeTime:o,maxRetransmits:c,protocol:n};g.debug("receiveDataChannel() [options:%o]",d);const l=this._pc.createDataChannel(r,d);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const e={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",e),await this._pc.setRemoteDescription(e);const t=await this._pc.createAnswer();if(!this._transportReady){const e=s.parse(t.sdp);await this.setupTransport({localDtlsRole:"client",localSdpObject:e})}g.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",t),await this._pc.setLocalDescription(t),this._hasDataChannelMediaSection=!0}return{dataChannel:l}}async setupTransport(e){let{localDtlsRole:t,localSdpObject:r}=e;r||(r=s.parse(this._pc.localDescription.sdp));const n=u.extractDtlsParameters({sdpObject:r});n.role=t,this._remoteSdp.updateDtlsRole("client"===t?"server":"client"),await new Promise(((e,t)=>{this.safeEmit("@connect",{dtlsParameters:n},e,t)})),this._transportReady=!0}assertNotClosed(){if(this._closed)throw new c.InvalidStateError("method called in a closed handler")}assertSendDirection(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}t.Firefox60=y},2356:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HandlerInterface=void 0;const n=r(2728);class i extends n.EnhancedEventEmitter{constructor(){super()}}t.HandlerInterface=i},2708:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ReactNative=void 0;const s=a(r(7181)),o=r(56),c=r(3288),d=a(r(6176)),l=a(r(9324)),u=a(r(6488)),p=a(r(752)),h=r(2356),f=r(992),m=new o.Logger("ReactNative"),g={OS:1024,MIS:1024};class v extends h.HandlerInterface{static createFactory(){return()=>new v}constructor(){super(),this._sendStream=new MediaStream,this._mapSendLocalIdTrack=new Map,this._nextSendLocalId=0,this._mapRecvLocalIdInfo=new Map,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return"ReactNative"}close(){if(m.debug("close()"),this._sendStream.release(!1),this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}async getNativeRtpCapabilities(){m.debug("getNativeRtpCapabilities()");const e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"});try{const r=await e.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});try{e.close()}catch(t){}const n=s.parse(r.sdp);return u.extractRtpCapabilities({sdpObject:n})}catch(t){try{e.close()}catch(r){}throw t}}async getNativeSctpCapabilities(){return m.debug("getNativeSctpCapabilities()"),{numStreams:g}}run(e){let{direction:t,iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:a,iceServers:s,iceTransportPolicy:o,additionalSettings:c,proprietaryConstraints:d,extendedRtpCapabilities:u}=e;m.debug("run()"),this._direction=t,this._remoteSdp=new f.RemoteSdp({iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:a,planB:!0}),this._sendingRtpParametersByKind={audio:l.getSendingRtpParameters("audio",u),video:l.getSendingRtpParameters("video",u)},this._sendingRemoteRtpParametersByKind={audio:l.getSendingRemoteRtpParameters("audio",u),video:l.getSendingRemoteRtpParameters("video",u)},i.role&&"auto"!==i.role&&(this._forcedLocalDtlsRole="server"===i.role?"client":"server"),this._pc=new RTCPeerConnection({iceServers:s||[],iceTransportPolicy:o||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b",...c},d),this._pc.addEventListener("icegatheringstatechange",(()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)})),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",(()=>{this.emit("@connectionstatechange",this._pc.connectionState)})):this._pc.addEventListener("iceconnectionstatechange",(()=>{switch(m.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":this.emit("@connectionstatechange","connecting");break;case"connected":case"completed":this.emit("@connectionstatechange","connected");break;case"failed":this.emit("@connectionstatechange","failed");break;case"disconnected":this.emit("@connectionstatechange","disconnected");break;case"closed":this.emit("@connectionstatechange","closed")}}))}async updateIceServers(e){m.debug("updateIceServers()");const t=this._pc.getConfiguration();t.iceServers=e,this._pc.setConfiguration(t)}async restartIce(e){if(m.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),this._transportReady)if("send"===this._direction){const e=await this._pc.createOffer({iceRestart:!0});m.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",e),await this._pc.setLocalDescription(e);const t={type:"answer",sdp:this._remoteSdp.getSdp()};m.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",t),await this._pc.setRemoteDescription(t)}else{const e={type:"offer",sdp:this._remoteSdp.getSdp()};m.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",e),await this._pc.setRemoteDescription(e);const t=await this._pc.createAnswer();m.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",t),await this._pc.setLocalDescription(t)}}async getTransportStats(){return this._pc.getStats()}async send(e){let{track:t,encodings:r,codecOptions:n,codec:i}=e;this.assertSendDirection(),m.debug("send() [kind:%s, track.id:%s]",t.kind,t.id),i&&m.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(t),this._pc.addStream(this._sendStream);let a,o=await this._pc.createOffer(),c=s.parse(o.sdp);const h=d.clone(this._sendingRtpParametersByKind[t.kind],{});h.codecs=l.reduceCodecs(h.codecs);const f=d.clone(this._sendingRemoteRtpParametersByKind[t.kind],{});var g;(f.codecs=l.reduceCodecs(f.codecs),this._transportReady)||await this.setupTransport({localDtlsRole:null!==(g=this._forcedLocalDtlsRole)&&void 0!==g?g:"client",localSdpObject:c});if("video"===t.kind&&r&&r.length>1&&(m.debug("send() | enabling simulcast"),c=s.parse(o.sdp),a=c.media.find((e=>"video"===e.type)),p.addLegacySimulcast({offerMediaObject:a,track:t,numStreams:r.length}),o={type:"offer",sdp:s.write(c)}),m.debug("send() | calling pc.setLocalDescription() [offer:%o]",o),await this._pc.setLocalDescription(o),c=s.parse(this._pc.localDescription.sdp),a=c.media.find((e=>e.type===t.kind)),h.rtcp.cname=u.getCname({offerMediaObject:a}),h.encodings=p.getRtpEncodings({offerMediaObject:a,track:t}),r)for(let s=0;s<h.encodings.length;++s)r[s]&&Object.assign(h.encodings[s],r[s]);if(h.encodings.length>1&&("video/vp8"===h.codecs[0].mimeType.toLowerCase()||"video/h264"===h.codecs[0].mimeType.toLowerCase()))for(const s of h.encodings)s.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:a,offerRtpParameters:h,answerRtpParameters:f,codecOptions:n});const v={type:"answer",sdp:this._remoteSdp.getSdp()};m.debug("send() | calling pc.setRemoteDescription() [answer:%o]",v),await this._pc.setRemoteDescription(v);const y=String(this._nextSendLocalId);return this._nextSendLocalId++,this._mapSendLocalIdTrack.set(y,t),{localId:y,rtpParameters:h}}async stopSending(e){this.assertSendDirection(),m.debug("stopSending() [localId:%s]",e);const t=this._mapSendLocalIdTrack.get(e);if(!t)throw new Error("track not found");this._mapSendLocalIdTrack.delete(e),this._sendStream.removeTrack(t),this._pc.addStream(this._sendStream);const r=await this._pc.createOffer();m.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",r);try{await this._pc.setLocalDescription(r)}catch(i){if(0===this._sendStream.getTracks().length)return void m.warn("stopSending() | ignoring expected error due no sending tracks: %s",i.toString());throw i}if("stable"===this._pc.signalingState)return;const n={type:"answer",sdp:this._remoteSdp.getSdp()};m.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}async pauseSending(e){}async resumeSending(e){}async replaceTrack(e,t){throw new c.UnsupportedError("not implemented")}async setMaxSpatialLayer(e,t){throw new c.UnsupportedError("not implemented")}async setRtpEncodingParameters(e,t){throw new c.UnsupportedError("not implemented")}async getSenderStats(e){throw new c.UnsupportedError("not implemented")}async sendDataChannel(e){let{ordered:t,maxPacketLifeTime:r,maxRetransmits:n,label:i,protocol:a}=e;this.assertSendDirection();const o={negotiated:!0,id:this._nextSendSctpStreamId,ordered:t,maxPacketLifeTime:r,maxRetransmitTime:r,maxRetransmits:n,protocol:a};m.debug("sendDataChannel() [options:%o]",o);const c=this._pc.createDataChannel(i,o);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%g.MIS,!this._hasDataChannelMediaSection){const e=await this._pc.createOffer(),t=s.parse(e.sdp),r=t.media.find((e=>"application"===e.type));var d;if(!this._transportReady)await this.setupTransport({localDtlsRole:null!==(d=this._forcedLocalDtlsRole)&&void 0!==d?d:"client",localSdpObject:t});m.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",e),await this._pc.setLocalDescription(e),this._remoteSdp.sendSctpAssociation({offerMediaObject:r});const n={type:"answer",sdp:this._remoteSdp.getSdp()};m.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n),this._hasDataChannelMediaSection=!0}return{dataChannel:c,sctpStreamParameters:{streamId:o.id,ordered:o.ordered,maxPacketLifeTime:o.maxPacketLifeTime,maxRetransmits:o.maxRetransmits}}}async receive(e){this.assertRecvDirection();const t=[],r=new Map;for(const s of e){const{trackId:e,kind:t,rtpParameters:n}=s;m.debug("receive() [trackId:%s, kind:%s]",e,t);const i=t;let a=s.streamId||n.rtcp.cname;m.debug("receive() | forcing a random remote streamId to avoid well known bug in react-native-webrtc"),a+="-hack-".concat(d.generateRandomNumber()),r.set(e,a),this._remoteSdp.receive({mid:i,kind:t,offerRtpParameters:n,streamId:a,trackId:e})}const n={type:"offer",sdp:this._remoteSdp.getSdp()};m.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);let i=await this._pc.createAnswer();const a=s.parse(i.sdp);for(const s of e){const{kind:e,rtpParameters:t}=s,r=e,n=a.media.find((e=>String(e.mid)===r));u.applyCodecParameters({offerRtpParameters:t,answerMediaObject:n})}var o;(i={type:"answer",sdp:s.write(a)},this._transportReady)||await this.setupTransport({localDtlsRole:null!==(o=this._forcedLocalDtlsRole)&&void 0!==o?o:"client",localSdpObject:a});m.debug("receive() | calling pc.setLocalDescription() [answer:%o]",i),await this._pc.setLocalDescription(i);for(const s of e){const{kind:e,trackId:n,rtpParameters:i}=s,a=n,o=e,c=r.get(n),d=this._pc.getRemoteStreams().find((e=>e.id===c)).getTrackById(a);if(!d)throw new Error("remote track not found");this._mapRecvLocalIdInfo.set(a,{mid:o,rtpParameters:i}),t.push({localId:a,track:d})}return t}async stopReceiving(e){this.assertRecvDirection();for(const n of e){m.debug("stopReceiving() [localId:%s]",n);const{mid:e,rtpParameters:t}=this._mapRecvLocalIdInfo.get(n)||{};this._mapRecvLocalIdInfo.delete(n),this._remoteSdp.planBStopReceiving({mid:e,offerRtpParameters:t})}const t={type:"offer",sdp:this._remoteSdp.getSdp()};m.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const r=await this._pc.createAnswer();m.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",r),await this._pc.setLocalDescription(r)}async pauseReceiving(e){}async resumeReceiving(e){}async getReceiverStats(e){throw new c.UnsupportedError("not implemented")}async receiveDataChannel(e){let{sctpStreamParameters:t,label:r,protocol:n}=e;this.assertRecvDirection();const{streamId:i,ordered:a,maxPacketLifeTime:o,maxRetransmits:c}=t,d={negotiated:!0,id:i,ordered:a,maxPacketLifeTime:o,maxRetransmitTime:o,maxRetransmits:c,protocol:n};m.debug("receiveDataChannel() [options:%o]",d);const l=this._pc.createDataChannel(r,d);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0});const e={type:"offer",sdp:this._remoteSdp.getSdp()};m.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",e),await this._pc.setRemoteDescription(e);const t=await this._pc.createAnswer();if(!this._transportReady){var u;const e=s.parse(t.sdp);await this.setupTransport({localDtlsRole:null!==(u=this._forcedLocalDtlsRole)&&void 0!==u?u:"client",localSdpObject:e})}m.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",t),await this._pc.setLocalDescription(t),this._hasDataChannelMediaSection=!0}return{dataChannel:l}}async setupTransport(e){let{localDtlsRole:t,localSdpObject:r}=e;r||(r=s.parse(this._pc.localDescription.sdp));const n=u.extractDtlsParameters({sdpObject:r});n.role=t,this._remoteSdp.updateDtlsRole("client"===t?"server":"client"),await new Promise(((e,t)=>{this.safeEmit("@connect",{dtlsParameters:n},e,t)})),this._transportReady=!0}assertSendDirection(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}t.ReactNative=v},6404:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ReactNativeUnifiedPlan=void 0;const s=a(r(7181)),o=r(56),c=a(r(6176)),d=a(r(9324)),l=a(r(6488)),u=a(r(4888)),p=a(r(4788)),h=r(3288),f=r(2356),m=r(992),g=r(2308),v=new o.Logger("ReactNativeUnifiedPlan"),y={OS:1024,MIS:1024};class b extends f.HandlerInterface{static createFactory(){return()=>new b}constructor(){super(),this._closed=!1,this._mapMidTransceiver=new Map,this._sendStream=new MediaStream,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return"ReactNativeUnifiedPlan"}close(){if(v.debug("close()"),!this._closed){if(this._closed=!0,this._sendStream.release(!1),this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}}async getNativeRtpCapabilities(){v.debug("getNativeRtpCapabilities()");const e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"});try{e.addTransceiver("audio"),e.addTransceiver("video");const r=await e.createOffer();try{e.close()}catch(t){}const n=s.parse(r.sdp),i=l.extractRtpCapabilities({sdpObject:n});return p.addNackSuppportForOpus(i),i}catch(t){try{e.close()}catch(r){}throw t}}async getNativeSctpCapabilities(){return v.debug("getNativeSctpCapabilities()"),{numStreams:y}}run(e){let{direction:t,iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:a,iceServers:s,iceTransportPolicy:o,additionalSettings:c,proprietaryConstraints:l,extendedRtpCapabilities:u}=e;this.assertNotClosed(),v.debug("run()"),this._direction=t,this._remoteSdp=new m.RemoteSdp({iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:a}),this._sendingRtpParametersByKind={audio:d.getSendingRtpParameters("audio",u),video:d.getSendingRtpParameters("video",u)},this._sendingRemoteRtpParametersByKind={audio:d.getSendingRemoteRtpParameters("audio",u),video:d.getSendingRemoteRtpParameters("video",u)},i.role&&"auto"!==i.role&&(this._forcedLocalDtlsRole="server"===i.role?"client":"server"),this._pc=new RTCPeerConnection({iceServers:s||[],iceTransportPolicy:o||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan",...c},l),this._pc.addEventListener("icegatheringstatechange",(()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)})),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",(()=>{this.emit("@connectionstatechange",this._pc.connectionState)})):this._pc.addEventListener("iceconnectionstatechange",(()=>{switch(v.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":this.emit("@connectionstatechange","connecting");break;case"connected":case"completed":this.emit("@connectionstatechange","connected");break;case"failed":this.emit("@connectionstatechange","failed");break;case"disconnected":this.emit("@connectionstatechange","disconnected");break;case"closed":this.emit("@connectionstatechange","closed")}}))}async updateIceServers(e){this.assertNotClosed(),v.debug("updateIceServers()");const t=this._pc.getConfiguration();t.iceServers=e,this._pc.setConfiguration(t)}async restartIce(e){if(this.assertNotClosed(),v.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),this._transportReady)if("send"===this._direction){const e=await this._pc.createOffer({iceRestart:!0});v.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",e),await this._pc.setLocalDescription(e);const t={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",t),await this._pc.setRemoteDescription(t)}else{const e={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",e),await this._pc.setRemoteDescription(e);const t=await this._pc.createAnswer();v.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",t),await this._pc.setLocalDescription(t)}}async getTransportStats(){return this.assertNotClosed(),this._pc.getStats()}async send(e){var t;let{track:r,encodings:n,codecOptions:i,codec:a}=e;this.assertNotClosed(),this.assertSendDirection(),v.debug("send() [kind:%s, track.id:%s]",r.kind,r.id),n&&n.length>1&&n.forEach(((e,t)=>{e.rid="r".concat(t)}));const o=c.clone(this._sendingRtpParametersByKind[r.kind],{});o.codecs=d.reduceCodecs(o.codecs,a);const p=c.clone(this._sendingRemoteRtpParametersByKind[r.kind],{});p.codecs=d.reduceCodecs(p.codecs,a);const h=this._remoteSdp.getNextMediaSectionIdx(),f=this._pc.addTransceiver(r,{direction:"sendonly",streams:[this._sendStream],sendEncodings:n});let m,y=await this._pc.createOffer(),b=s.parse(y.sdp);var _;this._transportReady||await this.setupTransport({localDtlsRole:null!==(_=this._forcedLocalDtlsRole)&&void 0!==_?_:"client",localSdpObject:b});let w=!1;const S=(0,g.parse)((n||[{}])[0].scalabilityMode);n&&1===n.length&&S.spatialLayers>1&&"video/vp9"===o.codecs[0].mimeType.toLowerCase()&&(v.debug("send() | enabling legacy simulcast for VP9 SVC"),w=!0,b=s.parse(y.sdp),m=b.media[h.idx],u.addLegacySimulcast({offerMediaObject:m,numStreams:S.spatialLayers}),y={type:"offer",sdp:s.write(b)}),v.debug("send() | calling pc.setLocalDescription() [offer:%o]",y),await this._pc.setLocalDescription(y);let C=null!==(t=f.mid)&&void 0!==t?t:void 0;if(C||v.warn("send() | missing transceiver.mid (bug in react-native-webrtc, using a workaround"),o.mid=C,b=s.parse(this._pc.localDescription.sdp),m=b.media[h.idx],o.rtcp.cname=l.getCname({offerMediaObject:m}),n)if(1===n.length){let e=u.getRtpEncodings({offerMediaObject:m});Object.assign(e[0],n[0]),w&&(e=[e[0]]),o.encodings=e}else o.encodings=n;else o.encodings=u.getRtpEncodings({offerMediaObject:m});if(o.encodings.length>1&&("video/vp8"===o.codecs[0].mimeType.toLowerCase()||"video/h264"===o.codecs[0].mimeType.toLowerCase()))for(const s of o.encodings)s.scalabilityMode?s.scalabilityMode="L1T".concat(S.temporalLayers):s.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:m,reuseMid:h.reuseMid,offerRtpParameters:o,answerRtpParameters:p,codecOptions:i,extmapAllowMixed:!0});const k={type:"answer",sdp:this._remoteSdp.getSdp()};return v.debug("send() | calling pc.setRemoteDescription() [answer:%o]",k),await this._pc.setRemoteDescription(k),C||(C=f.mid,o.mid=C),this._mapMidTransceiver.set(C,f),{localId:C,rtpParameters:o,rtpSender:f.sender}}async stopSending(e){if(this.assertSendDirection(),this._closed)return;v.debug("stopSending() [localId:%s]",e);const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");t.sender.replaceTrack(null),this._pc.removeTrack(t.sender);if(this._remoteSdp.closeMediaSection(t.mid))try{t.stop()}catch(i){}const r=await this._pc.createOffer();v.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);const n={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n),this._mapMidTransceiver.delete(e)}async pauseSending(e){this.assertNotClosed(),this.assertSendDirection(),v.debug("pauseSending() [localId:%s]",e);const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");t.direction="inactive",this._remoteSdp.pauseMediaSection(e);const r=await this._pc.createOffer();v.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);const n={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}async resumeSending(e){this.assertNotClosed(),this.assertSendDirection(),v.debug("resumeSending() [localId:%s]",e);const t=this._mapMidTransceiver.get(e);if(this._remoteSdp.resumeSendingMediaSection(e),!t)throw new Error("associated RTCRtpTransceiver not found");t.direction="sendonly";const r=await this._pc.createOffer();v.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);const n={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}async replaceTrack(e,t){this.assertNotClosed(),this.assertSendDirection(),t?v.debug("replaceTrack() [localId:%s, track.id:%s]",e,t.id):v.debug("replaceTrack() [localId:%s, no track]",e);const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");await r.sender.replaceTrack(t)}async setMaxSpatialLayer(e,t){this.assertNotClosed(),this.assertSendDirection(),v.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,t);const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");const n=r.sender.getParameters();n.encodings.forEach(((e,r)=>{e.active=r<=t})),await r.sender.setParameters(n),this._remoteSdp.muxMediaSectionSimulcast(e,n.encodings);const i=await this._pc.createOffer();v.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const a={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",a),await this._pc.setRemoteDescription(a)}async setRtpEncodingParameters(e,t){this.assertNotClosed(),this.assertSendDirection(),v.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,t);const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");const n=r.sender.getParameters();n.encodings.forEach(((e,r)=>{n.encodings[r]={...e,...t}})),await r.sender.setParameters(n),this._remoteSdp.muxMediaSectionSimulcast(e,n.encodings);const i=await this._pc.createOffer();v.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const a={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",a),await this._pc.setRemoteDescription(a)}async getSenderStats(e){this.assertNotClosed(),this.assertSendDirection();const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");return t.sender.getStats()}async sendDataChannel(e){let{ordered:t,maxPacketLifeTime:r,maxRetransmits:n,label:i,protocol:a}=e;this.assertNotClosed(),this.assertSendDirection();const o={negotiated:!0,id:this._nextSendSctpStreamId,ordered:t,maxPacketLifeTime:r,maxRetransmits:n,protocol:a};v.debug("sendDataChannel() [options:%o]",o);const c=this._pc.createDataChannel(i,o);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%y.MIS,!this._hasDataChannelMediaSection){const e=await this._pc.createOffer(),t=s.parse(e.sdp),r=t.media.find((e=>"application"===e.type));var d;if(!this._transportReady)await this.setupTransport({localDtlsRole:null!==(d=this._forcedLocalDtlsRole)&&void 0!==d?d:"client",localSdpObject:t});v.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",e),await this._pc.setLocalDescription(e),this._remoteSdp.sendSctpAssociation({offerMediaObject:r});const n={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n),this._hasDataChannelMediaSection=!0}return{dataChannel:c,sctpStreamParameters:{streamId:o.id,ordered:o.ordered,maxPacketLifeTime:o.maxPacketLifeTime,maxRetransmits:o.maxRetransmits}}}async receive(e){this.assertNotClosed(),this.assertRecvDirection();const t=[],r=new Map;for(const s of e){const{trackId:e,kind:t,rtpParameters:n,streamId:i}=s;v.debug("receive() [trackId:%s, kind:%s]",e,t);const a=n.mid||String(this._mapMidTransceiver.size);r.set(e,a),this._remoteSdp.receive({mid:a,kind:t,offerRtpParameters:n,streamId:i||n.rtcp.cname,trackId:e})}const n={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);let i=await this._pc.createAnswer();const a=s.parse(i.sdp);for(const s of e){const{trackId:e,rtpParameters:t}=s,n=r.get(e),i=a.media.find((e=>String(e.mid)===n));l.applyCodecParameters({offerRtpParameters:t,answerMediaObject:i})}var o;(i={type:"answer",sdp:s.write(a)},this._transportReady)||await this.setupTransport({localDtlsRole:null!==(o=this._forcedLocalDtlsRole)&&void 0!==o?o:"client",localSdpObject:a});v.debug("receive() | calling pc.setLocalDescription() [answer:%o]",i),await this._pc.setLocalDescription(i);for(const s of e){const{trackId:e}=s,n=r.get(e),i=this._pc.getTransceivers().find((e=>e.mid===n));if(!i)throw new Error("new RTCRtpTransceiver not found");this._mapMidTransceiver.set(n,i),t.push({localId:n,track:i.receiver.track,rtpReceiver:i.receiver})}return t}async stopReceiving(e){if(this.assertRecvDirection(),this._closed)return;for(const n of e){v.debug("stopReceiving() [localId:%s]",n);const e=this._mapMidTransceiver.get(n);if(!e)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(e.mid)}const t={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const r=await this._pc.createAnswer();v.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",r),await this._pc.setLocalDescription(r);for(const n of e)this._mapMidTransceiver.delete(n)}async pauseReceiving(e){this.assertNotClosed(),this.assertRecvDirection();for(const n of e){v.debug("pauseReceiving() [localId:%s]",n);const e=this._mapMidTransceiver.get(n);if(!e)throw new Error("associated RTCRtpTransceiver not found");e.direction="inactive",this._remoteSdp.pauseMediaSection(n)}const t={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const r=await this._pc.createAnswer();v.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",r),await this._pc.setLocalDescription(r)}async resumeReceiving(e){this.assertNotClosed(),this.assertRecvDirection();for(const n of e){v.debug("resumeReceiving() [localId:%s]",n);const e=this._mapMidTransceiver.get(n);if(!e)throw new Error("associated RTCRtpTransceiver not found");e.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(n)}const t={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const r=await this._pc.createAnswer();v.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",r),await this._pc.setLocalDescription(r)}async getReceiverStats(e){this.assertNotClosed(),this.assertRecvDirection();const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");return t.receiver.getStats()}async receiveDataChannel(e){let{sctpStreamParameters:t,label:r,protocol:n}=e;this.assertNotClosed(),this.assertRecvDirection();const{streamId:i,ordered:a,maxPacketLifeTime:o,maxRetransmits:c}=t,d={negotiated:!0,id:i,ordered:a,maxPacketLifeTime:o,maxRetransmits:c,protocol:n};v.debug("receiveDataChannel() [options:%o]",d);const l=this._pc.createDataChannel(r,d);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const e={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",e),await this._pc.setRemoteDescription(e);const t=await this._pc.createAnswer();if(!this._transportReady){var u;const e=s.parse(t.sdp);await this.setupTransport({localDtlsRole:null!==(u=this._forcedLocalDtlsRole)&&void 0!==u?u:"client",localSdpObject:e})}v.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",t),await this._pc.setLocalDescription(t),this._hasDataChannelMediaSection=!0}return{dataChannel:l}}async setupTransport(e){let{localDtlsRole:t,localSdpObject:r}=e;r||(r=s.parse(this._pc.localDescription.sdp));const n=l.extractDtlsParameters({sdpObject:r});n.role=t,this._remoteSdp.updateDtlsRole("client"===t?"server":"client"),await new Promise(((e,t)=>{this.safeEmit("@connect",{dtlsParameters:n},e,t)})),this._transportReady=!0}assertNotClosed(){if(this._closed)throw new h.InvalidStateError("method called in a closed handler")}assertSendDirection(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}t.ReactNativeUnifiedPlan=b},6232:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Safari11=void 0;const s=a(r(7181)),o=r(56),c=a(r(6176)),d=a(r(9324)),l=a(r(6488)),u=a(r(752)),p=r(2356),h=r(992),f=new o.Logger("Safari11"),m={OS:1024,MIS:1024};class g extends p.HandlerInterface{static createFactory(){return()=>new g}constructor(){super(),this._sendStream=new MediaStream,this._mapSendLocalIdRtpSender=new Map,this._nextSendLocalId=0,this._mapRecvLocalIdInfo=new Map,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return"Safari11"}close(){if(f.debug("close()"),this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}async getNativeRtpCapabilities(){f.debug("getNativeRtpCapabilities()");const e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"});try{const r=await e.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});try{e.close()}catch(t){}const n=s.parse(r.sdp);return l.extractRtpCapabilities({sdpObject:n})}catch(t){try{e.close()}catch(r){}throw t}}async getNativeSctpCapabilities(){return f.debug("getNativeSctpCapabilities()"),{numStreams:m}}run(e){let{direction:t,iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:a,iceServers:s,iceTransportPolicy:o,additionalSettings:c,proprietaryConstraints:l,extendedRtpCapabilities:u}=e;f.debug("run()"),this._direction=t,this._remoteSdp=new h.RemoteSdp({iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:a,planB:!0}),this._sendingRtpParametersByKind={audio:d.getSendingRtpParameters("audio",u),video:d.getSendingRtpParameters("video",u)},this._sendingRemoteRtpParametersByKind={audio:d.getSendingRemoteRtpParameters("audio",u),video:d.getSendingRemoteRtpParameters("video",u)},i.role&&"auto"!==i.role&&(this._forcedLocalDtlsRole="server"===i.role?"client":"server"),this._pc=new RTCPeerConnection({iceServers:s||[],iceTransportPolicy:o||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",...c},l),this._pc.addEventListener("icegatheringstatechange",(()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)})),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",(()=>{this.emit("@connectionstatechange",this._pc.connectionState)})):this._pc.addEventListener("iceconnectionstatechange",(()=>{switch(f.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":this.emit("@connectionstatechange","connecting");break;case"connected":case"completed":this.emit("@connectionstatechange","connected");break;case"failed":this.emit("@connectionstatechange","failed");break;case"disconnected":this.emit("@connectionstatechange","disconnected");break;case"closed":this.emit("@connectionstatechange","closed")}}))}async updateIceServers(e){f.debug("updateIceServers()");const t=this._pc.getConfiguration();t.iceServers=e,this._pc.setConfiguration(t)}async restartIce(e){if(f.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),this._transportReady)if("send"===this._direction){const e=await this._pc.createOffer({iceRestart:!0});f.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",e),await this._pc.setLocalDescription(e);const t={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",t),await this._pc.setRemoteDescription(t)}else{const e={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",e),await this._pc.setRemoteDescription(e);const t=await this._pc.createAnswer();f.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",t),await this._pc.setLocalDescription(t)}}async getTransportStats(){return this._pc.getStats()}async send(e){let{track:t,encodings:r,codecOptions:n,codec:i}=e;this.assertSendDirection(),f.debug("send() [kind:%s, track.id:%s]",t.kind,t.id),i&&f.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(t),this._pc.addTrack(t,this._sendStream);let a,o=await this._pc.createOffer(),p=s.parse(o.sdp);const h=c.clone(this._sendingRtpParametersByKind[t.kind],{});h.codecs=d.reduceCodecs(h.codecs);const m=c.clone(this._sendingRemoteRtpParametersByKind[t.kind],{});var g;(m.codecs=d.reduceCodecs(m.codecs),this._transportReady)||await this.setupTransport({localDtlsRole:null!==(g=this._forcedLocalDtlsRole)&&void 0!==g?g:"client",localSdpObject:p});if("video"===t.kind&&r&&r.length>1&&(f.debug("send() | enabling simulcast"),p=s.parse(o.sdp),a=p.media.find((e=>"video"===e.type)),u.addLegacySimulcast({offerMediaObject:a,track:t,numStreams:r.length}),o={type:"offer",sdp:s.write(p)}),f.debug("send() | calling pc.setLocalDescription() [offer:%o]",o),await this._pc.setLocalDescription(o),p=s.parse(this._pc.localDescription.sdp),a=p.media.find((e=>e.type===t.kind)),h.rtcp.cname=l.getCname({offerMediaObject:a}),h.encodings=u.getRtpEncodings({offerMediaObject:a,track:t}),r)for(let s=0;s<h.encodings.length;++s)r[s]&&Object.assign(h.encodings[s],r[s]);if(h.encodings.length>1&&"video/vp8"===h.codecs[0].mimeType.toLowerCase())for(const s of h.encodings)s.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:a,offerRtpParameters:h,answerRtpParameters:m,codecOptions:n});const v={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("send() | calling pc.setRemoteDescription() [answer:%o]",v),await this._pc.setRemoteDescription(v);const y=String(this._nextSendLocalId);this._nextSendLocalId++;const b=this._pc.getSenders().find((e=>e.track===t));return this._mapSendLocalIdRtpSender.set(y,b),{localId:y,rtpParameters:h,rtpSender:b}}async stopSending(e){this.assertSendDirection();const t=this._mapSendLocalIdRtpSender.get(e);if(!t)throw new Error("associated RTCRtpSender not found");t.track&&this._sendStream.removeTrack(t.track),this._mapSendLocalIdRtpSender.delete(e);const r=await this._pc.createOffer();f.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",r);try{await this._pc.setLocalDescription(r)}catch(i){if(0===this._sendStream.getTracks().length)return void f.warn("stopSending() | ignoring expected error due no sending tracks: %s",i.toString());throw i}if("stable"===this._pc.signalingState)return;const n={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}async pauseSending(e){}async resumeSending(e){}async replaceTrack(e,t){this.assertSendDirection(),t?f.debug("replaceTrack() [localId:%s, track.id:%s]",e,t.id):f.debug("replaceTrack() [localId:%s, no track]",e);const r=this._mapSendLocalIdRtpSender.get(e);if(!r)throw new Error("associated RTCRtpSender not found");const n=r.track;await r.replaceTrack(t),n&&this._sendStream.removeTrack(n),t&&this._sendStream.addTrack(t)}async setMaxSpatialLayer(e,t){this.assertSendDirection(),f.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,t);const r=this._mapSendLocalIdRtpSender.get(e);if(!r)throw new Error("associated RTCRtpSender not found");const n=r.getParameters();n.encodings.forEach(((e,r)=>{e.active=r<=t})),await r.setParameters(n)}async setRtpEncodingParameters(e,t){this.assertSendDirection(),f.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,t);const r=this._mapSendLocalIdRtpSender.get(e);if(!r)throw new Error("associated RTCRtpSender not found");const n=r.getParameters();n.encodings.forEach(((e,r)=>{n.encodings[r]={...e,...t}})),await r.setParameters(n)}async getSenderStats(e){this.assertSendDirection();const t=this._mapSendLocalIdRtpSender.get(e);if(!t)throw new Error("associated RTCRtpSender not found");return t.getStats()}async sendDataChannel(e){let{ordered:t,maxPacketLifeTime:r,maxRetransmits:n,label:i,protocol:a}=e;this.assertSendDirection();const o={negotiated:!0,id:this._nextSendSctpStreamId,ordered:t,maxPacketLifeTime:r,maxRetransmits:n,protocol:a};f.debug("sendDataChannel() [options:%o]",o);const c=this._pc.createDataChannel(i,o);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%m.MIS,!this._hasDataChannelMediaSection){const e=await this._pc.createOffer(),t=s.parse(e.sdp),r=t.media.find((e=>"application"===e.type));var d;if(!this._transportReady)await this.setupTransport({localDtlsRole:null!==(d=this._forcedLocalDtlsRole)&&void 0!==d?d:"client",localSdpObject:t});f.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",e),await this._pc.setLocalDescription(e),this._remoteSdp.sendSctpAssociation({offerMediaObject:r});const n={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n),this._hasDataChannelMediaSection=!0}return{dataChannel:c,sctpStreamParameters:{streamId:o.id,ordered:o.ordered,maxPacketLifeTime:o.maxPacketLifeTime,maxRetransmits:o.maxRetransmits}}}async receive(e){this.assertRecvDirection();const t=[];for(const s of e){const{trackId:e,kind:t,rtpParameters:r,streamId:n}=s;f.debug("receive() [trackId:%s, kind:%s]",e,t);const i=t;this._remoteSdp.receive({mid:i,kind:t,offerRtpParameters:r,streamId:n||r.rtcp.cname,trackId:e})}const r={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);let n=await this._pc.createAnswer();const i=s.parse(n.sdp);for(const s of e){const{kind:e,rtpParameters:t}=s,r=e,n=i.media.find((e=>String(e.mid)===r));l.applyCodecParameters({offerRtpParameters:t,answerMediaObject:n})}var a;(n={type:"answer",sdp:s.write(i)},this._transportReady)||await this.setupTransport({localDtlsRole:null!==(a=this._forcedLocalDtlsRole)&&void 0!==a?a:"client",localSdpObject:i});f.debug("receive() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n);for(const s of e){const{kind:e,trackId:r,rtpParameters:n}=s,i=e,a=r,o=this._pc.getReceivers().find((e=>e.track&&e.track.id===a));if(!o)throw new Error("new RTCRtpReceiver not");this._mapRecvLocalIdInfo.set(a,{mid:i,rtpParameters:n,rtpReceiver:o}),t.push({localId:a,track:o.track,rtpReceiver:o})}return t}async stopReceiving(e){this.assertRecvDirection();for(const n of e){f.debug("stopReceiving() [localId:%s]",n);const{mid:e,rtpParameters:t}=this._mapRecvLocalIdInfo.get(n)||{};this._mapRecvLocalIdInfo.delete(n),this._remoteSdp.planBStopReceiving({mid:e,offerRtpParameters:t})}const t={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const r=await this._pc.createAnswer();f.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",r),await this._pc.setLocalDescription(r)}async getReceiverStats(e){this.assertRecvDirection();const{rtpReceiver:t}=this._mapRecvLocalIdInfo.get(e)||{};if(!t)throw new Error("associated RTCRtpReceiver not found");return t.getStats()}async pauseReceiving(e){}async resumeReceiving(e){}async receiveDataChannel(e){let{sctpStreamParameters:t,label:r,protocol:n}=e;this.assertRecvDirection();const{streamId:i,ordered:a,maxPacketLifeTime:o,maxRetransmits:c}=t,d={negotiated:!0,id:i,ordered:a,maxPacketLifeTime:o,maxRetransmits:c,protocol:n};f.debug("receiveDataChannel() [options:%o]",d);const l=this._pc.createDataChannel(r,d);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0});const e={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",e),await this._pc.setRemoteDescription(e);const t=await this._pc.createAnswer();if(!this._transportReady){var u;const e=s.parse(t.sdp);await this.setupTransport({localDtlsRole:null!==(u=this._forcedLocalDtlsRole)&&void 0!==u?u:"client",localSdpObject:e})}f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",t),await this._pc.setLocalDescription(t),this._hasDataChannelMediaSection=!0}return{dataChannel:l}}async setupTransport(e){let{localDtlsRole:t,localSdpObject:r}=e;r||(r=s.parse(this._pc.localDescription.sdp));const n=l.extractDtlsParameters({sdpObject:r});n.role=t,this._remoteSdp.updateDtlsRole("client"===t?"server":"client"),await new Promise(((e,t)=>{this.safeEmit("@connect",{dtlsParameters:n},e,t)})),this._transportReady=!0}assertSendDirection(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}t.Safari11=g},1436:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Safari12=void 0;const s=a(r(7181)),o=r(56),c=a(r(6176)),d=a(r(9324)),l=a(r(6488)),u=a(r(4888)),p=a(r(4788)),h=r(3288),f=r(2356),m=r(992),g=r(2308),v=new o.Logger("Safari12"),y={OS:1024,MIS:1024};class b extends f.HandlerInterface{static createFactory(){return()=>new b}constructor(){super(),this._closed=!1,this._mapMidTransceiver=new Map,this._sendStream=new MediaStream,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return"Safari12"}close(){if(v.debug("close()"),!this._closed){if(this._closed=!0,this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}}async getNativeRtpCapabilities(){v.debug("getNativeRtpCapabilities()");const e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"});try{e.addTransceiver("audio"),e.addTransceiver("video");const r=await e.createOffer();try{e.close()}catch(t){}const n=s.parse(r.sdp),i=l.extractRtpCapabilities({sdpObject:n});return p.addNackSuppportForOpus(i),i}catch(t){try{e.close()}catch(r){}throw t}}async getNativeSctpCapabilities(){return v.debug("getNativeSctpCapabilities()"),{numStreams:y}}run(e){let{direction:t,iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:a,iceServers:s,iceTransportPolicy:o,additionalSettings:c,proprietaryConstraints:l,extendedRtpCapabilities:u}=e;this.assertNotClosed(),v.debug("run()"),this._direction=t,this._remoteSdp=new m.RemoteSdp({iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:a}),this._sendingRtpParametersByKind={audio:d.getSendingRtpParameters("audio",u),video:d.getSendingRtpParameters("video",u)},this._sendingRemoteRtpParametersByKind={audio:d.getSendingRemoteRtpParameters("audio",u),video:d.getSendingRemoteRtpParameters("video",u)},i.role&&"auto"!==i.role&&(this._forcedLocalDtlsRole="server"===i.role?"client":"server"),this._pc=new RTCPeerConnection({iceServers:s||[],iceTransportPolicy:o||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",...c},l),this._pc.addEventListener("icegatheringstatechange",(()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)})),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",(()=>{this.emit("@connectionstatechange",this._pc.connectionState)})):this._pc.addEventListener("iceconnectionstatechange",(()=>{switch(v.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":this.emit("@connectionstatechange","connecting");break;case"connected":case"completed":this.emit("@connectionstatechange","connected");break;case"failed":this.emit("@connectionstatechange","failed");break;case"disconnected":this.emit("@connectionstatechange","disconnected");break;case"closed":this.emit("@connectionstatechange","closed")}}))}async updateIceServers(e){this.assertNotClosed(),v.debug("updateIceServers()");const t=this._pc.getConfiguration();t.iceServers=e,this._pc.setConfiguration(t)}async restartIce(e){if(this.assertNotClosed(),v.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),this._transportReady)if("send"===this._direction){const e=await this._pc.createOffer({iceRestart:!0});v.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",e),await this._pc.setLocalDescription(e);const t={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",t),await this._pc.setRemoteDescription(t)}else{const e={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",e),await this._pc.setRemoteDescription(e);const t=await this._pc.createAnswer();v.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",t),await this._pc.setLocalDescription(t)}}async getTransportStats(){return this.assertNotClosed(),this._pc.getStats()}async send(e){let{track:t,encodings:r,codecOptions:n,codec:i}=e;this.assertNotClosed(),this.assertSendDirection(),v.debug("send() [kind:%s, track.id:%s]",t.kind,t.id);const a=c.clone(this._sendingRtpParametersByKind[t.kind],{});a.codecs=d.reduceCodecs(a.codecs,i);const o=c.clone(this._sendingRemoteRtpParametersByKind[t.kind],{});o.codecs=d.reduceCodecs(o.codecs,i);const p=this._remoteSdp.getNextMediaSectionIdx(),h=this._pc.addTransceiver(t,{direction:"sendonly",streams:[this._sendStream]});let f,m=await this._pc.createOffer(),y=s.parse(m.sdp);var b;this._transportReady||await this.setupTransport({localDtlsRole:null!==(b=this._forcedLocalDtlsRole)&&void 0!==b?b:"client",localSdpObject:y});const _=(0,g.parse)((r||[{}])[0].scalabilityMode);r&&r.length>1&&(v.debug("send() | enabling legacy simulcast"),y=s.parse(m.sdp),f=y.media[p.idx],u.addLegacySimulcast({offerMediaObject:f,numStreams:r.length}),m={type:"offer",sdp:s.write(y)}),v.debug("send() | calling pc.setLocalDescription() [offer:%o]",m),await this._pc.setLocalDescription(m);const w=h.mid;if(a.mid=w,y=s.parse(this._pc.localDescription.sdp),f=y.media[p.idx],a.rtcp.cname=l.getCname({offerMediaObject:f}),a.encodings=u.getRtpEncodings({offerMediaObject:f}),r)for(let s=0;s<a.encodings.length;++s)r[s]&&Object.assign(a.encodings[s],r[s]);if(a.encodings.length>1&&("video/vp8"===a.codecs[0].mimeType.toLowerCase()||"video/h264"===a.codecs[0].mimeType.toLowerCase()))for(const s of a.encodings)s.scalabilityMode?s.scalabilityMode="L1T".concat(_.temporalLayers):s.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:f,reuseMid:p.reuseMid,offerRtpParameters:a,answerRtpParameters:o,codecOptions:n});const S={type:"answer",sdp:this._remoteSdp.getSdp()};return v.debug("send() | calling pc.setRemoteDescription() [answer:%o]",S),await this._pc.setRemoteDescription(S),this._mapMidTransceiver.set(w,h),{localId:w,rtpParameters:a,rtpSender:h.sender}}async stopSending(e){if(this.assertSendDirection(),this._closed)return;v.debug("stopSending() [localId:%s]",e);const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");t.sender.replaceTrack(null),this._pc.removeTrack(t.sender);if(this._remoteSdp.closeMediaSection(t.mid))try{t.stop()}catch(i){}const r=await this._pc.createOffer();v.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);const n={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n),this._mapMidTransceiver.delete(e)}async pauseSending(e){this.assertNotClosed(),this.assertSendDirection(),v.debug("pauseSending() [localId:%s]",e);const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");t.direction="inactive",this._remoteSdp.pauseMediaSection(e);const r=await this._pc.createOffer();v.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);const n={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}async resumeSending(e){this.assertNotClosed(),this.assertSendDirection(),v.debug("resumeSending() [localId:%s]",e);const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");t.direction="sendonly",this._remoteSdp.resumeSendingMediaSection(e);const r=await this._pc.createOffer();v.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);const n={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}async replaceTrack(e,t){this.assertNotClosed(),this.assertSendDirection(),t?v.debug("replaceTrack() [localId:%s, track.id:%s]",e,t.id):v.debug("replaceTrack() [localId:%s, no track]",e);const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");await r.sender.replaceTrack(t)}async setMaxSpatialLayer(e,t){this.assertNotClosed(),this.assertSendDirection(),v.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,t);const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");const n=r.sender.getParameters();n.encodings.forEach(((e,r)=>{e.active=r<=t})),await r.sender.setParameters(n),this._remoteSdp.muxMediaSectionSimulcast(e,n.encodings);const i=await this._pc.createOffer();v.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const a={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",a),await this._pc.setRemoteDescription(a)}async setRtpEncodingParameters(e,t){this.assertNotClosed(),this.assertSendDirection(),v.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,t);const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");const n=r.sender.getParameters();n.encodings.forEach(((e,r)=>{n.encodings[r]={...e,...t}})),await r.sender.setParameters(n),this._remoteSdp.muxMediaSectionSimulcast(e,n.encodings);const i=await this._pc.createOffer();v.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const a={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",a),await this._pc.setRemoteDescription(a)}async getSenderStats(e){this.assertNotClosed(),this.assertSendDirection();const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");return t.sender.getStats()}async sendDataChannel(e){let{ordered:t,maxPacketLifeTime:r,maxRetransmits:n,label:i,protocol:a}=e;this.assertNotClosed(),this.assertSendDirection();const o={negotiated:!0,id:this._nextSendSctpStreamId,ordered:t,maxPacketLifeTime:r,maxRetransmits:n,protocol:a};v.debug("sendDataChannel() [options:%o]",o);const c=this._pc.createDataChannel(i,o);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%y.MIS,!this._hasDataChannelMediaSection){const e=await this._pc.createOffer(),t=s.parse(e.sdp),r=t.media.find((e=>"application"===e.type));var d;if(!this._transportReady)await this.setupTransport({localDtlsRole:null!==(d=this._forcedLocalDtlsRole)&&void 0!==d?d:"client",localSdpObject:t});v.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",e),await this._pc.setLocalDescription(e),this._remoteSdp.sendSctpAssociation({offerMediaObject:r});const n={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n),this._hasDataChannelMediaSection=!0}return{dataChannel:c,sctpStreamParameters:{streamId:o.id,ordered:o.ordered,maxPacketLifeTime:o.maxPacketLifeTime,maxRetransmits:o.maxRetransmits}}}async receive(e){this.assertNotClosed(),this.assertRecvDirection();const t=[],r=new Map;for(const s of e){const{trackId:e,kind:t,rtpParameters:n,streamId:i}=s;v.debug("receive() [trackId:%s, kind:%s]",e,t);const a=n.mid||String(this._mapMidTransceiver.size);r.set(e,a),this._remoteSdp.receive({mid:a,kind:t,offerRtpParameters:n,streamId:i||n.rtcp.cname,trackId:e})}const n={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);let i=await this._pc.createAnswer();const a=s.parse(i.sdp);for(const s of e){const{trackId:e,rtpParameters:t}=s,n=r.get(e),i=a.media.find((e=>String(e.mid)===n));l.applyCodecParameters({offerRtpParameters:t,answerMediaObject:i})}var o;(i={type:"answer",sdp:s.write(a)},this._transportReady)||await this.setupTransport({localDtlsRole:null!==(o=this._forcedLocalDtlsRole)&&void 0!==o?o:"client",localSdpObject:a});v.debug("receive() | calling pc.setLocalDescription() [answer:%o]",i),await this._pc.setLocalDescription(i);for(const s of e){const{trackId:e}=s,n=r.get(e),i=this._pc.getTransceivers().find((e=>e.mid===n));if(!i)throw new Error("new RTCRtpTransceiver not found");this._mapMidTransceiver.set(n,i),t.push({localId:n,track:i.receiver.track,rtpReceiver:i.receiver})}return t}async stopReceiving(e){if(this.assertRecvDirection(),this._closed)return;for(const n of e){v.debug("stopReceiving() [localId:%s]",n);const e=this._mapMidTransceiver.get(n);if(!e)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(e.mid)}const t={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const r=await this._pc.createAnswer();v.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",r),await this._pc.setLocalDescription(r);for(const n of e)this._mapMidTransceiver.delete(n)}async pauseReceiving(e){this.assertNotClosed(),this.assertRecvDirection();for(const n of e){v.debug("pauseReceiving() [localId:%s]",n);const e=this._mapMidTransceiver.get(n);if(!e)throw new Error("associated RTCRtpTransceiver not found");e.direction="inactive",this._remoteSdp.pauseMediaSection(n)}const t={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const r=await this._pc.createAnswer();v.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",r),await this._pc.setLocalDescription(r)}async resumeReceiving(e){this.assertNotClosed(),this.assertRecvDirection();for(const n of e){v.debug("resumeReceiving() [localId:%s]",n);const e=this._mapMidTransceiver.get(n);if(!e)throw new Error("associated RTCRtpTransceiver not found");e.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(n)}const t={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const r=await this._pc.createAnswer();v.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",r),await this._pc.setLocalDescription(r)}async getReceiverStats(e){this.assertNotClosed(),this.assertRecvDirection();const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");return t.receiver.getStats()}async receiveDataChannel(e){let{sctpStreamParameters:t,label:r,protocol:n}=e;this.assertNotClosed(),this.assertRecvDirection();const{streamId:i,ordered:a,maxPacketLifeTime:o,maxRetransmits:c}=t,d={negotiated:!0,id:i,ordered:a,maxPacketLifeTime:o,maxRetransmits:c,protocol:n};v.debug("receiveDataChannel() [options:%o]",d);const l=this._pc.createDataChannel(r,d);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const e={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",e),await this._pc.setRemoteDescription(e);const t=await this._pc.createAnswer();if(!this._transportReady){var u;const e=s.parse(t.sdp);await this.setupTransport({localDtlsRole:null!==(u=this._forcedLocalDtlsRole)&&void 0!==u?u:"client",localSdpObject:e})}v.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",t),await this._pc.setLocalDescription(t),this._hasDataChannelMediaSection=!0}return{dataChannel:l}}async setupTransport(e){let{localDtlsRole:t,localSdpObject:r}=e;r||(r=s.parse(this._pc.localDescription.sdp));const n=l.extractDtlsParameters({sdpObject:r});n.role=t,this._remoteSdp.updateDtlsRole("client"===t?"server":"client"),await new Promise(((e,t)=>{this.safeEmit("@connect",{dtlsParameters:n},e,t)})),this._transportReady=!0}assertNotClosed(){if(this._closed)throw new h.InvalidStateError("method called in a closed handler")}assertSendDirection(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}t.Safari12=b},1727:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.mangleRtpParameters=t.getCapabilities=void 0;const s=a(r(6176));t.getCapabilities=function(){const e=RTCRtpReceiver.getCapabilities(),t=s.clone(e,{});for(const r of t.codecs){if(r.channels=r.numChannels,delete r.numChannels,r.mimeType=r.mimeType||"".concat(r.kind,"/").concat(r.name),r.parameters){const e=r.parameters;e.apt&&(e.apt=Number(e.apt)),e["packetization-mode"]&&(e["packetization-mode"]=Number(e["packetization-mode"]))}for(const e of r.rtcpFeedback||[])e.parameter||(e.parameter="")}return t},t.mangleRtpParameters=function(e){const t=s.clone(e,{});t.mid&&(t.muxId=t.mid,delete t.mid);for(const r of t.codecs)r.channels&&(r.numChannels=r.channels,delete r.channels),r.mimeType&&!r.name&&(r.name=r.mimeType.split("/")[1]),delete r.mimeType;return t}},4788:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addNackSuppportForOpus=void 0,t.addNackSuppportForOpus=function(e){for(const r of e.codecs||[]){var t;"audio/opus"!==r.mimeType.toLowerCase()&&"audio/multiopus"!==r.mimeType.toLowerCase()||null!==(t=r.rtcpFeedback)&&void 0!==t&&t.some((e=>"nack"===e.type&&!e.parameter))||(r.rtcpFeedback||(r.rtcpFeedback=[]),r.rtcpFeedback.push({type:"nack"}))}}},8952:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.OfferMediaSection=t.AnswerMediaSection=t.MediaSection=void 0;const s=a(r(7181)),o=a(r(6176));class c{constructor(e){let{iceParameters:t,iceCandidates:r,dtlsParameters:n,planB:i=!1}=e;if(this._mediaObject={},this._planB=i,t&&this.setIceParameters(t),r){this._mediaObject.candidates=[];for(const e of r){const t={component:1};t.foundation=e.foundation,t.ip=e.ip,t.port=e.port,t.priority=e.priority,t.transport=e.protocol,t.type=e.type,e.tcpType&&(t.tcptype=e.tcpType),this._mediaObject.candidates.push(t)}this._mediaObject.endOfCandidates="end-of-candidates",this._mediaObject.iceOptions="renomination"}n&&this.setDtlsRole(n.role)}get mid(){return String(this._mediaObject.mid)}get closed(){return 0===this._mediaObject.port}getObject(){return this._mediaObject}setIceParameters(e){this._mediaObject.iceUfrag=e.usernameFragment,this._mediaObject.icePwd=e.password}pause(){this._mediaObject.direction="inactive"}disable(){this.pause(),delete this._mediaObject.ext,delete this._mediaObject.ssrcs,delete this._mediaObject.ssrcGroups,delete this._mediaObject.simulcast,delete this._mediaObject.simulcast_03,delete this._mediaObject.rids,delete this._mediaObject.extmapAllowMixed}close(){this.disable(),this._mediaObject.port=0}}t.MediaSection=c;t.AnswerMediaSection=class extends c{constructor(e){let{iceParameters:t,iceCandidates:r,dtlsParameters:n,sctpParameters:i,plainRtpParameters:a,planB:s=!1,offerMediaObject:c,offerRtpParameters:l,answerRtpParameters:u,codecOptions:p,extmapAllowMixed:h=!1}=e;switch(super({iceParameters:t,iceCandidates:r,dtlsParameters:n,planB:s}),this._mediaObject.mid=String(c.mid),this._mediaObject.type=c.type,this._mediaObject.protocol=c.protocol,a?(this._mediaObject.connection={ip:a.ip,version:a.ipVersion},this._mediaObject.port=a.port):(this._mediaObject.connection={ip:"127.0.0.1",version:4},this._mediaObject.port=7),c.type){case"audio":case"video":this._mediaObject.direction="recvonly",this._mediaObject.rtp=[],this._mediaObject.rtcpFb=[],this._mediaObject.fmtp=[];for(const e of u.codecs){const t={payload:e.payloadType,codec:d(e),rate:e.clockRate};e.channels>1&&(t.encoding=e.channels),this._mediaObject.rtp.push(t);const r=o.clone(e.parameters,{});let n=o.clone(e.rtcpFeedback,[]);if(p){const{opusStereo:t,opusFec:i,opusDtx:a,opusMaxPlaybackRate:s,opusMaxAverageBitrate:o,opusPtime:c,opusNack:d,videoGoogleStartBitrate:u,videoGoogleMaxBitrate:h,videoGoogleMinBitrate:f}=p,m=l.codecs.find((t=>t.payloadType===e.payloadType));switch(e.mimeType.toLowerCase()){case"audio/opus":case"audio/multiopus":void 0!==t&&(m.parameters["sprop-stereo"]=t?1:0,r.stereo=t?1:0),void 0!==i&&(m.parameters.useinbandfec=i?1:0,r.useinbandfec=i?1:0),void 0!==a&&(m.parameters.usedtx=a?1:0,r.usedtx=a?1:0),void 0!==s&&(r.maxplaybackrate=s),void 0!==o&&(r.maxaveragebitrate=o),void 0!==c&&(m.parameters.ptime=c,r.ptime=c),d||(m.rtcpFeedback=m.rtcpFeedback.filter((e=>"nack"!==e.type||e.parameter)),n=n.filter((e=>"nack"!==e.type||e.parameter)));break;case"video/vp8":case"video/vp9":case"video/h264":case"video/h265":void 0!==u&&(r["x-google-start-bitrate"]=u),void 0!==h&&(r["x-google-max-bitrate"]=h),void 0!==f&&(r["x-google-min-bitrate"]=f)}}const i={payload:e.payloadType,config:""};for(const e of Object.keys(r))i.config&&(i.config+=";"),i.config+="".concat(e,"=").concat(r[e]);i.config&&this._mediaObject.fmtp.push(i);for(const a of n)this._mediaObject.rtcpFb.push({payload:e.payloadType,type:a.type,subtype:a.parameter})}this._mediaObject.payloads=u.codecs.map((e=>e.payloadType)).join(" "),this._mediaObject.ext=[];for(const e of u.headerExtensions){(c.ext||[]).some((t=>t.uri===e.uri))&&this._mediaObject.ext.push({uri:e.uri,value:e.id})}if(h&&"extmap-allow-mixed"===c.extmapAllowMixed&&(this._mediaObject.extmapAllowMixed="extmap-allow-mixed"),c.simulcast){this._mediaObject.simulcast={dir1:"recv",list1:c.simulcast.list1},this._mediaObject.rids=[];for(const e of c.rids||[])"send"===e.direction&&this._mediaObject.rids.push({id:e.id,direction:"recv"})}else if(c.simulcast_03){this._mediaObject.simulcast_03={value:c.simulcast_03.value.replace(/send/g,"recv")},this._mediaObject.rids=[];for(const e of c.rids||[])"send"===e.direction&&this._mediaObject.rids.push({id:e.id,direction:"recv"})}this._mediaObject.rtcpMux="rtcp-mux",this._mediaObject.rtcpRsize="rtcp-rsize",this._planB&&"video"===this._mediaObject.type&&(this._mediaObject.xGoogleFlag="conference");break;case"application":"number"===typeof c.sctpPort?(this._mediaObject.payloads="webrtc-datachannel",this._mediaObject.sctpPort=i.port,this._mediaObject.maxMessageSize=i.maxMessageSize):c.sctpmap&&(this._mediaObject.payloads=i.port,this._mediaObject.sctpmap={app:"webrtc-datachannel",sctpmapNumber:i.port,maxMessageSize:i.maxMessageSize})}}setDtlsRole(e){switch(e){case"client":this._mediaObject.setup="active";break;case"server":this._mediaObject.setup="passive";break;case"auto":this._mediaObject.setup="actpass"}}resume(){this._mediaObject.direction="recvonly"}muxSimulcastStreams(e){if(!this._mediaObject.simulcast||!this._mediaObject.simulcast.list1)return;const t={};for(const a of e)a.rid&&(t[a.rid]=a);const r=this._mediaObject.simulcast.list1,n=s.parseSimulcastStreamList(r);for(const a of n)for(const e of a){var i;e.paused=!(null!==(i=t[e.scid])&&void 0!==i&&i.active)}this._mediaObject.simulcast.list1=n.map((e=>e.map((e=>"".concat(e.paused?"~":"").concat(e.scid))).join(","))).join(";")}};function d(e){const t=new RegExp("^(audio|video)/(.+)","i").exec(e.mimeType);if(!t)throw new TypeError("invalid codec.mimeType");return t[2]}t.OfferMediaSection=class extends c{constructor(e){let{iceParameters:t,iceCandidates:r,dtlsParameters:n,sctpParameters:i,plainRtpParameters:a,planB:s=!1,mid:o,kind:c,offerRtpParameters:l,streamId:u,trackId:p,oldDataChannelSpec:h=!1}=e;switch(super({iceParameters:t,iceCandidates:r,dtlsParameters:n,planB:s}),this._mediaObject.mid=String(o),this._mediaObject.type=c,a?(this._mediaObject.connection={ip:a.ip,version:a.ipVersion},this._mediaObject.protocol="RTP/AVP",this._mediaObject.port=a.port):(this._mediaObject.connection={ip:"127.0.0.1",version:4},this._mediaObject.protocol=i?"UDP/DTLS/SCTP":"UDP/TLS/RTP/SAVPF",this._mediaObject.port=7),c){case"audio":case"video":{this._mediaObject.direction="sendonly",this._mediaObject.rtp=[],this._mediaObject.rtcpFb=[],this._mediaObject.fmtp=[],this._planB||(this._mediaObject.msid="".concat(u||"-"," ").concat(p));for(const n of l.codecs){const e={payload:n.payloadType,codec:d(n),rate:n.clockRate};n.channels>1&&(e.encoding=n.channels),this._mediaObject.rtp.push(e);const t={payload:n.payloadType,config:""};for(const r of Object.keys(n.parameters))t.config&&(t.config+=";"),t.config+="".concat(r,"=").concat(n.parameters[r]);t.config&&this._mediaObject.fmtp.push(t);for(const r of n.rtcpFeedback)this._mediaObject.rtcpFb.push({payload:n.payloadType,type:r.type,subtype:r.parameter})}this._mediaObject.payloads=l.codecs.map((e=>e.payloadType)).join(" "),this._mediaObject.ext=[];for(const n of l.headerExtensions)this._mediaObject.ext.push({uri:n.uri,value:n.id});this._mediaObject.rtcpMux="rtcp-mux",this._mediaObject.rtcpRsize="rtcp-rsize";const e=l.encodings[0],t=e.ssrc,r=e.rtx&&e.rtx.ssrc?e.rtx.ssrc:void 0;this._mediaObject.ssrcs=[],this._mediaObject.ssrcGroups=[],l.rtcp.cname&&this._mediaObject.ssrcs.push({id:t,attribute:"cname",value:l.rtcp.cname}),this._planB&&this._mediaObject.ssrcs.push({id:t,attribute:"msid",value:"".concat(u||"-"," ").concat(p)}),r&&(l.rtcp.cname&&this._mediaObject.ssrcs.push({id:r,attribute:"cname",value:l.rtcp.cname}),this._planB&&this._mediaObject.ssrcs.push({id:r,attribute:"msid",value:"".concat(u||"-"," ").concat(p)}),this._mediaObject.ssrcGroups.push({semantics:"FID",ssrcs:"".concat(t," ").concat(r)}));break}case"application":h?(this._mediaObject.payloads=i.port,this._mediaObject.sctpmap={app:"webrtc-datachannel",sctpmapNumber:i.port,maxMessageSize:i.maxMessageSize}):(this._mediaObject.payloads="webrtc-datachannel",this._mediaObject.sctpPort=i.port,this._mediaObject.maxMessageSize=i.maxMessageSize)}}setDtlsRole(e){this._mediaObject.setup="actpass"}resume(){this._mediaObject.direction="sendonly"}planBReceive(e){let{offerRtpParameters:t,streamId:r,trackId:n}=e;const i=t.encodings[0],a=i.ssrc,s=i.rtx&&i.rtx.ssrc?i.rtx.ssrc:void 0,o=this._mediaObject.payloads.split(" ");for(const c of t.codecs){if(o.includes(String(c.payloadType)))continue;const e={payload:c.payloadType,codec:d(c),rate:c.clockRate};c.channels>1&&(e.encoding=c.channels),this._mediaObject.rtp.push(e);const t={payload:c.payloadType,config:""};for(const r of Object.keys(c.parameters))t.config&&(t.config+=";"),t.config+="".concat(r,"=").concat(c.parameters[r]);t.config&&this._mediaObject.fmtp.push(t);for(const r of c.rtcpFeedback)this._mediaObject.rtcpFb.push({payload:c.payloadType,type:r.type,subtype:r.parameter})}this._mediaObject.payloads+=" ".concat(t.codecs.filter((e=>!this._mediaObject.payloads.includes(e.payloadType))).map((e=>e.payloadType)).join(" ")),this._mediaObject.payloads=this._mediaObject.payloads.trim(),t.rtcp.cname&&this._mediaObject.ssrcs.push({id:a,attribute:"cname",value:t.rtcp.cname}),this._mediaObject.ssrcs.push({id:a,attribute:"msid",value:"".concat(r||"-"," ").concat(n)}),s&&(t.rtcp.cname&&this._mediaObject.ssrcs.push({id:s,attribute:"cname",value:t.rtcp.cname}),this._mediaObject.ssrcs.push({id:s,attribute:"msid",value:"".concat(r||"-"," ").concat(n)}),this._mediaObject.ssrcGroups.push({semantics:"FID",ssrcs:"".concat(a," ").concat(s)}))}planBStopReceiving(e){let{offerRtpParameters:t}=e;const r=t.encodings[0],n=r.ssrc,i=r.rtx&&r.rtx.ssrc?r.rtx.ssrc:void 0;this._mediaObject.ssrcs=this._mediaObject.ssrcs.filter((e=>e.id!==n&&e.id!==i)),i&&(this._mediaObject.ssrcGroups=this._mediaObject.ssrcGroups.filter((e=>e.ssrcs!=="".concat(n," ").concat(i))))}}},992:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.RemoteSdp=void 0;const s=a(r(7181)),o=r(56),c=r(8952),d=new o.Logger("RemoteSdp");t.RemoteSdp=class{constructor(e){let{iceParameters:t,iceCandidates:r,dtlsParameters:n,sctpParameters:i,plainRtpParameters:a,planB:s=!1}=e;if(this._mediaSections=[],this._midToIndex=new Map,this._iceParameters=t,this._iceCandidates=r,this._dtlsParameters=n,this._sctpParameters=i,this._plainRtpParameters=a,this._planB=s,this._sdpObject={version:0,origin:{address:"0.0.0.0",ipVer:4,netType:"IN",sessionId:1e4,sessionVersion:0,username:"mediasoup-client"},name:"-",timing:{start:0,stop:0},media:[]},t&&t.iceLite&&(this._sdpObject.icelite="ice-lite"),n){this._sdpObject.msidSemantic={semantic:"WMS",token:"*"};const e=this._dtlsParameters.fingerprints.length;this._sdpObject.fingerprint={type:n.fingerprints[e-1].algorithm,hash:n.fingerprints[e-1].value},this._sdpObject.groups=[{type:"BUNDLE",mids:""}]}a&&(this._sdpObject.origin.address=a.ip,this._sdpObject.origin.ipVer=a.ipVersion)}updateIceParameters(e){d.debug("updateIceParameters() [iceParameters:%o]",e),this._iceParameters=e,this._sdpObject.icelite=e.iceLite?"ice-lite":void 0;for(const t of this._mediaSections)t.setIceParameters(e)}updateDtlsRole(e){d.debug("updateDtlsRole() [role:%s]",e),this._dtlsParameters.role=e;for(const t of this._mediaSections)t.setDtlsRole(e)}getNextMediaSectionIdx(){for(let e=0;e<this._mediaSections.length;++e){const t=this._mediaSections[e];if(t.closed)return{idx:e,reuseMid:t.mid}}return{idx:this._mediaSections.length}}send(e){let{offerMediaObject:t,reuseMid:r,offerRtpParameters:n,answerRtpParameters:i,codecOptions:a,extmapAllowMixed:s=!1}=e;const o=new c.AnswerMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,plainRtpParameters:this._plainRtpParameters,planB:this._planB,offerMediaObject:t,offerRtpParameters:n,answerRtpParameters:i,codecOptions:a,extmapAllowMixed:s});r?this._replaceMediaSection(o,r):this._midToIndex.has(o.mid)?this._replaceMediaSection(o):this._addMediaSection(o)}receive(e){let{mid:t,kind:r,offerRtpParameters:n,streamId:i,trackId:a}=e;const s=this._midToIndex.get(t);let o;if(void 0!==s&&(o=this._mediaSections[s]),o)o.planBReceive({offerRtpParameters:n,streamId:i,trackId:a}),this._replaceMediaSection(o);else{o=new c.OfferMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,plainRtpParameters:this._plainRtpParameters,planB:this._planB,mid:t,kind:r,offerRtpParameters:n,streamId:i,trackId:a});const e=this._mediaSections.find((e=>e.closed));e?this._replaceMediaSection(o,e.mid):this._addMediaSection(o)}}pauseMediaSection(e){this._findMediaSection(e).pause()}resumeSendingMediaSection(e){this._findMediaSection(e).resume()}resumeReceivingMediaSection(e){this._findMediaSection(e).resume()}disableMediaSection(e){this._findMediaSection(e).disable()}closeMediaSection(e){const t=this._findMediaSection(e);return e===this._firstMid?(d.debug("closeMediaSection() | cannot close first media section, disabling it instead [mid:%s]",e),this.disableMediaSection(e),!1):(t.close(),this._regenerateBundleMids(),!0)}muxMediaSectionSimulcast(e,t){const r=this._findMediaSection(e);r.muxSimulcastStreams(t),this._replaceMediaSection(r)}planBStopReceiving(e){let{mid:t,offerRtpParameters:r}=e;const n=this._findMediaSection(t);n.planBStopReceiving({offerRtpParameters:r}),this._replaceMediaSection(n)}sendSctpAssociation(e){let{offerMediaObject:t}=e;const r=new c.AnswerMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,sctpParameters:this._sctpParameters,plainRtpParameters:this._plainRtpParameters,offerMediaObject:t});this._addMediaSection(r)}receiveSctpAssociation(){let{oldDataChannelSpec:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=new c.OfferMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,sctpParameters:this._sctpParameters,plainRtpParameters:this._plainRtpParameters,mid:"datachannel",kind:"application",oldDataChannelSpec:e});this._addMediaSection(t)}getSdp(){return this._sdpObject.origin.sessionVersion++,s.write(this._sdpObject)}_addMediaSection(e){this._firstMid||(this._firstMid=e.mid),this._mediaSections.push(e),this._midToIndex.set(e.mid,this._mediaSections.length-1),this._sdpObject.media.push(e.getObject()),this._regenerateBundleMids()}_replaceMediaSection(e,t){if("string"===typeof t){const r=this._midToIndex.get(t);if(void 0===r)throw new Error("no media section found for reuseMid '".concat(t,"'"));const n=this._mediaSections[r];this._mediaSections[r]=e,this._midToIndex.delete(n.mid),this._midToIndex.set(e.mid,r),this._sdpObject.media[r]=e.getObject(),this._regenerateBundleMids()}else{const t=this._midToIndex.get(e.mid);if(void 0===t)throw new Error("no media section found with mid '".concat(e.mid,"'"));this._mediaSections[t]=e,this._sdpObject.media[t]=e.getObject()}}_findMediaSection(e){const t=this._midToIndex.get(e);if(void 0===t)throw new Error("no media section found with mid '".concat(e,"'"));return this._mediaSections[t]}_regenerateBundleMids(){this._dtlsParameters&&(this._sdpObject.groups[0].mids=this._mediaSections.filter((e=>!e.closed)).map((e=>e.mid)).join(" "))}}},6488:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.applyCodecParameters=t.getCname=t.extractDtlsParameters=t.extractRtpCapabilities=void 0;const s=a(r(7181));t.extractRtpCapabilities=function(e){let{sdpObject:t}=e;const r=new Map,n=[];let i=!1,a=!1;for(const o of t.media){const e=o.type;switch(e){case"audio":if(i)continue;i=!0;break;case"video":if(a)continue;a=!0;break;default:continue}for(const t of o.rtp){const n={kind:e,mimeType:"".concat(e,"/").concat(t.codec),preferredPayloadType:t.payload,clockRate:t.rate,channels:t.encoding,parameters:{},rtcpFeedback:[]};r.set(n.preferredPayloadType,n)}for(const t of o.fmtp||[]){const e=s.parseParams(t.config),n=r.get(t.payload);n&&(e&&e.hasOwnProperty("profile-level-id")&&(e["profile-level-id"]=String(e["profile-level-id"])),n.parameters=e)}for(const t of o.rtcpFb||[]){const n={type:t.type,parameter:t.subtype};if(n.parameter||delete n.parameter,"*"!==t.payload){const e=r.get(t.payload);if(!e)continue;e.rtcpFeedback.push(n)}else for(const t of r.values())t.kind!==e||/.+\/rtx$/i.test(t.mimeType)||t.rtcpFeedback.push(n)}for(const t of o.ext||[]){if(t["encrypt-uri"])continue;const r={kind:e,uri:t.uri,preferredId:t.value};n.push(r)}}return{codecs:Array.from(r.values()),headerExtensions:n}},t.extractDtlsParameters=function(e){let t,{sdpObject:r}=e,n=r.setup,i=r.fingerprint;if(!n||!i){const e=(r.media||[]).find((e=>0!==e.port));var a,s;if(e)null!==(a=n)&&void 0!==a||(n=e.setup),null!==(s=i)&&void 0!==s||(i=e.fingerprint)}if(!n)throw new Error("no a=setup found at SDP session or media level");if(!i)throw new Error("no a=fingerprint found at SDP session or media level");switch(n){case"active":t="client";break;case"passive":t="server";break;case"actpass":t="auto"}return{role:t,fingerprints:[{algorithm:i.type,value:i.hash}]}},t.getCname=function(e){let{offerMediaObject:t}=e;const r=(t.ssrcs||[]).find((e=>"cname"===e.attribute));return r?r.value:""},t.applyCodecParameters=function(e){let{offerRtpParameters:t,answerMediaObject:r}=e;for(const n of t.codecs){const e=n.mimeType.toLowerCase();if("audio/opus"!==e)continue;if(!(r.rtp||[]).find((e=>e.payload===n.payloadType)))continue;r.fmtp=r.fmtp||[];let t=r.fmtp.find((e=>e.payload===n.payloadType));t||(t={payload:n.payloadType,config:""},r.fmtp.push(t));const i=s.parseParams(t.config);switch(e){case"audio/opus":{const e=n.parameters["sprop-stereo"];void 0!==e&&(i.stereo=e?1:0);break}}t.config="";for(const r of Object.keys(i))t.config&&(t.config+=";"),t.config+="".concat(r,"=").concat(i[r])}}},752:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addLegacySimulcast=t.getRtpEncodings=void 0,t.getRtpEncodings=function(e){let t,{offerMediaObject:r,track:n}=e;const i=new Set;for(const o of r.ssrcs||[]){if("msid"!==o.attribute)continue;if(o.value.split(" ")[1]===n.id){const e=o.id;i.add(e),t||(t=e)}}if(0===i.size)throw new Error("a=ssrc line with msid information not found [track.id:".concat(n.id,"]"));const a=new Map;for(const o of r.ssrcGroups||[]){if("FID"!==o.semantics)continue;let[e,t]=o.ssrcs.split(/\s+/);e=Number(e),t=Number(t),i.has(e)&&(i.delete(e),i.delete(t),a.set(e,t))}for(const o of i)a.set(o,null);const s=[];for(const[o,c]of a){const e={ssrc:o};c&&(e.rtx={ssrc:c}),s.push(e)}return s},t.addLegacySimulcast=function(e){let t,r,n,{offerMediaObject:i,track:a,numStreams:s}=e;if(s<=1)throw new TypeError("numStreams must be greater than 1");if(!(i.ssrcs||[]).find((e=>{if("msid"!==e.attribute)return!1;return e.value.split(" ")[1]===a.id&&(t=e.id,n=e.value.split(" ")[0],!0)})))throw new Error("a=ssrc line with msid information not found [track.id:".concat(a.id,"]"));(i.ssrcGroups||[]).some((e=>{if("FID"!==e.semantics)return!1;const n=e.ssrcs.split(/\s+/);return Number(n[0])===t&&(r=Number(n[1]),!0)}));const o=i.ssrcs.find((e=>"cname"===e.attribute&&e.id===t));if(!o)throw new Error("a=ssrc line with cname information not found [track.id:".concat(a.id,"]"));const c=o.value,d=[],l=[];for(let u=0;u<s;++u)d.push(t+u),r&&l.push(r+u);i.ssrcGroups=i.ssrcGroups||[],i.ssrcs=i.ssrcs||[],i.ssrcGroups.push({semantics:"SIM",ssrcs:d.join(" ")});for(let u=0;u<d.length;++u){const e=d[u];i.ssrcs.push({id:e,attribute:"cname",value:c}),i.ssrcs.push({id:e,attribute:"msid",value:"".concat(n," ").concat(a.id)})}for(let u=0;u<l.length;++u){const e=d[u],t=l[u];i.ssrcs.push({id:t,attribute:"cname",value:c}),i.ssrcs.push({id:t,attribute:"msid",value:"".concat(n," ").concat(a.id)}),i.ssrcGroups.push({semantics:"FID",ssrcs:"".concat(e," ").concat(t)})}}},4888:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addLegacySimulcast=t.getRtpEncodings=void 0,t.getRtpEncodings=function(e){let{offerMediaObject:t}=e;const r=new Set;for(const a of t.ssrcs||[]){const e=a.id;r.add(e)}if(0===r.size)throw new Error("no a=ssrc lines found");const n=new Map;for(const a of t.ssrcGroups||[]){if("FID"!==a.semantics)continue;let[e,t]=a.ssrcs.split(/\s+/);e=Number(e),t=Number(t),r.has(e)&&(r.delete(e),r.delete(t),n.set(e,t))}for(const a of r)n.set(a,null);const i=[];for(const[a,s]of n){const e={ssrc:a};s&&(e.rtx={ssrc:s}),i.push(e)}return i},t.addLegacySimulcast=function(e){let{offerMediaObject:t,numStreams:r}=e;if(r<=1)throw new TypeError("numStreams must be greater than 1");const n=(t.ssrcs||[]).find((e=>"msid"===e.attribute));if(!n)throw new Error("a=ssrc line with msid information not found");const[i,a]=n.value.split(" "),s=n.id;let o;(t.ssrcGroups||[]).some((e=>{if("FID"!==e.semantics)return!1;const t=e.ssrcs.split(/\s+/);return Number(t[0])===s&&(o=Number(t[1]),!0)}));const c=t.ssrcs.find((e=>"cname"===e.attribute));if(!c)throw new Error("a=ssrc line with cname information not found");const d=c.value,l=[],u=[];for(let p=0;p<r;++p)l.push(s+p),o&&u.push(o+p);t.ssrcGroups=[],t.ssrcs=[],t.ssrcGroups.push({semantics:"SIM",ssrcs:l.join(" ")});for(let p=0;p<l.length;++p){const e=l[p];t.ssrcs.push({id:e,attribute:"cname",value:d}),t.ssrcs.push({id:e,attribute:"msid",value:"".concat(i," ").concat(a)})}for(let p=0;p<u.length;++p){const e=l[p],r=u[p];t.ssrcs.push({id:r,attribute:"cname",value:d}),t.ssrcs.push({id:r,attribute:"msid",value:"".concat(i," ").concat(a)}),t.ssrcGroups.push({semantics:"FID",ssrcs:"".concat(e," ").concat(r)})}}},9340:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.debug=t.parseScalabilityMode=t.detectDevice=t.Device=t.version=t.types=void 0;const o=s(r(5184));t.debug=o.default;const c=r(28);Object.defineProperty(t,"Device",{enumerable:!0,get:function(){return c.Device}}),Object.defineProperty(t,"detectDevice",{enumerable:!0,get:function(){return c.detectDevice}});const d=a(r(3384));t.types=d,t.version="3.6.100";var l=r(2308);Object.defineProperty(t,"parseScalabilityMode",{enumerable:!0,get:function(){return l.parse}})},9324:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.canReceive=t.canSend=t.generateProbatorRtpParameters=t.reduceCodecs=t.getSendingRemoteRtpParameters=t.getSendingRtpParameters=t.getRecvRtpCapabilities=t.getExtendedRtpCapabilities=t.validateSctpStreamParameters=t.validateSctpParameters=t.validateNumSctpStreams=t.validateSctpCapabilities=t.validateRtcpParameters=t.validateRtpEncodingParameters=t.validateRtpHeaderExtensionParameters=t.validateRtpCodecParameters=t.validateRtpParameters=t.validateRtpHeaderExtension=t.validateRtcpFeedback=t.validateRtpCodecCapability=t.validateRtpCapabilities=void 0;const s=a(r(8332)),o=a(r(6176));function c(e){const t=new RegExp("^(audio|video)/(.+)","i");if("object"!==typeof e)throw new TypeError("codec is not an object");if(!e.mimeType||"string"!==typeof e.mimeType)throw new TypeError("missing codec.mimeType");const r=t.exec(e.mimeType);if(!r)throw new TypeError("invalid codec.mimeType");if(e.kind=r[1].toLowerCase(),e.preferredPayloadType&&"number"!==typeof e.preferredPayloadType)throw new TypeError("invalid codec.preferredPayloadType");if("number"!==typeof e.clockRate)throw new TypeError("missing codec.clockRate");"audio"===e.kind?"number"!==typeof e.channels&&(e.channels=1):delete e.channels,e.parameters&&"object"===typeof e.parameters||(e.parameters={});for(const n of Object.keys(e.parameters)){let t=e.parameters[n];if(void 0===t&&(e.parameters[n]="",t=""),"string"!==typeof t&&"number"!==typeof t)throw new TypeError("invalid codec parameter [key:".concat(n,"s, value:").concat(t,"]"));if("apt"===n&&"number"!==typeof t)throw new TypeError("invalid codec apt parameter")}e.rtcpFeedback&&Array.isArray(e.rtcpFeedback)||(e.rtcpFeedback=[]);for(const n of e.rtcpFeedback)d(n)}function d(e){if("object"!==typeof e)throw new TypeError("fb is not an object");if(!e.type||"string"!==typeof e.type)throw new TypeError("missing fb.type");e.parameter&&"string"===typeof e.parameter||(e.parameter="")}function l(e){if("object"!==typeof e)throw new TypeError("ext is not an object");if("audio"!==e.kind&&"video"!==e.kind)throw new TypeError("invalid ext.kind");if(!e.uri||"string"!==typeof e.uri)throw new TypeError("missing ext.uri");if("number"!==typeof e.preferredId)throw new TypeError("missing ext.preferredId");if(e.preferredEncrypt&&"boolean"!==typeof e.preferredEncrypt)throw new TypeError("invalid ext.preferredEncrypt");if(e.preferredEncrypt||(e.preferredEncrypt=!1),e.direction&&"string"!==typeof e.direction)throw new TypeError("invalid ext.direction");e.direction||(e.direction="sendrecv")}function u(e){if("object"!==typeof e)throw new TypeError("params is not an object");if(e.mid&&"string"!==typeof e.mid)throw new TypeError("params.mid is not a string");if(!Array.isArray(e.codecs))throw new TypeError("missing params.codecs");for(const t of e.codecs)p(t);if(e.headerExtensions&&!Array.isArray(e.headerExtensions))throw new TypeError("params.headerExtensions is not an array");e.headerExtensions||(e.headerExtensions=[]);for(const t of e.headerExtensions)h(t);if(e.encodings&&!Array.isArray(e.encodings))throw new TypeError("params.encodings is not an array");e.encodings||(e.encodings=[]);for(const t of e.encodings)f(t);if(e.rtcp&&"object"!==typeof e.rtcp)throw new TypeError("params.rtcp is not an object");e.rtcp||(e.rtcp={}),m(e.rtcp)}function p(e){const t=new RegExp("^(audio|video)/(.+)","i");if("object"!==typeof e)throw new TypeError("codec is not an object");if(!e.mimeType||"string"!==typeof e.mimeType)throw new TypeError("missing codec.mimeType");const r=t.exec(e.mimeType);if(!r)throw new TypeError("invalid codec.mimeType");if("number"!==typeof e.payloadType)throw new TypeError("missing codec.payloadType");if("number"!==typeof e.clockRate)throw new TypeError("missing codec.clockRate");"audio"===r[1].toLowerCase()?"number"!==typeof e.channels&&(e.channels=1):delete e.channels,e.parameters&&"object"===typeof e.parameters||(e.parameters={});for(const n of Object.keys(e.parameters)){let t=e.parameters[n];if(void 0===t&&(e.parameters[n]="",t=""),"string"!==typeof t&&"number"!==typeof t)throw new TypeError("invalid codec parameter [key:".concat(n,"s, value:").concat(t,"]"));if("apt"===n&&"number"!==typeof t)throw new TypeError("invalid codec apt parameter")}e.rtcpFeedback&&Array.isArray(e.rtcpFeedback)||(e.rtcpFeedback=[]);for(const n of e.rtcpFeedback)d(n)}function h(e){if("object"!==typeof e)throw new TypeError("ext is not an object");if(!e.uri||"string"!==typeof e.uri)throw new TypeError("missing ext.uri");if("number"!==typeof e.id)throw new TypeError("missing ext.id");if(e.encrypt&&"boolean"!==typeof e.encrypt)throw new TypeError("invalid ext.encrypt");e.encrypt||(e.encrypt=!1),e.parameters&&"object"===typeof e.parameters||(e.parameters={});for(const t of Object.keys(e.parameters)){let r=e.parameters[t];if(void 0===r&&(e.parameters[t]="",r=""),"string"!==typeof r&&"number"!==typeof r)throw new TypeError("invalid header extension parameter")}}function f(e){if("object"!==typeof e)throw new TypeError("encoding is not an object");if(e.ssrc&&"number"!==typeof e.ssrc)throw new TypeError("invalid encoding.ssrc");if(e.rid&&"string"!==typeof e.rid)throw new TypeError("invalid encoding.rid");if(e.rtx&&"object"!==typeof e.rtx)throw new TypeError("invalid encoding.rtx");if(e.rtx&&"number"!==typeof e.rtx.ssrc)throw new TypeError("missing encoding.rtx.ssrc");if(e.dtx&&"boolean"===typeof e.dtx||(e.dtx=!1),e.scalabilityMode&&"string"!==typeof e.scalabilityMode)throw new TypeError("invalid encoding.scalabilityMode")}function m(e){if("object"!==typeof e)throw new TypeError("rtcp is not an object");if(e.cname&&"string"!==typeof e.cname)throw new TypeError("invalid rtcp.cname");e.reducedSize&&"boolean"===typeof e.reducedSize||(e.reducedSize=!0)}function g(e){if("object"!==typeof e)throw new TypeError("numStreams is not an object");if("number"!==typeof e.OS)throw new TypeError("missing numStreams.OS");if("number"!==typeof e.MIS)throw new TypeError("missing numStreams.MIS")}function v(e){return!!e&&/.+\/rtx$/i.test(e.mimeType)}function y(e,t){let{strict:r=!1,modify:n=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=e.mimeType.toLowerCase();if(i!==t.mimeType.toLowerCase())return!1;if(e.clockRate!==t.clockRate)return!1;if(e.channels!==t.channels)return!1;switch(i){case"video/h264":if(r){if((e.parameters["packetization-mode"]||0)!==(t.parameters["packetization-mode"]||0))return!1;if(!s.isSameProfile(e.parameters,t.parameters))return!1;let r;try{r=s.generateProfileLevelIdForAnswer(e.parameters,t.parameters)}catch(a){return!1}n&&(r?(e.parameters["profile-level-id"]=r,t.parameters["profile-level-id"]=r):(delete e.parameters["profile-level-id"],delete t.parameters["profile-level-id"]))}break;case"video/vp9":if(r){if((e.parameters["profile-id"]||0)!==(t.parameters["profile-id"]||0))return!1}}return!0}function b(e,t){return(!e.kind||!t.kind||e.kind===t.kind)&&e.uri===t.uri}function _(e,t){const r=[];for(const n of e.rtcpFeedback||[]){const e=(t.rtcpFeedback||[]).find((e=>e.type===n.type&&(e.parameter===n.parameter||!e.parameter&&!n.parameter)));e&&r.push(e)}return r}t.validateRtpCapabilities=function(e){if("object"!==typeof e)throw new TypeError("caps is not an object");if(e.codecs&&!Array.isArray(e.codecs))throw new TypeError("caps.codecs is not an array");e.codecs||(e.codecs=[]);for(const t of e.codecs)c(t);if(e.headerExtensions&&!Array.isArray(e.headerExtensions))throw new TypeError("caps.headerExtensions is not an array");e.headerExtensions||(e.headerExtensions=[]);for(const t of e.headerExtensions)l(t)},t.validateRtpCodecCapability=c,t.validateRtcpFeedback=d,t.validateRtpHeaderExtension=l,t.validateRtpParameters=u,t.validateRtpCodecParameters=p,t.validateRtpHeaderExtensionParameters=h,t.validateRtpEncodingParameters=f,t.validateRtcpParameters=m,t.validateSctpCapabilities=function(e){if("object"!==typeof e)throw new TypeError("caps is not an object");if(!e.numStreams||"object"!==typeof e.numStreams)throw new TypeError("missing caps.numStreams");g(e.numStreams)},t.validateNumSctpStreams=g,t.validateSctpParameters=function(e){if("object"!==typeof e)throw new TypeError("params is not an object");if("number"!==typeof e.port)throw new TypeError("missing params.port");if("number"!==typeof e.OS)throw new TypeError("missing params.OS");if("number"!==typeof e.MIS)throw new TypeError("missing params.MIS");if("number"!==typeof e.maxMessageSize)throw new TypeError("missing params.maxMessageSize")},t.validateSctpStreamParameters=function(e){if("object"!==typeof e)throw new TypeError("params is not an object");if("number"!==typeof e.streamId)throw new TypeError("missing params.streamId");let t=!1;if("boolean"===typeof e.ordered?t=!0:e.ordered=!0,e.maxPacketLifeTime&&"number"!==typeof e.maxPacketLifeTime)throw new TypeError("invalid params.maxPacketLifeTime");if(e.maxRetransmits&&"number"!==typeof e.maxRetransmits)throw new TypeError("invalid params.maxRetransmits");if(e.maxPacketLifeTime&&e.maxRetransmits)throw new TypeError("cannot provide both maxPacketLifeTime and maxRetransmits");if(t&&e.ordered&&(e.maxPacketLifeTime||e.maxRetransmits))throw new TypeError("cannot be ordered with maxPacketLifeTime or maxRetransmits");if(t||!e.maxPacketLifeTime&&!e.maxRetransmits||(e.ordered=!1),e.label&&"string"!==typeof e.label)throw new TypeError("invalid params.label");if(e.protocol&&"string"!==typeof e.protocol)throw new TypeError("invalid params.protocol")},t.getExtendedRtpCapabilities=function(e,t){const r={codecs:[],headerExtensions:[]};for(const n of t.codecs||[]){if(v(n))continue;const t=(e.codecs||[]).find((e=>y(e,n,{strict:!0,modify:!0})));if(!t)continue;const i={mimeType:t.mimeType,kind:t.kind,clockRate:t.clockRate,channels:t.channels,localPayloadType:t.preferredPayloadType,localRtxPayloadType:void 0,remotePayloadType:n.preferredPayloadType,remoteRtxPayloadType:void 0,localParameters:t.parameters,remoteParameters:n.parameters,rtcpFeedback:_(t,n)};r.codecs.push(i)}for(const n of r.codecs){const r=e.codecs.find((e=>v(e)&&e.parameters.apt===n.localPayloadType)),i=t.codecs.find((e=>v(e)&&e.parameters.apt===n.remotePayloadType));r&&i&&(n.localRtxPayloadType=r.preferredPayloadType,n.remoteRtxPayloadType=i.preferredPayloadType)}for(const n of t.headerExtensions){const t=e.headerExtensions.find((e=>b(e,n)));if(!t)continue;const i={kind:n.kind,uri:n.uri,sendId:t.preferredId,recvId:n.preferredId,encrypt:t.preferredEncrypt,direction:"sendrecv"};switch(n.direction){case"sendrecv":i.direction="sendrecv";break;case"recvonly":i.direction="sendonly";break;case"sendonly":i.direction="recvonly";break;case"inactive":i.direction="inactive"}r.headerExtensions.push(i)}return r},t.getRecvRtpCapabilities=function(e){const t={codecs:[],headerExtensions:[]};for(const r of e.codecs){const e={mimeType:r.mimeType,kind:r.kind,preferredPayloadType:r.remotePayloadType,clockRate:r.clockRate,channels:r.channels,parameters:r.localParameters,rtcpFeedback:r.rtcpFeedback};if(t.codecs.push(e),!r.remoteRtxPayloadType)continue;const n={mimeType:"".concat(r.kind,"/rtx"),kind:r.kind,preferredPayloadType:r.remoteRtxPayloadType,clockRate:r.clockRate,parameters:{apt:r.remotePayloadType},rtcpFeedback:[]};t.codecs.push(n)}for(const r of e.headerExtensions){if("sendrecv"!==r.direction&&"recvonly"!==r.direction)continue;const e={kind:r.kind,uri:r.uri,preferredId:r.recvId,preferredEncrypt:r.encrypt,direction:r.direction};t.headerExtensions.push(e)}return t},t.getSendingRtpParameters=function(e,t){const r={mid:void 0,codecs:[],headerExtensions:[],encodings:[],rtcp:{}};for(const n of t.codecs){if(n.kind!==e)continue;const t={mimeType:n.mimeType,payloadType:n.localPayloadType,clockRate:n.clockRate,channels:n.channels,parameters:n.localParameters,rtcpFeedback:n.rtcpFeedback};if(r.codecs.push(t),n.localRtxPayloadType){const e={mimeType:"".concat(n.kind,"/rtx"),payloadType:n.localRtxPayloadType,clockRate:n.clockRate,parameters:{apt:n.localPayloadType},rtcpFeedback:[]};r.codecs.push(e)}}for(const n of t.headerExtensions){if(n.kind&&n.kind!==e||"sendrecv"!==n.direction&&"sendonly"!==n.direction)continue;const t={uri:n.uri,id:n.sendId,encrypt:n.encrypt,parameters:{}};r.headerExtensions.push(t)}return r},t.getSendingRemoteRtpParameters=function(e,t){const r={mid:void 0,codecs:[],headerExtensions:[],encodings:[],rtcp:{}};for(const n of t.codecs){if(n.kind!==e)continue;const t={mimeType:n.mimeType,payloadType:n.localPayloadType,clockRate:n.clockRate,channels:n.channels,parameters:n.remoteParameters,rtcpFeedback:n.rtcpFeedback};if(r.codecs.push(t),n.localRtxPayloadType){const e={mimeType:"".concat(n.kind,"/rtx"),payloadType:n.localRtxPayloadType,clockRate:n.clockRate,parameters:{apt:n.localPayloadType},rtcpFeedback:[]};r.codecs.push(e)}}for(const n of t.headerExtensions){if(n.kind&&n.kind!==e||"sendrecv"!==n.direction&&"sendonly"!==n.direction)continue;const t={uri:n.uri,id:n.sendId,encrypt:n.encrypt,parameters:{}};r.headerExtensions.push(t)}if(r.headerExtensions.some((e=>"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"===e.uri)))for(const n of r.codecs)n.rtcpFeedback=(n.rtcpFeedback||[]).filter((e=>"goog-remb"!==e.type));else if(r.headerExtensions.some((e=>"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"===e.uri)))for(const n of r.codecs)n.rtcpFeedback=(n.rtcpFeedback||[]).filter((e=>"transport-cc"!==e.type));else for(const n of r.codecs)n.rtcpFeedback=(n.rtcpFeedback||[]).filter((e=>"transport-cc"!==e.type&&"goog-remb"!==e.type));return r},t.reduceCodecs=function(e,t){const r=[];if(t){for(let n=0;n<e.length;++n)if(y(e[n],t)){r.push(e[n]),v(e[n+1])&&r.push(e[n+1]);break}if(0===r.length)throw new TypeError("no matching codec found")}else r.push(e[0]),v(e[1])&&r.push(e[1]);return r},t.generateProbatorRtpParameters=function(e){u(e=o.clone(e,{}));const t={mid:"probator",codecs:[],headerExtensions:[],encodings:[{ssrc:1234}],rtcp:{cname:"probator"}};return t.codecs.push(e.codecs[0]),t.codecs[0].payloadType=127,t.headerExtensions=e.headerExtensions,t},t.canSend=function(e,t){return t.codecs.some((t=>t.kind===e))},t.canReceive=function(e,t){if(u(e),0===e.codecs.length)return!1;const r=e.codecs[0];return t.codecs.some((e=>e.remotePayloadType===r.payloadType))}},2308:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parse=void 0;const r=new RegExp("^[LS]([1-9]\\d{0,1})T([1-9]\\d{0,1})");t.parse=function(e){const t=r.exec(e||"");return t?{spatialLayers:Number(t[1]),temporalLayers:Number(t[2])}:{spatialLayers:1,temporalLayers:1}}},3384:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(28),t),i(r(5612),t),i(r(9888),t),i(r(8288),t),i(r(9624),t),i(r(2352),t),i(r(3200),t),i(r(3575),t),i(r(2356),t),i(r(3288),t)},6176:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateRandomNumber=t.clone=void 0,t.clone=function(e,t){return"undefined"===typeof e?t:JSON.parse(JSON.stringify(e))},t.generateRandomNumber=function(){return Math.round(1e7*Math.random())}},2596:e=>{var t=1e3,r=60*t,n=60*r,i=24*n,a=7*i,s=365.25*i;function o(e,t,r,n){var i=t>=1.5*r;return Math.round(e/r)+" "+n+(i?"s":"")}e.exports=function(e,c){c=c||{};var d=typeof e;if("string"===d&&e.length>0)return function(e){if((e=String(e)).length>100)return;var o=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!o)return;var c=parseFloat(o[1]);switch((o[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return c*s;case"weeks":case"week":case"w":return c*a;case"days":case"day":case"d":return c*i;case"hours":case"hour":case"hrs":case"hr":case"h":return c*n;case"minutes":case"minute":case"mins":case"min":case"m":return c*r;case"seconds":case"second":case"secs":case"sec":case"s":return c*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}(e);if("number"===d&&isFinite(e))return c.long?function(e){var a=Math.abs(e);if(a>=i)return o(e,a,i,"day");if(a>=n)return o(e,a,n,"hour");if(a>=r)return o(e,a,r,"minute");if(a>=t)return o(e,a,t,"second");return e+" ms"}(e):function(e){var a=Math.abs(e);if(a>=i)return Math.round(e/i)+"d";if(a>=n)return Math.round(e/n)+"h";if(a>=r)return Math.round(e/r)+"m";if(a>=t)return Math.round(e/t)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},7376:(e,t,r)=>{let n;e.exports="function"===typeof queueMicrotask?queueMicrotask.bind("undefined"!==typeof window?window:r.g):e=>(n||(n=Promise.resolve())).then(e).catch((e=>setTimeout((()=>{throw e}),0)))},6144:(e,t,r)=>{"use strict";var n=r(9060),i=r(7724);function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,o={};function c(e,t){d(e,t),d(e+"Capture",t)}function d(e,t){for(o[e]=t,e=0;e<t.length;e++)s.add(t[e])}var l=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),u=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},f={};function m(e,t,r,n,i,a,s){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=s}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new m(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new m(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new m(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new m(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new m(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)}));var v=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,r,n){var i=g.hasOwnProperty(t)?g[t]:null;(null!==i?0!==i.type:n||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,r,n){if(null===t||"undefined"===typeof t||function(e,t,r,n){if(null!==r&&0===r.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!n&&(null!==r?!r.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,r,n))return!0;if(n)return!1;if(null!==r)switch(r.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,r,i,n)&&(r=null),n||null===i?function(e){return!!u.call(f,e)||!u.call(h,e)&&(p.test(e)?f[e]=!0:(h[e]=!0,!1))}(t)&&(null===r?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=null===r?3!==i.type&&"":r:(t=i.attributeName,n=i.attributeNamespace,null===r?e.removeAttribute(t):(r=3===(i=i.type)||4===i&&!0===r?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)}));var _=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),S=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),R=Symbol.for("react.profiler"),T=Symbol.for("react.provider"),P=Symbol.for("react.context"),E=Symbol.for("react.forward_ref"),D=Symbol.for("react.suspense"),O=Symbol.for("react.suspense_list"),x=Symbol.for("react.memo"),I=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var M=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var L=Symbol.iterator;function j(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=L&&e[L]||e["@@iterator"])?e:null}var A,N=Object.assign;function F(e){if(void 0===A)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);A=t&&t[1]||""}return"\n"+A+e}var z=!1;function B(e,t){if(!e||z)return"";z=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var n=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){n=d}e.call(t.prototype)}else{try{throw Error()}catch(d){n=d}e()}}catch(d){if(d&&n&&"string"===typeof d.stack){for(var i=d.stack.split("\n"),a=n.stack.split("\n"),s=i.length-1,o=a.length-1;1<=s&&0<=o&&i[s]!==a[o];)o--;for(;1<=s&&0<=o;s--,o--)if(i[s]!==a[o]){if(1!==s||1!==o)do{if(s--,0>--o||i[s]!==a[o]){var c="\n"+i[s].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}}while(1<=s&&0<=o);break}}}finally{z=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?F(e):""}function U(e){switch(e.tag){case 5:return F(e.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return e=B(e.type,!1);case 11:return e=B(e.type.render,!1);case 1:return e=B(e.type,!0);default:return""}}function V(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case C:return"Fragment";case S:return"Portal";case R:return"Profiler";case k:return"StrictMode";case D:return"Suspense";case O:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case P:return(e.displayName||"Context")+".Consumer";case T:return(e._context.displayName||"Context")+".Provider";case E:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case x:return null!==(t=e.displayName||null)?t:V(e.type)||"Memo";case I:t=e._payload,e=e._init;try{return V(e(t))}catch(r){}}return null}function q(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return V(t);case 8:return t===k?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function W(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function H(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function G(e){e._valueTracker||(e._valueTracker=function(e){var t=H(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof r&&"function"===typeof r.get&&"function"===typeof r.set){var i=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){n=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function K(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=H(e)?e.checked?"true":"false":e.value),(e=n)!==r&&(t.setValue(e),!0)}function J(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function $(e,t){var r=t.checked;return N({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=r?r:e._wrapperState.initialChecked})}function Q(e,t){var r=null==t.defaultValue?"":t.defaultValue,n=null!=t.checked?t.checked:t.defaultChecked;r=W(null!=t.value?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function X(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function Y(e,t){X(e,t);var r=W(t.value),n=t.type;if(null!=r)"number"===n?(0===r&&""===e.value||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if("submit"===n||"reset"===n)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,r):t.hasOwnProperty("defaultValue")&&ee(e,t.type,W(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!("submit"!==n&&"reset"!==n||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}""!==(r=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==r&&(e.name=r)}function ee(e,t,r){"number"===t&&J(e.ownerDocument)===e||(null==r?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var te=Array.isArray;function re(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+W(r),t=null,i=0;i<e.length;i++){if(e[i].value===r)return e[i].selected=!0,void(n&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function ne(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(a(91));return N({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var r=t.value;if(null==r){if(r=t.children,t=t.defaultValue,null!=r){if(null!=t)throw Error(a(92));if(te(r)){if(1<r.length)throw Error(a(93));r=r[0]}t=r}null==t&&(t=""),r=t}e._wrapperState={initialValue:W(r)}}function ae(e,t){var r=W(t.value),n=W(t.defaultValue);null!=r&&((r=""+r)!==e.value&&(e.value=r),null==t.defaultValue&&e.defaultValue!==r&&(e.defaultValue=r)),null!=n&&(e.defaultValue=""+n)}function se(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ce(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var de,le,ue=(le=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((de=de||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=de.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,r,n){MSApp.execUnsafeLocalFunction((function(){return le(e,t)}))}:le);function pe(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&3===r.nodeType)return void(r.nodeValue=t)}e.textContent=t}var he={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fe=["Webkit","ms","Moz","O"];function me(e,t,r){return null==t||"boolean"===typeof t||""===t?"":r||"number"!==typeof t||0===t||he.hasOwnProperty(e)&&he[e]?(""+t).trim():t+"px"}function ge(e,t){for(var r in e=e.style,t)if(t.hasOwnProperty(r)){var n=0===r.indexOf("--"),i=me(r,t[r],n);"float"===r&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}Object.keys(he).forEach((function(e){fe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),he[t]=he[e]}))}));var ve=N({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(a(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(a(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(a(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(a(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var _e=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Se=null,Ce=null,ke=null;function Re(e){if(e=bi(e)){if("function"!==typeof Se)throw Error(a(280));var t=e.stateNode;t&&(t=wi(t),Se(e.stateNode,e.type,t))}}function Te(e){Ce?ke?ke.push(e):ke=[e]:Ce=e}function Pe(){if(Ce){var e=Ce,t=ke;if(ke=Ce=null,Re(e),t)for(e=0;e<t.length;e++)Re(t[e])}}function Ee(e,t){return e(t)}function De(){}var Oe=!1;function xe(e,t,r){if(Oe)return e(t,r);Oe=!0;try{return Ee(e,t,r)}finally{Oe=!1,(null!==Ce||null!==ke)&&(De(),Pe())}}function Ie(e,t){var r=e.stateNode;if(null===r)return null;var n=wi(r);if(null===n)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!n;break e;default:e=!1}if(e)return null;if(r&&"function"!==typeof r)throw Error(a(231,t,typeof r));return r}var Me=!1;if(l)try{var Le={};Object.defineProperty(Le,"passive",{get:function(){Me=!0}}),window.addEventListener("test",Le,Le),window.removeEventListener("test",Le,Le)}catch(le){Me=!1}function je(e,t,r,n,i,a,s,o,c){var d=Array.prototype.slice.call(arguments,3);try{t.apply(r,d)}catch(l){this.onError(l)}}var Ae=!1,Ne=null,Fe=!1,ze=null,Be={onError:function(e){Ae=!0,Ne=e}};function Ue(e,t,r,n,i,a,s,o,c){Ae=!1,Ne=null,je.apply(Be,arguments)}function Ve(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(r=t.return),e=t.return}while(e)}return 3===t.tag?r:null}function qe(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function We(e){if(Ve(e)!==e)throw Error(a(188))}function He(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ve(e)))throw Error(a(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(null===i)break;var s=i.alternate;if(null===s){if(null!==(n=i.return)){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return We(i),e;if(s===n)return We(i),t;s=s.sibling}throw Error(a(188))}if(r.return!==n.return)r=i,n=s;else{for(var o=!1,c=i.child;c;){if(c===r){o=!0,r=i,n=s;break}if(c===n){o=!0,n=i,r=s;break}c=c.sibling}if(!o){for(c=s.child;c;){if(c===r){o=!0,r=s,n=i;break}if(c===n){o=!0,n=s,r=i;break}c=c.sibling}if(!o)throw Error(a(189))}}if(r.alternate!==n)throw Error(a(190))}if(3!==r.tag)throw Error(a(188));return r.stateNode.current===r?e:t}(e))?Ge(e):null}function Ge(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ge(e);if(null!==t)return t;e=e.sibling}return null}var Ke=i.unstable_scheduleCallback,Je=i.unstable_cancelCallback,$e=i.unstable_shouldYield,Qe=i.unstable_requestPaint,Xe=i.unstable_now,Ye=i.unstable_getCurrentPriorityLevel,Ze=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,rt=i.unstable_LowPriority,nt=i.unstable_IdlePriority,it=null,at=null;var st=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ot(e)/ct|0)|0},ot=Math.log,ct=Math.LN2;var dt=64,lt=4194304;function ut(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function pt(e,t){var r=e.pendingLanes;if(0===r)return 0;var n=0,i=e.suspendedLanes,a=e.pingedLanes,s=268435455&r;if(0!==s){var o=s&~i;0!==o?n=ut(o):0!==(a&=s)&&(n=ut(a))}else 0!==(s=r&~i)?n=ut(s):0!==a&&(n=ut(a));if(0===n)return 0;if(0!==t&&t!==n&&0===(t&i)&&((i=n&-n)>=(a=t&-t)||16===i&&0!==(4194240&a)))return t;if(0!==(4&n)&&(n|=16&r),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=n;0<t;)i=1<<(r=31-st(t)),n|=e[r],t&=~i;return n}function ht(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ft(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=dt;return 0===(4194240&(dt<<=1))&&(dt=64),e}function gt(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function vt(e,t,r){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-st(t)]=r}function yt(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-st(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var bt=0;function _t(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,St,Ct,kt,Rt,Tt=!1,Pt=[],Et=null,Dt=null,Ot=null,xt=new Map,It=new Map,Mt=[],Lt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function jt(e,t){switch(e){case"focusin":case"focusout":Et=null;break;case"dragenter":case"dragleave":Dt=null;break;case"mouseover":case"mouseout":Ot=null;break;case"pointerover":case"pointerout":xt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":It.delete(t.pointerId)}}function At(e,t,r,n,i,a){return null===e||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[i]},null!==t&&(null!==(t=bi(t))&&St(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Nt(e){var t=yi(e.target);if(null!==t){var r=Ve(t);if(null!==r)if(13===(t=r.tag)){if(null!==(t=qe(r)))return e.blockedOn=t,void Rt(e.priority,(function(){Ct(r)}))}else if(3===t&&r.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===r.tag?r.stateNode.containerInfo:null)}e.blockedOn=null}function Ft(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var r=$t(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==r)return null!==(t=bi(r))&&St(t),e.blockedOn=r,!1;var n=new(r=e.nativeEvent).constructor(r.type,r);_e=n,r.target.dispatchEvent(n),_e=null,t.shift()}return!0}function zt(e,t,r){Ft(e)&&r.delete(t)}function Bt(){Tt=!1,null!==Et&&Ft(Et)&&(Et=null),null!==Dt&&Ft(Dt)&&(Dt=null),null!==Ot&&Ft(Ot)&&(Ot=null),xt.forEach(zt),It.forEach(zt)}function Ut(e,t){e.blockedOn===t&&(e.blockedOn=null,Tt||(Tt=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Bt)))}function Vt(e){function t(t){return Ut(t,e)}if(0<Pt.length){Ut(Pt[0],e);for(var r=1;r<Pt.length;r++){var n=Pt[r];n.blockedOn===e&&(n.blockedOn=null)}}for(null!==Et&&Ut(Et,e),null!==Dt&&Ut(Dt,e),null!==Ot&&Ut(Ot,e),xt.forEach(t),It.forEach(t),r=0;r<Mt.length;r++)(n=Mt[r]).blockedOn===e&&(n.blockedOn=null);for(;0<Mt.length&&null===(r=Mt[0]).blockedOn;)Nt(r),null===r.blockedOn&&Mt.shift()}var qt=_.ReactCurrentBatchConfig,Wt=!0;function Ht(e,t,r,n){var i=bt,a=qt.transition;qt.transition=null;try{bt=1,Kt(e,t,r,n)}finally{bt=i,qt.transition=a}}function Gt(e,t,r,n){var i=bt,a=qt.transition;qt.transition=null;try{bt=4,Kt(e,t,r,n)}finally{bt=i,qt.transition=a}}function Kt(e,t,r,n){if(Wt){var i=$t(e,t,r,n);if(null===i)Wn(e,t,n,Jt,r),jt(e,n);else if(function(e,t,r,n,i){switch(t){case"focusin":return Et=At(Et,e,t,r,n,i),!0;case"dragenter":return Dt=At(Dt,e,t,r,n,i),!0;case"mouseover":return Ot=At(Ot,e,t,r,n,i),!0;case"pointerover":var a=i.pointerId;return xt.set(a,At(xt.get(a)||null,e,t,r,n,i)),!0;case"gotpointercapture":return a=i.pointerId,It.set(a,At(It.get(a)||null,e,t,r,n,i)),!0}return!1}(i,e,t,r,n))n.stopPropagation();else if(jt(e,n),4&t&&-1<Lt.indexOf(e)){for(;null!==i;){var a=bi(i);if(null!==a&&wt(a),null===(a=$t(e,t,r,n))&&Wn(e,t,n,Jt,r),a===i)break;i=a}null!==i&&n.stopPropagation()}else Wn(e,t,n,null,r)}}var Jt=null;function $t(e,t,r,n){if(Jt=null,null!==(e=yi(e=we(n))))if(null===(t=Ve(e)))e=null;else if(13===(r=t.tag)){if(null!==(e=qe(t)))return e;e=null}else if(3===r){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Jt=e,null}function Qt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ye()){case Ze:return 1;case et:return 4;case tt:case rt:return 16;case nt:return 536870912;default:return 16}default:return 16}}var Xt=null,Yt=null,Zt=null;function er(){if(Zt)return Zt;var e,t,r=Yt,n=r.length,i="value"in Xt?Xt.value:Xt.textContent,a=i.length;for(e=0;e<n&&r[e]===i[e];e++);var s=n-e;for(t=1;t<=s&&r[n-t]===i[a-t];t++);return Zt=i.slice(e,1<t?1-t:void 0)}function tr(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function rr(){return!0}function nr(){return!1}function ir(e){function t(t,r,n,i,a){for(var s in this._reactName=t,this._targetInst=n,this.type=r,this.nativeEvent=i,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(i):i[s]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?rr:nr,this.isPropagationStopped=nr,this}return N(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=rr)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=rr)},persist:function(){},isPersistent:rr}),t}var ar,sr,or,cr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},dr=ir(cr),lr=N({},cr,{view:0,detail:0}),ur=ir(lr),pr=N({},lr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:kr,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==or&&(or&&"mousemove"===e.type?(ar=e.screenX-or.screenX,sr=e.screenY-or.screenY):sr=ar=0,or=e),ar)},movementY:function(e){return"movementY"in e?e.movementY:sr}}),hr=ir(pr),fr=ir(N({},pr,{dataTransfer:0})),mr=ir(N({},lr,{relatedTarget:0})),gr=ir(N({},cr,{animationName:0,elapsedTime:0,pseudoElement:0})),vr=N({},cr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),yr=ir(vr),br=ir(N({},cr,{data:0})),_r={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Sr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Cr(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Sr[e])&&!!t[e]}function kr(){return Cr}var Rr=N({},lr,{key:function(e){if(e.key){var t=_r[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tr(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?wr[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:kr,charCode:function(e){return"keypress"===e.type?tr(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tr(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Tr=ir(Rr),Pr=ir(N({},pr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Er=ir(N({},lr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:kr})),Dr=ir(N({},cr,{propertyName:0,elapsedTime:0,pseudoElement:0})),Or=N({},pr,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),xr=ir(Or),Ir=[9,13,27,32],Mr=l&&"CompositionEvent"in window,Lr=null;l&&"documentMode"in document&&(Lr=document.documentMode);var jr=l&&"TextEvent"in window&&!Lr,Ar=l&&(!Mr||Lr&&8<Lr&&11>=Lr),Nr=String.fromCharCode(32),Fr=!1;function zr(e,t){switch(e){case"keyup":return-1!==Ir.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Br(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Ur=!1;var Vr={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Vr[e.type]:"textarea"===t}function Wr(e,t,r,n){Te(n),0<(t=Gn(t,"onChange")).length&&(r=new dr("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Hr=null,Gr=null;function Kr(e){Fn(e,0)}function Jr(e){if(K(_i(e)))return e}function $r(e,t){if("change"===e)return t}var Qr=!1;if(l){var Xr;if(l){var Yr="oninput"in document;if(!Yr){var Zr=document.createElement("div");Zr.setAttribute("oninput","return;"),Yr="function"===typeof Zr.oninput}Xr=Yr}else Xr=!1;Qr=Xr&&(!document.documentMode||9<document.documentMode)}function en(){Hr&&(Hr.detachEvent("onpropertychange",tn),Gr=Hr=null)}function tn(e){if("value"===e.propertyName&&Jr(Gr)){var t=[];Wr(t,Gr,e,we(e)),xe(Kr,t)}}function rn(e,t,r){"focusin"===e?(en(),Gr=r,(Hr=t).attachEvent("onpropertychange",tn)):"focusout"===e&&en()}function nn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Jr(Gr)}function an(e,t){if("click"===e)return Jr(t)}function sn(e,t){if("input"===e||"change"===e)return Jr(t)}var on="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function cn(e,t){if(on(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!u.call(t,i)||!on(e[i],t[i]))return!1}return!0}function dn(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ln(e,t){var r,n=dn(e);for(e=0;n;){if(3===n.nodeType){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=dn(n)}}function un(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?un(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function pn(){for(var e=window,t=J();t instanceof e.HTMLIFrameElement;){try{var r="string"===typeof t.contentWindow.location.href}catch(n){r=!1}if(!r)break;t=J((e=t.contentWindow).document)}return t}function hn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function fn(e){var t=pn(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&un(r.ownerDocument.documentElement,r)){if(null!==n&&hn(r))if(t=n.start,void 0===(e=n.end)&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if((e=(t=r.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=r.textContent.length,a=Math.min(n.start,i);n=void 0===n.end?a:Math.min(n.end,i),!e.extend&&a>n&&(i=n,n=a,a=i),i=ln(r,a);var s=ln(r,n);i&&s&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),a>n?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}for(t=[],e=r;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof r.focus&&r.focus(),r=0;r<t.length;r++)(e=t[r]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mn=l&&"documentMode"in document&&11>=document.documentMode,gn=null,vn=null,yn=null,bn=!1;function _n(e,t,r){var n=r.window===r?r.document:9===r.nodeType?r:r.ownerDocument;bn||null==gn||gn!==J(n)||("selectionStart"in(n=gn)&&hn(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},yn&&cn(yn,n)||(yn=n,0<(n=Gn(vn,"onSelect")).length&&(t=new dr("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=gn)))}function wn(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Sn={animationend:wn("Animation","AnimationEnd"),animationiteration:wn("Animation","AnimationIteration"),animationstart:wn("Animation","AnimationStart"),transitionend:wn("Transition","TransitionEnd")},Cn={},kn={};function Rn(e){if(Cn[e])return Cn[e];if(!Sn[e])return e;var t,r=Sn[e];for(t in r)if(r.hasOwnProperty(t)&&t in kn)return Cn[e]=r[t];return e}l&&(kn=document.createElement("div").style,"AnimationEvent"in window||(delete Sn.animationend.animation,delete Sn.animationiteration.animation,delete Sn.animationstart.animation),"TransitionEvent"in window||delete Sn.transitionend.transition);var Tn=Rn("animationend"),Pn=Rn("animationiteration"),En=Rn("animationstart"),Dn=Rn("transitionend"),On=new Map,xn="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function In(e,t){On.set(e,t),c(t,[e])}for(var Mn=0;Mn<xn.length;Mn++){var Ln=xn[Mn];In(Ln.toLowerCase(),"on"+(Ln[0].toUpperCase()+Ln.slice(1)))}In(Tn,"onAnimationEnd"),In(Pn,"onAnimationIteration"),In(En,"onAnimationStart"),In("dblclick","onDoubleClick"),In("focusin","onFocus"),In("focusout","onBlur"),In(Dn,"onTransitionEnd"),d("onMouseEnter",["mouseout","mouseover"]),d("onMouseLeave",["mouseout","mouseover"]),d("onPointerEnter",["pointerout","pointerover"]),d("onPointerLeave",["pointerout","pointerover"]),c("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),c("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),c("onBeforeInput",["compositionend","keypress","textInput","paste"]),c("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var jn="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),An=new Set("cancel close invalid load scroll toggle".split(" ").concat(jn));function Nn(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,function(e,t,r,n,i,s,o,c,d){if(Ue.apply(this,arguments),Ae){if(!Ae)throw Error(a(198));var l=Ne;Ae=!1,Ne=null,Fe||(Fe=!0,ze=l)}}(n,t,void 0,e),e.currentTarget=null}function Fn(e,t){t=0!==(4&t);for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var a=void 0;if(t)for(var s=n.length-1;0<=s;s--){var o=n[s],c=o.instance,d=o.currentTarget;if(o=o.listener,c!==a&&i.isPropagationStopped())break e;Nn(i,o,d),a=c}else for(s=0;s<n.length;s++){if(c=(o=n[s]).instance,d=o.currentTarget,o=o.listener,c!==a&&i.isPropagationStopped())break e;Nn(i,o,d),a=c}}}if(Fe)throw e=ze,Fe=!1,ze=null,e}function zn(e,t){var r=t[mi];void 0===r&&(r=t[mi]=new Set);var n=e+"__bubble";r.has(n)||(qn(t,e,2,!1),r.add(n))}function Bn(e,t,r){var n=0;t&&(n|=4),qn(r,e,n,t)}var Un="_reactListening"+Math.random().toString(36).slice(2);function Vn(e){if(!e[Un]){e[Un]=!0,s.forEach((function(t){"selectionchange"!==t&&(An.has(t)||Bn(t,!1,e),Bn(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Un]||(t[Un]=!0,Bn("selectionchange",!1,t))}}function qn(e,t,r,n){switch(Qt(t)){case 1:var i=Ht;break;case 4:i=Gt;break;default:i=Kt}r=i.bind(null,t,r,e),i=void 0,!Me||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),n?void 0!==i?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):void 0!==i?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function Wn(e,t,r,n,i){var a=n;if(0===(1&t)&&0===(2&t)&&null!==n)e:for(;;){if(null===n)return;var s=n.tag;if(3===s||4===s){var o=n.stateNode.containerInfo;if(o===i||8===o.nodeType&&o.parentNode===i)break;if(4===s)for(s=n.return;null!==s;){var c=s.tag;if((3===c||4===c)&&((c=s.stateNode.containerInfo)===i||8===c.nodeType&&c.parentNode===i))return;s=s.return}for(;null!==o;){if(null===(s=yi(o)))return;if(5===(c=s.tag)||6===c){n=a=s;continue e}o=o.parentNode}}n=n.return}xe((function(){var n=a,i=we(r),s=[];e:{var o=On.get(e);if(void 0!==o){var c=dr,d=e;switch(e){case"keypress":if(0===tr(r))break e;case"keydown":case"keyup":c=Tr;break;case"focusin":d="focus",c=mr;break;case"focusout":d="blur",c=mr;break;case"beforeblur":case"afterblur":c=mr;break;case"click":if(2===r.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=hr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=fr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=Er;break;case Tn:case Pn:case En:c=gr;break;case Dn:c=Dr;break;case"scroll":c=ur;break;case"wheel":c=xr;break;case"copy":case"cut":case"paste":c=yr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=Pr}var l=0!==(4&t),u=!l&&"scroll"===e,p=l?null!==o?o+"Capture":null:o;l=[];for(var h,f=n;null!==f;){var m=(h=f).stateNode;if(5===h.tag&&null!==m&&(h=m,null!==p&&(null!=(m=Ie(f,p))&&l.push(Hn(f,m,h)))),u)break;f=f.return}0<l.length&&(o=new c(o,d,null,r,i),s.push({event:o,listeners:l}))}}if(0===(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||r===_e||!(d=r.relatedTarget||r.fromElement)||!yi(d)&&!d[fi])&&(c||o)&&(o=i.window===i?i:(o=i.ownerDocument)?o.defaultView||o.parentWindow:window,c?(c=n,null!==(d=(d=r.relatedTarget||r.toElement)?yi(d):null)&&(d!==(u=Ve(d))||5!==d.tag&&6!==d.tag)&&(d=null)):(c=null,d=n),c!==d)){if(l=hr,m="onMouseLeave",p="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(l=Pr,m="onPointerLeave",p="onPointerEnter",f="pointer"),u=null==c?o:_i(c),h=null==d?o:_i(d),(o=new l(m,f+"leave",c,r,i)).target=u,o.relatedTarget=h,m=null,yi(i)===n&&((l=new l(p,f+"enter",d,r,i)).target=h,l.relatedTarget=u,m=l),u=m,c&&d)e:{for(p=d,f=0,h=l=c;h;h=Kn(h))f++;for(h=0,m=p;m;m=Kn(m))h++;for(;0<f-h;)l=Kn(l),f--;for(;0<h-f;)p=Kn(p),h--;for(;f--;){if(l===p||null!==p&&l===p.alternate)break e;l=Kn(l),p=Kn(p)}l=null}else l=null;null!==c&&Jn(s,o,c,l,!1),null!==d&&null!==u&&Jn(s,u,d,l,!0)}if("select"===(c=(o=n?_i(n):window).nodeName&&o.nodeName.toLowerCase())||"input"===c&&"file"===o.type)var g=$r;else if(qr(o))if(Qr)g=sn;else{g=nn;var v=rn}else(c=o.nodeName)&&"input"===c.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(g=an);switch(g&&(g=g(e,n))?Wr(s,g,r,i):(v&&v(e,o,n),"focusout"===e&&(v=o._wrapperState)&&v.controlled&&"number"===o.type&&ee(o,"number",o.value)),v=n?_i(n):window,e){case"focusin":(qr(v)||"true"===v.contentEditable)&&(gn=v,vn=n,yn=null);break;case"focusout":yn=vn=gn=null;break;case"mousedown":bn=!0;break;case"contextmenu":case"mouseup":case"dragend":bn=!1,_n(s,r,i);break;case"selectionchange":if(mn)break;case"keydown":case"keyup":_n(s,r,i)}var y;if(Mr)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Ur?zr(e,r)&&(b="onCompositionEnd"):"keydown"===e&&229===r.keyCode&&(b="onCompositionStart");b&&(Ar&&"ko"!==r.locale&&(Ur||"onCompositionStart"!==b?"onCompositionEnd"===b&&Ur&&(y=er()):(Yt="value"in(Xt=i)?Xt.value:Xt.textContent,Ur=!0)),0<(v=Gn(n,b)).length&&(b=new br(b,e,null,r,i),s.push({event:b,listeners:v}),y?b.data=y:null!==(y=Br(r))&&(b.data=y))),(y=jr?function(e,t){switch(e){case"compositionend":return Br(t);case"keypress":return 32!==t.which?null:(Fr=!0,Nr);case"textInput":return(e=t.data)===Nr&&Fr?null:e;default:return null}}(e,r):function(e,t){if(Ur)return"compositionend"===e||!Mr&&zr(e,t)?(e=er(),Zt=Yt=Xt=null,Ur=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ar&&"ko"!==t.locale?null:t.data}}(e,r))&&(0<(n=Gn(n,"onBeforeInput")).length&&(i=new br("onBeforeInput","beforeinput",null,r,i),s.push({event:i,listeners:n}),i.data=y))}Fn(s,t)}))}function Hn(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Gn(e,t){for(var r=t+"Capture",n=[];null!==e;){var i=e,a=i.stateNode;5===i.tag&&null!==a&&(i=a,null!=(a=Ie(e,r))&&n.unshift(Hn(e,a,i)),null!=(a=Ie(e,t))&&n.push(Hn(e,a,i))),e=e.return}return n}function Kn(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Jn(e,t,r,n,i){for(var a=t._reactName,s=[];null!==r&&r!==n;){var o=r,c=o.alternate,d=o.stateNode;if(null!==c&&c===n)break;5===o.tag&&null!==d&&(o=d,i?null!=(c=Ie(r,a))&&s.unshift(Hn(r,c,o)):i||null!=(c=Ie(r,a))&&s.push(Hn(r,c,o))),r=r.return}0!==s.length&&e.push({event:t,listeners:s})}var $n=/\r\n?/g,Qn=/\u0000|\uFFFD/g;function Xn(e){return("string"===typeof e?e:""+e).replace($n,"\n").replace(Qn,"")}function Yn(e,t,r){if(t=Xn(t),Xn(e)!==t&&r)throw Error(a(425))}function Zn(){}var ei=null,ti=null;function ri(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ni="function"===typeof setTimeout?setTimeout:void 0,ii="function"===typeof clearTimeout?clearTimeout:void 0,ai="function"===typeof Promise?Promise:void 0,si="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ai?function(e){return ai.resolve(null).then(e).catch(oi)}:ni;function oi(e){setTimeout((function(){throw e}))}function ci(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&8===i.nodeType)if("/$"===(r=i.data)){if(0===n)return e.removeChild(i),void Vt(t);n--}else"$"!==r&&"$?"!==r&&"$!"!==r||n++;r=i}while(r);Vt(t)}function di(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function li(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var r=e.data;if("$"===r||"$!"===r||"$?"===r){if(0===t)return e;t--}else"/$"===r&&t++}e=e.previousSibling}return null}var ui=Math.random().toString(36).slice(2),pi="__reactFiber$"+ui,hi="__reactProps$"+ui,fi="__reactContainer$"+ui,mi="__reactEvents$"+ui,gi="__reactListeners$"+ui,vi="__reactHandles$"+ui;function yi(e){var t=e[pi];if(t)return t;for(var r=e.parentNode;r;){if(t=r[fi]||r[pi]){if(r=t.alternate,null!==t.child||null!==r&&null!==r.child)for(e=li(e);null!==e;){if(r=e[pi])return r;e=li(e)}return t}r=(e=r).parentNode}return null}function bi(e){return!(e=e[pi]||e[fi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function _i(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(a(33))}function wi(e){return e[hi]||null}var Si=[],Ci=-1;function ki(e){return{current:e}}function Ri(e){0>Ci||(e.current=Si[Ci],Si[Ci]=null,Ci--)}function Ti(e,t){Ci++,Si[Ci]=e.current,e.current=t}var Pi={},Ei=ki(Pi),Di=ki(!1),Oi=Pi;function xi(e,t){var r=e.type.contextTypes;if(!r)return Pi;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i,a={};for(i in r)a[i]=t[i];return n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Ii(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Mi(){Ri(Di),Ri(Ei)}function Li(e,t,r){if(Ei.current!==Pi)throw Error(a(168));Ti(Ei,t),Ti(Di,r)}function ji(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,"function"!==typeof n.getChildContext)return r;for(var i in n=n.getChildContext())if(!(i in t))throw Error(a(108,q(e)||"Unknown",i));return N({},r,n)}function Ai(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Pi,Oi=Ei.current,Ti(Ei,e),Ti(Di,Di.current),!0}function Ni(e,t,r){var n=e.stateNode;if(!n)throw Error(a(169));r?(e=ji(e,t,Oi),n.__reactInternalMemoizedMergedChildContext=e,Ri(Di),Ri(Ei),Ti(Ei,e)):Ri(Di),Ti(Di,r)}var Fi=null,zi=!1,Bi=!1;function Ui(e){null===Fi?Fi=[e]:Fi.push(e)}function Vi(){if(!Bi&&null!==Fi){Bi=!0;var e=0,t=bt;try{var r=Fi;for(bt=1;e<r.length;e++){var n=r[e];do{n=n(!0)}while(null!==n)}Fi=null,zi=!1}catch(i){throw null!==Fi&&(Fi=Fi.slice(e+1)),Ke(Ze,Vi),i}finally{bt=t,Bi=!1}}return null}var qi=[],Wi=0,Hi=null,Gi=0,Ki=[],Ji=0,$i=null,Qi=1,Xi="";function Yi(e,t){qi[Wi++]=Gi,qi[Wi++]=Hi,Hi=e,Gi=t}function Zi(e,t,r){Ki[Ji++]=Qi,Ki[Ji++]=Xi,Ki[Ji++]=$i,$i=e;var n=Qi;e=Xi;var i=32-st(n)-1;n&=~(1<<i),r+=1;var a=32-st(t)+i;if(30<a){var s=i-i%5;a=(n&(1<<s)-1).toString(32),n>>=s,i-=s,Qi=1<<32-st(t)+i|r<<i|n,Xi=a+e}else Qi=1<<a|r<<i|n,Xi=e}function ea(e){null!==e.return&&(Yi(e,1),Zi(e,1,0))}function ta(e){for(;e===Hi;)Hi=qi[--Wi],qi[Wi]=null,Gi=qi[--Wi],qi[Wi]=null;for(;e===$i;)$i=Ki[--Ji],Ki[Ji]=null,Xi=Ki[--Ji],Ki[Ji]=null,Qi=Ki[--Ji],Ki[Ji]=null}var ra=null,na=null,ia=!1,aa=null;function sa(e,t){var r=Id(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,null===(t=e.deletions)?(e.deletions=[r],e.flags|=16):t.push(r)}function oa(e,t){switch(e.tag){case 5:var r=e.type;return null!==(t=1!==t.nodeType||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ra=e,na=di(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ra=e,na=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(r=null!==$i?{id:Qi,overflow:Xi}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},(r=Id(18,null,null,0)).stateNode=t,r.return=e,e.child=r,ra=e,na=null,!0);default:return!1}}function ca(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function da(e){if(ia){var t=na;if(t){var r=t;if(!oa(e,t)){if(ca(e))throw Error(a(418));t=di(r.nextSibling);var n=ra;t&&oa(e,t)?sa(n,r):(e.flags=-4097&e.flags|2,ia=!1,ra=e)}}else{if(ca(e))throw Error(a(418));e.flags=-4097&e.flags|2,ia=!1,ra=e}}}function la(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ra=e}function ua(e){if(e!==ra)return!1;if(!ia)return la(e),ia=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ri(e.type,e.memoizedProps)),t&&(t=na)){if(ca(e))throw pa(),Error(a(418));for(;t;)sa(e,t),t=di(t.nextSibling)}if(la(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var r=e.data;if("/$"===r){if(0===t){na=di(e.nextSibling);break e}t--}else"$"!==r&&"$!"!==r&&"$?"!==r||t++}e=e.nextSibling}na=null}}else na=ra?di(e.stateNode.nextSibling):null;return!0}function pa(){for(var e=na;e;)e=di(e.nextSibling)}function ha(){na=ra=null,ia=!1}function fa(e){null===aa?aa=[e]:aa.push(e)}var ma=_.ReactCurrentBatchConfig;function ga(e,t){if(e&&e.defaultProps){for(var r in t=N({},t),e=e.defaultProps)void 0===t[r]&&(t[r]=e[r]);return t}return t}var va=ki(null),ya=null,ba=null,_a=null;function wa(){_a=ba=ya=null}function Sa(e){var t=va.current;Ri(va),e._currentValue=t}function Ca(e,t,r){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==n&&(n.childLanes|=t)):null!==n&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function ka(e,t){ya=e,_a=ba=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(_o=!0),e.firstContext=null)}function Ra(e){var t=e._currentValue;if(_a!==e)if(e={context:e,memoizedValue:t,next:null},null===ba){if(null===ya)throw Error(a(308));ba=e,ya.dependencies={lanes:0,firstContext:e}}else ba=ba.next=e;return t}var Ta=null;function Pa(e){null===Ta?Ta=[e]:Ta.push(e)}function Ea(e,t,r,n){var i=t.interleaved;return null===i?(r.next=r,Pa(t)):(r.next=i.next,i.next=r),t.interleaved=r,Da(e,n)}function Da(e,t){e.lanes|=t;var r=e.alternate;for(null!==r&&(r.lanes|=t),r=e,e=e.return;null!==e;)e.childLanes|=t,null!==(r=e.alternate)&&(r.childLanes|=t),r=e,e=e.return;return 3===r.tag?r.stateNode:null}var Oa=!1;function xa(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ia(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ma(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function La(e,t,r){var n=e.updateQueue;if(null===n)return null;if(n=n.shared,0!==(2&Dc)){var i=n.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),n.pending=t,Da(e,r)}return null===(i=n.interleaved)?(t.next=t,Pa(n)):(t.next=i.next,i.next=t),n.interleaved=t,Da(e,r)}function ja(e,t,r){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&r))){var n=t.lanes;r|=n&=e.pendingLanes,t.lanes=r,yt(e,r)}}function Aa(e,t){var r=e.updateQueue,n=e.alternate;if(null!==n&&r===(n=n.updateQueue)){var i=null,a=null;if(null!==(r=r.firstBaseUpdate)){do{var s={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};null===a?i=a=s:a=a.next=s,r=r.next}while(null!==r);null===a?i=a=t:a=a.next=t}else i=a=t;return r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:n.shared,effects:n.effects},void(e.updateQueue=r)}null===(e=r.lastBaseUpdate)?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Na(e,t,r,n){var i=e.updateQueue;Oa=!1;var a=i.firstBaseUpdate,s=i.lastBaseUpdate,o=i.shared.pending;if(null!==o){i.shared.pending=null;var c=o,d=c.next;c.next=null,null===s?a=d:s.next=d,s=c;var l=e.alternate;null!==l&&((o=(l=l.updateQueue).lastBaseUpdate)!==s&&(null===o?l.firstBaseUpdate=d:o.next=d,l.lastBaseUpdate=c))}if(null!==a){var u=i.baseState;for(s=0,l=d=c=null,o=a;;){var p=o.lane,h=o.eventTime;if((n&p)===p){null!==l&&(l=l.next={eventTime:h,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var f=e,m=o;switch(p=t,h=r,m.tag){case 1:if("function"===typeof(f=m.payload)){u=f.call(h,u,p);break e}u=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(p="function"===typeof(f=m.payload)?f.call(h,u,p):f)||void 0===p)break e;u=N({},u,p);break e;case 2:Oa=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(p=i.effects)?i.effects=[o]:p.push(o))}else h={eventTime:h,lane:p,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===l?(d=l=h,c=u):l=l.next=h,s|=p;if(null===(o=o.next)){if(null===(o=i.shared.pending))break;o=(p=o).next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}if(null===l&&(c=u),i.baseState=c,i.firstBaseUpdate=d,i.lastBaseUpdate=l,null!==(t=i.shared.interleaved)){i=t;do{s|=i.lane,i=i.next}while(i!==t)}else null===a&&(i.shared.lanes=0);Nc|=s,e.lanes=s,e.memoizedState=u}}function Fa(e,t,r){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(null!==i){if(n.callback=null,n=r,"function"!==typeof i)throw Error(a(191,i));i.call(n)}}}var za=(new n.Component).refs;function Ba(e,t,r,n){r=null===(r=r(n,t=e.memoizedState))||void 0===r?t:N({},t,r),e.memoizedState=r,0===e.lanes&&(e.updateQueue.baseState=r)}var Ua={isMounted:function(e){return!!(e=e._reactInternals)&&Ve(e)===e},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=td(),i=rd(e),a=Ma(n,i);a.payload=t,void 0!==r&&null!==r&&(a.callback=r),null!==(t=La(e,a,i))&&(nd(t,e,i,n),ja(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=td(),i=rd(e),a=Ma(n,i);a.tag=1,a.payload=t,void 0!==r&&null!==r&&(a.callback=r),null!==(t=La(e,a,i))&&(nd(t,e,i,n),ja(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=td(),n=rd(e),i=Ma(r,n);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=La(e,i,n))&&(nd(t,e,n,r),ja(t,e,n))}};function Va(e,t,r,n,i,a,s){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,a,s):!t.prototype||!t.prototype.isPureReactComponent||(!cn(r,n)||!cn(i,a))}function qa(e,t,r){var n=!1,i=Pi,a=t.contextType;return"object"===typeof a&&null!==a?a=Ra(a):(i=Ii(t)?Oi:Ei.current,a=(n=null!==(n=t.contextTypes)&&void 0!==n)?xi(e,i):Pi),t=new t(r,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=Ua,e.stateNode=t,t._reactInternals=e,n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function Wa(e,t,r,n){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(r,n),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Ua.enqueueReplaceState(t,t.state,null)}function Ha(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs=za,xa(e);var a=t.contextType;"object"===typeof a&&null!==a?i.context=Ra(a):(a=Ii(t)?Oi:Ei.current,i.context=xi(e,a)),i.state=e.memoizedState,"function"===typeof(a=t.getDerivedStateFromProps)&&(Ba(e,t,a,r),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&Ua.enqueueReplaceState(i,i.state,null),Na(e,r,i,n),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}function Ga(e,t,r){if(null!==(e=r.ref)&&"function"!==typeof e&&"object"!==typeof e){if(r._owner){if(r=r._owner){if(1!==r.tag)throw Error(a(309));var n=r.stateNode}if(!n)throw Error(a(147,e));var i=n,s=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===s?t.ref:(t=function(e){var t=i.refs;t===za&&(t=i.refs={}),null===e?delete t[s]:t[s]=e},t._stringRef=s,t)}if("string"!==typeof e)throw Error(a(284));if(!r._owner)throw Error(a(290,e))}return e}function Ka(e,t){throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Ja(e){return(0,e._init)(e._payload)}function $a(e){function t(t,r){if(e){var n=t.deletions;null===n?(t.deletions=[r],t.flags|=16):n.push(r)}}function r(r,n){if(!e)return null;for(;null!==n;)t(r,n),n=n.sibling;return null}function n(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Ld(e,t)).index=0,e.sibling=null,e}function s(t,r,n){return t.index=n,e?null!==(n=t.alternate)?(n=n.index)<r?(t.flags|=2,r):n:(t.flags|=2,r):(t.flags|=1048576,r)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function c(e,t,r,n){return null===t||6!==t.tag?((t=Fd(r,e.mode,n)).return=e,t):((t=i(t,r)).return=e,t)}function d(e,t,r,n){var a=r.type;return a===C?u(e,t,r.props.children,n,r.key):null!==t&&(t.elementType===a||"object"===typeof a&&null!==a&&a.$$typeof===I&&Ja(a)===t.type)?((n=i(t,r.props)).ref=Ga(e,t,r),n.return=e,n):((n=jd(r.type,r.key,r.props,null,e.mode,n)).ref=Ga(e,t,r),n.return=e,n)}function l(e,t,r,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==r.containerInfo||t.stateNode.implementation!==r.implementation?((t=zd(r,e.mode,n)).return=e,t):((t=i(t,r.children||[])).return=e,t)}function u(e,t,r,n,a){return null===t||7!==t.tag?((t=Ad(r,e.mode,n,a)).return=e,t):((t=i(t,r)).return=e,t)}function p(e,t,r){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Fd(""+t,e.mode,r)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(r=jd(t.type,t.key,t.props,null,e.mode,r)).ref=Ga(e,null,t),r.return=e,r;case S:return(t=zd(t,e.mode,r)).return=e,t;case I:return p(e,(0,t._init)(t._payload),r)}if(te(t)||j(t))return(t=Ad(t,e.mode,r,null)).return=e,t;Ka(e,t)}return null}function h(e,t,r,n){var i=null!==t?t.key:null;if("string"===typeof r&&""!==r||"number"===typeof r)return null!==i?null:c(e,t,""+r,n);if("object"===typeof r&&null!==r){switch(r.$$typeof){case w:return r.key===i?d(e,t,r,n):null;case S:return r.key===i?l(e,t,r,n):null;case I:return h(e,t,(i=r._init)(r._payload),n)}if(te(r)||j(r))return null!==i?null:u(e,t,r,n,null);Ka(e,r)}return null}function f(e,t,r,n,i){if("string"===typeof n&&""!==n||"number"===typeof n)return c(t,e=e.get(r)||null,""+n,i);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return d(t,e=e.get(null===n.key?r:n.key)||null,n,i);case S:return l(t,e=e.get(null===n.key?r:n.key)||null,n,i);case I:return f(e,t,r,(0,n._init)(n._payload),i)}if(te(n)||j(n))return u(t,e=e.get(r)||null,n,i,null);Ka(t,n)}return null}function m(i,a,o,c){for(var d=null,l=null,u=a,m=a=0,g=null;null!==u&&m<o.length;m++){u.index>m?(g=u,u=null):g=u.sibling;var v=h(i,u,o[m],c);if(null===v){null===u&&(u=g);break}e&&u&&null===v.alternate&&t(i,u),a=s(v,a,m),null===l?d=v:l.sibling=v,l=v,u=g}if(m===o.length)return r(i,u),ia&&Yi(i,m),d;if(null===u){for(;m<o.length;m++)null!==(u=p(i,o[m],c))&&(a=s(u,a,m),null===l?d=u:l.sibling=u,l=u);return ia&&Yi(i,m),d}for(u=n(i,u);m<o.length;m++)null!==(g=f(u,i,m,o[m],c))&&(e&&null!==g.alternate&&u.delete(null===g.key?m:g.key),a=s(g,a,m),null===l?d=g:l.sibling=g,l=g);return e&&u.forEach((function(e){return t(i,e)})),ia&&Yi(i,m),d}function g(i,o,c,d){var l=j(c);if("function"!==typeof l)throw Error(a(150));if(null==(c=l.call(c)))throw Error(a(151));for(var u=l=null,m=o,g=o=0,v=null,y=c.next();null!==m&&!y.done;g++,y=c.next()){m.index>g?(v=m,m=null):v=m.sibling;var b=h(i,m,y.value,d);if(null===b){null===m&&(m=v);break}e&&m&&null===b.alternate&&t(i,m),o=s(b,o,g),null===u?l=b:u.sibling=b,u=b,m=v}if(y.done)return r(i,m),ia&&Yi(i,g),l;if(null===m){for(;!y.done;g++,y=c.next())null!==(y=p(i,y.value,d))&&(o=s(y,o,g),null===u?l=y:u.sibling=y,u=y);return ia&&Yi(i,g),l}for(m=n(i,m);!y.done;g++,y=c.next())null!==(y=f(m,i,g,y.value,d))&&(e&&null!==y.alternate&&m.delete(null===y.key?g:y.key),o=s(y,o,g),null===u?l=y:u.sibling=y,u=y);return e&&m.forEach((function(e){return t(i,e)})),ia&&Yi(i,g),l}return function e(n,a,s,c){if("object"===typeof s&&null!==s&&s.type===C&&null===s.key&&(s=s.props.children),"object"===typeof s&&null!==s){switch(s.$$typeof){case w:e:{for(var d=s.key,l=a;null!==l;){if(l.key===d){if((d=s.type)===C){if(7===l.tag){r(n,l.sibling),(a=i(l,s.props.children)).return=n,n=a;break e}}else if(l.elementType===d||"object"===typeof d&&null!==d&&d.$$typeof===I&&Ja(d)===l.type){r(n,l.sibling),(a=i(l,s.props)).ref=Ga(n,l,s),a.return=n,n=a;break e}r(n,l);break}t(n,l),l=l.sibling}s.type===C?((a=Ad(s.props.children,n.mode,c,s.key)).return=n,n=a):((c=jd(s.type,s.key,s.props,null,n.mode,c)).ref=Ga(n,a,s),c.return=n,n=c)}return o(n);case S:e:{for(l=s.key;null!==a;){if(a.key===l){if(4===a.tag&&a.stateNode.containerInfo===s.containerInfo&&a.stateNode.implementation===s.implementation){r(n,a.sibling),(a=i(a,s.children||[])).return=n,n=a;break e}r(n,a);break}t(n,a),a=a.sibling}(a=zd(s,n.mode,c)).return=n,n=a}return o(n);case I:return e(n,a,(l=s._init)(s._payload),c)}if(te(s))return m(n,a,s,c);if(j(s))return g(n,a,s,c);Ka(n,s)}return"string"===typeof s&&""!==s||"number"===typeof s?(s=""+s,null!==a&&6===a.tag?(r(n,a.sibling),(a=i(a,s)).return=n,n=a):(r(n,a),(a=Fd(s,n.mode,c)).return=n,n=a),o(n)):r(n,a)}}var Qa=$a(!0),Xa=$a(!1),Ya={},Za=ki(Ya),es=ki(Ya),ts=ki(Ya);function rs(e){if(e===Ya)throw Error(a(174));return e}function ns(e,t){switch(Ti(ts,t),Ti(es,e),Ti(Za,Ya),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ce(null,"");break;default:t=ce(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ri(Za),Ti(Za,t)}function is(){Ri(Za),Ri(es),Ri(ts)}function as(e){rs(ts.current);var t=rs(Za.current),r=ce(t,e.type);t!==r&&(Ti(es,e),Ti(Za,r))}function ss(e){es.current===e&&(Ri(Za),Ri(es))}var os=ki(0);function cs(e){for(var t=e;null!==t;){if(13===t.tag){var r=t.memoizedState;if(null!==r&&(null===(r=r.dehydrated)||"$?"===r.data||"$!"===r.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ds=[];function ls(){for(var e=0;e<ds.length;e++)ds[e]._workInProgressVersionPrimary=null;ds.length=0}var us=_.ReactCurrentDispatcher,ps=_.ReactCurrentBatchConfig,hs=0,fs=null,ms=null,gs=null,vs=!1,ys=!1,bs=0,_s=0;function ws(){throw Error(a(321))}function Ss(e,t){if(null===t)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!on(e[r],t[r]))return!1;return!0}function Cs(e,t,r,n,i,s){if(hs=s,fs=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,us.current=null===e||null===e.memoizedState?so:oo,e=r(n,i),ys){s=0;do{if(ys=!1,bs=0,25<=s)throw Error(a(301));s+=1,gs=ms=null,t.updateQueue=null,us.current=co,e=r(n,i)}while(ys)}if(us.current=ao,t=null!==ms&&null!==ms.next,hs=0,gs=ms=fs=null,vs=!1,t)throw Error(a(300));return e}function ks(){var e=0!==bs;return bs=0,e}function Rs(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===gs?fs.memoizedState=gs=e:gs=gs.next=e,gs}function Ts(){if(null===ms){var e=fs.alternate;e=null!==e?e.memoizedState:null}else e=ms.next;var t=null===gs?fs.memoizedState:gs.next;if(null!==t)gs=t,ms=e;else{if(null===e)throw Error(a(310));e={memoizedState:(ms=e).memoizedState,baseState:ms.baseState,baseQueue:ms.baseQueue,queue:ms.queue,next:null},null===gs?fs.memoizedState=gs=e:gs=gs.next=e}return gs}function Ps(e,t){return"function"===typeof t?t(e):t}function Es(e){var t=Ts(),r=t.queue;if(null===r)throw Error(a(311));r.lastRenderedReducer=e;var n=ms,i=n.baseQueue,s=r.pending;if(null!==s){if(null!==i){var o=i.next;i.next=s.next,s.next=o}n.baseQueue=i=s,r.pending=null}if(null!==i){s=i.next,n=n.baseState;var c=o=null,d=null,l=s;do{var u=l.lane;if((hs&u)===u)null!==d&&(d=d.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),n=l.hasEagerState?l.eagerState:e(n,l.action);else{var p={lane:u,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};null===d?(c=d=p,o=n):d=d.next=p,fs.lanes|=u,Nc|=u}l=l.next}while(null!==l&&l!==s);null===d?o=n:d.next=c,on(n,t.memoizedState)||(_o=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=d,r.lastRenderedState=n}if(null!==(e=r.interleaved)){i=e;do{s=i.lane,fs.lanes|=s,Nc|=s,i=i.next}while(i!==e)}else null===i&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Ds(e){var t=Ts(),r=t.queue;if(null===r)throw Error(a(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,s=t.memoizedState;if(null!==i){r.pending=null;var o=i=i.next;do{s=e(s,o.action),o=o.next}while(o!==i);on(s,t.memoizedState)||(_o=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function Os(){}function xs(e,t){var r=fs,n=Ts(),i=t(),s=!on(n.memoizedState,i);if(s&&(n.memoizedState=i,_o=!0),n=n.queue,qs(Ls.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||null!==gs&&1&gs.memoizedState.tag){if(r.flags|=2048,Fs(9,Ms.bind(null,r,n,i,t),void 0,null),null===Oc)throw Error(a(349));0!==(30&hs)||Is(r,t,i)}return i}function Is(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},null===(t=fs.updateQueue)?(t={lastEffect:null,stores:null},fs.updateQueue=t,t.stores=[e]):null===(r=t.stores)?t.stores=[e]:r.push(e)}function Ms(e,t,r,n){t.value=r,t.getSnapshot=n,js(t)&&As(e)}function Ls(e,t,r){return r((function(){js(t)&&As(e)}))}function js(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!on(e,r)}catch(n){return!0}}function As(e){var t=Da(e,1);null!==t&&nd(t,e,1,-1)}function Ns(e){var t=Rs();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ps,lastRenderedState:e},t.queue=e,e=e.dispatch=to.bind(null,fs,e),[t.memoizedState,e]}function Fs(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},null===(t=fs.updateQueue)?(t={lastEffect:null,stores:null},fs.updateQueue=t,t.lastEffect=e.next=e):null===(r=t.lastEffect)?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e),e}function zs(){return Ts().memoizedState}function Bs(e,t,r,n){var i=Rs();fs.flags|=e,i.memoizedState=Fs(1|t,r,void 0,void 0===n?null:n)}function Us(e,t,r,n){var i=Ts();n=void 0===n?null:n;var a=void 0;if(null!==ms){var s=ms.memoizedState;if(a=s.destroy,null!==n&&Ss(n,s.deps))return void(i.memoizedState=Fs(t,r,a,n))}fs.flags|=e,i.memoizedState=Fs(1|t,r,a,n)}function Vs(e,t){return Bs(8390656,8,e,t)}function qs(e,t){return Us(2048,8,e,t)}function Ws(e,t){return Us(4,2,e,t)}function Hs(e,t){return Us(4,4,e,t)}function Gs(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ks(e,t,r){return r=null!==r&&void 0!==r?r.concat([e]):null,Us(4,4,Gs.bind(null,t,e),r)}function Js(){}function $s(e,t){var r=Ts();t=void 0===t?null:t;var n=r.memoizedState;return null!==n&&null!==t&&Ss(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function Qs(e,t){var r=Ts();t=void 0===t?null:t;var n=r.memoizedState;return null!==n&&null!==t&&Ss(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function Xs(e,t,r){return 0===(21&hs)?(e.baseState&&(e.baseState=!1,_o=!0),e.memoizedState=r):(on(r,t)||(r=mt(),fs.lanes|=r,Nc|=r,e.baseState=!0),t)}function Ys(e,t){var r=bt;bt=0!==r&&4>r?r:4,e(!0);var n=ps.transition;ps.transition={};try{e(!1),t()}finally{bt=r,ps.transition=n}}function Zs(){return Ts().memoizedState}function eo(e,t,r){var n=rd(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},ro(e))no(t,r);else if(null!==(r=Ea(e,t,r,n))){nd(r,e,n,td()),io(r,t,n)}}function to(e,t,r){var n=rd(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(ro(e))no(t,i);else{var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var s=t.lastRenderedState,o=a(s,r);if(i.hasEagerState=!0,i.eagerState=o,on(o,s)){var c=t.interleaved;return null===c?(i.next=i,Pa(t)):(i.next=c.next,c.next=i),void(t.interleaved=i)}}catch(d){}null!==(r=Ea(e,t,i,n))&&(nd(r,e,n,i=td()),io(r,t,n))}}function ro(e){var t=e.alternate;return e===fs||null!==t&&t===fs}function no(e,t){ys=vs=!0;var r=e.pending;null===r?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function io(e,t,r){if(0!==(4194240&r)){var n=t.lanes;r|=n&=e.pendingLanes,t.lanes=r,yt(e,r)}}var ao={readContext:Ra,useCallback:ws,useContext:ws,useEffect:ws,useImperativeHandle:ws,useInsertionEffect:ws,useLayoutEffect:ws,useMemo:ws,useReducer:ws,useRef:ws,useState:ws,useDebugValue:ws,useDeferredValue:ws,useTransition:ws,useMutableSource:ws,useSyncExternalStore:ws,useId:ws,unstable_isNewReconciler:!1},so={readContext:Ra,useCallback:function(e,t){return Rs().memoizedState=[e,void 0===t?null:t],e},useContext:Ra,useEffect:Vs,useImperativeHandle:function(e,t,r){return r=null!==r&&void 0!==r?r.concat([e]):null,Bs(4194308,4,Gs.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Bs(4194308,4,e,t)},useInsertionEffect:function(e,t){return Bs(4,2,e,t)},useMemo:function(e,t){var r=Rs();return t=void 0===t?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Rs();return t=void 0!==r?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=eo.bind(null,fs,e),[n.memoizedState,e]},useRef:function(e){return e={current:e},Rs().memoizedState=e},useState:Ns,useDebugValue:Js,useDeferredValue:function(e){return Rs().memoizedState=e},useTransition:function(){var e=Ns(!1),t=e[0];return e=Ys.bind(null,e[1]),Rs().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=fs,i=Rs();if(ia){if(void 0===r)throw Error(a(407));r=r()}else{if(r=t(),null===Oc)throw Error(a(349));0!==(30&hs)||Is(n,t,r)}i.memoizedState=r;var s={value:r,getSnapshot:t};return i.queue=s,Vs(Ls.bind(null,n,s,e),[e]),n.flags|=2048,Fs(9,Ms.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=Rs(),t=Oc.identifierPrefix;if(ia){var r=Xi;t=":"+t+"R"+(r=(Qi&~(1<<32-st(Qi)-1)).toString(32)+r),0<(r=bs++)&&(t+="H"+r.toString(32)),t+=":"}else t=":"+t+"r"+(r=_s++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},oo={readContext:Ra,useCallback:$s,useContext:Ra,useEffect:qs,useImperativeHandle:Ks,useInsertionEffect:Ws,useLayoutEffect:Hs,useMemo:Qs,useReducer:Es,useRef:zs,useState:function(){return Es(Ps)},useDebugValue:Js,useDeferredValue:function(e){return Xs(Ts(),ms.memoizedState,e)},useTransition:function(){return[Es(Ps)[0],Ts().memoizedState]},useMutableSource:Os,useSyncExternalStore:xs,useId:Zs,unstable_isNewReconciler:!1},co={readContext:Ra,useCallback:$s,useContext:Ra,useEffect:qs,useImperativeHandle:Ks,useInsertionEffect:Ws,useLayoutEffect:Hs,useMemo:Qs,useReducer:Ds,useRef:zs,useState:function(){return Ds(Ps)},useDebugValue:Js,useDeferredValue:function(e){var t=Ts();return null===ms?t.memoizedState=e:Xs(t,ms.memoizedState,e)},useTransition:function(){return[Ds(Ps)[0],Ts().memoizedState]},useMutableSource:Os,useSyncExternalStore:xs,useId:Zs,unstable_isNewReconciler:!1};function lo(e,t){try{var r="",n=t;do{r+=U(n),n=n.return}while(n);var i=r}catch(a){i="\nError generating stack: "+a.message+"\n"+a.stack}return{value:e,source:t,stack:i,digest:null}}function uo(e,t,r){return{value:e,source:null,stack:null!=r?r:null,digest:null!=t?t:null}}function po(e,t){try{console.error(t.value)}catch(r){setTimeout((function(){throw r}))}}var ho="function"===typeof WeakMap?WeakMap:Map;function fo(e,t,r){(r=Ma(-1,r)).tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Hc||(Hc=!0,Gc=n),po(0,t)},r}function mo(e,t,r){(r=Ma(-1,r)).tag=3;var n=e.type.getDerivedStateFromError;if("function"===typeof n){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){po(0,t)}}var a=e.stateNode;return null!==a&&"function"===typeof a.componentDidCatch&&(r.callback=function(){po(0,t),"function"!==typeof n&&(null===Kc?Kc=new Set([this]):Kc.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),r}function go(e,t,r){var n=e.pingCache;if(null===n){n=e.pingCache=new ho;var i=new Set;n.set(t,i)}else void 0===(i=n.get(t))&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=Td.bind(null,e,t,r),t.then(e,e))}function vo(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function yo(e,t,r,n,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,1===r.tag&&(null===r.alternate?r.tag=17:((t=Ma(-1,1)).tag=2,La(r,t,1))),r.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var bo=_.ReactCurrentOwner,_o=!1;function wo(e,t,r,n){t.child=null===e?Xa(t,null,r,n):Qa(t,e.child,r,n)}function So(e,t,r,n,i){r=r.render;var a=t.ref;return ka(t,i),n=Cs(e,t,r,n,a,i),r=ks(),null===e||_o?(ia&&r&&ea(t),t.flags|=1,wo(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Ho(e,t,i))}function Co(e,t,r,n,i){if(null===e){var a=r.type;return"function"!==typeof a||Md(a)||void 0!==a.defaultProps||null!==r.compare||void 0!==r.defaultProps?((e=jd(r.type,null,n,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,ko(e,t,a,n,i))}if(a=e.child,0===(e.lanes&i)){var s=a.memoizedProps;if((r=null!==(r=r.compare)?r:cn)(s,n)&&e.ref===t.ref)return Ho(e,t,i)}return t.flags|=1,(e=Ld(a,n)).ref=t.ref,e.return=t,t.child=e}function ko(e,t,r,n,i){if(null!==e){var a=e.memoizedProps;if(cn(a,n)&&e.ref===t.ref){if(_o=!1,t.pendingProps=n=a,0===(e.lanes&i))return t.lanes=e.lanes,Ho(e,t,i);0!==(131072&e.flags)&&(_o=!0)}}return Po(e,t,r,n,i)}function Ro(e,t,r){var n=t.pendingProps,i=n.children,a=null!==e?e.memoizedState:null;if("hidden"===n.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ti(Lc,Mc),Mc|=r;else{if(0===(1073741824&r))return e=null!==a?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ti(Lc,Mc),Mc|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=null!==a?a.baseLanes:r,Ti(Lc,Mc),Mc|=n}else null!==a?(n=a.baseLanes|r,t.memoizedState=null):n=r,Ti(Lc,Mc),Mc|=n;return wo(e,t,i,r),t.child}function To(e,t){var r=t.ref;(null===e&&null!==r||null!==e&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Po(e,t,r,n,i){var a=Ii(r)?Oi:Ei.current;return a=xi(t,a),ka(t,i),r=Cs(e,t,r,n,a,i),n=ks(),null===e||_o?(ia&&n&&ea(t),t.flags|=1,wo(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Ho(e,t,i))}function Eo(e,t,r,n,i){if(Ii(r)){var a=!0;Ai(t)}else a=!1;if(ka(t,i),null===t.stateNode)Wo(e,t),qa(t,r,n),Ha(t,r,n,i),n=!0;else if(null===e){var s=t.stateNode,o=t.memoizedProps;s.props=o;var c=s.context,d=r.contextType;"object"===typeof d&&null!==d?d=Ra(d):d=xi(t,d=Ii(r)?Oi:Ei.current);var l=r.getDerivedStateFromProps,u="function"===typeof l||"function"===typeof s.getSnapshotBeforeUpdate;u||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o!==n||c!==d)&&Wa(t,s,n,d),Oa=!1;var p=t.memoizedState;s.state=p,Na(t,n,s,i),c=t.memoizedState,o!==n||p!==c||Di.current||Oa?("function"===typeof l&&(Ba(t,r,l,n),c=t.memoizedState),(o=Oa||Va(t,r,o,n,p,c,d))?(u||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(t.flags|=4194308)):("function"===typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),s.props=n,s.state=c,s.context=d,n=o):("function"===typeof s.componentDidMount&&(t.flags|=4194308),n=!1)}else{s=t.stateNode,Ia(e,t),o=t.memoizedProps,d=t.type===t.elementType?o:ga(t.type,o),s.props=d,u=t.pendingProps,p=s.context,"object"===typeof(c=r.contextType)&&null!==c?c=Ra(c):c=xi(t,c=Ii(r)?Oi:Ei.current);var h=r.getDerivedStateFromProps;(l="function"===typeof h||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o!==u||p!==c)&&Wa(t,s,n,c),Oa=!1,p=t.memoizedState,s.state=p,Na(t,n,s,i);var f=t.memoizedState;o!==u||p!==f||Di.current||Oa?("function"===typeof h&&(Ba(t,r,h,n),f=t.memoizedState),(d=Oa||Va(t,r,d,n,p,f,c)||!1)?(l||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(n,f,c),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(n,f,c)),"function"===typeof s.componentDidUpdate&&(t.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof s.componentDidUpdate||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=f),s.props=n,s.state=f,s.context=c,n=d):("function"!==typeof s.componentDidUpdate||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),n=!1)}return Do(e,t,r,n,a,i)}function Do(e,t,r,n,i,a){To(e,t);var s=0!==(128&t.flags);if(!n&&!s)return i&&Ni(t,r,!1),Ho(e,t,a);n=t.stateNode,bo.current=t;var o=s&&"function"!==typeof r.getDerivedStateFromError?null:n.render();return t.flags|=1,null!==e&&s?(t.child=Qa(t,e.child,null,a),t.child=Qa(t,null,o,a)):wo(e,t,o,a),t.memoizedState=n.state,i&&Ni(t,r,!0),t.child}function Oo(e){var t=e.stateNode;t.pendingContext?Li(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Li(0,t.context,!1),ns(e,t.containerInfo)}function xo(e,t,r,n,i){return ha(),fa(i),t.flags|=256,wo(e,t,r,n),t.child}var Io,Mo,Lo,jo,Ao={dehydrated:null,treeContext:null,retryLane:0};function No(e){return{baseLanes:e,cachePool:null,transitions:null}}function Fo(e,t,r){var n,i=t.pendingProps,s=os.current,o=!1,c=0!==(128&t.flags);if((n=c)||(n=(null===e||null!==e.memoizedState)&&0!==(2&s)),n?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(s|=1),Ti(os,1&s),null===e)return da(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(c=i.children,e=i.fallback,o?(i=t.mode,o=t.child,c={mode:"hidden",children:c},0===(1&i)&&null!==o?(o.childLanes=0,o.pendingProps=c):o=Nd(c,i,0,null),e=Ad(e,i,r,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=No(r),t.memoizedState=Ao,e):zo(t,c));if(null!==(s=e.memoizedState)&&null!==(n=s.dehydrated))return function(e,t,r,n,i,s,o){if(r)return 256&t.flags?(t.flags&=-257,Bo(e,t,o,n=uo(Error(a(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(s=n.fallback,i=t.mode,n=Nd({mode:"visible",children:n.children},i,0,null),(s=Ad(s,i,o,null)).flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,0!==(1&t.mode)&&Qa(t,e.child,null,o),t.child.memoizedState=No(o),t.memoizedState=Ao,s);if(0===(1&t.mode))return Bo(e,t,o,null);if("$!"===i.data){if(n=i.nextSibling&&i.nextSibling.dataset)var c=n.dgst;return n=c,Bo(e,t,o,n=uo(s=Error(a(419)),n,void 0))}if(c=0!==(o&e.childLanes),_o||c){if(null!==(n=Oc)){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(n.suspendedLanes|o))?0:i)&&i!==s.retryLane&&(s.retryLane=i,Da(e,i),nd(n,e,i,-1))}return gd(),Bo(e,t,o,n=uo(Error(a(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=Ed.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,na=di(i.nextSibling),ra=t,ia=!0,aa=null,null!==e&&(Ki[Ji++]=Qi,Ki[Ji++]=Xi,Ki[Ji++]=$i,Qi=e.id,Xi=e.overflow,$i=t),t=zo(t,n.children),t.flags|=4096,t)}(e,t,c,i,n,s,r);if(o){o=i.fallback,c=t.mode,n=(s=e.child).sibling;var d={mode:"hidden",children:i.children};return 0===(1&c)&&t.child!==s?((i=t.child).childLanes=0,i.pendingProps=d,t.deletions=null):(i=Ld(s,d)).subtreeFlags=14680064&s.subtreeFlags,null!==n?o=Ld(n,o):(o=Ad(o,c,r,null)).flags|=2,o.return=t,i.return=t,i.sibling=o,t.child=i,i=o,o=t.child,c=null===(c=e.child.memoizedState)?No(r):{baseLanes:c.baseLanes|r,cachePool:null,transitions:c.transitions},o.memoizedState=c,o.childLanes=e.childLanes&~r,t.memoizedState=Ao,i}return e=(o=e.child).sibling,i=Ld(o,{mode:"visible",children:i.children}),0===(1&t.mode)&&(i.lanes=r),i.return=t,i.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=i,t.memoizedState=null,i}function zo(e,t){return(t=Nd({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Bo(e,t,r,n){return null!==n&&fa(n),Qa(t,e.child,null,r),(e=zo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Uo(e,t,r){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),Ca(e.return,t,r)}function Vo(e,t,r,n,i){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=i)}function qo(e,t,r){var n=t.pendingProps,i=n.revealOrder,a=n.tail;if(wo(e,t,n.children,r),0!==(2&(n=os.current)))n=1&n|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Uo(e,r,t);else if(19===e.tag)Uo(e,r,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Ti(os,n),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;null!==r;)null!==(e=r.alternate)&&null===cs(e)&&(i=r),r=r.sibling;null===(r=i)?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),Vo(t,!1,i,r,a);break;case"backwards":for(r=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===cs(e)){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}Vo(t,!0,r,null,a);break;case"together":Vo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Wo(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ho(e,t,r){if(null!==e&&(t.dependencies=e.dependencies),Nc|=t.lanes,0===(r&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(r=Ld(e=t.child,e.pendingProps),t.child=r,r.return=t;null!==e.sibling;)e=e.sibling,(r=r.sibling=Ld(e,e.pendingProps)).return=t;r.sibling=null}return t.child}function Go(e,t){if(!ia)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;null!==t;)null!==t.alternate&&(r=t),t=t.sibling;null===r?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;null!==r;)null!==r.alternate&&(n=r),r=r.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Ko(e){var t=null!==e.alternate&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;null!==i;)r|=i.lanes|i.childLanes,n|=14680064&i.subtreeFlags,n|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function Jo(e,t,r){var n=t.pendingProps;switch(ta(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ko(t),null;case 1:case 17:return Ii(t.type)&&Mi(),Ko(t),null;case 3:return n=t.stateNode,is(),Ri(Di),Ri(Ei),ls(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(ua(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==aa&&(od(aa),aa=null))),Mo(e,t),Ko(t),null;case 5:ss(t);var i=rs(ts.current);if(r=t.type,null!==e&&null!=t.stateNode)Lo(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(null===t.stateNode)throw Error(a(166));return Ko(t),null}if(e=rs(Za.current),ua(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[pi]=t,n[hi]=s,e=0!==(1&t.mode),r){case"dialog":zn("cancel",n),zn("close",n);break;case"iframe":case"object":case"embed":zn("load",n);break;case"video":case"audio":for(i=0;i<jn.length;i++)zn(jn[i],n);break;case"source":zn("error",n);break;case"img":case"image":case"link":zn("error",n),zn("load",n);break;case"details":zn("toggle",n);break;case"input":Q(n,s),zn("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},zn("invalid",n);break;case"textarea":ie(n,s),zn("invalid",n)}for(var c in ye(r,s),i=null,s)if(s.hasOwnProperty(c)){var d=s[c];"children"===c?"string"===typeof d?n.textContent!==d&&(!0!==s.suppressHydrationWarning&&Yn(n.textContent,d,e),i=["children",d]):"number"===typeof d&&n.textContent!==""+d&&(!0!==s.suppressHydrationWarning&&Yn(n.textContent,d,e),i=["children",""+d]):o.hasOwnProperty(c)&&null!=d&&"onScroll"===c&&zn("scroll",n)}switch(r){case"input":G(n),Z(n,s,!0);break;case"textarea":G(n),se(n);break;case"select":case"option":break;default:"function"===typeof s.onClick&&(n.onclick=Zn)}n=i,t.updateQueue=n,null!==n&&(t.flags|=4)}else{c=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=oe(r)),"http://www.w3.org/1999/xhtml"===e?"script"===r?((e=c.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof n.is?e=c.createElement(r,{is:n.is}):(e=c.createElement(r),"select"===r&&(c=e,n.multiple?c.multiple=!0:n.size&&(c.size=n.size))):e=c.createElementNS(e,r),e[pi]=t,e[hi]=n,Io(e,t,!1,!1),t.stateNode=e;e:{switch(c=be(r,n),r){case"dialog":zn("cancel",e),zn("close",e),i=n;break;case"iframe":case"object":case"embed":zn("load",e),i=n;break;case"video":case"audio":for(i=0;i<jn.length;i++)zn(jn[i],e);i=n;break;case"source":zn("error",e),i=n;break;case"img":case"image":case"link":zn("error",e),zn("load",e),i=n;break;case"details":zn("toggle",e),i=n;break;case"input":Q(e,n),i=$(e,n),zn("invalid",e);break;case"option":default:i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=N({},n,{value:void 0}),zn("invalid",e);break;case"textarea":ie(e,n),i=ne(e,n),zn("invalid",e)}for(s in ye(r,i),d=i)if(d.hasOwnProperty(s)){var l=d[s];"style"===s?ge(e,l):"dangerouslySetInnerHTML"===s?null!=(l=l?l.__html:void 0)&&ue(e,l):"children"===s?"string"===typeof l?("textarea"!==r||""!==l)&&pe(e,l):"number"===typeof l&&pe(e,""+l):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(o.hasOwnProperty(s)?null!=l&&"onScroll"===s&&zn("scroll",e):null!=l&&b(e,s,l,c))}switch(r){case"input":G(e),Z(e,n,!1);break;case"textarea":G(e),se(e);break;case"option":null!=n.value&&e.setAttribute("value",""+W(n.value));break;case"select":e.multiple=!!n.multiple,null!=(s=n.value)?re(e,!!n.multiple,s,!1):null!=n.defaultValue&&re(e,!!n.multiple,n.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=Zn)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Ko(t),null;case 6:if(e&&null!=t.stateNode)jo(e,t,e.memoizedProps,n);else{if("string"!==typeof n&&null===t.stateNode)throw Error(a(166));if(r=rs(ts.current),rs(Za.current),ua(t)){if(n=t.stateNode,r=t.memoizedProps,n[pi]=t,(s=n.nodeValue!==r)&&null!==(e=ra))switch(e.tag){case 3:Yn(n.nodeValue,r,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Yn(n.nodeValue,r,0!==(1&e.mode))}s&&(t.flags|=4)}else(n=(9===r.nodeType?r:r.ownerDocument).createTextNode(n))[pi]=t,t.stateNode=n}return Ko(t),null;case 13:if(Ri(os),n=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ia&&null!==na&&0!==(1&t.mode)&&0===(128&t.flags))pa(),ha(),t.flags|=98560,s=!1;else if(s=ua(t),null!==n&&null!==n.dehydrated){if(null===e){if(!s)throw Error(a(318));if(!(s=null!==(s=t.memoizedState)?s.dehydrated:null))throw Error(a(317));s[pi]=t}else ha(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Ko(t),s=!1}else null!==aa&&(od(aa),aa=null),s=!0;if(!s)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=r,t):((n=null!==n)!==(null!==e&&null!==e.memoizedState)&&n&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&os.current)?0===jc&&(jc=3):gd())),null!==t.updateQueue&&(t.flags|=4),Ko(t),null);case 4:return is(),Mo(e,t),null===e&&Vn(t.stateNode.containerInfo),Ko(t),null;case 10:return Sa(t.type._context),Ko(t),null;case 19:if(Ri(os),null===(s=t.memoizedState))return Ko(t),null;if(n=0!==(128&t.flags),null===(c=s.rendering))if(n)Go(s,!1);else{if(0!==jc||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(c=cs(e))){for(t.flags|=128,Go(s,!1),null!==(n=c.updateQueue)&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;null!==r;)e=n,(s=r).flags&=14680066,null===(c=s.alternate)?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=c.childLanes,s.lanes=c.lanes,s.child=c.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=c.memoizedProps,s.memoizedState=c.memoizedState,s.updateQueue=c.updateQueue,s.type=c.type,e=c.dependencies,s.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Ti(os,1&os.current|2),t.child}e=e.sibling}null!==s.tail&&Xe()>qc&&(t.flags|=128,n=!0,Go(s,!1),t.lanes=4194304)}else{if(!n)if(null!==(e=cs(c))){if(t.flags|=128,n=!0,null!==(r=e.updateQueue)&&(t.updateQueue=r,t.flags|=4),Go(s,!0),null===s.tail&&"hidden"===s.tailMode&&!c.alternate&&!ia)return Ko(t),null}else 2*Xe()-s.renderingStartTime>qc&&1073741824!==r&&(t.flags|=128,n=!0,Go(s,!1),t.lanes=4194304);s.isBackwards?(c.sibling=t.child,t.child=c):(null!==(r=s.last)?r.sibling=c:t.child=c,s.last=c)}return null!==s.tail?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Xe(),t.sibling=null,r=os.current,Ti(os,n?1&r|2:1&r),t):(Ko(t),null);case 22:case 23:return pd(),n=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==n&&(t.flags|=8192),n&&0!==(1&t.mode)?0!==(1073741824&Mc)&&(Ko(t),6&t.subtreeFlags&&(t.flags|=8192)):Ko(t),null;case 24:case 25:return null}throw Error(a(156,t.tag))}function $o(e,t){switch(ta(t),t.tag){case 1:return Ii(t.type)&&Mi(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return is(),Ri(Di),Ri(Ei),ls(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return ss(t),null;case 13:if(Ri(os),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));ha()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ri(os),null;case 4:return is(),null;case 10:return Sa(t.type._context),null;case 22:case 23:return pd(),null;default:return null}}Io=function(e,t){for(var r=t.child;null!==r;){if(5===r.tag||6===r.tag)e.appendChild(r.stateNode);else if(4!==r.tag&&null!==r.child){r.child.return=r,r=r.child;continue}if(r===t)break;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}},Mo=function(){},Lo=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,rs(Za.current);var a,s=null;switch(r){case"input":i=$(e,i),n=$(e,n),s=[];break;case"select":i=N({},i,{value:void 0}),n=N({},n,{value:void 0}),s=[];break;case"textarea":i=ne(e,i),n=ne(e,n),s=[];break;default:"function"!==typeof i.onClick&&"function"===typeof n.onClick&&(e.onclick=Zn)}for(l in ye(r,n),r=null,i)if(!n.hasOwnProperty(l)&&i.hasOwnProperty(l)&&null!=i[l])if("style"===l){var c=i[l];for(a in c)c.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else"dangerouslySetInnerHTML"!==l&&"children"!==l&&"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&"autoFocus"!==l&&(o.hasOwnProperty(l)?s||(s=[]):(s=s||[]).push(l,null));for(l in n){var d=n[l];if(c=null!=i?i[l]:void 0,n.hasOwnProperty(l)&&d!==c&&(null!=d||null!=c))if("style"===l)if(c){for(a in c)!c.hasOwnProperty(a)||d&&d.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in d)d.hasOwnProperty(a)&&c[a]!==d[a]&&(r||(r={}),r[a]=d[a])}else r||(s||(s=[]),s.push(l,r)),r=d;else"dangerouslySetInnerHTML"===l?(d=d?d.__html:void 0,c=c?c.__html:void 0,null!=d&&c!==d&&(s=s||[]).push(l,d)):"children"===l?"string"!==typeof d&&"number"!==typeof d||(s=s||[]).push(l,""+d):"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&(o.hasOwnProperty(l)?(null!=d&&"onScroll"===l&&zn("scroll",e),s||c===d||(s=[])):(s=s||[]).push(l,d))}r&&(s=s||[]).push("style",r);var l=s;(t.updateQueue=l)&&(t.flags|=4)}},jo=function(e,t,r,n){r!==n&&(t.flags|=4)};var Qo=!1,Xo=!1,Yo="function"===typeof WeakSet?WeakSet:Set,Zo=null;function ec(e,t){var r=e.ref;if(null!==r)if("function"===typeof r)try{r(null)}catch(n){Rd(e,t,n)}else r.current=null}function tc(e,t,r){try{r()}catch(n){Rd(e,t,n)}}var rc=!1;function nc(e,t,r){var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var i=n=n.next;do{if((i.tag&e)===e){var a=i.destroy;i.destroy=void 0,void 0!==a&&tc(t,r,a)}i=i.next}while(i!==n)}}function ic(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function ac(e){var t=e.ref;if(null!==t){var r=e.stateNode;e.tag,e=r,"function"===typeof t?t(e):t.current=e}}function sc(e){var t=e.alternate;null!==t&&(e.alternate=null,sc(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[pi],delete t[hi],delete t[mi],delete t[gi],delete t[vi])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function oc(e){return 5===e.tag||3===e.tag||4===e.tag}function cc(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||oc(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function dc(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?8===r.nodeType?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(8===r.nodeType?(t=r.parentNode).insertBefore(e,r):(t=r).appendChild(e),null!==(r=r._reactRootContainer)&&void 0!==r||null!==t.onclick||(t.onclick=Zn));else if(4!==n&&null!==(e=e.child))for(dc(e,t,r),e=e.sibling;null!==e;)dc(e,t,r),e=e.sibling}function lc(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(4!==n&&null!==(e=e.child))for(lc(e,t,r),e=e.sibling;null!==e;)lc(e,t,r),e=e.sibling}var uc=null,pc=!1;function hc(e,t,r){for(r=r.child;null!==r;)fc(e,t,r),r=r.sibling}function fc(e,t,r){if(at&&"function"===typeof at.onCommitFiberUnmount)try{at.onCommitFiberUnmount(it,r)}catch(o){}switch(r.tag){case 5:Xo||ec(r,t);case 6:var n=uc,i=pc;uc=null,hc(e,t,r),pc=i,null!==(uc=n)&&(pc?(e=uc,r=r.stateNode,8===e.nodeType?e.parentNode.removeChild(r):e.removeChild(r)):uc.removeChild(r.stateNode));break;case 18:null!==uc&&(pc?(e=uc,r=r.stateNode,8===e.nodeType?ci(e.parentNode,r):1===e.nodeType&&ci(e,r),Vt(e)):ci(uc,r.stateNode));break;case 4:n=uc,i=pc,uc=r.stateNode.containerInfo,pc=!0,hc(e,t,r),uc=n,pc=i;break;case 0:case 11:case 14:case 15:if(!Xo&&(null!==(n=r.updateQueue)&&null!==(n=n.lastEffect))){i=n=n.next;do{var a=i,s=a.destroy;a=a.tag,void 0!==s&&(0!==(2&a)||0!==(4&a))&&tc(r,t,s),i=i.next}while(i!==n)}hc(e,t,r);break;case 1:if(!Xo&&(ec(r,t),"function"===typeof(n=r.stateNode).componentWillUnmount))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Rd(r,t,o)}hc(e,t,r);break;case 21:hc(e,t,r);break;case 22:1&r.mode?(Xo=(n=Xo)||null!==r.memoizedState,hc(e,t,r),Xo=n):hc(e,t,r);break;default:hc(e,t,r)}}function mc(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var r=e.stateNode;null===r&&(r=e.stateNode=new Yo),t.forEach((function(t){var n=Dd.bind(null,e,t);r.has(t)||(r.add(t),t.then(n,n))}))}}function gc(e,t){var r=t.deletions;if(null!==r)for(var n=0;n<r.length;n++){var i=r[n];try{var s=e,o=t,c=o;e:for(;null!==c;){switch(c.tag){case 5:uc=c.stateNode,pc=!1;break e;case 3:case 4:uc=c.stateNode.containerInfo,pc=!0;break e}c=c.return}if(null===uc)throw Error(a(160));fc(s,o,i),uc=null,pc=!1;var d=i.alternate;null!==d&&(d.return=null),i.return=null}catch(l){Rd(i,t,l)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)vc(t,e),t=t.sibling}function vc(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(gc(t,e),yc(e),4&n){try{nc(3,e,e.return),ic(3,e)}catch(g){Rd(e,e.return,g)}try{nc(5,e,e.return)}catch(g){Rd(e,e.return,g)}}break;case 1:gc(t,e),yc(e),512&n&&null!==r&&ec(r,r.return);break;case 5:if(gc(t,e),yc(e),512&n&&null!==r&&ec(r,r.return),32&e.flags){var i=e.stateNode;try{pe(i,"")}catch(g){Rd(e,e.return,g)}}if(4&n&&null!=(i=e.stateNode)){var s=e.memoizedProps,o=null!==r?r.memoizedProps:s,c=e.type,d=e.updateQueue;if(e.updateQueue=null,null!==d)try{"input"===c&&"radio"===s.type&&null!=s.name&&X(i,s),be(c,o);var l=be(c,s);for(o=0;o<d.length;o+=2){var u=d[o],p=d[o+1];"style"===u?ge(i,p):"dangerouslySetInnerHTML"===u?ue(i,p):"children"===u?pe(i,p):b(i,u,p,l)}switch(c){case"input":Y(i,s);break;case"textarea":ae(i,s);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var f=s.value;null!=f?re(i,!!s.multiple,f,!1):h!==!!s.multiple&&(null!=s.defaultValue?re(i,!!s.multiple,s.defaultValue,!0):re(i,!!s.multiple,s.multiple?[]:"",!1))}i[hi]=s}catch(g){Rd(e,e.return,g)}}break;case 6:if(gc(t,e),yc(e),4&n){if(null===e.stateNode)throw Error(a(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(g){Rd(e,e.return,g)}}break;case 3:if(gc(t,e),yc(e),4&n&&null!==r&&r.memoizedState.isDehydrated)try{Vt(t.containerInfo)}catch(g){Rd(e,e.return,g)}break;case 4:default:gc(t,e),yc(e);break;case 13:gc(t,e),yc(e),8192&(i=e.child).flags&&(s=null!==i.memoizedState,i.stateNode.isHidden=s,!s||null!==i.alternate&&null!==i.alternate.memoizedState||(Vc=Xe())),4&n&&mc(e);break;case 22:if(u=null!==r&&null!==r.memoizedState,1&e.mode?(Xo=(l=Xo)||u,gc(t,e),Xo=l):gc(t,e),yc(e),8192&n){if(l=null!==e.memoizedState,(e.stateNode.isHidden=l)&&!u&&0!==(1&e.mode))for(Zo=e,u=e.child;null!==u;){for(p=Zo=u;null!==Zo;){switch(f=(h=Zo).child,h.tag){case 0:case 11:case 14:case 15:nc(4,h,h.return);break;case 1:ec(h,h.return);var m=h.stateNode;if("function"===typeof m.componentWillUnmount){n=h,r=h.return;try{t=n,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Rd(n,r,g)}}break;case 5:ec(h,h.return);break;case 22:if(null!==h.memoizedState){Sc(p);continue}}null!==f?(f.return=h,Zo=f):Sc(p)}u=u.sibling}e:for(u=null,p=e;;){if(5===p.tag){if(null===u){u=p;try{i=p.stateNode,l?"function"===typeof(s=i.style).setProperty?s.setProperty("display","none","important"):s.display="none":(c=p.stateNode,o=void 0!==(d=p.memoizedProps.style)&&null!==d&&d.hasOwnProperty("display")?d.display:null,c.style.display=me("display",o))}catch(g){Rd(e,e.return,g)}}}else if(6===p.tag){if(null===u)try{p.stateNode.nodeValue=l?"":p.memoizedProps}catch(g){Rd(e,e.return,g)}}else if((22!==p.tag&&23!==p.tag||null===p.memoizedState||p===e)&&null!==p.child){p.child.return=p,p=p.child;continue}if(p===e)break e;for(;null===p.sibling;){if(null===p.return||p.return===e)break e;u===p&&(u=null),p=p.return}u===p&&(u=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:gc(t,e),yc(e),4&n&&mc(e);case 21:}}function yc(e){var t=e.flags;if(2&t){try{e:{for(var r=e.return;null!==r;){if(oc(r)){var n=r;break e}r=r.return}throw Error(a(160))}switch(n.tag){case 5:var i=n.stateNode;32&n.flags&&(pe(i,""),n.flags&=-33),lc(e,cc(e),i);break;case 3:case 4:var s=n.stateNode.containerInfo;dc(e,cc(e),s);break;default:throw Error(a(161))}}catch(o){Rd(e,e.return,o)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function bc(e,t,r){Zo=e,_c(e,t,r)}function _c(e,t,r){for(var n=0!==(1&e.mode);null!==Zo;){var i=Zo,a=i.child;if(22===i.tag&&n){var s=null!==i.memoizedState||Qo;if(!s){var o=i.alternate,c=null!==o&&null!==o.memoizedState||Xo;o=Qo;var d=Xo;if(Qo=s,(Xo=c)&&!d)for(Zo=i;null!==Zo;)c=(s=Zo).child,22===s.tag&&null!==s.memoizedState?Cc(i):null!==c?(c.return=s,Zo=c):Cc(i);for(;null!==a;)Zo=a,_c(a,t,r),a=a.sibling;Zo=i,Qo=o,Xo=d}wc(e)}else 0!==(8772&i.subtreeFlags)&&null!==a?(a.return=i,Zo=a):wc(e)}}function wc(e){for(;null!==Zo;){var t=Zo;if(0!==(8772&t.flags)){var r=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Xo||ic(5,t);break;case 1:var n=t.stateNode;if(4&t.flags&&!Xo)if(null===r)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:ga(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;null!==s&&Fa(t,s,n);break;case 3:var o=t.updateQueue;if(null!==o){if(r=null,null!==t.child)switch(t.child.tag){case 5:case 1:r=t.child.stateNode}Fa(t,o,r)}break;case 5:var c=t.stateNode;if(null===r&&4&t.flags){r=c;var d=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":d.autoFocus&&r.focus();break;case"img":d.src&&(r.src=d.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var l=t.alternate;if(null!==l){var u=l.memoizedState;if(null!==u){var p=u.dehydrated;null!==p&&Vt(p)}}}break;default:throw Error(a(163))}Xo||512&t.flags&&ac(t)}catch(h){Rd(t,t.return,h)}}if(t===e){Zo=null;break}if(null!==(r=t.sibling)){r.return=t.return,Zo=r;break}Zo=t.return}}function Sc(e){for(;null!==Zo;){var t=Zo;if(t===e){Zo=null;break}var r=t.sibling;if(null!==r){r.return=t.return,Zo=r;break}Zo=t.return}}function Cc(e){for(;null!==Zo;){var t=Zo;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{ic(4,t)}catch(c){Rd(t,r,c)}break;case 1:var n=t.stateNode;if("function"===typeof n.componentDidMount){var i=t.return;try{n.componentDidMount()}catch(c){Rd(t,i,c)}}var a=t.return;try{ac(t)}catch(c){Rd(t,a,c)}break;case 5:var s=t.return;try{ac(t)}catch(c){Rd(t,s,c)}}}catch(c){Rd(t,t.return,c)}if(t===e){Zo=null;break}var o=t.sibling;if(null!==o){o.return=t.return,Zo=o;break}Zo=t.return}}var kc,Rc=Math.ceil,Tc=_.ReactCurrentDispatcher,Pc=_.ReactCurrentOwner,Ec=_.ReactCurrentBatchConfig,Dc=0,Oc=null,xc=null,Ic=0,Mc=0,Lc=ki(0),jc=0,Ac=null,Nc=0,Fc=0,zc=0,Bc=null,Uc=null,Vc=0,qc=1/0,Wc=null,Hc=!1,Gc=null,Kc=null,Jc=!1,$c=null,Qc=0,Xc=0,Yc=null,Zc=-1,ed=0;function td(){return 0!==(6&Dc)?Xe():-1!==Zc?Zc:Zc=Xe()}function rd(e){return 0===(1&e.mode)?1:0!==(2&Dc)&&0!==Ic?Ic&-Ic:null!==ma.transition?(0===ed&&(ed=mt()),ed):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Qt(e.type)}function nd(e,t,r,n){if(50<Xc)throw Xc=0,Yc=null,Error(a(185));vt(e,r,n),0!==(2&Dc)&&e===Oc||(e===Oc&&(0===(2&Dc)&&(Fc|=r),4===jc&&cd(e,Ic)),id(e,n),1===r&&0===Dc&&0===(1&t.mode)&&(qc=Xe()+500,zi&&Vi()))}function id(e,t){var r=e.callbackNode;!function(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var s=31-st(a),o=1<<s,c=i[s];-1===c?0!==(o&r)&&0===(o&n)||(i[s]=ht(o,t)):c<=t&&(e.expiredLanes|=o),a&=~o}}(e,t);var n=pt(e,e===Oc?Ic:0);if(0===n)null!==r&&Je(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(null!=r&&Je(r),1===t)0===e.tag?function(e){zi=!0,Ui(e)}(dd.bind(null,e)):Ui(dd.bind(null,e)),si((function(){0===(6&Dc)&&Vi()})),r=null;else{switch(_t(n)){case 1:r=Ze;break;case 4:r=et;break;case 16:default:r=tt;break;case 536870912:r=nt}r=Od(r,ad.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function ad(e,t){if(Zc=-1,ed=0,0!==(6&Dc))throw Error(a(327));var r=e.callbackNode;if(Cd()&&e.callbackNode!==r)return null;var n=pt(e,e===Oc?Ic:0);if(0===n)return null;if(0!==(30&n)||0!==(n&e.expiredLanes)||t)t=vd(e,n);else{t=n;var i=Dc;Dc|=2;var s=md();for(Oc===e&&Ic===t||(Wc=null,qc=Xe()+500,hd(e,t));;)try{bd();break}catch(c){fd(e,c)}wa(),Tc.current=s,Dc=i,null!==xc?t=0:(Oc=null,Ic=0,t=jc)}if(0!==t){if(2===t&&(0!==(i=ft(e))&&(n=i,t=sd(e,i))),1===t)throw r=Ac,hd(e,0),cd(e,n),id(e,Xe()),r;if(6===t)cd(e,n);else{if(i=e.current.alternate,0===(30&n)&&!function(e){for(var t=e;;){if(16384&t.flags){var r=t.updateQueue;if(null!==r&&null!==(r=r.stores))for(var n=0;n<r.length;n++){var i=r[n],a=i.getSnapshot;i=i.value;try{if(!on(a(),i))return!1}catch(o){return!1}}}if(r=t.child,16384&t.subtreeFlags&&null!==r)r.return=t,t=r;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=vd(e,n))&&(0!==(s=ft(e))&&(n=s,t=sd(e,s))),1===t))throw r=Ac,hd(e,0),cd(e,n),id(e,Xe()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(a(345));case 2:case 5:Sd(e,Uc,Wc);break;case 3:if(cd(e,n),(130023424&n)===n&&10<(t=Vc+500-Xe())){if(0!==pt(e,0))break;if(((i=e.suspendedLanes)&n)!==n){td(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ni(Sd.bind(null,e,Uc,Wc),t);break}Sd(e,Uc,Wc);break;case 4:if(cd(e,n),(4194240&n)===n)break;for(t=e.eventTimes,i=-1;0<n;){var o=31-st(n);s=1<<o,(o=t[o])>i&&(i=o),n&=~s}if(n=i,10<(n=(120>(n=Xe()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Rc(n/1960))-n)){e.timeoutHandle=ni(Sd.bind(null,e,Uc,Wc),n);break}Sd(e,Uc,Wc);break;default:throw Error(a(329))}}}return id(e,Xe()),e.callbackNode===r?ad.bind(null,e):null}function sd(e,t){var r=Bc;return e.current.memoizedState.isDehydrated&&(hd(e,t).flags|=256),2!==(e=vd(e,t))&&(t=Uc,Uc=r,null!==t&&od(t)),e}function od(e){null===Uc?Uc=e:Uc.push.apply(Uc,e)}function cd(e,t){for(t&=~zc,t&=~Fc,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-st(t),n=1<<r;e[r]=-1,t&=~n}}function dd(e){if(0!==(6&Dc))throw Error(a(327));Cd();var t=pt(e,0);if(0===(1&t))return id(e,Xe()),null;var r=vd(e,t);if(0!==e.tag&&2===r){var n=ft(e);0!==n&&(t=n,r=sd(e,n))}if(1===r)throw r=Ac,hd(e,0),cd(e,t),id(e,Xe()),r;if(6===r)throw Error(a(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Sd(e,Uc,Wc),id(e,Xe()),null}function ld(e,t){var r=Dc;Dc|=1;try{return e(t)}finally{0===(Dc=r)&&(qc=Xe()+500,zi&&Vi())}}function ud(e){null!==$c&&0===$c.tag&&0===(6&Dc)&&Cd();var t=Dc;Dc|=1;var r=Ec.transition,n=bt;try{if(Ec.transition=null,bt=1,e)return e()}finally{bt=n,Ec.transition=r,0===(6&(Dc=t))&&Vi()}}function pd(){Mc=Lc.current,Ri(Lc)}function hd(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(-1!==r&&(e.timeoutHandle=-1,ii(r)),null!==xc)for(r=xc.return;null!==r;){var n=r;switch(ta(n),n.tag){case 1:null!==(n=n.type.childContextTypes)&&void 0!==n&&Mi();break;case 3:is(),Ri(Di),Ri(Ei),ls();break;case 5:ss(n);break;case 4:is();break;case 13:case 19:Ri(os);break;case 10:Sa(n.type._context);break;case 22:case 23:pd()}r=r.return}if(Oc=e,xc=e=Ld(e.current,null),Ic=Mc=t,jc=0,Ac=null,zc=Fc=Nc=0,Uc=Bc=null,null!==Ta){for(t=0;t<Ta.length;t++)if(null!==(n=(r=Ta[t]).interleaved)){r.interleaved=null;var i=n.next,a=r.pending;if(null!==a){var s=a.next;a.next=i,n.next=s}r.pending=n}Ta=null}return e}function fd(e,t){for(;;){var r=xc;try{if(wa(),us.current=ao,vs){for(var n=fs.memoizedState;null!==n;){var i=n.queue;null!==i&&(i.pending=null),n=n.next}vs=!1}if(hs=0,gs=ms=fs=null,ys=!1,bs=0,Pc.current=null,null===r||null===r.return){jc=1,Ac=t,xc=null;break}e:{var s=e,o=r.return,c=r,d=t;if(t=Ic,c.flags|=32768,null!==d&&"object"===typeof d&&"function"===typeof d.then){var l=d,u=c,p=u.tag;if(0===(1&u.mode)&&(0===p||11===p||15===p)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=vo(o);if(null!==f){f.flags&=-257,yo(f,o,c,0,t),1&f.mode&&go(s,l,t),d=l;var m=(t=f).updateQueue;if(null===m){var g=new Set;g.add(d),t.updateQueue=g}else m.add(d);break e}if(0===(1&t)){go(s,l,t),gd();break e}d=Error(a(426))}else if(ia&&1&c.mode){var v=vo(o);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),yo(v,o,c,0,t),fa(lo(d,c));break e}}s=d=lo(d,c),4!==jc&&(jc=2),null===Bc?Bc=[s]:Bc.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t,Aa(s,fo(0,d,t));break e;case 1:c=d;var y=s.type,b=s.stateNode;if(0===(128&s.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Kc||!Kc.has(b)))){s.flags|=65536,t&=-t,s.lanes|=t,Aa(s,mo(s,c,t));break e}}s=s.return}while(null!==s)}wd(r)}catch(_){t=_,xc===r&&null!==r&&(xc=r=r.return);continue}break}}function md(){var e=Tc.current;return Tc.current=ao,null===e?ao:e}function gd(){0!==jc&&3!==jc&&2!==jc||(jc=4),null===Oc||0===(268435455&Nc)&&0===(268435455&Fc)||cd(Oc,Ic)}function vd(e,t){var r=Dc;Dc|=2;var n=md();for(Oc===e&&Ic===t||(Wc=null,hd(e,t));;)try{yd();break}catch(i){fd(e,i)}if(wa(),Dc=r,Tc.current=n,null!==xc)throw Error(a(261));return Oc=null,Ic=0,jc}function yd(){for(;null!==xc;)_d(xc)}function bd(){for(;null!==xc&&!$e();)_d(xc)}function _d(e){var t=kc(e.alternate,e,Mc);e.memoizedProps=e.pendingProps,null===t?wd(e):xc=t,Pc.current=null}function wd(e){var t=e;do{var r=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(r=Jo(r,t,Mc)))return void(xc=r)}else{if(null!==(r=$o(r,t)))return r.flags&=32767,void(xc=r);if(null===e)return jc=6,void(xc=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(xc=t);xc=t=e}while(null!==t);0===jc&&(jc=5)}function Sd(e,t,r){var n=bt,i=Ec.transition;try{Ec.transition=null,bt=1,function(e,t,r,n){do{Cd()}while(null!==$c);if(0!==(6&Dc))throw Error(a(327));r=e.finishedWork;var i=e.finishedLanes;if(null===r)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(a(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(function(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-st(r),a=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~a}}(e,s),e===Oc&&(xc=Oc=null,Ic=0),0===(2064&r.subtreeFlags)&&0===(2064&r.flags)||Jc||(Jc=!0,Od(tt,(function(){return Cd(),null}))),s=0!==(15990&r.flags),0!==(15990&r.subtreeFlags)||s){s=Ec.transition,Ec.transition=null;var o=bt;bt=1;var c=Dc;Dc|=4,Pc.current=null,function(e,t){if(ei=Wt,hn(e=pn())){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{var n=(r=(r=e.ownerDocument)&&r.defaultView||window).getSelection&&r.getSelection();if(n&&0!==n.rangeCount){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch(w){r=null;break e}var o=0,c=-1,d=-1,l=0,u=0,p=e,h=null;t:for(;;){for(var f;p!==r||0!==i&&3!==p.nodeType||(c=o+i),p!==s||0!==n&&3!==p.nodeType||(d=o+n),3===p.nodeType&&(o+=p.nodeValue.length),null!==(f=p.firstChild);)h=p,p=f;for(;;){if(p===e)break t;if(h===r&&++l===i&&(c=o),h===s&&++u===n&&(d=o),null!==(f=p.nextSibling))break;h=(p=h).parentNode}p=f}r=-1===c||-1===d?null:{start:c,end:d}}else r=null}r=r||{start:0,end:0}}else r=null;for(ti={focusedElem:e,selectionRange:r},Wt=!1,Zo=t;null!==Zo;)if(e=(t=Zo).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Zo=e;else for(;null!==Zo;){t=Zo;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,v=m.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:ga(t.type,g),v);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var _=t.stateNode.containerInfo;1===_.nodeType?_.textContent="":9===_.nodeType&&_.documentElement&&_.removeChild(_.documentElement);break;default:throw Error(a(163))}}catch(w){Rd(t,t.return,w)}if(null!==(e=t.sibling)){e.return=t.return,Zo=e;break}Zo=t.return}m=rc,rc=!1}(e,r),vc(r,e),fn(ti),Wt=!!ei,ti=ei=null,e.current=r,bc(r,e,i),Qe(),Dc=c,bt=o,Ec.transition=s}else e.current=r;if(Jc&&(Jc=!1,$c=e,Qc=i),s=e.pendingLanes,0===s&&(Kc=null),function(e){if(at&&"function"===typeof at.onCommitFiberRoot)try{at.onCommitFiberRoot(it,e,void 0,128===(128&e.current.flags))}catch(t){}}(r.stateNode),id(e,Xe()),null!==t)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Hc)throw Hc=!1,e=Gc,Gc=null,e;0!==(1&Qc)&&0!==e.tag&&Cd(),s=e.pendingLanes,0!==(1&s)?e===Yc?Xc++:(Xc=0,Yc=e):Xc=0,Vi()}(e,t,r,n)}finally{Ec.transition=i,bt=n}return null}function Cd(){if(null!==$c){var e=_t(Qc),t=Ec.transition,r=bt;try{if(Ec.transition=null,bt=16>e?16:e,null===$c)var n=!1;else{if(e=$c,$c=null,Qc=0,0!==(6&Dc))throw Error(a(331));var i=Dc;for(Dc|=4,Zo=e.current;null!==Zo;){var s=Zo,o=s.child;if(0!==(16&Zo.flags)){var c=s.deletions;if(null!==c){for(var d=0;d<c.length;d++){var l=c[d];for(Zo=l;null!==Zo;){var u=Zo;switch(u.tag){case 0:case 11:case 15:nc(8,u,s)}var p=u.child;if(null!==p)p.return=u,Zo=p;else for(;null!==Zo;){var h=(u=Zo).sibling,f=u.return;if(sc(u),u===l){Zo=null;break}if(null!==h){h.return=f,Zo=h;break}Zo=f}}}var m=s.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}Zo=s}}if(0!==(2064&s.subtreeFlags)&&null!==o)o.return=s,Zo=o;else e:for(;null!==Zo;){if(0!==(2048&(s=Zo).flags))switch(s.tag){case 0:case 11:case 15:nc(9,s,s.return)}var y=s.sibling;if(null!==y){y.return=s.return,Zo=y;break e}Zo=s.return}}var b=e.current;for(Zo=b;null!==Zo;){var _=(o=Zo).child;if(0!==(2064&o.subtreeFlags)&&null!==_)_.return=o,Zo=_;else e:for(o=b;null!==Zo;){if(0!==(2048&(c=Zo).flags))try{switch(c.tag){case 0:case 11:case 15:ic(9,c)}}catch(S){Rd(c,c.return,S)}if(c===o){Zo=null;break e}var w=c.sibling;if(null!==w){w.return=c.return,Zo=w;break e}Zo=c.return}}if(Dc=i,Vi(),at&&"function"===typeof at.onPostCommitFiberRoot)try{at.onPostCommitFiberRoot(it,e)}catch(S){}n=!0}return n}finally{bt=r,Ec.transition=t}}return!1}function kd(e,t,r){e=La(e,t=fo(0,t=lo(r,t),1),1),t=td(),null!==e&&(vt(e,1,t),id(e,t))}function Rd(e,t,r){if(3===e.tag)kd(e,e,r);else for(;null!==t;){if(3===t.tag){kd(t,e,r);break}if(1===t.tag){var n=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof n.componentDidCatch&&(null===Kc||!Kc.has(n))){t=La(t,e=mo(t,e=lo(r,e),1),1),e=td(),null!==t&&(vt(t,1,e),id(t,e));break}}t=t.return}}function Td(e,t,r){var n=e.pingCache;null!==n&&n.delete(t),t=td(),e.pingedLanes|=e.suspendedLanes&r,Oc===e&&(Ic&r)===r&&(4===jc||3===jc&&(130023424&Ic)===Ic&&500>Xe()-Vc?hd(e,0):zc|=r),id(e,t)}function Pd(e,t){0===t&&(0===(1&e.mode)?t=1:(t=lt,0===(130023424&(lt<<=1))&&(lt=4194304)));var r=td();null!==(e=Da(e,t))&&(vt(e,t,r),id(e,r))}function Ed(e){var t=e.memoizedState,r=0;null!==t&&(r=t.retryLane),Pd(e,r)}function Dd(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;null!==i&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(a(314))}null!==n&&n.delete(t),Pd(e,r)}function Od(e,t){return Ke(e,t)}function xd(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Id(e,t,r,n){return new xd(e,t,r,n)}function Md(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Ld(e,t){var r=e.alternate;return null===r?((r=Id(e.tag,t,e.key,e.mode)).elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=14680064&e.flags,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function jd(e,t,r,n,i,s){var o=2;if(n=e,"function"===typeof e)Md(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case C:return Ad(r.children,i,s,t);case k:o=8,i|=8;break;case R:return(e=Id(12,r,t,2|i)).elementType=R,e.lanes=s,e;case D:return(e=Id(13,r,t,i)).elementType=D,e.lanes=s,e;case O:return(e=Id(19,r,t,i)).elementType=O,e.lanes=s,e;case M:return Nd(r,i,s,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case T:o=10;break e;case P:o=9;break e;case E:o=11;break e;case x:o=14;break e;case I:o=16,n=null;break e}throw Error(a(130,null==e?e:typeof e,""))}return(t=Id(o,r,t,i)).elementType=e,t.type=n,t.lanes=s,t}function Ad(e,t,r,n){return(e=Id(7,e,n,t)).lanes=r,e}function Nd(e,t,r,n){return(e=Id(22,e,n,t)).elementType=M,e.lanes=r,e.stateNode={isHidden:!1},e}function Fd(e,t,r){return(e=Id(6,e,null,t)).lanes=r,e}function zd(e,t,r){return(t=Id(4,null!==e.children?e.children:[],e.key,t)).lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Bd(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Ud(e,t,r,n,i,a,s,o,c){return e=new Bd(e,t,r,o,c),1===t?(t=1,!0===a&&(t|=8)):t=0,a=Id(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},xa(a),e}function Vd(e){if(!e)return Pi;e:{if(Ve(e=e._reactInternals)!==e||1!==e.tag)throw Error(a(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ii(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(a(171))}if(1===e.tag){var r=e.type;if(Ii(r))return ji(e,r,t)}return t}function qd(e,t,r,n,i,a,s,o,c){return(e=Ud(r,n,!0,e,0,a,0,o,c)).context=Vd(null),r=e.current,(a=Ma(n=td(),i=rd(r))).callback=void 0!==t&&null!==t?t:null,La(r,a,i),e.current.lanes=i,vt(e,i,n),id(e,n),e}function Wd(e,t,r,n){var i=t.current,a=td(),s=rd(i);return r=Vd(r),null===t.context?t.context=r:t.pendingContext=r,(t=Ma(a,s)).payload={element:e},null!==(n=void 0===n?null:n)&&(t.callback=n),null!==(e=La(i,t,s))&&(nd(e,i,s,a),ja(e,i,s)),s}function Hd(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Gd(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var r=e.retryLane;e.retryLane=0!==r&&r<t?r:t}}function Kd(e,t){Gd(e,t),(e=e.alternate)&&Gd(e,t)}kc=function(e,t,r){if(null!==e)if(e.memoizedProps!==t.pendingProps||Di.current)_o=!0;else{if(0===(e.lanes&r)&&0===(128&t.flags))return _o=!1,function(e,t,r){switch(t.tag){case 3:Oo(t),ha();break;case 5:as(t);break;case 1:Ii(t.type)&&Ai(t);break;case 4:ns(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;Ti(va,n._currentValue),n._currentValue=i;break;case 13:if(null!==(n=t.memoizedState))return null!==n.dehydrated?(Ti(os,1&os.current),t.flags|=128,null):0!==(r&t.child.childLanes)?Fo(e,t,r):(Ti(os,1&os.current),null!==(e=Ho(e,t,r))?e.sibling:null);Ti(os,1&os.current);break;case 19:if(n=0!==(r&t.childLanes),0!==(128&e.flags)){if(n)return qo(e,t,r);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ti(os,os.current),n)break;return null;case 22:case 23:return t.lanes=0,Ro(e,t,r)}return Ho(e,t,r)}(e,t,r);_o=0!==(131072&e.flags)}else _o=!1,ia&&0!==(1048576&t.flags)&&Zi(t,Gi,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Wo(e,t),e=t.pendingProps;var i=xi(t,Ei.current);ka(t,r),i=Cs(null,t,n,e,i,r);var s=ks();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ii(n)?(s=!0,Ai(t)):s=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,xa(t),i.updater=Ua,t.stateNode=i,i._reactInternals=t,Ha(t,n,e,r),t=Do(null,t,n,!0,s,r)):(t.tag=0,ia&&s&&ea(t),wo(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Wo(e,t),e=t.pendingProps,n=(i=n._init)(n._payload),t.type=n,i=t.tag=function(e){if("function"===typeof e)return Md(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===E)return 11;if(e===x)return 14}return 2}(n),e=ga(n,e),i){case 0:t=Po(null,t,n,e,r);break e;case 1:t=Eo(null,t,n,e,r);break e;case 11:t=So(null,t,n,e,r);break e;case 14:t=Co(null,t,n,ga(n.type,e),r);break e}throw Error(a(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,Po(e,t,n,i=t.elementType===n?i:ga(n,i),r);case 1:return n=t.type,i=t.pendingProps,Eo(e,t,n,i=t.elementType===n?i:ga(n,i),r);case 3:e:{if(Oo(t),null===e)throw Error(a(387));n=t.pendingProps,i=(s=t.memoizedState).element,Ia(e,t),Na(t,n,null,r);var o=t.memoizedState;if(n=o.element,s.isDehydrated){if(s={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=xo(e,t,n,r,i=lo(Error(a(423)),t));break e}if(n!==i){t=xo(e,t,n,r,i=lo(Error(a(424)),t));break e}for(na=di(t.stateNode.containerInfo.firstChild),ra=t,ia=!0,aa=null,r=Xa(t,null,n,r),t.child=r;r;)r.flags=-3&r.flags|4096,r=r.sibling}else{if(ha(),n===i){t=Ho(e,t,r);break e}wo(e,t,n,r)}t=t.child}return t;case 5:return as(t),null===e&&da(t),n=t.type,i=t.pendingProps,s=null!==e?e.memoizedProps:null,o=i.children,ri(n,i)?o=null:null!==s&&ri(n,s)&&(t.flags|=32),To(e,t),wo(e,t,o,r),t.child;case 6:return null===e&&da(t),null;case 13:return Fo(e,t,r);case 4:return ns(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=Qa(t,null,n,r):wo(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,So(e,t,n,i=t.elementType===n?i:ga(n,i),r);case 7:return wo(e,t,t.pendingProps,r),t.child;case 8:case 12:return wo(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,s=t.memoizedProps,o=i.value,Ti(va,n._currentValue),n._currentValue=o,null!==s)if(on(s.value,o)){if(s.children===i.children&&!Di.current){t=Ho(e,t,r);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var c=s.dependencies;if(null!==c){o=s.child;for(var d=c.firstContext;null!==d;){if(d.context===n){if(1===s.tag){(d=Ma(-1,r&-r)).tag=2;var l=s.updateQueue;if(null!==l){var u=(l=l.shared).pending;null===u?d.next=d:(d.next=u.next,u.next=d),l.pending=d}}s.lanes|=r,null!==(d=s.alternate)&&(d.lanes|=r),Ca(s.return,r,t),c.lanes|=r;break}d=d.next}}else if(10===s.tag)o=s.type===t.type?null:s.child;else if(18===s.tag){if(null===(o=s.return))throw Error(a(341));o.lanes|=r,null!==(c=o.alternate)&&(c.lanes|=r),Ca(o,r,t),o=s.sibling}else o=s.child;if(null!==o)o.return=s;else for(o=s;null!==o;){if(o===t){o=null;break}if(null!==(s=o.sibling)){s.return=o.return,o=s;break}o=o.return}s=o}wo(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,ka(t,r),n=n(i=Ra(i)),t.flags|=1,wo(e,t,n,r),t.child;case 14:return i=ga(n=t.type,t.pendingProps),Co(e,t,n,i=ga(n.type,i),r);case 15:return ko(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:ga(n,i),Wo(e,t),t.tag=1,Ii(n)?(e=!0,Ai(t)):e=!1,ka(t,r),qa(t,n,i),Ha(t,n,i,r),Do(null,t,n,!0,e,r);case 19:return qo(e,t,r);case 22:return Ro(e,t,r)}throw Error(a(156,t.tag))};var Jd="function"===typeof reportError?reportError:function(e){console.error(e)};function $d(e){this._internalRoot=e}function Qd(e){this._internalRoot=e}function Xd(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Yd(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Zd(){}function el(e,t,r,n,i){var a=r._reactRootContainer;if(a){var s=a;if("function"===typeof i){var o=i;i=function(){var e=Hd(s);o.call(e)}}Wd(t,s,e,i)}else s=function(e,t,r,n,i){if(i){if("function"===typeof n){var a=n;n=function(){var e=Hd(s);a.call(e)}}var s=qd(t,n,e,0,null,!1,0,"",Zd);return e._reactRootContainer=s,e[fi]=s.current,Vn(8===e.nodeType?e.parentNode:e),ud(),s}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof n){var o=n;n=function(){var e=Hd(c);o.call(e)}}var c=Ud(e,0,!1,null,0,!1,0,"",Zd);return e._reactRootContainer=c,e[fi]=c.current,Vn(8===e.nodeType?e.parentNode:e),ud((function(){Wd(t,c,r,n)})),c}(r,t,e,i,n);return Hd(s)}Qd.prototype.render=$d.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(a(409));Wd(e,t,null,null)},Qd.prototype.unmount=$d.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;ud((function(){Wd(null,e,null,null)})),t[fi]=null}},Qd.prototype.unstable_scheduleHydration=function(e){if(e){var t=kt();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Mt.length&&0!==t&&t<Mt[r].priority;r++);Mt.splice(r,0,e),0===r&&Nt(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=ut(t.pendingLanes);0!==r&&(yt(t,1|r),id(t,Xe()),0===(6&Dc)&&(qc=Xe()+500,Vi()))}break;case 13:ud((function(){var t=Da(e,1);if(null!==t){var r=td();nd(t,e,1,r)}})),Kd(e,1)}},St=function(e){if(13===e.tag){var t=Da(e,134217728);if(null!==t)nd(t,e,134217728,td());Kd(e,134217728)}},Ct=function(e){if(13===e.tag){var t=rd(e),r=Da(e,t);if(null!==r)nd(r,e,t,td());Kd(e,t)}},kt=function(){return bt},Rt=function(e,t){var r=bt;try{return bt=e,t()}finally{bt=r}},Se=function(e,t,r){switch(t){case"input":if(Y(e,r),t=r.name,"radio"===r.type&&null!=t){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=wi(n);if(!i)throw Error(a(90));K(n),Y(n,i)}}}break;case"textarea":ae(e,r);break;case"select":null!=(t=r.value)&&re(e,!!r.multiple,t,!1)}},Ee=ld,De=ud;var tl={usingClientEntryPoint:!1,Events:[bi,_i,wi,Te,Pe,ld]},rl={findFiberByHostInstance:yi,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},nl={bundleType:rl.bundleType,version:rl.version,rendererPackageName:rl.rendererPackageName,rendererConfig:rl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:_.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=He(e))?null:e.stateNode},findFiberByHostInstance:rl.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var il=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!il.isDisabled&&il.supportsFiber)try{it=il.inject(nl),at=il}catch(le){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tl,t.createPortal=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Xd(t))throw Error(a(200));return function(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:S,key:null==n?null:""+n,children:e,containerInfo:t,implementation:r}}(e,t,null,r)},t.createRoot=function(e,t){if(!Xd(e))throw Error(a(299));var r=!1,n="",i=Jd;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(r=!0),void 0!==t.identifierPrefix&&(n=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=Ud(e,1,!1,null,0,r,0,n,i),e[fi]=t.current,Vn(8===e.nodeType?e.parentNode:e),new $d(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(a(188));throw e=Object.keys(e).join(","),Error(a(268,e))}return e=null===(e=He(t))?null:e.stateNode},t.flushSync=function(e){return ud(e)},t.hydrate=function(e,t,r){if(!Yd(t))throw Error(a(200));return el(null,e,t,!0,r)},t.hydrateRoot=function(e,t,r){if(!Xd(e))throw Error(a(405));var n=null!=r&&r.hydratedSources||null,i=!1,s="",o=Jd;if(null!==r&&void 0!==r&&(!0===r.unstable_strictMode&&(i=!0),void 0!==r.identifierPrefix&&(s=r.identifierPrefix),void 0!==r.onRecoverableError&&(o=r.onRecoverableError)),t=qd(t,null,e,1,null!=r?r:null,i,0,s,o),e[fi]=t.current,Vn(e),n)for(e=0;e<n.length;e++)i=(i=(r=n[e])._getVersion)(r._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new Qd(t)},t.render=function(e,t,r){if(!Yd(t))throw Error(a(200));return el(null,e,t,!1,r)},t.unmountComponentAtNode=function(e){if(!Yd(e))throw Error(a(40));return!!e._reactRootContainer&&(ud((function(){el(null,null,e,!1,(function(){e._reactRootContainer=null,e[fi]=null}))})),!0)},t.unstable_batchedUpdates=ld,t.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Yd(r))throw Error(a(200));if(null==e||void 0===e._reactInternals)throw Error(a(38));return el(e,t,r,!1,n)},t.version="18.2.0-next-9e3b772b8-20220608"},1180:(e,t,r)=>{"use strict";var n=r(1292);t.createRoot=n.createRoot,t.hydrateRoot=n.hydrateRoot},1292:(e,t,r)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=r(6144)},36:(e,t,r)=>{"use strict";var n=r(9060),i=Symbol.for("react.element"),a=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,o=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function d(e,t,r){var n,a={},d=null,l=null;for(n in void 0!==r&&(d=""+r),void 0!==t.key&&(d=""+t.key),void 0!==t.ref&&(l=t.ref),t)s.call(t,n)&&!c.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===a[n]&&(a[n]=t[n]);return{$$typeof:i,type:e,key:d,ref:l,props:a,_owner:o.current}}t.jsx=d,t.jsxs=d},4564:(e,t)=>{"use strict";var r=Symbol.for("react.element"),n=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),c=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),h=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function v(e,t,r){this.props=e,this.context=t,this.refs=g,this.updater=r||f}function y(){}function b(e,t,r){this.props=e,this.context=t,this.refs=g,this.updater=r||f}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var _=b.prototype=new y;_.constructor=b,m(_,v.prototype),_.isPureReactComponent=!0;var w=Array.isArray,S=Object.prototype.hasOwnProperty,C={current:null},k={key:!0,ref:!0,__self:!0,__source:!0};function R(e,t,n){var i,a={},s=null,o=null;if(null!=t)for(i in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(s=""+t.key),t)S.call(t,i)&&!k.hasOwnProperty(i)&&(a[i]=t[i]);var c=arguments.length-2;if(1===c)a.children=n;else if(1<c){for(var d=Array(c),l=0;l<c;l++)d[l]=arguments[l+2];a.children=d}if(e&&e.defaultProps)for(i in c=e.defaultProps)void 0===a[i]&&(a[i]=c[i]);return{$$typeof:r,type:e,key:s,ref:o,props:a,_owner:C.current}}function T(e){return"object"===typeof e&&null!==e&&e.$$typeof===r}var P=/\/+/g;function E(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function D(e,t,i,a,s){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var c=!1;if(null===e)c=!0;else switch(o){case"string":case"number":c=!0;break;case"object":switch(e.$$typeof){case r:case n:c=!0}}if(c)return s=s(c=e),e=""===a?"."+E(c,0):a,w(s)?(i="",null!=e&&(i=e.replace(P,"$&/")+"/"),D(s,t,i,"",(function(e){return e}))):null!=s&&(T(s)&&(s=function(e,t){return{$$typeof:r,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(s,i+(!s.key||c&&c.key===s.key?"":(""+s.key).replace(P,"$&/")+"/")+e)),t.push(s)),1;if(c=0,a=""===a?".":a+":",w(e))for(var d=0;d<e.length;d++){var l=a+E(o=e[d],d);c+=D(o,t,i,l,s)}else if(l=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=h&&e[h]||e["@@iterator"])?e:null}(e),"function"===typeof l)for(e=l.call(e),d=0;!(o=e.next()).done;)c+=D(o=o.value,t,i,l=a+E(o,d++),s);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return c}function O(e,t,r){if(null==e)return e;var n=[],i=0;return D(e,n,"","",(function(e){return t.call(r,e,i++)})),n}function x(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var I={current:null},M={transition:null},L={ReactCurrentDispatcher:I,ReactCurrentBatchConfig:M,ReactCurrentOwner:C};t.Children={map:O,forEach:function(e,t,r){O(e,(function(){t.apply(this,arguments)}),r)},count:function(e){var t=0;return O(e,(function(){t++})),t},toArray:function(e){return O(e,(function(e){return e}))||[]},only:function(e){if(!T(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=i,t.Profiler=s,t.PureComponent=b,t.StrictMode=a,t.Suspense=l,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=L,t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=m({},e.props),a=e.key,s=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,o=C.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(d in t)S.call(t,d)&&!k.hasOwnProperty(d)&&(i[d]=void 0===t[d]&&void 0!==c?c[d]:t[d])}var d=arguments.length-2;if(1===d)i.children=n;else if(1<d){c=Array(d);for(var l=0;l<d;l++)c[l]=arguments[l+2];i.children=c}return{$$typeof:r,type:e.type,key:a,ref:s,props:i,_owner:o}},t.createContext=function(e){return(e={$$typeof:c,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=R,t.createFactory=function(e){var t=R.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:d,render:e}},t.isValidElement=T,t.lazy=function(e){return{$$typeof:p,_payload:{_status:-1,_result:e},_init:x}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=M.transition;M.transition={};try{e()}finally{M.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return I.current.useCallback(e,t)},t.useContext=function(e){return I.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return I.current.useDeferredValue(e)},t.useEffect=function(e,t){return I.current.useEffect(e,t)},t.useId=function(){return I.current.useId()},t.useImperativeHandle=function(e,t,r){return I.current.useImperativeHandle(e,t,r)},t.useInsertionEffect=function(e,t){return I.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return I.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return I.current.useMemo(e,t)},t.useReducer=function(e,t,r){return I.current.useReducer(e,t,r)},t.useRef=function(e){return I.current.useRef(e)},t.useState=function(e){return I.current.useState(e)},t.useSyncExternalStore=function(e,t,r){return I.current.useSyncExternalStore(e,t,r)},t.useTransition=function(){return I.current.useTransition()},t.version="18.2.0"},9060:(e,t,r)=>{"use strict";e.exports=r(4564)},2496:(e,t,r)=>{"use strict";e.exports=r(36)},9872:(e,t,r)=>{"use strict";var n=r(2232);function i(e,t,r,i,a){var s=n.writeRtpDescription(e.kind,t);if(s+=n.writeIceParameters(e.iceGatherer.getLocalParameters()),s+=n.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===r?"actpass":a||"active"),s+="a=mid:"+e.mid+"\r\n",e.rtpSender&&e.rtpReceiver?s+="a=sendrecv\r\n":e.rtpSender?s+="a=sendonly\r\n":e.rtpReceiver?s+="a=recvonly\r\n":s+="a=inactive\r\n",e.rtpSender){var o=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=o;var c="msid:"+(i?i.id:"-")+" "+o+"\r\n";s+="a="+c,s+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+c,e.sendEncodingParameters[0].rtx&&(s+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+c,s+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return s+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+n.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(s+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+n.localCName+"\r\n"),s}function a(e,t){var r={codecs:[],headerExtensions:[],fecMechanisms:[]},n=function(e,t){e=parseInt(e,10);for(var r=0;r<t.length;r++)if(t[r].payloadType===e||t[r].preferredPayloadType===e)return t[r]},i=function(e,t,r,i){var a=n(e.parameters.apt,r),s=n(t.parameters.apt,i);return a&&s&&a.name.toLowerCase()===s.name.toLowerCase()};return e.codecs.forEach((function(n){for(var a=0;a<t.codecs.length;a++){var s=t.codecs[a];if(n.name.toLowerCase()===s.name.toLowerCase()&&n.clockRate===s.clockRate){if("rtx"===n.name.toLowerCase()&&n.parameters&&s.parameters.apt&&!i(n,s,e.codecs,t.codecs))continue;(s=JSON.parse(JSON.stringify(s))).numChannels=Math.min(n.numChannels,s.numChannels),r.codecs.push(s),s.rtcpFeedback=s.rtcpFeedback.filter((function(e){for(var t=0;t<n.rtcpFeedback.length;t++)if(n.rtcpFeedback[t].type===e.type&&n.rtcpFeedback[t].parameter===e.parameter)return!0;return!1}));break}}})),e.headerExtensions.forEach((function(e){for(var n=0;n<t.headerExtensions.length;n++){var i=t.headerExtensions[n];if(e.uri===i.uri){r.headerExtensions.push(i);break}}})),r}function s(e,t,r){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(r)}function o(e,t){var r=e.getRemoteCandidates().find((function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type}));return r||e.addRemoteCandidate(t),!r}function c(e,t){var r=new Error(t);return r.name=e,r.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],r}e.exports=function(e,t){function r(t,r){r.addTrack(t),r.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:t}))}function d(t,r,n,i){var a=new Event("track");a.track=r,a.receiver=n,a.transceiver={receiver:n},a.streams=i,e.setTimeout((function(){t._dispatchEvent("track",a)}))}var l=function(r){var i=this,a=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach((function(e){i[e]=a[e].bind(a)})),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",r=JSON.parse(JSON.stringify(r||{})),this.usingBundle="max-bundle"===r.bundlePolicy,"negotiate"===r.rtcpMuxPolicy)throw c("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(r.rtcpMuxPolicy||(r.rtcpMuxPolicy="require"),r.iceTransportPolicy){case"all":case"relay":break;default:r.iceTransportPolicy="all"}switch(r.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:r.bundlePolicy="balanced"}if(r.iceServers=function(e,t){var r=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var n=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var i="string"===typeof n;return i&&(n=[n]),n=n.filter((function(e){return 0!==e.indexOf("turn:")||-1===e.indexOf("transport=udp")||-1!==e.indexOf("turn:[")||r?0===e.indexOf("stun:")&&t>=14393&&-1===e.indexOf("?transport=udp"):(r=!0,!0)})),delete e.url,e.urls=i?n[0]:n,!!n.length}}))}(r.iceServers||[],t),this._iceGatherers=[],r.iceCandidatePoolSize)for(var s=r.iceCandidatePoolSize;s>0;s--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:r.iceServers,gatherPolicy:r.iceTransportPolicy}));else r.iceCandidatePoolSize=0;this._config=r,this.transceivers=[],this._sdpSessionId=n.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(l.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(l.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),l.prototype.onicecandidate=null,l.prototype.onaddstream=null,l.prototype.ontrack=null,l.prototype.onremovestream=null,l.prototype.onsignalingstatechange=null,l.prototype.oniceconnectionstatechange=null,l.prototype.onconnectionstatechange=null,l.prototype.onicegatheringstatechange=null,l.prototype.onnegotiationneeded=null,l.prototype.ondatachannel=null,l.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"===typeof this["on"+e]&&this["on"+e](t))},l.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},l.prototype.getConfiguration=function(){return this._config},l.prototype.getLocalStreams=function(){return this.localStreams},l.prototype.getRemoteStreams=function(){return this.remoteStreams},l.prototype._createTransceiver=function(e,t){var r=this.transceivers.length>0,n={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&r)n.iceTransport=this.transceivers[0].iceTransport,n.dtlsTransport=this.transceivers[0].dtlsTransport;else{var i=this._createIceAndDtlsTransports();n.iceTransport=i.iceTransport,n.dtlsTransport=i.dtlsTransport}return t||this.transceivers.push(n),n},l.prototype.addTrack=function(t,r){if(this._isClosed)throw c("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var n;if(this.transceivers.find((function(e){return e.track===t})))throw c("InvalidAccessError","Track already exists.");for(var i=0;i<this.transceivers.length;i++)this.transceivers[i].track||this.transceivers[i].kind!==t.kind||(n=this.transceivers[i]);return n||(n=this._createTransceiver(t.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(r)&&this.localStreams.push(r),n.track=t,n.stream=r,n.rtpSender=new e.RTCRtpSender(t,n.dtlsTransport),n.rtpSender},l.prototype.addStream=function(e){var r=this;if(t>=15025)e.getTracks().forEach((function(t){r.addTrack(t,e)}));else{var n=e.clone();e.getTracks().forEach((function(e,t){var r=n.getTracks()[t];e.addEventListener("enabled",(function(e){r.enabled=e.enabled}))})),n.getTracks().forEach((function(e){r.addTrack(e,n)}))}},l.prototype.removeTrack=function(t){if(this._isClosed)throw c("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var r=this.transceivers.find((function(e){return e.rtpSender===t}));if(!r)throw c("InvalidAccessError","Sender was not created by this connection.");var n=r.stream;r.rtpSender.stop(),r.rtpSender=null,r.track=null,r.stream=null,-1===this.transceivers.map((function(e){return e.stream})).indexOf(n)&&this.localStreams.indexOf(n)>-1&&this.localStreams.splice(this.localStreams.indexOf(n),1),this._maybeFireNegotiationNeeded()},l.prototype.removeStream=function(e){var t=this;e.getTracks().forEach((function(e){var r=t.getSenders().find((function(t){return t.track===e}));r&&t.removeTrack(r)}))},l.prototype.getSenders=function(){return this.transceivers.filter((function(e){return!!e.rtpSender})).map((function(e){return e.rtpSender}))},l.prototype.getReceivers=function(){return this.transceivers.filter((function(e){return!!e.rtpReceiver})).map((function(e){return e.rtpReceiver}))},l.prototype._createIceGatherer=function(t,r){var n=this;if(r&&t>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var i=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(i,"state",{value:"new",writable:!0}),this.transceivers[t].bufferedCandidateEvents=[],this.transceivers[t].bufferCandidates=function(e){var r=!e.candidate||0===Object.keys(e.candidate).length;i.state=r?"completed":"gathering",null!==n.transceivers[t].bufferedCandidateEvents&&n.transceivers[t].bufferedCandidateEvents.push(e)},i.addEventListener("localcandidate",this.transceivers[t].bufferCandidates),i},l.prototype._gather=function(t,r){var i=this,a=this.transceivers[r].iceGatherer;if(!a.onlocalcandidate){var s=this.transceivers[r].bufferedCandidateEvents;this.transceivers[r].bufferedCandidateEvents=null,a.removeEventListener("localcandidate",this.transceivers[r].bufferCandidates),a.onlocalcandidate=function(e){if(!(i.usingBundle&&r>0)){var s=new Event("icecandidate");s.candidate={sdpMid:t,sdpMLineIndex:r};var o=e.candidate,c=!o||0===Object.keys(o).length;if(c)"new"!==a.state&&"gathering"!==a.state||(a.state="completed");else{"new"===a.state&&(a.state="gathering"),o.component=1,o.ufrag=a.getLocalParameters().usernameFragment;var d=n.writeCandidate(o);s.candidate=Object.assign(s.candidate,n.parseCandidate(d)),s.candidate.candidate=d,s.candidate.toJSON=function(){return{candidate:s.candidate.candidate,sdpMid:s.candidate.sdpMid,sdpMLineIndex:s.candidate.sdpMLineIndex,usernameFragment:s.candidate.usernameFragment}}}var l=n.getMediaSections(i._localDescription.sdp);l[s.candidate.sdpMLineIndex]+=c?"a=end-of-candidates\r\n":"a="+s.candidate.candidate+"\r\n",i._localDescription.sdp=n.getDescription(i._localDescription.sdp)+l.join("");var u=i.transceivers.every((function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state}));"gathering"!==i.iceGatheringState&&(i.iceGatheringState="gathering",i._emitGatheringStateChange()),c||i._dispatchEvent("icecandidate",s),u&&(i._dispatchEvent("icecandidate",new Event("icecandidate")),i.iceGatheringState="complete",i._emitGatheringStateChange())}},e.setTimeout((function(){s.forEach((function(e){a.onlocalcandidate(e)}))}),0)}},l.prototype._createIceAndDtlsTransports=function(){var t=this,r=new e.RTCIceTransport(null);r.onicestatechange=function(){t._updateIceConnectionState(),t._updateConnectionState()};var n=new e.RTCDtlsTransport(r);return n.ondtlsstatechange=function(){t._updateConnectionState()},n.onerror=function(){Object.defineProperty(n,"state",{value:"failed",writable:!0}),t._updateConnectionState()},{iceTransport:r,dtlsTransport:n}},l.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var r=this.transceivers[e].iceTransport;r&&(delete r.onicestatechange,delete this.transceivers[e].iceTransport);var n=this.transceivers[e].dtlsTransport;n&&(delete n.ondtlsstatechange,delete n.onerror,delete this.transceivers[e].dtlsTransport)},l.prototype._transceive=function(e,r,i){var s=a(e.localCapabilities,e.remoteCapabilities);r&&e.rtpSender&&(s.encodings=e.sendEncodingParameters,s.rtcp={cname:n.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(s.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(s)),i&&e.rtpReceiver&&s.codecs.length>0&&("video"===e.kind&&e.recvEncodingParameters&&t<15019&&e.recvEncodingParameters.forEach((function(e){delete e.rtx})),e.recvEncodingParameters.length?s.encodings=e.recvEncodingParameters:s.encodings=[{}],s.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(s.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(s.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(s))},l.prototype.setLocalDescription=function(e){var t,r,i=this;if(-1===["offer","answer"].indexOf(e.type))return Promise.reject(c("TypeError",'Unsupported type "'+e.type+'"'));if(!s("setLocalDescription",e.type,i.signalingState)||i._isClosed)return Promise.reject(c("InvalidStateError","Can not set local "+e.type+" in state "+i.signalingState));if("offer"===e.type)t=n.splitSections(e.sdp),r=t.shift(),t.forEach((function(e,t){var r=n.parseRtpParameters(e);i.transceivers[t].localCapabilities=r})),i.transceivers.forEach((function(e,t){i._gather(e.mid,t)}));else if("answer"===e.type){t=n.splitSections(i._remoteDescription.sdp),r=t.shift();var o=n.matchPrefix(r,"a=ice-lite").length>0;t.forEach((function(e,t){var s=i.transceivers[t],c=s.iceGatherer,d=s.iceTransport,l=s.dtlsTransport,u=s.localCapabilities,p=s.remoteCapabilities;if(!(n.isRejected(e)&&0===n.matchPrefix(e,"a=bundle-only").length)&&!s.rejected){var h=n.getIceParameters(e,r),f=n.getDtlsParameters(e,r);o&&(f.role="server"),i.usingBundle&&0!==t||(i._gather(s.mid,t),"new"===d.state&&d.start(c,h,o?"controlling":"controlled"),"new"===l.state&&l.start(f));var m=a(u,p);i._transceive(s,m.codecs.length>0,!1)}}))}return i._localDescription={type:e.type,sdp:e.sdp},"offer"===e.type?i._updateSignalingState("have-local-offer"):i._updateSignalingState("stable"),Promise.resolve()},l.prototype.setRemoteDescription=function(i){var l=this;if(-1===["offer","answer"].indexOf(i.type))return Promise.reject(c("TypeError",'Unsupported type "'+i.type+'"'));if(!s("setRemoteDescription",i.type,l.signalingState)||l._isClosed)return Promise.reject(c("InvalidStateError","Can not set remote "+i.type+" in state "+l.signalingState));var u={};l.remoteStreams.forEach((function(e){u[e.id]=e}));var p=[],h=n.splitSections(i.sdp),f=h.shift(),m=n.matchPrefix(f,"a=ice-lite").length>0,g=n.matchPrefix(f,"a=group:BUNDLE ").length>0;l.usingBundle=g;var v=n.matchPrefix(f,"a=ice-options:")[0];return l.canTrickleIceCandidates=!!v&&v.substr(14).split(" ").indexOf("trickle")>=0,h.forEach((function(s,c){var d=n.splitLines(s),h=n.getKind(s),v=n.isRejected(s)&&0===n.matchPrefix(s,"a=bundle-only").length,y=d[0].substr(2).split(" ")[2],b=n.getDirection(s,f),_=n.parseMsid(s),w=n.getMid(s)||n.generateIdentifier();if(v||"application"===h&&("DTLS/SCTP"===y||"UDP/DTLS/SCTP"===y))l.transceivers[c]={mid:w,kind:h,protocol:y,rejected:!0};else{var S,C,k,R,T,P,E,D,O;!v&&l.transceivers[c]&&l.transceivers[c].rejected&&(l.transceivers[c]=l._createTransceiver(h,!0));var x,I,M=n.parseRtpParameters(s);v||(x=n.getIceParameters(s,f),(I=n.getDtlsParameters(s,f)).role="client"),E=n.parseRtpEncodingParameters(s);var L=n.parseRtcpParameters(s),j=n.matchPrefix(s,"a=end-of-candidates",f).length>0,A=n.matchPrefix(s,"a=candidate:").map((function(e){return n.parseCandidate(e)})).filter((function(e){return 1===e.component}));if(("offer"===i.type||"answer"===i.type)&&!v&&g&&c>0&&l.transceivers[c]&&(l._disposeIceAndDtlsTransports(c),l.transceivers[c].iceGatherer=l.transceivers[0].iceGatherer,l.transceivers[c].iceTransport=l.transceivers[0].iceTransport,l.transceivers[c].dtlsTransport=l.transceivers[0].dtlsTransport,l.transceivers[c].rtpSender&&l.transceivers[c].rtpSender.setTransport(l.transceivers[0].dtlsTransport),l.transceivers[c].rtpReceiver&&l.transceivers[c].rtpReceiver.setTransport(l.transceivers[0].dtlsTransport)),"offer"!==i.type||v){if("answer"===i.type&&!v){C=(S=l.transceivers[c]).iceGatherer,k=S.iceTransport,R=S.dtlsTransport,T=S.rtpReceiver,P=S.sendEncodingParameters,D=S.localCapabilities,l.transceivers[c].recvEncodingParameters=E,l.transceivers[c].remoteCapabilities=M,l.transceivers[c].rtcpParameters=L,A.length&&"new"===k.state&&(!m&&!j||g&&0!==c?A.forEach((function(e){o(S.iceTransport,e)})):k.setRemoteCandidates(A)),g&&0!==c||("new"===k.state&&k.start(C,x,"controlling"),"new"===R.state&&R.start(I)),!a(S.localCapabilities,S.remoteCapabilities).codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&S.sendEncodingParameters[0].rtx&&delete S.sendEncodingParameters[0].rtx,l._transceive(S,"sendrecv"===b||"recvonly"===b,"sendrecv"===b||"sendonly"===b),!T||"sendrecv"!==b&&"sendonly"!==b?delete S.rtpReceiver:(O=T.track,_?(u[_.stream]||(u[_.stream]=new e.MediaStream),r(O,u[_.stream]),p.push([O,T,u[_.stream]])):(u.default||(u.default=new e.MediaStream),r(O,u.default),p.push([O,T,u.default])))}}else{(S=l.transceivers[c]||l._createTransceiver(h)).mid=w,S.iceGatherer||(S.iceGatherer=l._createIceGatherer(c,g)),A.length&&"new"===S.iceTransport.state&&(!j||g&&0!==c?A.forEach((function(e){o(S.iceTransport,e)})):S.iceTransport.setRemoteCandidates(A)),D=e.RTCRtpReceiver.getCapabilities(h),t<15019&&(D.codecs=D.codecs.filter((function(e){return"rtx"!==e.name}))),P=S.sendEncodingParameters||[{ssrc:1001*(2*c+2)}];var N,F=!1;if("sendrecv"===b||"sendonly"===b){if(F=!S.rtpReceiver,T=S.rtpReceiver||new e.RTCRtpReceiver(S.dtlsTransport,h),F)O=T.track,_&&"-"===_.stream||(_?(u[_.stream]||(u[_.stream]=new e.MediaStream,Object.defineProperty(u[_.stream],"id",{get:function(){return _.stream}})),Object.defineProperty(O,"id",{get:function(){return _.track}}),N=u[_.stream]):(u.default||(u.default=new e.MediaStream),N=u.default)),N&&(r(O,N),S.associatedRemoteMediaStreams.push(N)),p.push([O,T,N])}else S.rtpReceiver&&S.rtpReceiver.track&&(S.associatedRemoteMediaStreams.forEach((function(t){var r=t.getTracks().find((function(e){return e.id===S.rtpReceiver.track.id}));r&&function(t,r){r.removeTrack(t),r.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:t}))}(r,t)})),S.associatedRemoteMediaStreams=[]);S.localCapabilities=D,S.remoteCapabilities=M,S.rtpReceiver=T,S.rtcpParameters=L,S.sendEncodingParameters=P,S.recvEncodingParameters=E,l._transceive(l.transceivers[c],!1,F)}}})),void 0===l._dtlsRole&&(l._dtlsRole="offer"===i.type?"active":"passive"),l._remoteDescription={type:i.type,sdp:i.sdp},"offer"===i.type?l._updateSignalingState("have-remote-offer"):l._updateSignalingState("stable"),Object.keys(u).forEach((function(t){var r=u[t];if(r.getTracks().length){if(-1===l.remoteStreams.indexOf(r)){l.remoteStreams.push(r);var n=new Event("addstream");n.stream=r,e.setTimeout((function(){l._dispatchEvent("addstream",n)}))}p.forEach((function(e){var t=e[0],n=e[1];r.id===e[2].id&&d(l,t,n,[r])}))}})),p.forEach((function(e){e[2]||d(l,e[0],e[1],[])})),e.setTimeout((function(){l&&l.transceivers&&l.transceivers.forEach((function(e){e.iceTransport&&"new"===e.iceTransport.state&&e.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))}))}),4e3),Promise.resolve()},l.prototype.close=function(){this.transceivers.forEach((function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()})),this._isClosed=!0,this._updateSignalingState("closed")},l.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)},l.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,e.setTimeout((function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}}),0))},l.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&!e.rejected&&t[e.iceTransport.state]++})),e="new",t.failed>0?e="failed":t.checking>0?e="checking":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0?e="connected":t.completed>0&&(e="completed"),e!==this.iceConnectionState){this.iceConnectionState=e;var r=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",r)}},l.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)})),t.connected+=t.completed,e="new",t.failed>0?e="failed":t.connecting>0?e="connecting":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0&&(e="connected"),e!==this.connectionState){this.connectionState=e;var r=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",r)}},l.prototype.createOffer=function(){var r=this;if(r._isClosed)return Promise.reject(c("InvalidStateError","Can not call createOffer after close"));var a=r.transceivers.filter((function(e){return"audio"===e.kind})).length,s=r.transceivers.filter((function(e){return"video"===e.kind})).length,o=arguments[0];if(o){if(o.mandatory||o.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==o.offerToReceiveAudio&&(a=!0===o.offerToReceiveAudio?1:!1===o.offerToReceiveAudio?0:o.offerToReceiveAudio),void 0!==o.offerToReceiveVideo&&(s=!0===o.offerToReceiveVideo?1:!1===o.offerToReceiveVideo?0:o.offerToReceiveVideo)}for(r.transceivers.forEach((function(e){"audio"===e.kind?--a<0&&(e.wantReceive=!1):"video"===e.kind&&--s<0&&(e.wantReceive=!1)}));a>0||s>0;)a>0&&(r._createTransceiver("audio"),a--),s>0&&(r._createTransceiver("video"),s--);var d=n.writeSessionBoilerplate(r._sdpSessionId,r._sdpSessionVersion++);r.transceivers.forEach((function(i,a){var s=i.track,o=i.kind,c=i.mid||n.generateIdentifier();i.mid=c,i.iceGatherer||(i.iceGatherer=r._createIceGatherer(a,r.usingBundle));var d=e.RTCRtpSender.getCapabilities(o);t<15019&&(d.codecs=d.codecs.filter((function(e){return"rtx"!==e.name}))),d.codecs.forEach((function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1"),i.remoteCapabilities&&i.remoteCapabilities.codecs&&i.remoteCapabilities.codecs.forEach((function(t){e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate&&(e.preferredPayloadType=t.payloadType)}))})),d.headerExtensions.forEach((function(e){(i.remoteCapabilities&&i.remoteCapabilities.headerExtensions||[]).forEach((function(t){e.uri===t.uri&&(e.id=t.id)}))}));var l=i.sendEncodingParameters||[{ssrc:1001*(2*a+1)}];s&&t>=15019&&"video"===o&&!l[0].rtx&&(l[0].rtx={ssrc:l[0].ssrc+1}),i.wantReceive&&(i.rtpReceiver=new e.RTCRtpReceiver(i.dtlsTransport,o)),i.localCapabilities=d,i.sendEncodingParameters=l})),"max-compat"!==r._config.bundlePolicy&&(d+="a=group:BUNDLE "+r.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),d+="a=ice-options:trickle\r\n",r.transceivers.forEach((function(e,t){d+=i(e,e.localCapabilities,"offer",e.stream,r._dtlsRole),d+="a=rtcp-rsize\r\n",!e.iceGatherer||"new"===r.iceGatheringState||0!==t&&r.usingBundle||(e.iceGatherer.getLocalCandidates().forEach((function(e){e.component=1,d+="a="+n.writeCandidate(e)+"\r\n"})),"completed"===e.iceGatherer.state&&(d+="a=end-of-candidates\r\n"))}));var l=new e.RTCSessionDescription({type:"offer",sdp:d});return Promise.resolve(l)},l.prototype.createAnswer=function(){var r=this;if(r._isClosed)return Promise.reject(c("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==r.signalingState&&"have-local-pranswer"!==r.signalingState)return Promise.reject(c("InvalidStateError","Can not call createAnswer in signalingState "+r.signalingState));var s=n.writeSessionBoilerplate(r._sdpSessionId,r._sdpSessionVersion++);r.usingBundle&&(s+="a=group:BUNDLE "+r.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),s+="a=ice-options:trickle\r\n";var o=n.getMediaSections(r._remoteDescription.sdp).length;r.transceivers.forEach((function(e,n){if(!(n+1>o)){if(e.rejected)return"application"===e.kind?"DTLS/SCTP"===e.protocol?s+="m=application 0 DTLS/SCTP 5000\r\n":s+="m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?s+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(s+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(s+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");var c;if(e.stream)"audio"===e.kind?c=e.stream.getAudioTracks()[0]:"video"===e.kind&&(c=e.stream.getVideoTracks()[0]),c&&t>=15019&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1});var d=a(e.localCapabilities,e.remoteCapabilities);!d.codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,s+=i(e,d,"answer",e.stream,r._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(s+="a=rtcp-rsize\r\n")}}));var d=new e.RTCSessionDescription({type:"answer",sdp:s});return Promise.resolve(d)},l.prototype.addIceCandidate=function(e){var t,r=this;return e&&void 0===e.sdpMLineIndex&&!e.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise((function(i,a){if(!r._remoteDescription)return a(c("InvalidStateError","Can not add ICE candidate without a remote description"));if(e&&""!==e.candidate){var s=e.sdpMLineIndex;if(e.sdpMid)for(var d=0;d<r.transceivers.length;d++)if(r.transceivers[d].mid===e.sdpMid){s=d;break}var l=r.transceivers[s];if(!l)return a(c("OperationError","Can not add ICE candidate"));if(l.rejected)return i();var u=Object.keys(e.candidate).length>0?n.parseCandidate(e.candidate):{};if("tcp"===u.protocol&&(0===u.port||9===u.port))return i();if(u.component&&1!==u.component)return i();if((0===s||s>0&&l.iceTransport!==r.transceivers[0].iceTransport)&&!o(l.iceTransport,u))return a(c("OperationError","Can not add ICE candidate"));var p=e.candidate.trim();0===p.indexOf("a=")&&(p=p.substr(2)),(t=n.getMediaSections(r._remoteDescription.sdp))[s]+="a="+(u.type?p:"end-of-candidates")+"\r\n",r._remoteDescription.sdp=n.getDescription(r._remoteDescription.sdp)+t.join("")}else for(var h=0;h<r.transceivers.length&&(r.transceivers[h].rejected||(r.transceivers[h].iceTransport.addRemoteCandidate({}),(t=n.getMediaSections(r._remoteDescription.sdp))[h]+="a=end-of-candidates\r\n",r._remoteDescription.sdp=n.getDescription(r._remoteDescription.sdp)+t.join(""),!r.usingBundle));h++);i()}))},l.prototype.getStats=function(t){if(t&&t instanceof e.MediaStreamTrack){var r=null;if(this.transceivers.forEach((function(e){e.rtpSender&&e.rtpSender.track===t?r=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(r=e.rtpReceiver)})),!r)throw c("InvalidAccessError","Invalid selector.");return r.getStats()}var n=[];return this.transceivers.forEach((function(e){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach((function(t){e[t]&&n.push(e[t].getStats())}))})),Promise.all(n).then((function(e){var t=new Map;return e.forEach((function(e){e.forEach((function(e){t.set(e.id,e)}))})),t}))};["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach((function(t){var r=e[t];if(r&&r.prototype&&r.prototype.getStats){var n=r.prototype.getStats;r.prototype.getStats=function(){return n.apply(this).then((function(e){var t=new Map;return Object.keys(e).forEach((function(r){var n;e[r].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[(n=e[r]).type]||n.type,t.set(r,e[r])})),t}))}}}));var u=["createOffer","createAnswer"];return u.forEach((function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"===typeof e[0]||"function"===typeof e[1]?t.apply(this,[arguments[2]]).then((function(t){"function"===typeof e[0]&&e[0].apply(null,[t])}),(function(t){"function"===typeof e[1]&&e[1].apply(null,[t])})):t.apply(this,arguments)}})),(u=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach((function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"===typeof e[1]||"function"===typeof e[2]?t.apply(this,arguments).then((function(){"function"===typeof e[1]&&e[1].apply(null)}),(function(t){"function"===typeof e[2]&&e[2].apply(null,[t])})):t.apply(this,arguments)}})),["getStats"].forEach((function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"===typeof e[1]?t.apply(this,arguments).then((function(){"function"===typeof e[1]&&e[1].apply(null)})):t.apply(this,arguments)}})),l}},6692:(e,t)=>{"use strict";function r(e,t){var r=e.length;e.push(t);e:for(;0<r;){var n=r-1>>>1,i=e[n];if(!(0<a(i,t)))break e;e[n]=t,e[r]=i,r=n}}function n(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],r=e.pop();if(r!==t){e[0]=r;e:for(var n=0,i=e.length,s=i>>>1;n<s;){var o=2*(n+1)-1,c=e[o],d=o+1,l=e[d];if(0>a(c,r))d<i&&0>a(l,c)?(e[n]=l,e[d]=r,n=d):(e[n]=c,e[o]=r,n=o);else{if(!(d<i&&0>a(l,r)))break e;e[n]=l,e[d]=r,n=d}}}return t}function a(e,t){var r=e.sortIndex-t.sortIndex;return 0!==r?r:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,c=o.now();t.unstable_now=function(){return o.now()-c}}var d=[],l=[],u=1,p=null,h=3,f=!1,m=!1,g=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function _(e){for(var t=n(l);null!==t;){if(null===t.callback)i(l);else{if(!(t.startTime<=e))break;i(l),t.sortIndex=t.expirationTime,r(d,t)}t=n(l)}}function w(e){if(g=!1,_(e),!m)if(null!==n(d))m=!0,M(S);else{var t=n(l);null!==t&&L(w,t.startTime-e)}}function S(e,r){m=!1,g&&(g=!1,y(T),T=-1),f=!0;var a=h;try{for(_(r),p=n(d);null!==p&&(!(p.expirationTime>r)||e&&!D());){var s=p.callback;if("function"===typeof s){p.callback=null,h=p.priorityLevel;var o=s(p.expirationTime<=r);r=t.unstable_now(),"function"===typeof o?p.callback=o:p===n(d)&&i(d),_(r)}else i(d);p=n(d)}if(null!==p)var c=!0;else{var u=n(l);null!==u&&L(w,u.startTime-r),c=!1}return c}finally{p=null,h=a,f=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var C,k=!1,R=null,T=-1,P=5,E=-1;function D(){return!(t.unstable_now()-E<P)}function O(){if(null!==R){var e=t.unstable_now();E=e;var r=!0;try{r=R(!0,e)}finally{r?C():(k=!1,R=null)}}else k=!1}if("function"===typeof b)C=function(){b(O)};else if("undefined"!==typeof MessageChannel){var x=new MessageChannel,I=x.port2;x.port1.onmessage=O,C=function(){I.postMessage(null)}}else C=function(){v(O,0)};function M(e){R=e,k||(k=!0,C())}function L(e,r){T=v((function(){e(t.unstable_now())}),r)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||f||(m=!0,M(S))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(d)},t.unstable_next=function(e){switch(h){case 1:case 2:case 3:var t=3;break;default:t=h}var r=h;h=t;try{return e()}finally{h=r}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=h;h=e;try{return t()}finally{h=r}},t.unstable_scheduleCallback=function(e,i,a){var s=t.unstable_now();switch("object"===typeof a&&null!==a?a="number"===typeof(a=a.delay)&&0<a?s+a:s:a=s,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:u++,callback:i,priorityLevel:e,startTime:a,expirationTime:o=a+o,sortIndex:-1},a>s?(e.sortIndex=a,r(l,e),null===n(d)&&e===n(l)&&(g?(y(T),T=-1):g=!0,L(w,a-s))):(e.sortIndex=o,r(d,e),m||f||(m=!0,M(S))),e},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(e){var t=h;return function(){var r=h;h=t;try{return e.apply(this,arguments)}finally{h=r}}}},7724:(e,t,r)=>{"use strict";e.exports=r(6692)},8991:e=>{var t=e.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=null!=e.raddr?" raddr %s rport %d":"%v%v",t+=null!=e.tcptype?" tcptype %s":"%v",null!=e.generation&&(t+=" generation %d"),t+=null!=e["network-id"]?" network-id %d":"%v",t+=null!=e["network-cost"]?" network-cost %d":"%v"}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return null!=e.attribute&&(t+=" %s",null!=e.value&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return null!=e.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(null!=e.clksrcExt?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var t="mediaclk:";return t+=null!=e.id?"id=%s %s":"%v%s",t+=null!=e.mediaClockValue?"=%s":"",t+=null!=e.rateNumerator?" rate=%s":"",t+=null!=e.rateDenominator?"/%s":""}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(t).forEach((function(e){t[e].forEach((function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")}))}))},7181:(e,t,r)=>{var n=r(8436),i=r(952);t.write=i,t.parse=n.parse,t.parseParams=n.parseParams,t.parseFmtpConfig=n.parseFmtpConfig,t.parsePayloads=n.parsePayloads,t.parseRemoteCandidates=n.parseRemoteCandidates,t.parseImageAttributes=n.parseImageAttributes,t.parseSimulcastStreamList=n.parseSimulcastStreamList},8436:(e,t,r)=>{var n=function(e){return String(Number(e))===e?Number(e):e},i=function(e,t,r){var i=e.name&&e.names;e.push&&!t[e.push]?t[e.push]=[]:i&&!t[e.name]&&(t[e.name]={});var a=e.push?{}:i?t[e.name]:t;!function(e,t,r,i){if(i&&!r)t[i]=n(e[1]);else for(var a=0;a<r.length;a+=1)null!=e[a+1]&&(t[r[a]]=n(e[a+1]))}(r.match(e.reg),a,e.names,e.name),e.push&&t[e.push].push(a)},a=r(8991),s=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(e){var t={},r=[],n=t;return e.split(/(\r\n|\r|\n)/).filter(s).forEach((function(e){var t=e[0],s=e.slice(2);"m"===t&&(r.push({rtp:[],fmtp:[]}),n=r[r.length-1]);for(var o=0;o<(a[t]||[]).length;o+=1){var c=a[t][o];if(c.reg.test(s))return i(c,n,s)}})),t.media=r,t};var o=function(e,t){var r=t.split(/=(.+)/,2);return 2===r.length?e[r[0]]=n(r[1]):1===r.length&&t.length>1&&(e[r[0]]=void 0),e};t.parseParams=function(e){return e.split(/;\s?/).reduce(o,{})},t.parseFmtpConfig=t.parseParams,t.parsePayloads=function(e){return e.toString().split(" ").map(Number)},t.parseRemoteCandidates=function(e){for(var t=[],r=e.split(" ").map(n),i=0;i<r.length;i+=3)t.push({component:r[i],ip:r[i+1],port:r[i+2]});return t},t.parseImageAttributes=function(e){return e.split(" ").map((function(e){return e.substring(1,e.length-1).split(",").reduce(o,{})}))},t.parseSimulcastStreamList=function(e){return e.split(";").map((function(e){return e.split(",").map((function(e){var t,r=!1;return"~"!==e[0]?t=n(e):(t=n(e.substring(1,e.length)),r=!0),{scid:t,paused:r}}))}))}},952:(e,t,r)=>{var n=r(8991),i=/%[sdv%]/g,a=function(e){var t=1,r=arguments,n=r.length;return e.replace(i,(function(e){if(t>=n)return e;var i=r[t];switch(t+=1,e){case"%%":return"%";case"%s":return String(i);case"%d":return Number(i);case"%v":return""}}))},s=function(e,t,r){var n=[e+"="+(t.format instanceof Function?t.format(t.push?r:r[t.name]):t.format)];if(t.names)for(var i=0;i<t.names.length;i+=1){var s=t.names[i];t.name?n.push(r[t.name][s]):n.push(r[t.names[i]])}else n.push(r[t.name]);return a.apply(null,n)},o=["v","o","s","i","u","e","p","c","b","t","r","z","a"],c=["i","c","b","a"];e.exports=function(e,t){t=t||{},null==e.version&&(e.version=0),null==e.name&&(e.name=" "),e.media.forEach((function(e){null==e.payloads&&(e.payloads="")}));var r=t.outerOrder||o,i=t.innerOrder||c,a=[];return r.forEach((function(t){n[t].forEach((function(r){r.name in e&&null!=e[r.name]?a.push(s(t,r,e)):r.push in e&&null!=e[r.push]&&e[r.push].forEach((function(e){a.push(s(t,r,e))}))}))})),e.media.forEach((function(e){a.push(s("m",n.m[0],e)),i.forEach((function(t){n[t].forEach((function(r){r.name in e&&null!=e[r.name]?a.push(s(t,r,e)):r.push in e&&null!=e[r.push]&&e[r.push].forEach((function(e){a.push(s(t,r,e))}))}))}))})),a.join("\r\n")+"\r\n"}},2232:e=>{"use strict";var t={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};t.localCName=t.generateIdentifier(),t.splitLines=function(e){return e.trim().split("\n").map((function(e){return e.trim()}))},t.splitSections=function(e){return e.split("\nm=").map((function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"}))},t.getDescription=function(e){var r=t.splitSections(e);return r&&r[0]},t.getMediaSections=function(e){var r=t.splitSections(e);return r.shift(),r},t.matchPrefix=function(e,r){return t.splitLines(e).filter((function(e){return 0===e.indexOf(r)}))},t.parseCandidate=function(e){for(var t,r={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},n=8;n<t.length;n+=2)switch(t[n]){case"raddr":r.relatedAddress=t[n+1];break;case"rport":r.relatedPort=parseInt(t[n+1],10);break;case"tcptype":r.tcpType=t[n+1];break;case"ufrag":r.ufrag=t[n+1],r.usernameFragment=t[n+1];break;default:r[t[n]]=t[n+1]}return r},t.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var r=e.type;return t.push("typ"),t.push(r),"host"!==r&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},t.parseIceOptions=function(e){return e.substr(14).split(" ")},t.parseRtpMap=function(e){var t=e.substr(9).split(" "),r={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),r.name=t[0],r.clockRate=parseInt(t[1],10),r.channels=3===t.length?parseInt(t[2],10):1,r.numChannels=r.channels,r},t.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var r=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==r?"/"+r:"")+"\r\n"},t.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},t.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},t.parseFmtp=function(e){for(var t,r={},n=e.substr(e.indexOf(" ")+1).split(";"),i=0;i<n.length;i++)r[(t=n[i].trim().split("="))[0].trim()]=t[1];return r},t.writeFmtp=function(e){var t="",r=e.payloadType;if(void 0!==e.preferredPayloadType&&(r=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var n=[];Object.keys(e.parameters).forEach((function(t){e.parameters[t]?n.push(t+"="+e.parameters[t]):n.push(t)})),t+="a=fmtp:"+r+" "+n.join(";")+"\r\n"}return t},t.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},t.writeRtcpFb=function(e){var t="",r=e.payloadType;return void 0!==e.preferredPayloadType&&(r=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((function(e){t+="a=rtcp-fb:"+r+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},t.parseSsrcMedia=function(e){var t=e.indexOf(" "),r={ssrc:parseInt(e.substr(7,t-7),10)},n=e.indexOf(":",t);return n>-1?(r.attribute=e.substr(t+1,n-t-1),r.value=e.substr(n+1)):r.attribute=e.substr(t+1),r},t.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((function(e){return parseInt(e,10)}))}},t.getMid=function(e){var r=t.matchPrefix(e,"a=mid:")[0];if(r)return r.substr(6)},t.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},t.getDtlsParameters=function(e,r){return{role:"auto",fingerprints:t.matchPrefix(e+r,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(e,t){var r="a=setup:"+t+"\r\n";return e.fingerprints.forEach((function(e){r+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),r},t.parseCryptoLine=function(e){var t=e.substr(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},t.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"===typeof e.keyParams?t.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},t.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;var t=e.substr(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},t.getCryptoParameters=function(e,r){return t.matchPrefix(e+r,"a=crypto:").map(t.parseCryptoLine)},t.getIceParameters=function(e,r){var n=t.matchPrefix(e+r,"a=ice-ufrag:")[0],i=t.matchPrefix(e+r,"a=ice-pwd:")[0];return n&&i?{usernameFragment:n.substr(12),password:i.substr(10)}:null},t.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},t.parseRtpParameters=function(e){for(var r={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=t.splitLines(e)[0].split(" "),i=3;i<n.length;i++){var a=n[i],s=t.matchPrefix(e,"a=rtpmap:"+a+" ")[0];if(s){var o=t.parseRtpMap(s),c=t.matchPrefix(e,"a=fmtp:"+a+" ");switch(o.parameters=c.length?t.parseFmtp(c[0]):{},o.rtcpFeedback=t.matchPrefix(e,"a=rtcp-fb:"+a+" ").map(t.parseRtcpFb),r.codecs.push(o),o.name.toUpperCase()){case"RED":case"ULPFEC":r.fecMechanisms.push(o.name.toUpperCase())}}}return t.matchPrefix(e,"a=extmap:").forEach((function(e){r.headerExtensions.push(t.parseExtmap(e))})),r},t.writeRtpDescription=function(e,r){var n="";n+="m="+e+" ",n+=r.codecs.length>0?"9":"0",n+=" UDP/TLS/RTP/SAVPF ",n+=r.codecs.map((function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType})).join(" ")+"\r\n",n+="c=IN IP4 0.0.0.0\r\n",n+="a=rtcp:9 IN IP4 0.0.0.0\r\n",r.codecs.forEach((function(e){n+=t.writeRtpMap(e),n+=t.writeFmtp(e),n+=t.writeRtcpFb(e)}));var i=0;return r.codecs.forEach((function(e){e.maxptime>i&&(i=e.maxptime)})),i>0&&(n+="a=maxptime:"+i+"\r\n"),n+="a=rtcp-mux\r\n",r.headerExtensions&&r.headerExtensions.forEach((function(e){n+=t.writeExtmap(e)})),n},t.parseRtpEncodingParameters=function(e){var r,n=[],i=t.parseRtpParameters(e),a=-1!==i.fecMechanisms.indexOf("RED"),s=-1!==i.fecMechanisms.indexOf("ULPFEC"),o=t.matchPrefix(e,"a=ssrc:").map((function(e){return t.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute})),c=o.length>0&&o[0].ssrc,d=t.matchPrefix(e,"a=ssrc-group:FID").map((function(e){return e.substr(17).split(" ").map((function(e){return parseInt(e,10)}))}));d.length>0&&d[0].length>1&&d[0][0]===c&&(r=d[0][1]),i.codecs.forEach((function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var t={ssrc:c,codecPayloadType:parseInt(e.parameters.apt,10)};c&&r&&(t.rtx={ssrc:r}),n.push(t),a&&((t=JSON.parse(JSON.stringify(t))).fec={ssrc:c,mechanism:s?"red+ulpfec":"red"},n.push(t))}})),0===n.length&&c&&n.push({ssrc:c});var l=t.matchPrefix(e,"b=");return l.length&&(l=0===l[0].indexOf("b=TIAS:")?parseInt(l[0].substr(7),10):0===l[0].indexOf("b=AS:")?1e3*parseInt(l[0].substr(5),10)*.95-16e3:void 0,n.forEach((function(e){e.maxBitrate=l}))),n},t.parseRtcpParameters=function(e){var r={},n=t.matchPrefix(e,"a=ssrc:").map((function(e){return t.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute}))[0];n&&(r.cname=n.value,r.ssrc=n.ssrc);var i=t.matchPrefix(e,"a=rtcp-rsize");r.reducedSize=i.length>0,r.compound=0===i.length;var a=t.matchPrefix(e,"a=rtcp-mux");return r.mux=a.length>0,r},t.parseMsid=function(e){var r,n=t.matchPrefix(e,"a=msid:");if(1===n.length)return{stream:(r=n[0].substr(7).split(" "))[0],track:r[1]};var i=t.matchPrefix(e,"a=ssrc:").map((function(e){return t.parseSsrcMedia(e)})).filter((function(e){return"msid"===e.attribute}));return i.length>0?{stream:(r=i[0].value.split(" "))[0],track:r[1]}:void 0},t.parseSctpDescription=function(e){var r,n=t.parseMLine(e),i=t.matchPrefix(e,"a=max-message-size:");i.length>0&&(r=parseInt(i[0].substr(19),10)),isNaN(r)&&(r=65536);var a=t.matchPrefix(e,"a=sctp-port:");if(a.length>0)return{port:parseInt(a[0].substr(12),10),protocol:n.fmt,maxMessageSize:r};if(t.matchPrefix(e,"a=sctpmap:").length>0){var s=t.matchPrefix(e,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(s[0],10),protocol:s[1],maxMessageSize:r}}},t.writeSctpDescription=function(e,t){var r=[];return r="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&r.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),r.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,21)},t.writeSessionBoilerplate=function(e,r,n){var i=void 0!==r?r:2;return"v=0\r\no="+(n||"thisisadapterortc")+" "+(e||t.generateSessionId())+" "+i+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},t.writeMediaSection=function(e,r,n,i){var a=t.writeRtpDescription(e.kind,r);if(a+=t.writeIceParameters(e.iceGatherer.getLocalParameters()),a+=t.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":"active"),a+="a=mid:"+e.mid+"\r\n",e.direction?a+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?a+="a=sendrecv\r\n":e.rtpSender?a+="a=sendonly\r\n":e.rtpReceiver?a+="a=recvonly\r\n":a+="a=inactive\r\n",e.rtpSender){var s="msid:"+i.id+" "+e.rtpSender.track.id+"\r\n";a+="a="+s,a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+s,e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+s,a+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+t.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+t.localCName+"\r\n"),a},t.getDirection=function(e,r){for(var n=t.splitLines(e),i=0;i<n.length;i++)switch(n[i]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[i].substr(2)}return r?t.getDirection(r):"sendrecv"},t.getKind=function(e){return t.splitLines(e)[0].split(" ")[0].substr(2)},t.isRejected=function(e){return"0"===e.split(" ",2)[1]},t.parseMLine=function(e){var r=t.splitLines(e)[0].substr(2).split(" ");return{kind:r[0],port:parseInt(r[1],10),protocol:r[2],fmt:r.slice(3).join(" ")}},t.parseOLine=function(e){var r=t.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:r[0],sessionId:r[1],sessionVersion:parseInt(r[2],10),netType:r[3],addressType:r[4],address:r[5]}},t.isValidSDP=function(e){if("string"!==typeof e||0===e.length)return!1;for(var r=t.splitLines(e),n=0;n<r.length;n++)if(r[n].length<2||"="!==r[n].charAt(1))return!1;return!0},e.exports=t},6016:function(e,t,r){var n;!function(i,a){"use strict";var s="function",o="undefined",c="object",d="string",l="major",u="model",p="name",h="type",f="vendor",m="version",g="architecture",v="console",y="mobile",b="tablet",_="smarttv",w="wearable",S="embedded",C="Amazon",k="Apple",R="ASUS",T="BlackBerry",P="Browser",E="Chrome",D="Firefox",O="Google",x="Huawei",I="LG",M="Microsoft",L="Motorola",j="Opera",A="Samsung",N="Sharp",F="Sony",z="Xiaomi",B="Zebra",U="Facebook",V="Chromium OS",q="Mac OS",W=function(e){for(var t={},r=0;r<e.length;r++)t[e[r].toUpperCase()]=e[r];return t},H=function(e,t){return typeof e===d&&-1!==G(t).indexOf(G(e))},G=function(e){return e.toLowerCase()},K=function(e,t){if(typeof e===d)return e=e.replace(/^\s\s*/,""),typeof t===o?e:e.substring(0,500)},J=function(e,t){for(var r,n,i,o,d,l,u=0;u<t.length&&!d;){var p=t[u],h=t[u+1];for(r=n=0;r<p.length&&!d&&p[r];)if(d=p[r++].exec(e))for(i=0;i<h.length;i++)l=d[++n],typeof(o=h[i])===c&&o.length>0?2===o.length?typeof o[1]==s?this[o[0]]=o[1].call(this,l):this[o[0]]=o[1]:3===o.length?typeof o[1]!==s||o[1].exec&&o[1].test?this[o[0]]=l?l.replace(o[1],o[2]):a:this[o[0]]=l?o[1].call(this,l,o[2]):a:4===o.length&&(this[o[0]]=l?o[3].call(this,l.replace(o[1],o[2])):a):this[o]=l||a;u+=2}},$=function(e,t){for(var r in t)if(typeof t[r]===c&&t[r].length>0){for(var n=0;n<t[r].length;n++)if(H(t[r][n],e))return"?"===r?a:r}else if(H(t[r],e))return"?"===r?a:r;return e},Q={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},X={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[m,[p,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[m,[p,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[p,m],[/opios[\/ ]+([\w\.]+)/i],[m,[p,j+" Mini"]],[/\bopr\/([\w\.]+)/i],[m,[p,j]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[m,[p,"Baidu"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim)\s?(?:browser)?[\/ ]?([\w\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[p,m],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[m,[p,"UC"+P]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[m,[p,"WeChat"]],[/konqueror\/([\w\.]+)/i],[m,[p,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[m,[p,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[m,[p,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[m,[p,"Smart Lenovo "+P]],[/(avast|avg)\/([\w\.]+)/i],[[p,/(.+)/,"$1 Secure "+P],m],[/\bfocus\/([\w\.]+)/i],[m,[p,D+" Focus"]],[/\bopt\/([\w\.]+)/i],[m,[p,j+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[m,[p,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[m,[p,"Dolphin"]],[/coast\/([\w\.]+)/i],[m,[p,j+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[m,[p,"MIUI "+P]],[/fxios\/([-\w\.]+)/i],[m,[p,D]],[/\bqihu|(qi?ho?o?|360)browser/i],[[p,"360 "+P]],[/(oculus|sailfish|huawei|vivo)browser\/([\w\.]+)/i],[[p,/(.+)/,"$1 "+P],m],[/samsungbrowser\/([\w\.]+)/i],[m,[p,A+" Internet"]],[/(comodo_dragon)\/([\w\.]+)/i],[[p,/_/g," "],m],[/metasr[\/ ]?([\d\.]+)/i],[m,[p,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[p,"Sogou Mobile"],m],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345Explorer)[\/ ]?([\w\.]+)/i],[p,m],[/(lbbrowser)/i,/\[(linkedin)app\]/i],[p],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[p,U],m],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[p,m],[/\bgsa\/([\w\.]+) .*safari\//i],[m,[p,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[m,[p,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[m,[p,E+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[p,E+" WebView"],m],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[m,[p,"Android "+P]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[p,m],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[m,[p,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[m,p],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[p,[m,$,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[p,m],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[p,"Netscape"],m],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[m,[p,D+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[p,m],[/(cobalt)\/([\w\.]+)/i],[p,[m,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[g,"amd64"]],[/(ia32(?=;))/i],[[g,G]],[/((?:i[346]|x)86)[;\)]/i],[[g,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[g,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[g,"armhf"]],[/windows (ce|mobile); ppc;/i],[[g,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[g,/ower/,"",G]],[/(sun4\w)[;\)]/i],[[g,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[g,G]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[u,[f,A],[h,b]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[u,[f,A],[h,y]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[u,[f,k],[h,y]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[u,[f,k],[h,b]],[/(macintosh);/i],[u,[f,k]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[u,[f,N],[h,y]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[u,[f,x],[h,b]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[u,[f,x],[h,y]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[u,/_/g," "],[f,z],[h,y]],[/oid[^\)]+; (2\d{4}(283|rpbf)[cgl])( bui|\))/i,/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[u,/_/g," "],[f,z],[h,b]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[u,[f,"OPPO"],[h,y]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[u,[f,"Vivo"],[h,y]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[u,[f,"Realme"],[h,y]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[u,[f,L],[h,y]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[u,[f,L],[h,b]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[u,[f,I],[h,b]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[u,[f,I],[h,y]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[u,[f,"Lenovo"],[h,b]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[u,/_/g," "],[f,"Nokia"],[h,y]],[/(pixel c)\b/i],[u,[f,O],[h,b]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[u,[f,O],[h,y]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[u,[f,F],[h,y]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[u,"Xperia Tablet"],[f,F],[h,b]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[u,[f,"OnePlus"],[h,y]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[u,[f,C],[h,b]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[u,/(.+)/g,"Fire Phone $1"],[f,C],[h,y]],[/(playbook);[-\w\),; ]+(rim)/i],[u,f,[h,b]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[u,[f,T],[h,y]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[u,[f,R],[h,b]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[u,[f,R],[h,y]],[/(nexus 9)/i],[u,[f,"HTC"],[h,b]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[f,[u,/_/g," "],[h,y]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[u,[f,"Acer"],[h,b]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[u,[f,"Meizu"],[h,y]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[u,[f,"Ulefone"],[h,y]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron|infinix|tecno)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[f,u,[h,y]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[f,u,[h,b]],[/(surface duo)/i],[u,[f,M],[h,b]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[u,[f,"Fairphone"],[h,y]],[/(u304aa)/i],[u,[f,"AT&T"],[h,y]],[/\bsie-(\w*)/i],[u,[f,"Siemens"],[h,y]],[/\b(rct\w+) b/i],[u,[f,"RCA"],[h,b]],[/\b(venue[\d ]{2,7}) b/i],[u,[f,"Dell"],[h,b]],[/\b(q(?:mv|ta)\w+) b/i],[u,[f,"Verizon"],[h,b]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[u,[f,"Barnes & Noble"],[h,b]],[/\b(tm\d{3}\w+) b/i],[u,[f,"NuVision"],[h,b]],[/\b(k88) b/i],[u,[f,"ZTE"],[h,b]],[/\b(nx\d{3}j) b/i],[u,[f,"ZTE"],[h,y]],[/\b(gen\d{3}) b.+49h/i],[u,[f,"Swiss"],[h,y]],[/\b(zur\d{3}) b/i],[u,[f,"Swiss"],[h,b]],[/\b((zeki)?tb.*\b) b/i],[u,[f,"Zeki"],[h,b]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[f,"Dragon Touch"],u,[h,b]],[/\b(ns-?\w{0,9}) b/i],[u,[f,"Insignia"],[h,b]],[/\b((nxa|next)-?\w{0,9}) b/i],[u,[f,"NextBook"],[h,b]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[f,"Voice"],u,[h,y]],[/\b(lvtel\-)?(v1[12]) b/i],[[f,"LvTel"],u,[h,y]],[/\b(ph-1) /i],[u,[f,"Essential"],[h,y]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[u,[f,"Envizen"],[h,b]],[/\b(trio[-\w\. ]+) b/i],[u,[f,"MachSpeed"],[h,b]],[/\btu_(1491) b/i],[u,[f,"Rotor"],[h,b]],[/(shield[\w ]+) b/i],[u,[f,"Nvidia"],[h,b]],[/(sprint) (\w+)/i],[f,u,[h,y]],[/(kin\.[onetw]{3})/i],[[u,/\./g," "],[f,M],[h,y]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[u,[f,B],[h,b]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[u,[f,B],[h,y]],[/smart-tv.+(samsung)/i],[f,[h,_]],[/hbbtv.+maple;(\d+)/i],[[u,/^/,"SmartTV"],[f,A],[h,_]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[f,I],[h,_]],[/(apple) ?tv/i],[f,[u,k+" TV"],[h,_]],[/crkey/i],[[u,E+"cast"],[f,O],[h,_]],[/droid.+aft(\w+)( bui|\))/i],[u,[f,C],[h,_]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[u,[f,N],[h,_]],[/(bravia[\w ]+)( bui|\))/i],[u,[f,F],[h,_]],[/(mitv-\w{5}) bui/i],[u,[f,z],[h,_]],[/Hbbtv.*(technisat) (.*);/i],[f,u,[h,_]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[f,K],[u,K],[h,_]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[h,_]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[f,u,[h,v]],[/droid.+; (shield) bui/i],[u,[f,"Nvidia"],[h,v]],[/(playstation [345portablevi]+)/i],[u,[f,F],[h,v]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[u,[f,M],[h,v]],[/((pebble))app/i],[f,u,[h,w]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[u,[f,k],[h,w]],[/droid.+; (glass) \d/i],[u,[f,O],[h,w]],[/droid.+; (wt63?0{2,3})\)/i],[u,[f,B],[h,w]],[/(quest( 2| pro)?)/i],[u,[f,U],[h,w]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[f,[h,S]],[/(aeobc)\b/i],[u,[f,C],[h,S]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[u,[h,y]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[u,[h,b]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[h,b]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[h,y]],[/(android[-\w\. ]{0,9});.+buil/i],[u,[f,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[m,[p,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[m,[p,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[p,m],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[m,p]],os:[[/microsoft (windows) (vista|xp)/i],[p,m],[/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i],[p,[m,$,Q]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[m,$,Q],[p,"Windows"]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[m,/_/g,"."],[p,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[p,q],[m,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[m,p],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[p,m],[/\(bb(10);/i],[m,[p,T]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[m,[p,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[m,[p,D+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[m,[p,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[m,[p,"watchOS"]],[/crkey\/([\d\.]+)/i],[m,[p,E+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[p,V],m],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[p,m],[/(sunos) ?([\w\.\d]*)/i],[[p,"Solaris"],m],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[p,m]]},Y=function(e,t){if(typeof e===c&&(t=e,e=a),!(this instanceof Y))return new Y(e,t).getResult();var r=typeof i!==o&&i.navigator?i.navigator:a,n=e||(r&&r.userAgent?r.userAgent:""),v=r&&r.userAgentData?r.userAgentData:a,_=t?function(e,t){var r={};for(var n in e)t[n]&&t[n].length%2===0?r[n]=t[n].concat(e[n]):r[n]=e[n];return r}(X,t):X,w=r&&r.userAgent==n;return this.getBrowser=function(){var e,t={};return t[p]=a,t[m]=a,J.call(t,n,_.browser),t[l]=typeof(e=t[m])===d?e.replace(/[^\d\.]/g,"").split(".")[0]:a,w&&r&&r.brave&&typeof r.brave.isBrave==s&&(t[p]="Brave"),t},this.getCPU=function(){var e={};return e[g]=a,J.call(e,n,_.cpu),e},this.getDevice=function(){var e={};return e[f]=a,e[u]=a,e[h]=a,J.call(e,n,_.device),w&&!e[h]&&v&&v.mobile&&(e[h]=y),w&&"Macintosh"==e[u]&&r&&typeof r.standalone!==o&&r.maxTouchPoints&&r.maxTouchPoints>2&&(e[u]="iPad",e[h]=b),e},this.getEngine=function(){var e={};return e[p]=a,e[m]=a,J.call(e,n,_.engine),e},this.getOS=function(){var e={};return e[p]=a,e[m]=a,J.call(e,n,_.os),w&&!e[p]&&v&&"Unknown"!=v.platform&&(e[p]=v.platform.replace(/chrome os/i,V).replace(/macos/i,q)),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return n},this.setUA=function(e){return n=typeof e===d&&e.length>500?K(e,500):e,this},this.setUA(n),this};Y.VERSION="1.0.37",Y.BROWSER=W([p,m,l]),Y.CPU=W([g]),Y.DEVICE=W([u,f,h,v,y,_,b,w,S]),Y.ENGINE=Y.OS=W([p,m]),typeof t!==o?(e.exports&&(t=e.exports=Y),t.UAParser=Y):r.amdO?(n=function(){return Y}.call(t,r,t,e))===a||(e.exports=n):typeof i!==o&&(i.UAParser=Y);var Z=typeof i!==o&&(i.jQuery||i.Zepto);if(Z&&!Z.ua){var ee=new Y;Z.ua=ee.getResult(),Z.ua.get=function(){return ee.getUA()},Z.ua.set=function(e){ee.setUA(e);var t=ee.getResult();for(var r in t)Z.ua[r]=t[r]}}}("object"===typeof window?window:this)}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var a=t[n]={exports:{}};return e[n].call(a.exports,a,a.exports,r),a.exports}r.amdO={},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";var e={};r.r(e),r.d(e,{Decoder:()=>Wr,Encoder:()=>Vr,PacketType:()=>Ur,protocol:()=>Br});var t={};r.r(t),r.d(t,{fixNegotiationNeeded:()=>Cn,shimAddTrackRemoveTrack:()=>wn,shimAddTrackRemoveTrackWithNative:()=>_n,shimGetDisplayMedia:()=>fn,shimGetSendersWithDtmf:()=>vn,shimGetStats:()=>yn,shimGetUserMedia:()=>hn,shimMediaStream:()=>mn,shimOnTrack:()=>gn,shimPeerConnection:()=>Sn,shimSenderReceiverGetStats:()=>bn});var n={};r.r(n),r.d(n,{shimGetDisplayMedia:()=>Pn,shimGetUserMedia:()=>Tn,shimPeerConnection:()=>En,shimReplaceTrack:()=>Dn});var i={};r.r(i),r.d(i,{shimAddTransceiver:()=>Fn,shimCreateAnswer:()=>Un,shimCreateOffer:()=>Bn,shimGetDisplayMedia:()=>xn,shimGetParameters:()=>zn,shimGetUserMedia:()=>On,shimOnTrack:()=>In,shimPeerConnection:()=>Mn,shimRTCDataChannel:()=>Nn,shimReceiverGetStats:()=>jn,shimRemoveStream:()=>An,shimSenderGetStats:()=>Ln});var a={};r.r(a),r.d(a,{shimAudioContext:()=>Qn,shimCallbacksAPI:()=>Wn,shimConstraints:()=>Gn,shimCreateOfferLegacy:()=>$n,shimGetUserMedia:()=>Hn,shimLocalStreamsAPI:()=>Vn,shimRTCIceServerUrls:()=>Kn,shimRemoteStreamsAPI:()=>qn,shimTrackEventTransceiver:()=>Jn});var s={};r.r(s),r.d(s,{removeExtmapAllowMixed:()=>ni,shimAddIceCandidateNullOrEmpty:()=>ii,shimConnectionState:()=>ri,shimMaxMessageSize:()=>ei,shimRTCIceCandidate:()=>Zn,shimSendThrowTypeError:()=>ti});var o={};r.r(o),r.d(o,{hasBrowserEnv:()=>ya,hasStandardBrowserEnv:()=>ba,hasStandardBrowserWebWorkerEnv:()=>wa});var c=r(9060),d=r(1180);function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function u(e){var t=function(e,t){if("object"!=l(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==l(t)?t:String(t)}function p(e,t,r){return(t=u(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var h=Symbol.for("immer-nothing"),f=Symbol.for("immer-draftable"),m=Symbol.for("immer-state");function g(e){throw new Error("[Immer] minified error nr: ".concat(e,". Full error at: https://bit.ly/3cXEKWf"))}var v=Object.getPrototypeOf;function y(e){return!!e&&!!e[m]}function b(e){var t;return!!e&&(w(e)||Array.isArray(e)||!!e[f]||!(null===(t=e.constructor)||void 0===t||!t[f])||T(e)||P(e))}var _=Object.prototype.constructor.toString();function w(e){if(!e||"object"!==typeof e)return!1;const t=v(e);if(null===t)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object||"function"==typeof r&&Function.toString.call(r)===_}function S(e,t){0===C(e)?Object.entries(e).forEach((r=>{let[n,i]=r;t(n,i,e)})):e.forEach(((r,n)=>t(n,r,e)))}function C(e){const t=e[m];return t?t.type_:Array.isArray(e)?1:T(e)?2:P(e)?3:0}function k(e,t){return 2===C(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function R(e,t,r){const n=C(e);2===n?e.set(t,r):3===n?e.add(r):e[t]=r}function T(e){return e instanceof Map}function P(e){return e instanceof Set}function E(e){return e.copy_||e.base_}function D(e,t){if(T(e))return new Map(e);if(P(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);if(!t&&w(e)){if(!v(e)){const t=Object.create(null);return Object.assign(t,e)}return{...e}}const r=Object.getOwnPropertyDescriptors(e);delete r[m];let n=Reflect.ownKeys(r);for(let i=0;i<n.length;i++){const t=n[i],a=r[t];!1===a.writable&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(r[t]={configurable:!0,writable:!0,enumerable:a.enumerable,value:e[t]})}return Object.create(v(e),r)}function O(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return I(e)||y(e)||!b(e)||(C(e)>1&&(e.set=e.add=e.clear=e.delete=x),Object.freeze(e),t&&S(e,((e,t)=>O(t,!0)))),e}function x(){g(2)}function I(e){return Object.isFrozen(e)}var M,L={};function j(e){const t=L[e];return t||g(0),t}function A(){return M}function N(e,t){t&&(j("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function F(e){z(e),e.drafts_.forEach(U),e.drafts_=null}function z(e){e===M&&(M=e.parent_)}function B(e){return M={drafts_:[],parent_:M,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function U(e){const t=e[m];0===t.type_||1===t.type_?t.revoke_():t.revoked_=!0}function V(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return void 0!==e&&e!==r?(r[m].modified_&&(F(t),g(4)),b(e)&&(e=q(t,e),t.parent_||H(t,e)),t.patches_&&j("Patches").generateReplacementPatches_(r[m].base_,e,t.patches_,t.inversePatches_)):e=q(t,r,[]),F(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==h?e:void 0}function q(e,t,r){if(I(t))return t;const n=t[m];if(!n)return S(t,((i,a)=>W(e,n,t,i,a,r))),t;if(n.scope_!==e)return t;if(!n.modified_)return H(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const t=n.copy_;let i=t,a=!1;3===n.type_&&(i=new Set(t),t.clear(),a=!0),S(i,((i,s)=>W(e,n,t,i,s,r,a))),H(e,t,!1),r&&e.patches_&&j("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function W(e,t,r,n,i,a,s){if(y(i)){const s=q(e,i,a&&t&&3!==t.type_&&!k(t.assigned_,n)?a.concat(n):void 0);if(R(r,n,s),!y(s))return;e.canAutoFreeze_=!1}else s&&r.add(i);if(b(i)&&!I(i)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;q(e,i),t&&t.scope_.parent_||H(e,i)}}function H(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&O(t,r)}var G={get(e,t){if(t===m)return e;const r=E(e);if(!k(r,t))return function(e,t,r){var n;const i=$(t,r);return i?"value"in i?i.value:null===(n=i.get)||void 0===n?void 0:n.call(e.draft_):void 0}(e,r,t);const n=r[t];return e.finalized_||!b(n)?n:n===J(e.base_,t)?(X(e),e.copy_[t]=Y(n,e)):n},has:(e,t)=>t in E(e),ownKeys:e=>Reflect.ownKeys(E(e)),set(e,t,r){const n=$(E(e),t);if(null!==n&&void 0!==n&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const n=J(E(e),t),s=null===n||void 0===n?void 0:n[m];if(s&&s.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(((i=r)===(a=n)?0!==i||1/i===1/a:i!==i&&a!==a)&&(void 0!==r||k(e.base_,t)))return!0;X(e),Q(e)}var i,a;return e.copy_[t]===r&&(void 0!==r||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty:(e,t)=>(void 0!==J(e.base_,t)||t in e.base_?(e.assigned_[t]=!1,X(e),Q(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0),getOwnPropertyDescriptor(e,t){const r=E(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n?{writable:!0,configurable:1!==e.type_||"length"!==t,enumerable:n.enumerable,value:r[t]}:n},defineProperty(){g(11)},getPrototypeOf:e=>v(e.base_),setPrototypeOf(){g(12)}},K={};function J(e,t){const r=e[m];return(r?E(r):e)[t]}function $(e,t){if(!(t in e))return;let r=v(e);for(;r;){const e=Object.getOwnPropertyDescriptor(r,t);if(e)return e;r=v(r)}}function Q(e){e.modified_||(e.modified_=!0,e.parent_&&Q(e.parent_))}function X(e){e.copy_||(e.copy_=D(e.base_,e.scope_.immer_.useStrictShallowCopy_))}S(G,((e,t)=>{K[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),K.deleteProperty=function(e,t){return K.set.call(this,e,t,void 0)},K.set=function(e,t,r){return G.set.call(this,e[0],t,r,e[0])};function Y(e,t){const r=T(e)?j("MapSet").proxyMap_(e,t):P(e)?j("MapSet").proxySet_(e,t):function(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:A(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=n,a=G;r&&(i=[n],a=K);const{revoke:s,proxy:o}=Proxy.revocable(i,a);return n.draft_=o,n.revoke_=s,o}(e,t);return(t?t.scope_:A()).drafts_.push(r),r}function Z(e){return y(e)||g(10),ee(e)}function ee(e){if(!b(e)||I(e))return e;const t=e[m];let r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=D(e,t.scope_.immer_.useStrictShallowCopy_)}else r=D(e,!0);return S(r,((e,t)=>{R(r,e,ee(t))})),t&&(t.finalized_=!1),r}var te=new class{constructor(e){var t=this;this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,t,r)=>{if("function"===typeof e&&"function"!==typeof t){const r=t;t=e;const n=this;return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r;for(var i=arguments.length,a=new Array(i>1?i-1:0),s=1;s<i;s++)a[s-1]=arguments[s];return n.produce(e,(e=>t.call(this,e,...a)))}}let n;if("function"!==typeof t&&g(6),void 0!==r&&"function"!==typeof r&&g(7),b(e)){const i=B(this),a=Y(e,void 0);let s=!0;try{n=t(a),s=!1}finally{s?F(i):z(i)}return N(i,r),V(n,i)}if(!e||"object"!==typeof e){if(n=t(e),void 0===n&&(n=e),n===h&&(n=void 0),this.autoFreeze_&&O(n,!0),r){const t=[],i=[];j("Patches").generateReplacementPatches_(e,n,t,i),r(t,i)}return n}g(1)},this.produceWithPatches=(e,r)=>{if("function"===typeof e)return function(r){for(var n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];return t.produceWithPatches(r,(t=>e(t,...i)))};let n,i;return[this.produce(e,r,((e,t)=>{n=e,i=t})),n,i]},"boolean"===typeof(null===e||void 0===e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze),"boolean"===typeof(null===e||void 0===e?void 0:e.useStrictShallowCopy)&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){b(e)||g(8),y(e)&&(e=Z(e));const t=B(this),r=Y(e,void 0);return r[m].isManual_=!0,z(t),r}finishDraft(e,t){const r=e&&e[m];r&&r.isManual_||g(9);const{scope_:n}=r;return N(n,t),V(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const n=t[r];if(0===n.path.length&&"replace"===n.op){e=n.value;break}}r>-1&&(t=t.slice(r+1));const n=j("Patches").applyPatches_;return y(e)?n(e,t):this.produce(e,(e=>n(e,t)))}},re=te.produce;te.produceWithPatches.bind(te),te.setAutoFreeze.bind(te),te.setUseStrictShallowCopy.bind(te),te.applyPatches.bind(te),te.createDraft.bind(te),te.finishDraft.bind(te);function ne(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"expected a function, instead received ".concat(typeof e);if("function"!==typeof e)throw new TypeError(t)}var ie=e=>Array.isArray(e)?e:[e];function ae(e){const t=Array.isArray(e[0])?e[0]:e;return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"expected all items to be functions, instead received the following types: ";if(!e.every((e=>"function"===typeof e))){const r=e.map((e=>"function"===typeof e?"function ".concat(e.name||"unnamed","()"):typeof e)).join(", ");throw new TypeError("".concat(t,"[").concat(r,"]"))}}(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}Symbol(),Object.getPrototypeOf({});var se="undefined"!==typeof WeakRef?WeakRef:class{constructor(e){this.value=e}deref(){return this.value}},oe=0,ce=1;function de(){return{s:oe,v:void 0,o:null,p:null}}function le(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=de();const{resultEqualityCheck:n}=t;let i,a=0;function s(){let t=r;const{length:s}=arguments;for(let e=0,r=s;e<r;e++){const r=arguments[e];if("function"===typeof r||"object"===typeof r&&null!==r){let e=t.o;null===e&&(t.o=e=new WeakMap);const n=e.get(r);void 0===n?(t=de(),e.set(r,t)):t=n}else{let e=t.p;null===e&&(t.p=e=new Map);const n=e.get(r);void 0===n?(t=de(),e.set(r,t)):t=n}}const o=t;let c;if(t.s===ce?c=t.v:(c=e.apply(null,arguments),a++),o.s=ce,n){var d,l,u;const e=null!==(d=null===(l=i)||void 0===l||null===(u=l.deref)||void 0===u?void 0:u.call(l))&&void 0!==d?d:i;null!=e&&n(e,c)&&(c=e,0!==a&&a--);i="object"===typeof c&&null!==c||"function"===typeof c?new se(c):c}return o.v=c,c}return s.clearCache=()=>{r=de(),s.resetResultsCount()},s.resultsCount=()=>a,s.resetResultsCount=()=>{a=0},s}function ue(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];const i="function"===typeof e?{memoize:e,memoizeOptions:r}:e,a=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];let n,a=0,s=0,o={},c=t.pop();"object"===typeof c&&(o=c,c=t.pop()),ne(c,"createSelector expects an output function after the inputs, but received: [".concat(typeof c,"]"));const d={...i,...o},{memoize:l,memoizeOptions:u=[],argsMemoize:p=le,argsMemoizeOptions:h=[],devModeChecks:f={}}=d,m=ie(u),g=ie(h),v=ae(t),y=l((function(){return a++,c.apply(null,arguments)}),...m);const b=p((function(){s++;const e=function(e,t){const r=[],{length:n}=e;for(let i=0;i<n;i++)r.push(e[i].apply(null,t));return r}(v,arguments);return n=y.apply(null,e),n}),...g);return Object.assign(b,{resultFunc:c,memoizedResultFunc:y,dependencies:v,dependencyRecomputations:()=>s,resetDependencyRecomputations:()=>{s=0},lastResult:()=>n,recomputations:()=>a,resetRecomputations:()=>{a=0},memoize:l,argsMemoize:p})};return Object.assign(a,{withTypes:()=>a}),a}var pe=ue(le),he=Object.assign((function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:pe;!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"expected an object, instead received ".concat(typeof e);if("object"!==typeof e)throw new TypeError(t)}(e,"createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ".concat(typeof e));const r=Object.keys(e),n=t(r.map((t=>e[t])),(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(((e,t,n)=>(e[r[n]]=t,e)),{})}));return n}),{withTypes:()=>he});function fe(e){return"Minified Redux error #".concat(e,"; visit https://redux.js.org/Errors?code=").concat(e," for the full message or use the non-minified dev environment for full errors. ")}var me=(()=>"function"===typeof Symbol&&Symbol.observable||"@@observable")(),ge=()=>Math.random().toString(36).substring(7).split("").join("."),ve={INIT:"@@redux/INIT".concat(ge()),REPLACE:"@@redux/REPLACE".concat(ge()),PROBE_UNKNOWN_ACTION:()=>"@@redux/PROBE_UNKNOWN_ACTION".concat(ge())};function ye(e){if("object"!==typeof e||null===e)return!1;let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||null===Object.getPrototypeOf(e)}function be(e,t,r){if("function"!==typeof e)throw new Error(fe(2));if("function"===typeof t&&"function"===typeof r||"function"===typeof r&&"function"===typeof arguments[3])throw new Error(fe(0));if("function"===typeof t&&"undefined"===typeof r&&(r=t,t=void 0),"undefined"!==typeof r){if("function"!==typeof r)throw new Error(fe(1));return r(be)(e,t)}let n=e,i=t,a=new Map,s=a,o=0,c=!1;function d(){s===a&&(s=new Map,a.forEach(((e,t)=>{s.set(t,e)})))}function l(){if(c)throw new Error(fe(3));return i}function u(e){if("function"!==typeof e)throw new Error(fe(4));if(c)throw new Error(fe(5));let t=!0;d();const r=o++;return s.set(r,e),function(){if(t){if(c)throw new Error(fe(6));t=!1,d(),s.delete(r),a=null}}}function p(e){if(!ye(e))throw new Error(fe(7));if("undefined"===typeof e.type)throw new Error(fe(8));if("string"!==typeof e.type)throw new Error(fe(17));if(c)throw new Error(fe(9));try{c=!0,i=n(i,e)}finally{c=!1}return(a=s).forEach((e=>{e()})),e}p({type:ve.INIT});return{dispatch:p,subscribe:u,getState:l,replaceReducer:function(e){if("function"!==typeof e)throw new Error(fe(10));n=e,p({type:ve.REPLACE})},[me]:function(){const e=u;return{subscribe(t){if("object"!==typeof t||null===t)throw new Error(fe(11));function r(){const e=t;e.next&&e.next(l())}r();return{unsubscribe:e(r)}},[me](){return this}}}}}function _e(e){const t=Object.keys(e),r={};for(let s=0;s<t.length;s++){const n=t[s];0,"function"===typeof e[n]&&(r[n]=e[n])}const n=Object.keys(r);let i;try{!function(e){Object.keys(e).forEach((t=>{const r=e[t];if("undefined"===typeof r(void 0,{type:ve.INIT}))throw new Error(fe(12));if("undefined"===typeof r(void 0,{type:ve.PROBE_UNKNOWN_ACTION()}))throw new Error(fe(13))}))}(r)}catch(a){i=a}return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(i)throw i;let a=!1;const s={};for(let i=0;i<n.length;i++){const o=n[i],c=r[o],d=e[o],l=c(d,t);if("undefined"===typeof l){t&&t.type;throw new Error(fe(14))}s[o]=l,a=a||l!==d}return a=a||n.length!==Object.keys(e).length,a?s:e}}function we(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return 0===t.length?e=>e:1===t.length?t[0]:t.reduce(((e,t)=>function(){return e(t(...arguments))}))}function Se(e){return ye(e)&&"type"in e&&"string"===typeof e.type}function Ce(e){return t=>{let{dispatch:r,getState:n}=t;return t=>i=>"function"===typeof i?i(r,n,e):t(i)}}var ke=Ce(),Re=Ce,Te=(function(){const e=ue(...arguments),t=Object.assign((function(){const t=e(...arguments),r=function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return t(y(e)?Z(e):e,...n)};return Object.assign(r,t),r}),{withTypes:()=>t})}(le),"undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(0!==arguments.length)return"object"===typeof arguments[0]?we:we.apply(null,arguments)}),Pe=("undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__,e=>e&&"function"===typeof e.match);function Ee(e,t){function r(){if(t){let r=t(...arguments);if(!r)throw new Error(Dt(0));return{type:e,payload:r.payload,..."meta"in r&&{meta:r.meta},..."error"in r&&{error:r.error}}}return{type:e,payload:arguments.length<=0?void 0:arguments[0]}}return r.toString=()=>"".concat(e),r.type=e,r.match=t=>Se(t)&&t.type===e,r}function De(e,t){for(const r of e)if(t(r))return r}var Oe=class e extends Array{constructor(){super(...arguments),Object.setPrototypeOf(this,e.prototype)}static get[Symbol.species](){return e}concat(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return super.concat.apply(this,t)}prepend(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return 1===r.length&&Array.isArray(r[0])?new e(...r[0].concat(this)):new e(...r.concat(this))}};function xe(e){return b(e)?re(e,(()=>{})):e}function Ie(e,t,r){if(e.has(t)){let n=e.get(t);return r.update&&(n=r.update(n,t,e),e.set(t,n)),n}if(!r.insert)throw new Error(Dt(10));const n=r.insert(t,e);return e.set(t,n),n}var Me="RTK_autoBatch",Le=e=>t=>{setTimeout(t,e)},je="undefined"!==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame:Le(10),Ae=e=>function(t){const{autoBatch:r=!0}=null!==t&&void 0!==t?t:{};let n=new Oe(e);return r&&n.push(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{type:"raf"};return t=>function(){const r=t(...arguments);let n=!0,i=!1,a=!1;const s=new Set,o="tick"===e.type?queueMicrotask:"raf"===e.type?je:"callback"===e.type?e.queueNotification:Le(e.timeout),c=()=>{a=!1,i&&(i=!1,s.forEach((e=>e())))};return Object.assign({},r,{subscribe(e){const t=r.subscribe((()=>n&&e()));return s.add(e),()=>{t(),s.delete(e)}},dispatch(e){try{var t;return n=!(null!==e&&void 0!==e&&null!==(t=e.meta)&&void 0!==t&&t[Me]),i=!n,i&&(a||(a=!0,o(c))),r.dispatch(e)}finally{n=!0}}})}}("object"===typeof r?r:void 0)),n};function Ne(e){const t=function(e){const{thunk:t=!0,immutableCheck:r=!0,serializableCheck:n=!0,actionCreatorCheck:i=!0}=null!==e&&void 0!==e?e:{};let a=new Oe;return t&&("boolean"===typeof t?a.push(ke):a.push(Re(t.extraArgument))),a},{reducer:r,middleware:n,devTools:i=!0,preloadedState:a,enhancers:s}=e||{};let o,c;if("function"===typeof r)o=r;else{if(!ye(r))throw new Error(Dt(1));o=_e(r)}c="function"===typeof n?n(t):t();let d=we;i&&(d=Te({trace:!1,..."object"===typeof i&&i}));const l=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return e=>(r,n)=>{const i=e(r,n);let a=()=>{throw new Error(fe(15))};const s={getState:i.getState,dispatch:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return a(e,...r)}},o=t.map((e=>e(s)));return a=we(...o)(i.dispatch),{...i,dispatch:a}}}(...c),u=Ae(l);let p="function"===typeof s?s(u):u();return be(o,a,d(...p))}function Fe(e){const t={},r=[];let n;const i={addCase(e,r){const n="string"===typeof e?e:e.type;if(!n)throw new Error(Dt(28));if(n in t)throw new Error(Dt(29));return t[n]=r,i},addMatcher:(e,t)=>(r.push({matcher:e,reducer:t}),i),addDefaultCase:e=>(n=e,i)};return e(i),[t,r,n]}var ze=function(){let e="",t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:21;for(;t--;)e+="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW"[64*Math.random()|0];return e},Be=(e,t)=>Pe(e)?e.match(t):e(t);function Ue(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return e=>t.some((t=>Be(t,e)))}var Ve=["name","message","stack","code"],qe=class{constructor(e,t){p(this,"_type",void 0),this.payload=e,this.meta=t}},We=class{constructor(e,t){p(this,"_type",void 0),this.payload=e,this.meta=t}},He=e=>{if("object"===typeof e&&null!==e){const t={};for(const r of Ve)"string"===typeof e[r]&&(t[r]=e[r]);return t}return{message:String(e)}},Ge=(()=>{function e(e,t,r){const n=Ee(e+"/fulfilled",((e,t,r,n)=>({payload:e,meta:{...n||{},arg:r,requestId:t,requestStatus:"fulfilled"}}))),i=Ee(e+"/pending",((e,t,r)=>({payload:void 0,meta:{...r||{},arg:t,requestId:e,requestStatus:"pending"}}))),a=Ee(e+"/rejected",((e,t,n,i,a)=>({payload:i,error:(r&&r.serializeError||He)(e||"Rejected"),meta:{...a||{},arg:n,requestId:t,rejectedWithValue:!!i,requestStatus:"rejected",aborted:"AbortError"===(null===e||void 0===e?void 0:e.name),condition:"ConditionError"===(null===e||void 0===e?void 0:e.name)}})));return Object.assign((function(e){return(s,o,c)=>{const d=null!==r&&void 0!==r&&r.idGenerator?r.idGenerator(e):ze(),l=new AbortController;let u,p;function h(e){p=e,l.abort()}const f=async function(){let f;try{var m,g;let a=null===r||void 0===r||null===(m=r.condition)||void 0===m?void 0:m.call(r,e,{getState:o,extra:c});if(function(e){return null!==e&&"object"===typeof e&&"function"===typeof e.then}(a)&&(a=await a),!1===a||l.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};const v=new Promise(((e,t)=>{u=()=>{t({name:"AbortError",message:p||"Aborted"})},l.signal.addEventListener("abort",u)}));s(i(d,e,null===r||void 0===r||null===(g=r.getPendingMeta)||void 0===g?void 0:g.call(r,{requestId:d,arg:e},{getState:o,extra:c}))),f=await Promise.race([v,Promise.resolve(t(e,{dispatch:s,getState:o,extra:c,requestId:d,signal:l.signal,abort:h,rejectWithValue:(e,t)=>new qe(e,t),fulfillWithValue:(e,t)=>new We(e,t)})).then((t=>{if(t instanceof qe)throw t;return t instanceof We?n(t.payload,d,e,t.meta):n(t,d,e)}))])}catch(v){f=v instanceof qe?a(null,d,e,v.payload,v.meta):a(v,d,e)}finally{u&&l.signal.removeEventListener("abort",u)}return r&&!r.dispatchConditionRejection&&a.match(f)&&f.meta.condition||s(f),f}();return Object.assign(f,{abort:h,requestId:d,arg:e,unwrap:()=>f.then(Ke)})}}),{pending:i,rejected:a,fulfilled:n,settled:Ue(a,n),typePrefix:e})}return e.withTypes=()=>e,e})();function Ke(e){if(e.meta&&e.meta.rejectedWithValue)throw e.payload;if(e.error)throw e.error;return e.payload}var Je=Symbol.for("rtk-slice-createasyncthunk");function $e(e,t){return"".concat(e,"/").concat(t)}function Qe(e,t,r,n){function i(i){let a=t(i);"undefined"===typeof a&&n&&(a=r());for(var s=arguments.length,o=new Array(s>1?s-1:0),c=1;c<s;c++)o[c-1]=arguments[c];return e(a,...o)}return i.unwrapped=e,i}var Xe=function(){var e;let{creators:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const r=null===t||void 0===t||null===(e=t.asyncThunk)||void 0===e?void 0:e[Je];return function(e){const{name:t,reducerPath:n=t}=e;if(!t)throw new Error(Dt(11));const i=("function"===typeof e.reducers?e.reducers(function(){function e(e,t){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...t}}return e.withTypes=()=>e,{reducer:e=>Object.assign({[e.name](){return e(...arguments)}}[e.name],{_reducerDefinitionType:"reducer"}),preparedReducer:(e,t)=>({_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:t}),asyncThunk:e}}()):e.reducers)||{},a=Object.keys(i),s={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},o={addCase(e,t){const r="string"===typeof e?e:e.type;if(!r)throw new Error(Dt(12));if(r in s.sliceCaseReducersByType)throw new Error(Dt(13));return s.sliceCaseReducersByType[r]=t,o},addMatcher:(e,t)=>(s.sliceMatchers.push({matcher:e,reducer:t}),o),exposeAction:(e,t)=>(s.actionCreators[e]=t,o),exposeCaseReducer:(e,t)=>(s.sliceCaseReducersByName[e]=t,o)};function c(){const[t={},r=[],n]="function"===typeof e.extraReducers?Fe(e.extraReducers):[e.extraReducers],i={...t,...s.sliceCaseReducersByType};return function(e,t){let r,[n,i,a]=Fe(t);if("function"===typeof e)r=()=>xe(e());else{const t=xe(e);r=()=>t}function s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r(),t=arguments.length>1?arguments[1]:void 0,s=[n[t.type],...i.filter((e=>{let{matcher:r}=e;return r(t)})).map((e=>{let{reducer:t}=e;return t}))];return 0===s.filter((e=>!!e)).length&&(s=[a]),s.reduce(((e,r)=>{if(r){if(y(e)){const n=r(e,t);return void 0===n?e:n}if(b(e))return re(e,(e=>r(e,t)));{const n=r(e,t);if(void 0===n){if(null===e)return e;throw new Error(Dt(9))}return n}}return e}),e)}return s.getInitialState=r,s}(e.initialState,(e=>{for(let t in i)e.addCase(t,i[t]);for(let t of s.sliceMatchers)e.addMatcher(t.matcher,t.reducer);for(let t of r)e.addMatcher(t.matcher,t.reducer);n&&e.addDefaultCase(n)}))}a.forEach((n=>{const a=i[n],s={reducerName:n,type:$e(t,n),createNotation:"function"===typeof e.reducers};!function(e){return"asyncThunk"===e._reducerDefinitionType}(a)?function(e,t,r){let n,i,{type:a,reducerName:s,createNotation:o}=e;if("reducer"in t){if(o&&!function(e){return"reducerWithPrepare"===e._reducerDefinitionType}(t))throw new Error(Dt(17));n=t.reducer,i=t.prepare}else n=t;r.addCase(a,n).exposeCaseReducer(s,n).exposeAction(s,i?Ee(a,i):Ee(a))}(s,a,o):function(e,t,r,n){let{type:i,reducerName:a}=e;if(!n)throw new Error(Dt(18));const{payloadCreator:s,fulfilled:o,pending:c,rejected:d,settled:l,options:u}=t,p=n(i,s,u);r.exposeAction(a,p),o&&r.addCase(p.fulfilled,o);c&&r.addCase(p.pending,c);d&&r.addCase(p.rejected,d);l&&r.addMatcher(p.settled,l);r.exposeCaseReducer(a,{fulfilled:o||Ye,pending:c||Ye,rejected:d||Ye,settled:l||Ye})}(s,a,o,r)}));const d=e=>e,l=new Map;let u;function p(e,t){return u||(u=c()),u(e,t)}function h(){return u||(u=c()),u.getInitialState()}function f(t){let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function n(e){let n=e[t];return"undefined"===typeof n&&r&&(n=h()),n}function i(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d;const n=Ie(l,r,{insert:()=>new WeakMap});return Ie(n,t,{insert:()=>{const n={};for(const[a,s]of Object.entries(null!==(i=e.selectors)&&void 0!==i?i:{})){var i;n[a]=Qe(s,t,h,r)}return n}})}return{reducerPath:t,getSelectors:i,get selectors(){return i(n)},selectSlice:n}}const m={name:t,reducer:p,actions:s.actionCreators,caseReducers:s.sliceCaseReducersByName,getInitialState:h,...f(n),injectInto(e){let{reducerPath:t,...r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=null!==t&&void 0!==t?t:n;return e.inject({reducerPath:i,reducer:p},r),{...m,...f(i,!0)}}};return m}}();function Ye(){}var Ze="listener",et="completed",tt="cancelled",rt="task-".concat(tt),nt="task-".concat(et),it="".concat(Ze,"-").concat(tt),at="".concat(Ze,"-").concat(et),st=class{constructor(e){p(this,"name","TaskAbortError"),p(this,"message",void 0),this.code=e,this.message="".concat("task"," ").concat(tt," (reason: ").concat(e,")")}},ot=(e,t)=>{if("function"!==typeof e)throw new Error(Dt(32))},ct=()=>{},dt=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ct;return e.catch(t),e},lt=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),ut=(e,t)=>{const r=e.signal;r.aborted||("reason"in r||Object.defineProperty(r,"reason",{enumerable:!0,value:t,configurable:!0,writable:!0}),e.abort(t))},pt=e=>{if(e.aborted){const{reason:t}=e;throw new st(t)}};function ht(e,t){let r=ct;return new Promise(((n,i)=>{const a=()=>i(new st(e.reason));e.aborted?a():(r=lt(e,a),t.finally((()=>r())).then(n,i))})).finally((()=>{r=ct}))}var ft=e=>t=>dt(ht(e,t).then((t=>(pt(e),t)))),mt=e=>{const t=ft(e);return e=>t(new Promise((t=>setTimeout(t,e))))},{assign:gt}=Object,vt={},yt="listenerMiddleware",bt=(e,t)=>(r,n)=>{ot(r);const i=new AbortController;var a;a=i,lt(e,(()=>ut(a,e.reason)));const s=(async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(r){return{status:r instanceof st?"cancelled":"rejected",error:r}}finally{null===t||void 0===t||t()}})((async()=>{pt(e),pt(i.signal);const t=await r({pause:ft(i.signal),delay:mt(i.signal),signal:i.signal});return pt(i.signal),t}),(()=>ut(i,nt)));return null!==n&&void 0!==n&&n.autoJoin&&t.push(s.catch(ct)),{result:ft(e)(s),cancel(){ut(i,rt)}}},_t=(e,t)=>(r,n)=>dt((async(r,n)=>{pt(t);let i=()=>{};const a=[new Promise(((t,n)=>{let a=e({predicate:r,effect:(e,r)=>{r.unsubscribe(),t([e,r.getState(),r.getOriginalState()])}});i=()=>{a(),n()}}))];null!=n&&a.push(new Promise((e=>setTimeout(e,n,null))));try{const e=await ht(t,Promise.race(a));return pt(t),e}finally{i()}})(r,n)),wt=e=>{let{type:t,actionCreator:r,matcher:n,predicate:i,effect:a}=e;if(t)i=Ee(t).match;else if(r)t=r.type,i=r.match;else if(n)i=n;else if(!i)throw new Error(Dt(21));return ot(a),{predicate:i,type:t,effect:a}},St=Object.assign((e=>{const{type:t,predicate:r,effect:n}=wt(e);return{id:ze(),effect:n,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(Dt(22))}}}),{withTypes:()=>St}),Ct=e=>{e.pending.forEach((e=>{ut(e,it)}))},kt=(e,t,r)=>{try{e(t,r)}catch(n){setTimeout((()=>{throw n}),0)}},Rt=Object.assign(Ee("".concat(yt,"/add")),{withTypes:()=>Rt}),Tt=Ee("".concat(yt,"/removeAll")),Pt=Object.assign(Ee("".concat(yt,"/remove")),{withTypes:()=>Pt}),Et=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];console.error("".concat(yt,"/error"),...t)};Symbol.for("rtk-state-proxy-original");function Dt(e){return"Minified Redux Toolkit error #".concat(e,"; visit https://redux-toolkit.js.org/Errors?code=").concat(e," for the full message or use the non-minified dev environment for full errors. ")}const Ot=Object.create(null);Ot.open="0",Ot.close="1",Ot.ping="2",Ot.pong="3",Ot.message="4",Ot.upgrade="5",Ot.noop="6";const xt=Object.create(null);Object.keys(Ot).forEach((e=>{xt[Ot[e]]=e}));const It={type:"error",data:"parser error"},Mt="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),Lt="function"===typeof ArrayBuffer,jt=e=>"function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,At=(e,t,r)=>{let{type:n,data:i}=e;return Mt&&i instanceof Blob?t?r(i):Nt(i,r):Lt&&(i instanceof ArrayBuffer||jt(i))?t?r(i):Nt(new Blob([i]),r):r(Ot[n]+(i||""))},Nt=(e,t)=>{const r=new FileReader;return r.onload=function(){const e=r.result.split(",")[1];t("b"+(e||""))},r.readAsDataURL(e)};function Ft(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let zt;const Bt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ut="undefined"===typeof Uint8Array?[]:new Uint8Array(256);for(let r=0;r<64;r++)Ut[Bt.charCodeAt(r)]=r;const Vt="function"===typeof ArrayBuffer,qt=(e,t)=>{if("string"!==typeof e)return{type:"message",data:Ht(e,t)};const r=e.charAt(0);if("b"===r)return{type:"message",data:Wt(e.substring(1),t)};return xt[r]?e.length>1?{type:xt[r],data:e.substring(1)}:{type:xt[r]}:It},Wt=(e,t)=>{if(Vt){const r=(e=>{let t,r,n,i,a,s=.75*e.length,o=e.length,c=0;"="===e[e.length-1]&&(s--,"="===e[e.length-2]&&s--);const d=new ArrayBuffer(s),l=new Uint8Array(d);for(t=0;t<o;t+=4)r=Ut[e.charCodeAt(t)],n=Ut[e.charCodeAt(t+1)],i=Ut[e.charCodeAt(t+2)],a=Ut[e.charCodeAt(t+3)],l[c++]=r<<2|n>>4,l[c++]=(15&n)<<4|i>>2,l[c++]=(3&i)<<6|63&a;return d})(e);return Ht(r,t)}return{base64:!0,data:e}},Ht=(e,t)=>"blob"===t?e instanceof Blob?e:new Blob([e]):e instanceof ArrayBuffer?e:e.buffer,Gt=String.fromCharCode(30);function Kt(){return new TransformStream({transform(e,t){!function(e,t){Mt&&e.data instanceof Blob?e.data.arrayBuffer().then(Ft).then(t):Lt&&(e.data instanceof ArrayBuffer||jt(e.data))?t(Ft(e.data)):At(e,!1,(e=>{zt||(zt=new TextEncoder),t(zt.encode(e))}))}(e,(r=>{const n=r.length;let i;if(n<126)i=new Uint8Array(1),new DataView(i.buffer).setUint8(0,n);else if(n<65536){i=new Uint8Array(3);const e=new DataView(i.buffer);e.setUint8(0,126),e.setUint16(1,n)}else{i=new Uint8Array(9);const e=new DataView(i.buffer);e.setUint8(0,127),e.setBigUint64(1,BigInt(n))}e.data&&"string"!==typeof e.data&&(i[0]|=128),t.enqueue(i),t.enqueue(r)}))}})}let Jt;function $t(e){return e.reduce(((e,t)=>e+t.length),0)}function Qt(e,t){if(e[0].length===t)return e.shift();const r=new Uint8Array(t);let n=0;for(let i=0;i<t;i++)r[i]=e[0][n++],n===e[0].length&&(e.shift(),n=0);return e.length&&n<e[0].length&&(e[0]=e[0].slice(n)),r}function Xt(e){if(e)return function(e){for(var t in Xt.prototype)e[t]=Xt.prototype[t];return e}(e)}Xt.prototype.on=Xt.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},Xt.prototype.once=function(e,t){function r(){this.off(e,r),t.apply(this,arguments)}return r.fn=t,this.on(e,r),this},Xt.prototype.off=Xt.prototype.removeListener=Xt.prototype.removeAllListeners=Xt.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var r,n=this._callbacks["$"+e];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var i=0;i<n.length;i++)if((r=n[i])===t||r.fn===t){n.splice(i,1);break}return 0===n.length&&delete this._callbacks["$"+e],this},Xt.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),r=this._callbacks["$"+e],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(r){n=0;for(var i=(r=r.slice(0)).length;n<i;++n)r[n].apply(this,t)}return this},Xt.prototype.emitReserved=Xt.prototype.emit,Xt.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},Xt.prototype.hasListeners=function(e){return!!this.listeners(e).length};const Yt="undefined"!==typeof self?self:"undefined"!==typeof window?window:Function("return this")();function Zt(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return r.reduce(((t,r)=>(e.hasOwnProperty(r)&&(t[r]=e[r]),t)),{})}const er=Yt.setTimeout,tr=Yt.clearTimeout;function rr(e,t){t.useNativeTimers?(e.setTimeoutFn=er.bind(Yt),e.clearTimeoutFn=tr.bind(Yt)):(e.setTimeoutFn=Yt.setTimeout.bind(Yt),e.clearTimeoutFn=Yt.clearTimeout.bind(Yt))}class nr extends Error{constructor(e,t,r){super(e),this.description=t,this.context=r,this.type="TransportError"}}class ir extends Xt{constructor(e){super(),this.writable=!1,rr(this,e),this.opts=e,this.query=e.query,this.socket=e.socket}onError(e,t,r){return super.emitReserved("error",new nr(e,t,r)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(e){"open"===this.readyState&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=qt(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){const e=this.opts.hostname;return-1===e.indexOf(":")?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(443!==this.opts.port)||!this.opts.secure&&80!==Number(this.opts.port))?":"+this.opts.port:""}_query(e){const t=function(e){let t="";for(let r in e)e.hasOwnProperty(r)&&(t.length&&(t+="&"),t+=encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t}(e);return t.length?"?"+t:""}}const ar="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),sr=64,or={};let cr,dr=0,lr=0;function ur(e){let t="";do{t=ar[e%sr]+t,e=Math.floor(e/sr)}while(e>0);return t}function pr(){const e=ur(+new Date);return e!==cr?(dr=0,cr=e):e+"."+ur(dr++)}for(;lr<sr;lr++)or[ar[lr]]=lr;let hr=!1;try{hr="undefined"!==typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(xu){}const fr=hr;function mr(e){const t=e.xdomain;try{if("undefined"!==typeof XMLHttpRequest&&(!t||fr))return new XMLHttpRequest}catch(r){}if(!t)try{return new(Yt[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(r){}}function gr(){}const vr=null!=new mr({xdomain:!1}).responseType;class yr extends Xt{constructor(e,t){super(),rr(this,t),this.opts=t,this.method=t.method||"GET",this.uri=e,this.data=void 0!==t.data?t.data:null,this.create()}create(){var e;const t=Zt(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this.opts.xd;const r=this.xhr=new mr(t);try{r.open(this.method,this.uri,!0);try{if(this.opts.extraHeaders){r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0);for(let e in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(e)&&r.setRequestHeader(e,this.opts.extraHeaders[e])}}catch(n){}if("POST"===this.method)try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(n){}try{r.setRequestHeader("Accept","*/*")}catch(n){}null===(e=this.opts.cookieJar)||void 0===e||e.addCookies(r),"withCredentials"in r&&(r.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(r.timeout=this.opts.requestTimeout),r.onreadystatechange=()=>{var e;3===r.readyState&&(null===(e=this.opts.cookieJar)||void 0===e||e.parseCookies(r)),4===r.readyState&&(200===r.status||1223===r.status?this.onLoad():this.setTimeoutFn((()=>{this.onError("number"===typeof r.status?r.status:0)}),0))},r.send(this.data)}catch(n){return void this.setTimeoutFn((()=>{this.onError(n)}),0)}"undefined"!==typeof document&&(this.index=yr.requestsCount++,yr.requests[this.index]=this)}onError(e){this.emitReserved("error",e,this.xhr),this.cleanup(!0)}cleanup(e){if("undefined"!==typeof this.xhr&&null!==this.xhr){if(this.xhr.onreadystatechange=gr,e)try{this.xhr.abort()}catch(t){}"undefined"!==typeof document&&delete yr.requests[this.index],this.xhr=null}}onLoad(){const e=this.xhr.responseText;null!==e&&(this.emitReserved("data",e),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}}if(yr.requestsCount=0,yr.requests={},"undefined"!==typeof document)if("function"===typeof attachEvent)attachEvent("onunload",br);else if("function"===typeof addEventListener){addEventListener("onpagehide"in Yt?"pagehide":"unload",br,!1)}function br(){for(let e in yr.requests)yr.requests.hasOwnProperty(e)&&yr.requests[e].abort()}const _r="function"===typeof Promise&&"function"===typeof Promise.resolve?e=>Promise.resolve().then(e):(e,t)=>t(e,0),wr=Yt.WebSocket||Yt.MozWebSocket,Sr="undefined"!==typeof navigator&&"string"===typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();const Cr={websocket:class extends ir{constructor(e){super(e),this.supportsBinary=!e.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const e=this.uri(),t=this.opts.protocols,r=Sr?{}:Zt(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=Sr?new wr(e,t,r):t?new wr(e,t):new wr(e)}catch(xu){return this.emitReserved("error",xu)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const r=e[t],n=t===e.length-1;At(r,this.supportsBinary,(e=>{try{this.ws.send(e)}catch(t){}n&&_r((()=>{this.writable=!0,this.emitReserved("drain")}),this.setTimeoutFn)}))}}doClose(){"undefined"!==typeof this.ws&&(this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=pr()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}check(){return!!wr}},webtransport:class extends ir{get name(){return"webtransport"}doOpen(){"function"===typeof WebTransport&&(this.transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name]),this.transport.closed.then((()=>{this.onClose()})).catch((e=>{this.onError("webtransport error",e)})),this.transport.ready.then((()=>{this.transport.createBidirectionalStream().then((e=>{const t=function(e,t){Jt||(Jt=new TextDecoder);const r=[];let n=0,i=-1,a=!1;return new TransformStream({transform(s,o){for(r.push(s);;){if(0===n){if($t(r)<1)break;const e=Qt(r,1);a=128===(128&e[0]),i=127&e[0],n=i<126?3:126===i?1:2}else if(1===n){if($t(r)<2)break;const e=Qt(r,2);i=new DataView(e.buffer,e.byteOffset,e.length).getUint16(0),n=3}else if(2===n){if($t(r)<8)break;const e=Qt(r,8),t=new DataView(e.buffer,e.byteOffset,e.length),a=t.getUint32(0);if(a>Math.pow(2,21)-1){o.enqueue(It);break}i=a*Math.pow(2,32)+t.getUint32(4),n=3}else{if($t(r)<i)break;const e=Qt(r,i);o.enqueue(qt(a?e:Jt.decode(e),t)),n=0}if(0===i||i>e){o.enqueue(It);break}}}})}(Number.MAX_SAFE_INTEGER,this.socket.binaryType),r=e.readable.pipeThrough(t).getReader(),n=Kt();n.readable.pipeTo(e.writable),this.writer=n.writable.getWriter();const i=()=>{r.read().then((e=>{let{done:t,value:r}=e;t||(this.onPacket(r),i())})).catch((e=>{}))};i();const a={type:"open"};this.query.sid&&(a.data='{"sid":"'.concat(this.query.sid,'"}')),this.writer.write(a).then((()=>this.onOpen()))}))})))}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const r=e[t],n=t===e.length-1;this.writer.write(r).then((()=>{n&&_r((()=>{this.writable=!0,this.emitReserved("drain")}),this.setTimeoutFn)}))}}doClose(){var e;null===(e=this.transport)||void 0===e||e.close()}},polling:class extends ir{constructor(e){if(super(e),this.polling=!1,"undefined"!==typeof location){const t="https:"===location.protocol;let r=location.port;r||(r=t?"443":"80"),this.xd="undefined"!==typeof location&&e.hostname!==location.hostname||r!==e.port}const t=e&&e.forceBase64;this.supportsBinary=vr&&!t,this.opts.withCredentials&&(this.cookieJar=void 0)}get name(){return"polling"}doOpen(){this.poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this.polling||!this.writable){let e=0;this.polling&&(e++,this.once("pollComplete",(function(){--e||t()}))),this.writable||(e++,this.once("drain",(function(){--e||t()})))}else t()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){((e,t)=>{const r=e.split(Gt),n=[];for(let i=0;i<r.length;i++){const e=qt(r[i],t);if(n.push(e),"error"===e.type)break}return n})(e,this.socket.binaryType).forEach((e=>{if("opening"===this.readyState&&"open"===e.type&&this.onOpen(),"close"===e.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(e)})),"closed"!==this.readyState&&(this.polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this.poll())}doClose(){const e=()=>{this.write([{type:"close"}])};"open"===this.readyState?e():this.once("open",e)}write(e){this.writable=!1,((e,t)=>{const r=e.length,n=new Array(r);let i=0;e.forEach(((e,a)=>{At(e,!1,(e=>{n[a]=e,++i===r&&t(n.join(Gt))}))}))})(e,(e=>{this.doWrite(e,(()=>{this.writable=!0,this.emitReserved("drain")}))}))}uri(){const e=this.opts.secure?"https":"http",t=this.query||{};return!1!==this.opts.timestampRequests&&(t[this.opts.timestampParam]=pr()),this.supportsBinary||t.sid||(t.b64=1),this.createUri(e,t)}request(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign(e,{xd:this.xd,cookieJar:this.cookieJar},this.opts),new yr(this.uri(),e)}doWrite(e,t){const r=this.request({method:"POST",data:e});r.on("success",t),r.on("error",((e,t)=>{this.onError("xhr post error",e,t)}))}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",((e,t)=>{this.onError("xhr poll error",e,t)})),this.pollXhr=e}}},kr=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Rr=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Tr(e){if(e.length>2e3)throw"URI too long";const t=e,r=e.indexOf("["),n=e.indexOf("]");-1!=r&&-1!=n&&(e=e.substring(0,r)+e.substring(r,n).replace(/:/g,";")+e.substring(n,e.length));let i=kr.exec(e||""),a={},s=14;for(;s--;)a[Rr[s]]=i[s]||"";return-1!=r&&-1!=n&&(a.source=t,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a.pathNames=function(e,t){const r=/\/{2,9}/g,n=t.replace(r,"/").split("/");"/"!=t.slice(0,1)&&0!==t.length||n.splice(0,1);"/"==t.slice(-1)&&n.splice(n.length-1,1);return n}(0,a.path),a.queryKey=function(e,t){const r={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(e,t,n){t&&(r[t]=n)})),r}(0,a.query),a}class Pr extends Xt{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this.binaryType="arraybuffer",this.writeBuffer=[],e&&"object"===typeof e&&(t=e,e=null),e?(e=Tr(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=Tr(t.host).host),rr(this,t),this.secure=null!=t.secure?t.secure:"undefined"!==typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||("undefined"!==typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!==typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=t.transports||["polling","websocket","webtransport"],this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),"string"===typeof this.opts.query&&(this.opts.query=function(e){let t={},r=e.split("&");for(let n=0,i=r.length;n<i;n++){let e=r[n].split("=");t[decodeURIComponent(e[0])]=decodeURIComponent(e[1])}return t}(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,"function"===typeof addEventListener&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),"localhost"!==this.hostname&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=4,t.transport=e,this.id&&(t.sid=this.id);const r=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new Cr[e](r)}open(){let e;if(this.opts.rememberUpgrade&&Pr.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length)return void this.setTimeoutFn((()=>{this.emitReserved("error","No transports available")}),0);e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(t){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",(e=>this.onClose("transport close",e)))}probe(e){let t=this.createTransport(e),r=!1;Pr.priorWebsocketSuccess=!1;const n=()=>{r||(t.send([{type:"ping",data:"probe"}]),t.once("packet",(e=>{if(!r)if("pong"===e.type&&"probe"===e.data){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;Pr.priorWebsocketSuccess="websocket"===t.name,this.transport.pause((()=>{r||"closed"!==this.readyState&&(d(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())}))}else{const e=new Error("probe error");e.transport=t.name,this.emitReserved("upgradeError",e)}})))};function i(){r||(r=!0,d(),t.close(),t=null)}const a=e=>{const r=new Error("probe error: "+e);r.transport=t.name,i(),this.emitReserved("upgradeError",r)};function s(){a("transport closed")}function o(){a("socket closed")}function c(e){t&&e.name!==t.name&&i()}const d=()=>{t.removeListener("open",n),t.removeListener("error",a),t.removeListener("close",s),this.off("close",o),this.off("upgrading",c)};t.once("open",n),t.once("error",a),t.once("close",s),this.once("close",o),this.once("upgrading",c),-1!==this.upgrades.indexOf("webtransport")&&"webtransport"!==e?this.setTimeoutFn((()=>{r||t.open()}),200):t.open()}onOpen(){if(this.readyState="open",Pr.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade){let e=0;const t=this.upgrades.length;for(;e<t;e++)this.probe(this.upgrades[e])}}onPacket(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),this.resetPingTimeout(),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data)}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.maxPayload=e.maxPayload,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn((()=>{this.onClose("ping timeout")}),this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this.getWritablePackets();this.transport.send(e),this.prevBufferLen=e.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;let e=1;for(let r=0;r<this.writeBuffer.length;r++){const n=this.writeBuffer[r].data;if(n&&(e+="string"===typeof(t=n)?function(e){let t=0,r=0;for(let n=0,i=e.length;n<i;n++)t=e.charCodeAt(n),t<128?r+=1:t<2048?r+=2:t<55296||t>=57344?r+=3:(n++,r+=4);return r}(t):Math.ceil(1.33*(t.byteLength||t.size))),r>0&&e>this.maxPayload)return this.writeBuffer.slice(0,r);e+=2}var t;return this.writeBuffer}write(e,t,r){return this.sendPacket("message",e,t,r),this}send(e,t,r){return this.sendPacket("message",e,t,r),this}sendPacket(e,t,r,n){if("function"===typeof t&&(n=t,t=void 0),"function"===typeof r&&(n=r,r=null),"closing"===this.readyState||"closed"===this.readyState)return;(r=r||{}).compress=!1!==r.compress;const i={type:e,data:t,options:r};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),n&&this.once("flush",n),this.flush()}close(){const e=()=>{this.onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},r=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",(()=>{this.upgrading?r():e()})):this.upgrading?r():e()),this}onError(e){Pr.priorWebsocketSuccess=!1,this.emitReserved("error",e),this.onClose("transport error",e)}onClose(e,t){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"===typeof removeEventListener&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(e){const t=[];let r=0;const n=e.length;for(;r<n;r++)~this.transports.indexOf(e[r])&&t.push(e[r]);return t}}Pr.protocol=4;Pr.protocol;const Er="function"===typeof ArrayBuffer,Dr=e=>"function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer,Or=Object.prototype.toString,xr="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===Or.call(Blob),Ir="function"===typeof File||"undefined"!==typeof File&&"[object FileConstructor]"===Or.call(File);function Mr(e){return Er&&(e instanceof ArrayBuffer||Dr(e))||xr&&e instanceof Blob||Ir&&e instanceof File}function Lr(e,t){if(!e||"object"!==typeof e)return!1;if(Array.isArray(e)){for(let t=0,r=e.length;t<r;t++)if(Lr(e[t]))return!0;return!1}if(Mr(e))return!0;if(e.toJSON&&"function"===typeof e.toJSON&&1===arguments.length)return Lr(e.toJSON(),!0);for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&Lr(e[r]))return!0;return!1}function jr(e){const t=[],r=e.data,n=e;return n.data=Ar(r,t),n.attachments=t.length,{packet:n,buffers:t}}function Ar(e,t){if(!e)return e;if(Mr(e)){const r={_placeholder:!0,num:t.length};return t.push(e),r}if(Array.isArray(e)){const r=new Array(e.length);for(let n=0;n<e.length;n++)r[n]=Ar(e[n],t);return r}if("object"===typeof e&&!(e instanceof Date)){const r={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=Ar(e[n],t));return r}return e}function Nr(e,t){return e.data=Fr(e.data,t),delete e.attachments,e}function Fr(e,t){if(!e)return e;if(e&&!0===e._placeholder){if("number"===typeof e.num&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}if(Array.isArray(e))for(let r=0;r<e.length;r++)e[r]=Fr(e[r],t);else if("object"===typeof e)for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(e[r]=Fr(e[r],t));return e}const zr=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],Br=5;var Ur;!function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"}(Ur||(Ur={}));class Vr{constructor(e){this.replacer=e}encode(e){return e.type!==Ur.EVENT&&e.type!==Ur.ACK||!Lr(e)?[this.encodeAsString(e)]:this.encodeAsBinary({type:e.type===Ur.EVENT?Ur.BINARY_EVENT:Ur.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id})}encodeAsString(e){let t=""+e.type;return e.type!==Ur.BINARY_EVENT&&e.type!==Ur.BINARY_ACK||(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=jr(e),r=this.encodeAsString(t.packet),n=t.buffers;return n.unshift(r),n}}function qr(e){return"[object Object]"===Object.prototype.toString.call(e)}class Wr extends Xt{constructor(e){super(),this.reviver=e}add(e){let t;if("string"===typeof e){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const r=t.type===Ur.BINARY_EVENT;r||t.type===Ur.BINARY_ACK?(t.type=r?Ur.EVENT:Ur.ACK,this.reconstructor=new Hr(t),0===t.attachments&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else{if(!Mr(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t))}}decodeString(e){let t=0;const r={type:Number(e.charAt(0))};if(void 0===Ur[r.type])throw new Error("unknown packet type "+r.type);if(r.type===Ur.BINARY_EVENT||r.type===Ur.BINARY_ACK){const n=t+1;for(;"-"!==e.charAt(++t)&&t!=e.length;);const i=e.substring(n,t);if(i!=Number(i)||"-"!==e.charAt(t))throw new Error("Illegal attachments");r.attachments=Number(i)}if("/"===e.charAt(t+1)){const n=t+1;for(;++t;){if(","===e.charAt(t))break;if(t===e.length)break}r.nsp=e.substring(n,t)}else r.nsp="/";const n=e.charAt(t+1);if(""!==n&&Number(n)==n){const n=t+1;for(;++t;){const r=e.charAt(t);if(null==r||Number(r)!=r){--t;break}if(t===e.length)break}r.id=Number(e.substring(n,t+1))}if(e.charAt(++t)){const n=this.tryParse(e.substr(t));if(!Wr.isPayloadValid(r.type,n))throw new Error("invalid payload");r.data=n}return r}tryParse(e){try{return JSON.parse(e,this.reviver)}catch(t){return!1}}static isPayloadValid(e,t){switch(e){case Ur.CONNECT:return qr(t);case Ur.DISCONNECT:return void 0===t;case Ur.CONNECT_ERROR:return"string"===typeof t||qr(t);case Ur.EVENT:case Ur.BINARY_EVENT:return Array.isArray(t)&&("number"===typeof t[0]||"string"===typeof t[0]&&-1===zr.indexOf(t[0]));case Ur.ACK:case Ur.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class Hr{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const e=Nr(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function Gr(e,t,r){return e.on(t,r),function(){e.off(t,r)}}const Kr=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Jr extends Xt{constructor(e,t,r){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,r&&r.auth&&(this.auth=r.auth),this._opts=Object.assign({},r),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[Gr(e,"open",this.onopen.bind(this)),Gr(e,"packet",this.onpacket.bind(this)),Gr(e,"error",this.onerror.bind(this)),Gr(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.unshift("message"),this.emit.apply(this,t),this}emit(e){if(Kr.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];if(r.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(r),this;const i={type:Ur.EVENT,data:r,options:{}};if(i.options.compress=!1!==this.flags.compress,"function"===typeof r[r.length-1]){const e=this.ids++,t=r.pop();this._registerAckCallback(e,t),i.id=e}const a=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!a||!this.connected)||(this.connected?(this.notifyOutgoingListeners(i),this.packet(i)):this.sendBuffer.push(i)),this.flags={},this}_registerAckCallback(e,t){var r,n=this;const i=null!==(r=this.flags.timeout)&&void 0!==r?r:this._opts.ackTimeout;if(void 0===i)return void(this.acks[e]=t);const a=this.io.setTimeoutFn((()=>{delete this.acks[e];for(let t=0;t<this.sendBuffer.length;t++)this.sendBuffer[t].id===e&&this.sendBuffer.splice(t,1);t.call(this,new Error("operation has timed out"))}),i);this.acks[e]=function(){n.io.clearTimeoutFn(a);for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];t.apply(n,[null,...r])}}emitWithAck(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];const i=void 0!==this.flags.timeout||void 0!==this._opts.ackTimeout;return new Promise(((t,n)=>{r.push(((e,r)=>i?e?n(e):t(r):t(e))),this.emit(e,...r)}))}_addToQueue(e){var t=this;let r;"function"===typeof e[e.length-1]&&(r=e.pop());const n={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((function(e){if(n!==t._queue[0])return;if(null!==e)n.tryCount>t._opts.retries&&(t._queue.shift(),r&&r(e));else if(t._queue.shift(),r){for(var i=arguments.length,a=new Array(i>1?i-1:0),s=1;s<i;s++)a[s-1]=arguments[s];r(null,...a)}return n.pending=!1,t._drainQueue()})),this._queue.push(n),this._drainQueue()}_drainQueue(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.connected||0===this._queue.length)return;const t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){"function"==typeof this.auth?this.auth((e=>{this._sendConnectPacket(e)})):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:Ur.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t)}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case Ur.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Ur.EVENT:case Ur.BINARY_EVENT:this.onevent(e);break;case Ur.ACK:case Ur.BINARY_ACK:this.onack(e);break;case Ur.DISCONNECT:this.ondisconnect();break;case Ur.CONNECT_ERROR:this.destroy();const t=new Error(e.data.message);t.data=e.data.data,this.emitReserved("connect_error",t)}}onevent(e){const t=e.data||[];null!=e.id&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const r of t)r.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&"string"===typeof e[e.length-1]&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let r=!1;return function(){if(!r){r=!0;for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];t.packet({type:Ur.ACK,id:e,data:i})}}}onack(e){const t=this.acks[e.id];"function"===typeof t&&(t.apply(this,e.data),delete this.acks[e.id])}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach((e=>this.emitEvent(e))),this.receiveBuffer=[],this.sendBuffer.forEach((e=>{this.notifyOutgoingListeners(e),this.packet(e)})),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach((e=>e())),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:Ur.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let r=0;r<t.length;r++)if(e===t[r])return t.splice(r,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let r=0;r<t.length;r++)if(e===t[r])return t.splice(r,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const r of t)r.apply(this,e.data)}}}function $r(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}$r.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),r=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-r:e+r}return 0|Math.min(e,this.max)},$r.prototype.reset=function(){this.attempts=0},$r.prototype.setMin=function(e){this.ms=e},$r.prototype.setMax=function(e){this.max=e},$r.prototype.setJitter=function(e){this.jitter=e};class Qr extends Xt{constructor(t,r){var n;super(),this.nsps={},this.subs=[],t&&"object"===typeof t&&(r=t,t=void 0),(r=r||{}).path=r.path||"/socket.io",this.opts=r,rr(this,r),this.reconnection(!1!==r.reconnection),this.reconnectionAttempts(r.reconnectionAttempts||1/0),this.reconnectionDelay(r.reconnectionDelay||1e3),this.reconnectionDelayMax(r.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(n=r.randomizationFactor)&&void 0!==n?n:.5),this.backoff=new $r({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==r.timeout?2e4:r.timeout),this._readyState="closed",this.uri=t;const i=r.parser||e;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=!1!==r.autoConnect,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return void 0===e?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return void 0===e?this._reconnectionDelay:(this._reconnectionDelay=e,null===(t=this.backoff)||void 0===t||t.setMin(e),this)}randomizationFactor(e){var t;return void 0===e?this._randomizationFactor:(this._randomizationFactor=e,null===(t=this.backoff)||void 0===t||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return void 0===e?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,null===(t=this.backoff)||void 0===t||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new Pr(this.uri,this.opts);const t=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;const n=Gr(t,"open",(function(){r.onopen(),e&&e()})),i=t=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",t),e?e(t):this.maybeReconnectOnOpen()},a=Gr(t,"error",i);if(!1!==this._timeout){const e=this._timeout,r=this.setTimeoutFn((()=>{n(),i(new Error("timeout")),t.close()}),e);this.opts.autoUnref&&r.unref(),this.subs.push((()=>{this.clearTimeoutFn(r)}))}return this.subs.push(n),this.subs.push(a),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(Gr(e,"ping",this.onping.bind(this)),Gr(e,"data",this.ondata.bind(this)),Gr(e,"error",this.onerror.bind(this)),Gr(e,"close",this.onclose.bind(this)),Gr(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}ondecoded(e){_r((()=>{this.emitReserved("packet",e)}),this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let r=this.nsps[e];return r?this._autoConnect&&!r.active&&r.connect():(r=new Jr(this,e,t),this.nsps[e]=r),r}_destroy(e){const t=Object.keys(this.nsps);for(const r of t){if(this.nsps[r].active)return}this._close()}_packet(e){const t=this.encoder.encode(e);for(let r=0;r<t.length;r++)this.engine.write(t[r],e.options)}cleanup(){this.subs.forEach((e=>e())),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e,t){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const r=this.setTimeoutFn((()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),e.skipReconnect||e.open((t=>{t?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",t)):e.onreconnect()})))}),t);this.opts.autoUnref&&r.unref(),this.subs.push((()=>{this.clearTimeoutFn(r)}))}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const Xr={};function Yr(e,t){"object"===typeof e&&(t=e,e=void 0);const r=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2?arguments[2]:void 0,n=e;r=r||"undefined"!==typeof location&&location,null==e&&(e=r.protocol+"//"+r.host),"string"===typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?r.protocol+e:r.host+e),/^(https?|wss?):\/\//.test(e)||(e="undefined"!==typeof r?r.protocol+"//"+e:"https://"+e),n=Tr(e)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";const i=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+i+":"+n.port+t,n.href=n.protocol+"://"+i+(r&&r.port===n.port?"":":"+n.port),n}(e,(t=t||{}).path||"/socket.io"),n=r.source,i=r.id,a=r.path,s=Xr[i]&&a in Xr[i].nsps;let o;return t.forceNew||t["force new connection"]||!1===t.multiplex||s?o=new Qr(n,t):(Xr[i]||(Xr[i]=new Qr(n,t)),o=Xr[i]),r.query&&!t.query&&(t.query=r.queryKey),o.socket(r.path,t)}Object.assign(Yr,{Manager:Qr,Socket:Jr,io:Yr,connect:Yr});let Zr=!0,en=!0;function tn(e,t,r){const n=e.match(t);return n&&n.length>=r&&parseInt(n[r],10)}function rn(e,t,r){if(!e.RTCPeerConnection)return;const n=e.RTCPeerConnection.prototype,i=n.addEventListener;n.addEventListener=function(e,n){if(e!==t)return i.apply(this,arguments);const a=e=>{const t=r(e);t&&(n.handleEvent?n.handleEvent(t):n(t))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(n,a),i.apply(this,[e,a])};const a=n.removeEventListener;n.removeEventListener=function(e,r){if(e!==t||!this._eventMap||!this._eventMap[t])return a.apply(this,arguments);if(!this._eventMap[t].has(r))return a.apply(this,arguments);const n=this._eventMap[t].get(r);return this._eventMap[t].delete(r),0===this._eventMap[t].size&&delete this._eventMap[t],0===Object.keys(this._eventMap).length&&delete this._eventMap,a.apply(this,[e,n])},Object.defineProperty(n,"on"+t,{get(){return this["_on"+t]},set(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}function nn(e){return"boolean"!==typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(Zr=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function an(e){return"boolean"!==typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(en=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function sn(){if("object"===typeof window){if(Zr)return;"undefined"!==typeof console&&"function"===typeof console.log&&console.log.apply(console,arguments)}}function on(e,t){en&&console.warn(e+" is deprecated, please use "+t+" instead.")}function cn(e){return"[object Object]"===Object.prototype.toString.call(e)}function dn(e){return cn(e)?Object.keys(e).reduce((function(t,r){const n=cn(e[r]),i=n?dn(e[r]):e[r],a=n&&!Object.keys(i).length;return void 0===i||a?t:Object.assign(t,{[r]:i})}),{}):e}function ln(e,t,r){t&&!r.has(t.id)&&(r.set(t.id,t),Object.keys(t).forEach((n=>{n.endsWith("Id")?ln(e,e.get(t[n]),r):n.endsWith("Ids")&&t[n].forEach((t=>{ln(e,e.get(t),r)}))})))}function un(e,t,r){const n=r?"outbound-rtp":"inbound-rtp",i=new Map;if(null===t)return i;const a=[];return e.forEach((e=>{"track"===e.type&&e.trackIdentifier===t.id&&a.push(e)})),a.forEach((t=>{e.forEach((r=>{r.type===n&&r.trackId===t.id&&ln(e,r,i)}))})),i}const pn=sn;function hn(e,t){const r=e&&e.navigator;if(!r.mediaDevices)return;const n=function(e){if("object"!==typeof e||e.mandatory||e.optional)return e;const t={};return Object.keys(e).forEach((r=>{if("require"===r||"advanced"===r||"mediaSource"===r)return;const n="object"===typeof e[r]?e[r]:{ideal:e[r]};void 0!==n.exact&&"number"===typeof n.exact&&(n.min=n.max=n.exact);const i=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==n.ideal){t.optional=t.optional||[];let e={};"number"===typeof n.ideal?(e[i("min",r)]=n.ideal,t.optional.push(e),e={},e[i("max",r)]=n.ideal,t.optional.push(e)):(e[i("",r)]=n.ideal,t.optional.push(e))}void 0!==n.exact&&"number"!==typeof n.exact?(t.mandatory=t.mandatory||{},t.mandatory[i("",r)]=n.exact):["min","max"].forEach((e=>{void 0!==n[e]&&(t.mandatory=t.mandatory||{},t.mandatory[i(e,r)]=n[e])}))})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},i=function(e,i){if(t.version>=61)return i(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"===typeof e.audio){const t=function(e,t,r){t in e&&!(r in e)&&(e[r]=e[t],delete e[t])};t((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),t(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=n(e.audio)}if(e&&"object"===typeof e.video){let a=e.video.facingMode;a=a&&("object"===typeof a?a:{ideal:a});const s=t.version<66;if(a&&("user"===a.exact||"environment"===a.exact||"user"===a.ideal||"environment"===a.ideal)&&(!r.mediaDevices.getSupportedConstraints||!r.mediaDevices.getSupportedConstraints().facingMode||s)){let t;if(delete e.video.facingMode,"environment"===a.exact||"environment"===a.ideal?t=["back","rear"]:"user"!==a.exact&&"user"!==a.ideal||(t=["front"]),t)return r.mediaDevices.enumerateDevices().then((r=>{let s=(r=r.filter((e=>"videoinput"===e.kind))).find((e=>t.some((t=>e.label.toLowerCase().includes(t)))));return!s&&r.length&&t.includes("back")&&(s=r[r.length-1]),s&&(e.video.deviceId=a.exact?{exact:s.deviceId}:{ideal:s.deviceId}),e.video=n(e.video),pn("chrome: "+JSON.stringify(e)),i(e)}))}e.video=n(e.video)}return pn("chrome: "+JSON.stringify(e)),i(e)},a=function(e){return t.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(r.getUserMedia=function(e,t,n){i(e,(e=>{r.webkitGetUserMedia(e,t,(e=>{n&&n(a(e))}))}))}.bind(r),r.mediaDevices.getUserMedia){const e=r.mediaDevices.getUserMedia.bind(r.mediaDevices);r.mediaDevices.getUserMedia=function(t){return i(t,(t=>e(t).then((e=>{if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach((e=>{e.stop()})),new DOMException("","NotFoundError");return e}),(e=>Promise.reject(a(e))))))}}}function fn(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"===typeof t?e.navigator.mediaDevices.getDisplayMedia=function(r){return t(r).then((t=>{const n=r.video&&r.video.width,i=r.video&&r.video.height,a=r.video&&r.video.frameRate;return r.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:a||3}},n&&(r.video.mandatory.maxWidth=n),i&&(r.video.mandatory.maxHeight=i),e.navigator.mediaDevices.getUserMedia(r)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}function mn(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function gn(e){if("object"===typeof e&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=t=>{t.stream.addEventListener("addtrack",(r=>{let n;n=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((e=>e.track&&e.track.id===r.track.id)):{track:r.track};const i=new Event("track");i.track=r.track,i.receiver=n,i.transceiver={receiver:n},i.streams=[t.stream],this.dispatchEvent(i)})),t.stream.getTracks().forEach((r=>{let n;n=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((e=>e.track&&e.track.id===r.id)):{track:r};const i=new Event("track");i.track=r,i.receiver=n,i.transceiver={receiver:n},i.streams=[t.stream],this.dispatchEvent(i)}))},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else rn(e,"track",(e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e)))}function vn(e){if("object"===typeof e&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const r=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){let i=r.apply(this,arguments);return i||(i=t(this,e),this._senders.push(i)),i};const n=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){n.apply(this,arguments);const t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}const r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._senders=this._senders||[],r.apply(this,[e]),e.getTracks().forEach((e=>{this._senders.push(t(this,e))}))};const n=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._senders=this._senders||[],n.apply(this,[e]),e.getTracks().forEach((e=>{const t=this._senders.find((t=>t.track===e));t&&this._senders.splice(this._senders.indexOf(t),1)}))}}else if("object"===typeof e&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function yn(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,r,n]=arguments;if(arguments.length>0&&"function"===typeof e)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!==typeof e))return t.apply(this,[]);const i=function(e){const t={};return e.result().forEach((e=>{const r={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((t=>{r[t]=e.stat(t)})),t[r.id]=r})),t},a=function(e){return new Map(Object.keys(e).map((t=>[t,e[t]])))};if(arguments.length>=2){const n=function(e){r(a(i(e)))};return t.apply(this,[n,e])}return new Promise(((e,r)=>{t.apply(this,[function(t){e(a(i(t)))},r])})).then(r,n)}}function bn(e){if(!("object"===typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e});const r=e.RTCPeerConnection.prototype.addTrack;r&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=r.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){const e=this;return this._pc.getStats().then((t=>un(t,e.track,!0)))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e}),rn(e,"track",(e=>(e.receiver._pc=e.srcElement,e))),e.RTCRtpReceiver.prototype.getStats=function(){const e=this;return this._pc.getStats().then((t=>un(t,e.track,!1)))}}if(!("getStats"in e.RTCRtpSender.prototype)||!("getStats"in e.RTCRtpReceiver.prototype))return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const e=arguments[0];let t,r,n;return this.getSenders().forEach((r=>{r.track===e&&(t?n=!0:t=r)})),this.getReceivers().forEach((t=>(t.track===e&&(r?n=!0:r=t),t.track===e))),n||t&&r?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():r?r.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return t.apply(this,arguments)}}function _n(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((e=>this._shimmedLocalStreams[e][0]))};const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){if(!r)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const n=t.apply(this,arguments);return this._shimmedLocalStreams[r.id]?-1===this._shimmedLocalStreams[r.id].indexOf(n)&&this._shimmedLocalStreams[r.id].push(n):this._shimmedLocalStreams[r.id]=[r,n],n};const r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((e=>{if(this.getSenders().find((t=>t.track===e)))throw new DOMException("Track already exists.","InvalidAccessError")}));const t=this.getSenders();r.apply(this,arguments);const n=this.getSenders().filter((e=>-1===t.indexOf(e)));this._shimmedLocalStreams[e.id]=[e].concat(n)};const n=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],n.apply(this,arguments)};const i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((t=>{const r=this._shimmedLocalStreams[t].indexOf(e);-1!==r&&this._shimmedLocalStreams[t].splice(r,1),1===this._shimmedLocalStreams[t].length&&delete this._shimmedLocalStreams[t]})),i.apply(this,arguments)}}function wn(e,t){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return _n(e);const r=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const e=r.apply(this);return this._reverseStreams=this._reverseStreams||{},e.map((e=>this._reverseStreams[e.id]))};const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach((e=>{if(this.getSenders().find((t=>t.track===e)))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[t.id]){const r=new e.MediaStream(t.getTracks());this._streams[t.id]=r,this._reverseStreams[r.id]=t,t=r}n.apply(this,[t])};const i=e.RTCPeerConnection.prototype.removeStream;function a(e,t){let r=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((t=>{const n=e._reverseStreams[t],i=e._streams[n.id];r=r.replace(new RegExp(i.id,"g"),n.id)})),new RTCSessionDescription({type:t.type,sdp:r})}e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,r){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const n=[].slice.call(arguments,1);if(1!==n.length||!n[0].getTracks().find((e=>e===t)))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find((e=>e.track===t)))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const i=this._streams[r.id];if(i)i.addTrack(t),Promise.resolve().then((()=>{this.dispatchEvent(new Event("negotiationneeded"))}));else{const n=new e.MediaStream([t]);this._streams[r.id]=n,this._reverseStreams[n.id]=r,this.addStream(n)}return this.getSenders().find((e=>e.track===t))},["createOffer","createAnswer"].forEach((function(t){const r=e.RTCPeerConnection.prototype[t],n={[t](){const e=arguments;return arguments.length&&"function"===typeof arguments[0]?r.apply(this,[t=>{const r=a(this,t);e[0].apply(null,[r])},t=>{e[1]&&e[1].apply(null,t)},arguments[2]]):r.apply(this,arguments).then((e=>a(this,e)))}};e.RTCPeerConnection.prototype[t]=n[t]}));const s=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(e,t){let r=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((t=>{const n=e._reverseStreams[t],i=e._streams[n.id];r=r.replace(new RegExp(n.id,"g"),i.id)})),new RTCSessionDescription({type:t.type,sdp:r})}(this,arguments[0]),s.apply(this,arguments)):s.apply(this,arguments)};const o=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const e=o.get.apply(this);return""===e.type?e:a(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(e._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let t;this._streams=this._streams||{},Object.keys(this._streams).forEach((r=>{this._streams[r].getTracks().find((t=>e.track===t))&&(t=this._streams[r])})),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function Sn(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const r=e.RTCPeerConnection.prototype[t],n={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=n[t]}))}function Cn(e,t){rn(e,"negotiationneeded",(e=>{const r=e.target;if(!(t.version<72||r.getConfiguration&&"plan-b"===r.getConfiguration().sdpSemantics)||"stable"===r.signalingState)return e}))}var kn=r(9872),Rn=r.n(kn);function Tn(e){const t=e&&e.navigator,r=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return r(e).catch((e=>Promise.reject(function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString(){return this.name}}}(e))))}}function Pn(e){"getDisplayMedia"in e.navigator&&e.navigator.mediaDevices&&(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator)))}function En(e,t){if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),t.version<15025)){const t=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set(e){t.set.call(this,e);const r=new Event("enabled");r.enabled=e,this.dispatchEvent(r)}})}e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)&&Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);const r=Rn()(e,t.version);e.RTCPeerConnection=function(e){return e&&e.iceServers&&(e.iceServers=function(e,t){let r=!1;return(e=JSON.parse(JSON.stringify(e))).filter((e=>{if(e&&(e.urls||e.url)){let t=e.urls||e.url;e.url&&!e.urls&&on("RTCIceServer.url","RTCIceServer.urls");const n="string"===typeof t;return n&&(t=[t]),t=t.filter((e=>{if(0===e.indexOf("stun:"))return!1;const t=e.startsWith("turn")&&!e.startsWith("turn:[")&&e.includes("transport=udp");return t&&!r?(r=!0,!0):t&&!r})),delete e.url,e.urls=n?t[0]:t,!!t.length}}))}(e.iceServers,t.version),sn("ICE servers after filtering:",e.iceServers)),new r(e)},e.RTCPeerConnection.prototype=r.prototype}function Dn(e){e.RTCRtpSender&&!("replaceTrack"in e.RTCRtpSender.prototype)&&(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)}function On(e,t){const r=e&&e.navigator,n=e&&e.MediaStreamTrack;if(r.getUserMedia=function(e,t,n){on("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),r.mediaDevices.getUserMedia(e).then(t,n)},!(t.version>55&&"autoGainControl"in r.mediaDevices.getSupportedConstraints())){const e=function(e,t,r){t in e&&!(r in e)&&(e[r]=e[t],delete e[t])},t=r.mediaDevices.getUserMedia.bind(r.mediaDevices);if(r.mediaDevices.getUserMedia=function(r){return"object"===typeof r&&"object"===typeof r.audio&&(r=JSON.parse(JSON.stringify(r)),e(r.audio,"autoGainControl","mozAutoGainControl"),e(r.audio,"noiseSuppression","mozNoiseSuppression")),t(r)},n&&n.prototype.getSettings){const t=n.prototype.getSettings;n.prototype.getSettings=function(){const r=t.apply(this,arguments);return e(r,"mozAutoGainControl","autoGainControl"),e(r,"mozNoiseSuppression","noiseSuppression"),r}}if(n&&n.prototype.applyConstraints){const t=n.prototype.applyConstraints;n.prototype.applyConstraints=function(r){return"audio"===this.kind&&"object"===typeof r&&(r=JSON.parse(JSON.stringify(r)),e(r,"autoGainControl","mozAutoGainControl"),e(r,"noiseSuppression","mozNoiseSuppression")),t.apply(this,[r])}}}}function xn(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(r){if(!r||!r.video){const e=new DOMException("getDisplayMedia without video constraints is undefined");return e.name="NotFoundError",e.code=8,Promise.reject(e)}return!0===r.video?r.video={mediaSource:t}:r.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(r)})}function In(e){"object"===typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Mn(e,t){if("object"!==typeof e||!e.RTCPeerConnection&&!e.mozRTCPeerConnection)return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const r=e.RTCPeerConnection.prototype[t],n={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=n[t]}));const r={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},n=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,i,a]=arguments;return n.apply(this,[e||null]).then((e=>{if(t.version<53&&!i)try{e.forEach((e=>{e.type=r[e.type]||e.type}))}catch(n){if("TypeError"!==n.name)throw n;e.forEach(((t,n)=>{e.set(n,Object.assign({},t,{type:r[t.type]||t.type}))}))}return e})).then(i,a)}}function Ln(e){if("object"!==typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e});const r=e.RTCPeerConnection.prototype.addTrack;r&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=r.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function jn(e){if("object"!==typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e}),rn(e,"track",(e=>(e.receiver._pc=e.srcElement,e))),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function An(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(e){on("removeStream","removeTrack"),this.getSenders().forEach((t=>{t.track&&e.getTracks().includes(t.track)&&this.removeTrack(t)}))})}function Nn(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function Fn(e){if("object"!==typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];const e=arguments[1],r=e&&"sendEncodings"in e;r&&e.sendEncodings.forEach((e=>{if("rid"in e){if(!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.")}if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));const n=t.apply(this,arguments);if(r){const{sender:t}=n,r=t.getParameters();(!("encodings"in r)||1===r.encodings.length&&0===Object.keys(r.encodings[0]).length)&&(r.encodings=e.sendEncodings,t.sendEncodings=e.sendEncodings,this.setParametersPromises.push(t.setParameters(r).then((()=>{delete t.sendEncodings})).catch((()=>{delete t.sendEncodings}))))}return n})}function zn(e){if("object"!==typeof e||!e.RTCRtpSender)return;const t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){const e=t.apply(this,arguments);return"encodings"in e||(e.encodings=[].concat(this.sendEncodings||[{}])),e})}function Bn(e){if("object"!==typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>t.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):t.apply(this,arguments)}}function Un(e){if("object"!==typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>t.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):t.apply(this,arguments)}}function Vn(e){if("object"===typeof e&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach((r=>t.call(this,r,e))),e.getVideoTracks().forEach((r=>t.call(this,r,e)))},e.RTCPeerConnection.prototype.addTrack=function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return n&&n.forEach((e=>{this._localStreams?this._localStreams.includes(e)||this._localStreams.push(e):this._localStreams=[e]})),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){this._localStreams||(this._localStreams=[]);const t=this._localStreams.indexOf(e);if(-1===t)return;this._localStreams.splice(t,1);const r=e.getTracks();this.getSenders().forEach((e=>{r.includes(e.track)&&this.removeTrack(e)}))})}}function qn(e){if("object"===typeof e&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(e){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=e=>{e.streams.forEach((e=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(e))return;this._remoteStreams.push(e);const t=new Event("addstream");t.stream=e,this.dispatchEvent(t)}))})}});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((t=>{if(e._remoteStreams||(e._remoteStreams=[]),e._remoteStreams.indexOf(t)>=0)return;e._remoteStreams.push(t);const r=new Event("addstream");r.stream=t,e.dispatchEvent(r)}))}),t.apply(e,arguments)}}}function Wn(e){if("object"!==typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype,r=t.createOffer,n=t.createAnswer,i=t.setLocalDescription,a=t.setRemoteDescription,s=t.addIceCandidate;t.createOffer=function(e,t){const n=arguments.length>=2?arguments[2]:arguments[0],i=r.apply(this,[n]);return t?(i.then(e,t),Promise.resolve()):i},t.createAnswer=function(e,t){const r=arguments.length>=2?arguments[2]:arguments[0],i=n.apply(this,[r]);return t?(i.then(e,t),Promise.resolve()):i};let o=function(e,t,r){const n=i.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n};t.setLocalDescription=o,o=function(e,t,r){const n=a.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n},t.setRemoteDescription=o,o=function(e,t,r){const n=s.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n},t.addIceCandidate=o}function Hn(e){const t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){const e=t.mediaDevices,r=e.getUserMedia.bind(e);t.mediaDevices.getUserMedia=e=>r(Gn(e))}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,r,n){t.mediaDevices.getUserMedia(e).then(r,n)}.bind(t))}function Gn(e){return e&&void 0!==e.video?Object.assign({},e,{video:dn(e.video)}):e}function Kn(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,r){if(e&&e.iceServers){const t=[];for(let r=0;r<e.iceServers.length;r++){let n=e.iceServers[r];!n.hasOwnProperty("urls")&&n.hasOwnProperty("url")?(on("RTCIceServer.url","RTCIceServer.urls"),n=JSON.parse(JSON.stringify(n)),n.urls=n.url,delete n.url,t.push(n)):t.push(e.iceServers[r])}e.iceServers=t}return new t(e,r)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:()=>t.generateCertificate})}function Jn(e){"object"===typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function $n(e){const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){"undefined"!==typeof e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);const t=this.getTransceivers().find((e=>"audio"===e.receiver.track.kind));!1===e.offerToReceiveAudio&&t?"sendrecv"===t.direction?t.setDirection?t.setDirection("sendonly"):t.direction="sendonly":"recvonly"===t.direction&&(t.setDirection?t.setDirection("inactive"):t.direction="inactive"):!0!==e.offerToReceiveAudio||t||this.addTransceiver("audio"),"undefined"!==typeof e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);const r=this.getTransceivers().find((e=>"video"===e.receiver.track.kind));!1===e.offerToReceiveVideo&&r?"sendrecv"===r.direction?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":"recvonly"===r.direction&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):!0!==e.offerToReceiveVideo||r||this.addTransceiver("video")}return t.apply(this,arguments)}}function Qn(e){"object"!==typeof e||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var Xn=r(2232),Yn=r.n(Xn);function Zn(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"===typeof e&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){const r=new t(e),n=Yn().parseCandidate(e.candidate),i=Object.assign(r,n);return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,rn(e,"icecandidate",(t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t)))}function ei(e,t){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return"undefined"===typeof this._sctp?null:this._sctp}});const r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){const{sdpSemantics:e}=this.getConfiguration();"plan-b"===e&&Object.defineProperty(this,"sctp",{get(){return"undefined"===typeof this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(function(e){if(!e||!e.sdp)return!1;const t=Yn().splitSections(e.sdp);return t.shift(),t.some((e=>{const t=Yn().parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")}))}(arguments[0])){const e=function(e){const t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;const r=parseInt(t[1],10);return r!==r?-1:r}(arguments[0]),r=function(e){let r=65536;return"firefox"===t.browser&&(r=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),r}(e),n=function(e,r){let n=65536;"firefox"===t.browser&&57===t.version&&(n=65535);const i=Yn().matchPrefix(e.sdp,"a=max-message-size:");return i.length>0?n=parseInt(i[0].substr(19),10):"firefox"===t.browser&&-1!==r&&(n=2147483637),n}(arguments[0],e);let i;i=0===r&&0===n?Number.POSITIVE_INFINITY:0===r||0===n?Math.max(r,n):Math.min(r,n);const a={};Object.defineProperty(a,"maxMessageSize",{get:()=>i}),this._sctp=a}return r.apply(this,arguments)}}function ti(e){if(!e.RTCPeerConnection||!("createDataChannel"in e.RTCPeerConnection.prototype))return;function t(e,t){const r=e.send;e.send=function(){const n=arguments[0],i=n.length||n.size||n.byteLength;if("open"===e.readyState&&t.sctp&&i>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return r.apply(e,arguments)}}const r=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const e=r.apply(this,arguments);return t(e,this),e},rn(e,"datachannel",(e=>(t(e.channel,e.target),e)))}function ri(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((e=>{const r=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=e=>{const t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;const r=new Event("connectionstatechange",e);t.dispatchEvent(r)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),r.apply(this,arguments)}}))}function ni(e,t){if(!e.RTCPeerConnection)return;if("chrome"===t.browser&&t.version>=71)return;if("safari"===t.browser&&t.version>=605)return;const r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(t){if(t&&t.sdp&&-1!==t.sdp.indexOf("\na=extmap-allow-mixed")){const r=t.sdp.split("\n").filter((e=>"a=extmap-allow-mixed"!==e.trim())).join("\n");e.RTCSessionDescription&&t instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:t.type,sdp:r}):t.sdp=r}return r.apply(this,arguments)}}function ii(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const r=e.RTCPeerConnection.prototype.addIceCandidate;r&&0!==r.length&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===t.browser&&t.version<78||"firefox"===t.browser&&t.version<68||"safari"===t.browser)&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():r.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}const ai=function(){let{window:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0};const o=sn,c=function(e){const t={browser:null,version:null};if("undefined"===typeof e||!e.navigator)return t.browser="Not a browser.",t;const{navigator:r}=e;if(r.mozGetUserMedia)t.browser="firefox",t.version=tn(r.userAgent,/Firefox\/(\d+)\./,1);else if(r.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)t.browser="chrome",t.version=tn(r.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(r.mediaDevices&&r.userAgent.match(/Edge\/(\d+).(\d+)$/))t.browser="edge",t.version=tn(r.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!r.userAgent.match(/AppleWebKit\/(\d+)\./))return t.browser="Not a supported browser.",t;t.browser="safari",t.version=tn(r.userAgent,/AppleWebKit\/(\d+)\./,1),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return t}(e),d={browserDetails:c,commonShim:s,extractVersion:tn,disableLog:nn,disableWarnings:an};switch(c.browser){case"chrome":if(!t||!Sn||!r.shimChrome)return o("Chrome shim is not included in this adapter release."),d;if(null===c.version)return o("Chrome shim can not determine version, not shimming."),d;o("adapter.js shimming chrome."),d.browserShim=t,ii(e,c),hn(e,c),mn(e),Sn(e,c),gn(e),wn(e,c),vn(e),yn(e),bn(e),Cn(e,c),Zn(e),ri(e),ei(e,c),ti(e),ni(e,c);break;case"firefox":if(!i||!Mn||!r.shimFirefox)return o("Firefox shim is not included in this adapter release."),d;o("adapter.js shimming firefox."),d.browserShim=i,ii(e,c),On(e,c),Mn(e,c),In(e),An(e),Ln(e),jn(e),Nn(e),Fn(e),zn(e),Bn(e),Un(e),Zn(e),ri(e),ei(e,c),ti(e);break;case"edge":if(!n||!En||!r.shimEdge)return o("MS edge shim is not included in this adapter release."),d;o("adapter.js shimming edge."),d.browserShim=n,Tn(e),Pn(e),En(e,c),Dn(e),ei(e,c),ti(e);break;case"safari":if(!a||!r.shimSafari)return o("Safari shim is not included in this adapter release."),d;o("adapter.js shimming safari."),d.browserShim=a,ii(e,c),Kn(e),$n(e),Wn(e),Vn(e),qn(e),Jn(e),Hn(e),Qn(e),Zn(e),ei(e,c),ti(e),ni(e,c);break;default:o("Unsupported browser!")}return d}({window:"undefined"===typeof window?void 0:window}),si=ai;var oi=r(7181);const ci={randomUUID:"undefined"!==typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let di;const li=new Uint8Array(16);function ui(){if(!di&&(di="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!di))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return di(li)}const pi=[];for(let r=0;r<256;++r)pi.push((r+256).toString(16).slice(1));function hi(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return pi[e[t+0]]+pi[e[t+1]]+pi[e[t+2]]+pi[e[t+3]]+"-"+pi[e[t+4]]+pi[e[t+5]]+"-"+pi[e[t+6]]+pi[e[t+7]]+"-"+pi[e[t+8]]+pi[e[t+9]]+"-"+pi[e[t+10]]+pi[e[t+11]]+pi[e[t+12]]+pi[e[t+13]]+pi[e[t+14]]+pi[e[t+15]]}const fi=function(e,t,r){if(ci.randomUUID&&!t&&!e)return ci.randomUUID();const n=(e=e||{}).random||(e.rng||ui)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=n[e];return t}return hi(n)};var mi=r(9340),gi=r(8380),vi=r.n(gi),yi=r(3928),bi=r.n(yi);function _i(e,t){return function(){return e.apply(t,arguments)}}const{toString:wi}=Object.prototype,{getPrototypeOf:Si}=Object,Ci=(e=>t=>{const r=wi.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),ki=e=>(e=e.toLowerCase(),t=>Ci(t)===e),Ri=e=>t=>typeof t===e,{isArray:Ti}=Array,Pi=Ri("undefined");const Ei=ki("ArrayBuffer");const Di=Ri("string"),Oi=Ri("function"),xi=Ri("number"),Ii=e=>null!==e&&"object"===typeof e,Mi=e=>{if("object"!==Ci(e))return!1;const t=Si(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},Li=ki("Date"),ji=ki("File"),Ai=ki("Blob"),Ni=ki("FileList"),Fi=ki("URLSearchParams");function zi(e,t){let r,n,{allOwnKeys:i=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!==e&&"undefined"!==typeof e)if("object"!==typeof e&&(e=[e]),Ti(e))for(r=0,n=e.length;r<n;r++)t.call(null,e[r],r,e);else{const n=i?Object.getOwnPropertyNames(e):Object.keys(e),a=n.length;let s;for(r=0;r<a;r++)s=n[r],t.call(null,e[s],s,e)}}function Bi(e,t){t=t.toLowerCase();const r=Object.keys(e);let n,i=r.length;for(;i-- >0;)if(n=r[i],t===n.toLowerCase())return n;return null}const Ui="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:global,Vi=e=>!Pi(e)&&e!==Ui;const qi=(Wi="undefined"!==typeof Uint8Array&&Si(Uint8Array),e=>Wi&&e instanceof Wi);var Wi;const Hi=ki("HTMLFormElement"),Gi=(e=>{let{hasOwnProperty:t}=e;return(e,r)=>t.call(e,r)})(Object.prototype),Ki=ki("RegExp"),Ji=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};zi(r,((r,i)=>{let a;!1!==(a=t(r,i,e))&&(n[i]=a||r)})),Object.defineProperties(e,n)},$i="abcdefghijklmnopqrstuvwxyz",Qi="0123456789",Xi={DIGIT:Qi,ALPHA:$i,ALPHA_DIGIT:$i+$i.toUpperCase()+Qi};const Yi=ki("AsyncFunction"),Zi={isArray:Ti,isArrayBuffer:Ei,isBuffer:function(e){return null!==e&&!Pi(e)&&null!==e.constructor&&!Pi(e.constructor)&&Oi(e.constructor.isBuffer)&&e.constructor.isBuffer(e)},isFormData:e=>{let t;return e&&("function"===typeof FormData&&e instanceof FormData||Oi(e.append)&&("formdata"===(t=Ci(e))||"object"===t&&Oi(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let t;return t="undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&Ei(e.buffer),t},isString:Di,isNumber:xi,isBoolean:e=>!0===e||!1===e,isObject:Ii,isPlainObject:Mi,isUndefined:Pi,isDate:Li,isFile:ji,isBlob:Ai,isRegExp:Ki,isFunction:Oi,isStream:e=>Ii(e)&&Oi(e.pipe),isURLSearchParams:Fi,isTypedArray:qi,isFileList:Ni,forEach:zi,merge:function e(){const{caseless:t}=Vi(this)&&this||{},r={},n=(n,i)=>{const a=t&&Bi(r,i)||i;Mi(r[a])&&Mi(n)?r[a]=e(r[a],n):Mi(n)?r[a]=e({},n):Ti(n)?r[a]=n.slice():r[a]=n};for(let i=0,a=arguments.length;i<a;i++)arguments[i]&&zi(arguments[i],n);return r},extend:function(e,t,r){let{allOwnKeys:n}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return zi(t,((t,n)=>{r&&Oi(t)?e[n]=_i(t,r):e[n]=t}),{allOwnKeys:n}),e},trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},toFlatObject:(e,t,r,n)=>{let i,a,s;const o={};if(t=t||{},null==e)return t;do{for(i=Object.getOwnPropertyNames(e),a=i.length;a-- >0;)s=i[a],n&&!n(s,e,t)||o[s]||(t[s]=e[s],o[s]=!0);e=!1!==r&&Si(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},kindOf:Ci,kindOfTest:ki,endsWith:(e,t,r)=>{e=String(e),(void 0===r||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return-1!==n&&n===r},toArray:e=>{if(!e)return null;if(Ti(e))return e;let t=e.length;if(!xi(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},forEachEntry:(e,t)=>{const r=(e&&e[Symbol.iterator]).call(e);let n;for(;(n=r.next())&&!n.done;){const r=n.value;t.call(e,r[0],r[1])}},matchAll:(e,t)=>{let r;const n=[];for(;null!==(r=e.exec(t));)n.push(r);return n},isHTMLForm:Hi,hasOwnProperty:Gi,hasOwnProp:Gi,reduceDescriptors:Ji,freezeMethods:e=>{Ji(e,((t,r)=>{if(Oi(e)&&-1!==["arguments","caller","callee"].indexOf(r))return!1;const n=e[r];Oi(n)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")}))}))},toObjectSet:(e,t)=>{const r={},n=e=>{e.forEach((e=>{r[e]=!0}))};return Ti(e)?n(e):n(String(e).split(t)),r},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(e,t,r){return t.toUpperCase()+r})),noop:()=>{},toFiniteNumber:(e,t)=>(e=+e,Number.isFinite(e)?e:t),findKey:Bi,global:Ui,isContextDefined:Vi,ALPHABET:Xi,generateString:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Xi.ALPHA_DIGIT,r="";const{length:n}=t;for(;e--;)r+=t[Math.random()*n|0];return r},isSpecCompliantForm:function(e){return!!(e&&Oi(e.append)&&"FormData"===e[Symbol.toStringTag]&&e[Symbol.iterator])},toJSONObject:e=>{const t=new Array(10),r=(e,n)=>{if(Ii(e)){if(t.indexOf(e)>=0)return;if(!("toJSON"in e)){t[n]=e;const i=Ti(e)?[]:{};return zi(e,((e,t)=>{const a=r(e,n+1);!Pi(a)&&(i[t]=a)})),t[n]=void 0,i}}return e};return r(e,0)},isAsyncFn:Yi,isThenable:e=>e&&(Ii(e)||Oi(e))&&Oi(e.then)&&Oi(e.catch)};function ea(e,t,r,n,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),i&&(this.response=i)}Zi.inherits(ea,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Zi.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const ta=ea.prototype,ra={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach((e=>{ra[e]={value:e}})),Object.defineProperties(ea,ra),Object.defineProperty(ta,"isAxiosError",{value:!0}),ea.from=(e,t,r,n,i,a)=>{const s=Object.create(ta);return Zi.toFlatObject(e,s,(function(e){return e!==Error.prototype}),(e=>"isAxiosError"!==e)),ea.call(s,e.message,t,r,n,i),s.cause=e,s.name=e.name,a&&Object.assign(s,a),s};const na=ea;function ia(e){return Zi.isPlainObject(e)||Zi.isArray(e)}function aa(e){return Zi.endsWith(e,"[]")?e.slice(0,-2):e}function sa(e,t,r){return e?e.concat(t).map((function(e,t){return e=aa(e),!r&&t?"["+e+"]":e})).join(r?".":""):t}const oa=Zi.toFlatObject(Zi,{},null,(function(e){return/^is[A-Z]/.test(e)}));const ca=function(e,t,r){if(!Zi.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;const n=(r=Zi.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(e,t){return!Zi.isUndefined(t[e])}))).metaTokens,i=r.visitor||d,a=r.dots,s=r.indexes,o=(r.Blob||"undefined"!==typeof Blob&&Blob)&&Zi.isSpecCompliantForm(t);if(!Zi.isFunction(i))throw new TypeError("visitor must be a function");function c(e){if(null===e)return"";if(Zi.isDate(e))return e.toISOString();if(!o&&Zi.isBlob(e))throw new na("Blob is not supported. Use a Buffer instead.");return Zi.isArrayBuffer(e)||Zi.isTypedArray(e)?o&&"function"===typeof Blob?new Blob([e]):Buffer.from(e):e}function d(e,r,i){let o=e;if(e&&!i&&"object"===typeof e)if(Zi.endsWith(r,"{}"))r=n?r:r.slice(0,-2),e=JSON.stringify(e);else if(Zi.isArray(e)&&function(e){return Zi.isArray(e)&&!e.some(ia)}(e)||(Zi.isFileList(e)||Zi.endsWith(r,"[]"))&&(o=Zi.toArray(e)))return r=aa(r),o.forEach((function(e,n){!Zi.isUndefined(e)&&null!==e&&t.append(!0===s?sa([r],n,a):null===s?r:r+"[]",c(e))})),!1;return!!ia(e)||(t.append(sa(i,r,a),c(e)),!1)}const l=[],u=Object.assign(oa,{defaultVisitor:d,convertValue:c,isVisitable:ia});if(!Zi.isObject(e))throw new TypeError("data must be an object");return function e(r,n){if(!Zi.isUndefined(r)){if(-1!==l.indexOf(r))throw Error("Circular reference detected in "+n.join("."));l.push(r),Zi.forEach(r,(function(r,a){!0===(!(Zi.isUndefined(r)||null===r)&&i.call(t,r,Zi.isString(a)?a.trim():a,n,u))&&e(r,n?n.concat(a):[a])})),l.pop()}}(e),t};function da(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,(function(e){return t[e]}))}function la(e,t){this._pairs=[],e&&ca(e,this,t)}const ua=la.prototype;ua.append=function(e,t){this._pairs.push([e,t])},ua.toString=function(e){const t=e?function(t){return e.call(this,t,da)}:da;return this._pairs.map((function(e){return t(e[0])+"="+t(e[1])}),"").join("&")};const pa=la;function ha(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function fa(e,t,r){if(!t)return e;const n=r&&r.encode||ha,i=r&&r.serialize;let a;if(a=i?i(t,r):Zi.isURLSearchParams(t)?t.toString():new pa(t,r).toString(n),a){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+a}return e}const ma=class{constructor(){this.handlers=[]}use(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!r&&r.synchronous,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){Zi.forEach(this.handlers,(function(t){null!==t&&e(t)}))}},ga={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},va={isBrowser:!0,classes:{URLSearchParams:"undefined"!==typeof URLSearchParams?URLSearchParams:pa,FormData:"undefined"!==typeof FormData?FormData:null,Blob:"undefined"!==typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},ya="undefined"!==typeof window&&"undefined"!==typeof document,ba=(_a="undefined"!==typeof navigator&&navigator.product,ya&&["ReactNative","NativeScript","NS"].indexOf(_a)<0);var _a;const wa="undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"===typeof self.importScripts,Sa={...o,...va};const Ca=function(e){function t(e,r,n,i){let a=e[i++];if("__proto__"===a)return!0;const s=Number.isFinite(+a),o=i>=e.length;if(a=!a&&Zi.isArray(n)?n.length:a,o)return Zi.hasOwnProp(n,a)?n[a]=[n[a],r]:n[a]=r,!s;n[a]&&Zi.isObject(n[a])||(n[a]=[]);return t(e,r,n[a],i)&&Zi.isArray(n[a])&&(n[a]=function(e){const t={},r=Object.keys(e);let n;const i=r.length;let a;for(n=0;n<i;n++)a=r[n],t[a]=e[a];return t}(n[a])),!s}if(Zi.isFormData(e)&&Zi.isFunction(e.entries)){const r={};return Zi.forEachEntry(e,((e,n)=>{t(function(e){return Zi.matchAll(/\w+|\[(\w*)]/g,e).map((e=>"[]"===e[0]?"":e[1]||e[0]))}(e),n,r,0)})),r}return null};const ka={transitional:ga,adapter:["xhr","http"],transformRequest:[function(e,t){const r=t.getContentType()||"",n=r.indexOf("application/json")>-1,i=Zi.isObject(e);i&&Zi.isHTMLForm(e)&&(e=new FormData(e));if(Zi.isFormData(e))return n?JSON.stringify(Ca(e)):e;if(Zi.isArrayBuffer(e)||Zi.isBuffer(e)||Zi.isStream(e)||Zi.isFile(e)||Zi.isBlob(e))return e;if(Zi.isArrayBufferView(e))return e.buffer;if(Zi.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(i){if(r.indexOf("application/x-www-form-urlencoded")>-1)return function(e,t){return ca(e,new Sa.classes.URLSearchParams,Object.assign({visitor:function(e,t,r,n){return Sa.isNode&&Zi.isBuffer(e)?(this.append(t,e.toString("base64")),!1):n.defaultVisitor.apply(this,arguments)}},t))}(e,this.formSerializer).toString();if((a=Zi.isFileList(e))||r.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return ca(a?{"files[]":e}:e,t&&new t,this.formSerializer)}}return i||n?(t.setContentType("application/json",!1),function(e,t,r){if(Zi.isString(e))try{return(t||JSON.parse)(e),Zi.trim(e)}catch(n){if("SyntaxError"!==n.name)throw n}return(r||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const t=this.transitional||ka.transitional,r=t&&t.forcedJSONParsing,n="json"===this.responseType;if(e&&Zi.isString(e)&&(r&&!this.responseType||n)){const r=!(t&&t.silentJSONParsing)&&n;try{return JSON.parse(e)}catch(i){if(r){if("SyntaxError"===i.name)throw na.from(i,na.ERR_BAD_RESPONSE,this,null,this.response);throw i}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Sa.classes.FormData,Blob:Sa.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Zi.forEach(["delete","get","head","post","put","patch"],(e=>{ka.headers[e]={}}));const Ra=ka,Ta=Zi.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Pa=Symbol("internals");function Ea(e){return e&&String(e).trim().toLowerCase()}function Da(e){return!1===e||null==e?e:Zi.isArray(e)?e.map(Da):String(e)}function Oa(e,t,r,n,i){return Zi.isFunction(n)?n.call(this,t,r):(i&&(t=r),Zi.isString(t)?Zi.isString(n)?-1!==t.indexOf(n):Zi.isRegExp(n)?n.test(t):void 0:void 0)}class xa{constructor(e){e&&this.set(e)}set(e,t,r){const n=this;function i(e,t,r){const i=Ea(t);if(!i)throw new Error("header name must be a non-empty string");const a=Zi.findKey(n,i);(!a||void 0===n[a]||!0===r||void 0===r&&!1!==n[a])&&(n[a||t]=Da(e))}const a=(e,t)=>Zi.forEach(e,((e,r)=>i(e,r,t)));return Zi.isPlainObject(e)||e instanceof this.constructor?a(e,t):Zi.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim())?a((e=>{const t={};let r,n,i;return e&&e.split("\n").forEach((function(e){i=e.indexOf(":"),r=e.substring(0,i).trim().toLowerCase(),n=e.substring(i+1).trim(),!r||t[r]&&Ta[r]||("set-cookie"===r?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)})),t})(e),t):null!=e&&i(t,e,r),this}get(e,t){if(e=Ea(e)){const r=Zi.findKey(this,e);if(r){const e=this[r];if(!t)return e;if(!0===t)return function(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}(e);if(Zi.isFunction(t))return t.call(this,e,r);if(Zi.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=Ea(e)){const r=Zi.findKey(this,e);return!(!r||void 0===this[r]||t&&!Oa(0,this[r],r,t))}return!1}delete(e,t){const r=this;let n=!1;function i(e){if(e=Ea(e)){const i=Zi.findKey(r,e);!i||t&&!Oa(0,r[i],i,t)||(delete r[i],n=!0)}}return Zi.isArray(e)?e.forEach(i):i(e),n}clear(e){const t=Object.keys(this);let r=t.length,n=!1;for(;r--;){const i=t[r];e&&!Oa(0,this[i],i,e,!0)||(delete this[i],n=!0)}return n}normalize(e){const t=this,r={};return Zi.forEach(this,((n,i)=>{const a=Zi.findKey(r,i);if(a)return t[a]=Da(n),void delete t[i];const s=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,((e,t,r)=>t.toUpperCase()+r))}(i):String(i).trim();s!==i&&delete t[i],t[s]=Da(n),r[s]=!0})),this}concat(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.constructor.concat(this,...t)}toJSON(e){const t=Object.create(null);return Zi.forEach(this,((r,n)=>{null!=r&&!1!==r&&(t[n]=e&&Zi.isArray(r)?r.join(", "):r)})),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map((e=>{let[t,r]=e;return t+": "+r})).join("\n")}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e){const t=new this(e);for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return n.forEach((e=>t.set(e))),t}static accessor(e){const t=(this[Pa]=this[Pa]={accessors:{}}).accessors,r=this.prototype;function n(e){const n=Ea(e);t[n]||(!function(e,t){const r=Zi.toCamelCase(" "+t);["get","set","has"].forEach((n=>{Object.defineProperty(e,n+r,{value:function(e,r,i){return this[n].call(this,t,e,r,i)},configurable:!0})}))}(r,e),t[n]=!0)}return Zi.isArray(e)?e.forEach(n):n(e),this}}xa.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),Zi.reduceDescriptors(xa.prototype,((e,t)=>{let{value:r}=e,n=t[0].toUpperCase()+t.slice(1);return{get:()=>r,set(e){this[n]=e}}})),Zi.freezeMethods(xa);const Ia=xa;function Ma(e,t){const r=this||Ra,n=t||r,i=Ia.from(n.headers);let a=n.data;return Zi.forEach(e,(function(e){a=e.call(r,a,i.normalize(),t?t.status:void 0)})),i.normalize(),a}function La(e){return!(!e||!e.__CANCEL__)}function ja(e,t,r){na.call(this,null==e?"canceled":e,na.ERR_CANCELED,t,r),this.name="CanceledError"}Zi.inherits(ja,na,{__CANCEL__:!0});const Aa=ja;const Na=Sa.hasStandardBrowserEnv?{write(e,t,r,n,i,a){const s=[e+"="+encodeURIComponent(t)];Zi.isNumber(r)&&s.push("expires="+new Date(r).toGMTString()),Zi.isString(n)&&s.push("path="+n),Zi.isString(i)&&s.push("domain="+i),!0===a&&s.push("secure"),document.cookie=s.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function Fa(e,t){return e&&!function(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}(t)?function(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}const za=Sa.hasStandardBrowserEnv?function(){const e=/(msie|trident)/i.test(navigator.userAgent),t=document.createElement("a");let r;function n(r){let n=r;return e&&(t.setAttribute("href",n),n=t.href),t.setAttribute("href",n),{href:t.href,protocol:t.protocol?t.protocol.replace(/:$/,""):"",host:t.host,search:t.search?t.search.replace(/^\?/,""):"",hash:t.hash?t.hash.replace(/^#/,""):"",hostname:t.hostname,port:t.port,pathname:"/"===t.pathname.charAt(0)?t.pathname:"/"+t.pathname}}return r=n(window.location.href),function(e){const t=Zi.isString(e)?n(e):e;return t.protocol===r.protocol&&t.host===r.host}}():function(){return!0};const Ba=function(e,t){e=e||10;const r=new Array(e),n=new Array(e);let i,a=0,s=0;return t=void 0!==t?t:1e3,function(o){const c=Date.now(),d=n[s];i||(i=c),r[a]=o,n[a]=c;let l=s,u=0;for(;l!==a;)u+=r[l++],l%=e;if(a=(a+1)%e,a===s&&(s=(s+1)%e),c-i<t)return;const p=d&&c-d;return p?Math.round(1e3*u/p):void 0}};function Ua(e,t){let r=0;const n=Ba(50,250);return i=>{const a=i.loaded,s=i.lengthComputable?i.total:void 0,o=a-r,c=n(o);r=a;const d={loaded:a,total:s,progress:s?a/s:void 0,bytes:o,rate:c||void 0,estimated:c&&s&&a<=s?(s-a)/c:void 0,event:i};d[t?"download":"upload"]=!0,e(d)}}const Va="undefined"!==typeof XMLHttpRequest&&function(e){return new Promise((function(t,r){let n=e.data;const i=Ia.from(e.headers).normalize();let a,s,{responseType:o,withXSRFToken:c}=e;function d(){e.cancelToken&&e.cancelToken.unsubscribe(a),e.signal&&e.signal.removeEventListener("abort",a)}if(Zi.isFormData(n))if(Sa.hasStandardBrowserEnv||Sa.hasStandardBrowserWebWorkerEnv)i.setContentType(!1);else if(!1!==(s=i.getContentType())){const[e,...t]=s?s.split(";").map((e=>e.trim())).filter(Boolean):[];i.setContentType([e||"multipart/form-data",...t].join("; "))}let l=new XMLHttpRequest;if(e.auth){const t=e.auth.username||"",r=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";i.set("Authorization","Basic "+btoa(t+":"+r))}const u=Fa(e.baseURL,e.url);function p(){if(!l)return;const n=Ia.from("getAllResponseHeaders"in l&&l.getAllResponseHeaders());!function(e,t,r){const n=r.config.validateStatus;r.status&&n&&!n(r.status)?t(new na("Request failed with status code "+r.status,[na.ERR_BAD_REQUEST,na.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r)):e(r)}((function(e){t(e),d()}),(function(e){r(e),d()}),{data:o&&"text"!==o&&"json"!==o?l.response:l.responseText,status:l.status,statusText:l.statusText,headers:n,config:e,request:l}),l=null}if(l.open(e.method.toUpperCase(),fa(u,e.params,e.paramsSerializer),!0),l.timeout=e.timeout,"onloadend"in l?l.onloadend=p:l.onreadystatechange=function(){l&&4===l.readyState&&(0!==l.status||l.responseURL&&0===l.responseURL.indexOf("file:"))&&setTimeout(p)},l.onabort=function(){l&&(r(new na("Request aborted",na.ECONNABORTED,e,l)),l=null)},l.onerror=function(){r(new na("Network Error",na.ERR_NETWORK,e,l)),l=null},l.ontimeout=function(){let t=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded";const n=e.transitional||ga;e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),r(new na(t,n.clarifyTimeoutError?na.ETIMEDOUT:na.ECONNABORTED,e,l)),l=null},Sa.hasStandardBrowserEnv&&(c&&Zi.isFunction(c)&&(c=c(e)),c||!1!==c&&za(u))){const t=e.xsrfHeaderName&&e.xsrfCookieName&&Na.read(e.xsrfCookieName);t&&i.set(e.xsrfHeaderName,t)}void 0===n&&i.setContentType(null),"setRequestHeader"in l&&Zi.forEach(i.toJSON(),(function(e,t){l.setRequestHeader(t,e)})),Zi.isUndefined(e.withCredentials)||(l.withCredentials=!!e.withCredentials),o&&"json"!==o&&(l.responseType=e.responseType),"function"===typeof e.onDownloadProgress&&l.addEventListener("progress",Ua(e.onDownloadProgress,!0)),"function"===typeof e.onUploadProgress&&l.upload&&l.upload.addEventListener("progress",Ua(e.onUploadProgress)),(e.cancelToken||e.signal)&&(a=t=>{l&&(r(!t||t.type?new Aa(null,e,l):t),l.abort(),l=null)},e.cancelToken&&e.cancelToken.subscribe(a),e.signal&&(e.signal.aborted?a():e.signal.addEventListener("abort",a)));const h=function(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(u);h&&-1===Sa.protocols.indexOf(h)?r(new na("Unsupported protocol "+h+":",na.ERR_BAD_REQUEST,e)):l.send(n||null)}))},qa={http:null,xhr:Va};Zi.forEach(qa,((e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(r){}Object.defineProperty(e,"adapterName",{value:t})}}));const Wa=e=>"- ".concat(e),Ha=e=>Zi.isFunction(e)||null===e||!1===e,Ga=e=>{e=Zi.isArray(e)?e:[e];const{length:t}=e;let r,n;const i={};for(let a=0;a<t;a++){let t;if(r=e[a],n=r,!Ha(r)&&(n=qa[(t=String(r)).toLowerCase()],void 0===n))throw new na("Unknown adapter '".concat(t,"'"));if(n)break;i[t||"#"+a]=n}if(!n){const e=Object.entries(i).map((e=>{let[t,r]=e;return"adapter ".concat(t," ")+(!1===r?"is not supported by the environment":"is not available in the build")}));let r=t?e.length>1?"since :\n"+e.map(Wa).join("\n"):" "+Wa(e[0]):"as no adapter specified";throw new na("There is no suitable adapter to dispatch the request "+r,"ERR_NOT_SUPPORT")}return n};function Ka(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Aa(null,e)}function Ja(e){Ka(e),e.headers=Ia.from(e.headers),e.data=Ma.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1);return Ga(e.adapter||Ra.adapter)(e).then((function(t){return Ka(e),t.data=Ma.call(e,e.transformResponse,t),t.headers=Ia.from(t.headers),t}),(function(t){return La(t)||(Ka(e),t&&t.response&&(t.response.data=Ma.call(e,e.transformResponse,t.response),t.response.headers=Ia.from(t.response.headers))),Promise.reject(t)}))}const $a=e=>e instanceof Ia?e.toJSON():e;function Qa(e,t){t=t||{};const r={};function n(e,t,r){return Zi.isPlainObject(e)&&Zi.isPlainObject(t)?Zi.merge.call({caseless:r},e,t):Zi.isPlainObject(t)?Zi.merge({},t):Zi.isArray(t)?t.slice():t}function i(e,t,r){return Zi.isUndefined(t)?Zi.isUndefined(e)?void 0:n(void 0,e,r):n(e,t,r)}function a(e,t){if(!Zi.isUndefined(t))return n(void 0,t)}function s(e,t){return Zi.isUndefined(t)?Zi.isUndefined(e)?void 0:n(void 0,e):n(void 0,t)}function o(r,i,a){return a in t?n(r,i):a in e?n(void 0,r):void 0}const c={url:a,method:a,data:a,baseURL:s,transformRequest:s,transformResponse:s,paramsSerializer:s,timeout:s,timeoutMessage:s,withCredentials:s,withXSRFToken:s,adapter:s,responseType:s,xsrfCookieName:s,xsrfHeaderName:s,onUploadProgress:s,onDownloadProgress:s,decompress:s,maxContentLength:s,maxBodyLength:s,beforeRedirect:s,transport:s,httpAgent:s,httpsAgent:s,cancelToken:s,socketPath:s,responseEncoding:s,validateStatus:o,headers:(e,t)=>i($a(e),$a(t),!0)};return Zi.forEach(Object.keys(Object.assign({},e,t)),(function(n){const a=c[n]||i,s=a(e[n],t[n],n);Zi.isUndefined(s)&&a!==o||(r[n]=s)})),r}const Xa="1.6.7",Ya={};["object","boolean","number","function","string","symbol"].forEach(((e,t)=>{Ya[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}}));const Za={};Ya.transitional=function(e,t,r){function n(e,t){return"[Axios v1.6.7] Transitional option '"+e+"'"+t+(r?". "+r:"")}return(r,i,a)=>{if(!1===e)throw new na(n(i," has been removed"+(t?" in "+t:"")),na.ERR_DEPRECATED);return t&&!Za[i]&&(Za[i]=!0,console.warn(n(i," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(r,i,a)}};const es={assertOptions:function(e,t,r){if("object"!==typeof e)throw new na("options must be an object",na.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let i=n.length;for(;i-- >0;){const a=n[i],s=t[a];if(s){const t=e[a],r=void 0===t||s(t,a,e);if(!0!==r)throw new na("option "+a+" must be "+r,na.ERR_BAD_OPTION_VALUE)}else if(!0!==r)throw new na("Unknown option "+a,na.ERR_BAD_OPTION)}},validators:Ya},ts=es.validators;class rs{constructor(e){this.defaults=e,this.interceptors={request:new ma,response:new ma}}async request(e,t){try{return await this._request(e,t)}catch(xu){if(xu instanceof Error){let t;Error.captureStackTrace?Error.captureStackTrace(t={}):t=new Error;const r=t.stack?t.stack.replace(/^.+\n/,""):"";xu.stack?r&&!String(xu.stack).endsWith(r.replace(/^.+\n.+\n/,""))&&(xu.stack+="\n"+r):xu.stack=r}throw xu}}_request(e,t){"string"===typeof e?(t=t||{}).url=e:t=e||{},t=Qa(this.defaults,t);const{transitional:r,paramsSerializer:n,headers:i}=t;void 0!==r&&es.assertOptions(r,{silentJSONParsing:ts.transitional(ts.boolean),forcedJSONParsing:ts.transitional(ts.boolean),clarifyTimeoutError:ts.transitional(ts.boolean)},!1),null!=n&&(Zi.isFunction(n)?t.paramsSerializer={serialize:n}:es.assertOptions(n,{encode:ts.function,serialize:ts.function},!0)),t.method=(t.method||this.defaults.method||"get").toLowerCase();let a=i&&Zi.merge(i.common,i[t.method]);i&&Zi.forEach(["delete","get","head","post","put","patch","common"],(e=>{delete i[e]})),t.headers=Ia.concat(a,i);const s=[];let o=!0;this.interceptors.request.forEach((function(e){"function"===typeof e.runWhen&&!1===e.runWhen(t)||(o=o&&e.synchronous,s.unshift(e.fulfilled,e.rejected))}));const c=[];let d;this.interceptors.response.forEach((function(e){c.push(e.fulfilled,e.rejected)}));let l,u=0;if(!o){const e=[Ja.bind(this),void 0];for(e.unshift.apply(e,s),e.push.apply(e,c),l=e.length,d=Promise.resolve(t);u<l;)d=d.then(e[u++],e[u++]);return d}l=s.length;let p=t;for(u=0;u<l;){const e=s[u++],t=s[u++];try{p=e(p)}catch(h){t.call(this,h);break}}try{d=Ja.call(this,p)}catch(h){return Promise.reject(h)}for(u=0,l=c.length;u<l;)d=d.then(c[u++],c[u++]);return d}getUri(e){return fa(Fa((e=Qa(this.defaults,e)).baseURL,e.url),e.params,e.paramsSerializer)}}Zi.forEach(["delete","get","head","options"],(function(e){rs.prototype[e]=function(t,r){return this.request(Qa(r||{},{method:e,url:t,data:(r||{}).data}))}})),Zi.forEach(["post","put","patch"],(function(e){function t(t){return function(r,n,i){return this.request(Qa(i||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:r,data:n}))}}rs.prototype[e]=t(),rs.prototype[e+"Form"]=t(!0)}));const ns=rs;class is{constructor(e){if("function"!==typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise((function(e){t=e}));const r=this;this.promise.then((e=>{if(!r._listeners)return;let t=r._listeners.length;for(;t-- >0;)r._listeners[t](e);r._listeners=null})),this.promise.then=e=>{let t;const n=new Promise((e=>{r.subscribe(e),t=e})).then(e);return n.cancel=function(){r.unsubscribe(t)},n},e((function(e,n,i){r.reason||(r.reason=new Aa(e,n,i),t(r.reason))}))}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}static source(){let e;return{token:new is((function(t){e=t})),cancel:e}}}const as=is;const ss={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(ss).forEach((e=>{let[t,r]=e;ss[r]=t}));const os=ss;const cs=function e(t){const r=new ns(t),n=_i(ns.prototype.request,r);return Zi.extend(n,ns.prototype,r,{allOwnKeys:!0}),Zi.extend(n,r,null,{allOwnKeys:!0}),n.create=function(r){return e(Qa(t,r))},n}(Ra);cs.Axios=ns,cs.CanceledError=Aa,cs.CancelToken=as,cs.isCancel=La,cs.VERSION=Xa,cs.toFormData=ca,cs.AxiosError=na,cs.Cancel=cs.CanceledError,cs.all=function(e){return Promise.all(e)},cs.spread=function(e){return function(t){return e.apply(null,t)}},cs.isAxiosError=function(e){return Zi.isObject(e)&&!0===e.isAxiosError},cs.mergeConfig=Qa,cs.AxiosHeaders=Ia,cs.formToJSON=e=>Ca(Zi.isHTMLForm(e)?new FormData(e):e),cs.getAdapter=Ga,cs.HttpStatusCode=os,cs.default=cs;const ds=cs;function ls(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}function us(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{c(n.next(e))}catch(t){a(t)}}function o(e){try{c(n.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}c((n=n.apply(e,t||[])).next())}))}function ps(e){let t,{delay:r=500,edges:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=0;return function(){for(var a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];i+=1,n&&1===i&&e(...s),clearTimeout(t),t=setTimeout((()=>{(!n||i>1)&&e(...s),t=void 0,i=0}),r)}}"function"===typeof SuppressedError&&SuppressedError;var hs=e=>{var{muted:t,mirror:r=!1,stream:n,onResize:i}=e,a=ls(e,["muted","mirror","stream","onResize"]);const s=(0,c.useRef)(null);return(0,c.useEffect)((()=>{if(!s.current||!i)return;const e=new ResizeObserver(ps((()=>{s.current&&(null===n||void 0===n?void 0:n.id)&&i({width:s.current.clientWidth,height:s.current.clientHeight,stream:n})}),{delay:1e3,edges:!0}));return e.observe(s.current),()=>{e.disconnect()}}),[n]),(0,c.useEffect)((()=>{s.current&&(s.current.srcObject!==n&&(s.current.srcObject=n),s.current.muted!==t&&(s.current.muted=Boolean(t)))}),[t,n,s]),c.createElement("video",Object.assign({ref:s,autoPlay:!0,playsInline:!0},a,{style:Object.assign({transform:r?"scaleX(-1)":"none",width:"100%",height:"100%"},a.style)}))};const fs=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=new Map,{extra:r,onError:n=Et}=e;ot(n);const i=e=>{let r=De(Array.from(t.values()),(t=>t.effect===e.effect));return r||(r=St(e)),(e=>(e.unsubscribe=()=>t.delete(e.id),t.set(e.id,e),t=>{e.unsubscribe(),null!==t&&void 0!==t&&t.cancelActive&&Ct(e)}))(r)};Object.assign(i,{withTypes:()=>i});const a=e=>{const{type:r,effect:n,predicate:i}=wt(e),a=De(Array.from(t.values()),(e=>("string"===typeof r?e.type===r:e.predicate===i)&&e.effect===n));return a&&(a.unsubscribe(),e.cancelActive&&Ct(a)),!!a};Object.assign(a,{withTypes:()=>a});const s=async(e,a,s,o)=>{const c=new AbortController,d=_t(i,c.signal),l=[];try{e.pending.add(c),await Promise.resolve(e.effect(a,gt({},s,{getOriginalState:o,condition:(e,t)=>d(e,t).then(Boolean),take:d,delay:mt(c.signal),pause:ft(c.signal),extra:r,signal:c.signal,fork:bt(c.signal,l),unsubscribe:e.unsubscribe,subscribe:()=>{t.set(e.id,e)},cancelActiveListeners:()=>{e.pending.forEach(((e,t,r)=>{e!==c&&(ut(e,it),r.delete(e))}))},cancel:()=>{ut(c,it),e.pending.delete(c)},throwIfCancelled:()=>{pt(c.signal)}})))}catch(u){u instanceof st||kt(n,u,{raisedBy:"effect"})}finally{await Promise.all(l),ut(c,at),e.pending.delete(c)}},o=(e=>()=>{e.forEach(Ct),e.clear()})(t);return{middleware:e=>r=>c=>{if(!Se(c))return r(c);if(Rt.match(c))return i(c.payload);if(Tt.match(c))return void o();if(Pt.match(c))return a(c.payload);let d=e.getState();const l=()=>{if(d===vt)throw new Error(Dt(23));return d};let u;try{if(u=r(c),t.size>0){const r=e.getState(),i=Array.from(t.values());for(const t of i){let i=!1;try{i=t.predicate(c,r,d)}catch(p){i=!1,kt(n,p,{raisedBy:"predicate"})}i&&s(t,c,e,l)}}}finally{d=vt}return u},startListening:i,stopListening:a,clearListeners:o}}(),ms=fs.startListening,gs=(e,t)=>ms({predicate:(t,r,n)=>{const i=e.map((e=>e(n))),a=e.map((e=>e(r)));return i.some(((e,t)=>e!==a[t]))},effect:(r,n)=>{let{dispatch:i,getState:a,extra:s}=n;const o=e.map((e=>e(a())));t({dispatch:i,getState:a,extra:s},...o)}}),vs=Xe({name:"app",initialState:{wantsToJoin:!1,roomName:null,roomKey:null,roomUrl:null,displayName:null,sdkVersion:null,externalId:null},reducers:{doAppJoin:(e,t)=>{const r=new URL(t.payload.roomUrl);return Object.assign(Object.assign(Object.assign({},e),t.payload),{roomName:r.pathname,wantsToJoin:!0})},appLeft:e=>Object.assign(Object.assign({},e),{wantsToJoin:!1}),setRoomKey:(e,t)=>Object.assign(Object.assign({},e),{roomKey:t.payload})}}),{doAppJoin:ys,appLeft:bs,setRoomKey:_s}=vs.actions,ws=e=>e.app.wantsToJoin,Ss=e=>e.app.roomName,Cs=e=>e.app.roomKey,ks=e=>e.app.displayName,Rs=e=>e.app.sdkVersion,Ts=e=>e.app.externalId;function Ps(e,t){return Ge(e,t)}function Es(e){return Ee("signalConnection/event/".concat(e))}const Ds={audioEnabled:Es("audioEnabled"),chatMessage:Es("chatMessage"),clientLeft:Es("clientLeft"),clientMetadataReceived:Es("clientMetadataReceived"),cloudRecordingStarted:Es("cloudRecordingStarted"),cloudRecordingStopped:Es("cloudRecordingStopped"),disconnect:Es("disconnect"),knockerLeft:Es("knockerLeft"),knockHandled:Es("knockHandled"),newClient:Es("newClient"),roomJoined:Es("roomJoined"),roomKnocked:Es("roomKnocked"),roomSessionEnded:Es("roomSessionEnded"),screenshareStarted:Es("screenshareStarted"),screenshareStopped:Es("screenshareStopped"),streamingStopped:Es("streamingStopped"),videoEnabled:Es("videoEnabled")},Os=Xe({name:"deviceCredentials",initialState:{isFetching:!1,data:null},reducers:{},extraReducers:e=>{e.addCase(xs.pending,(e=>Object.assign(Object.assign({},e),{isFetching:!0}))),e.addCase(xs.fulfilled,((e,t)=>Object.assign(Object.assign({},e),{isFetching:!1,data:t.payload}))),e.addCase(xs.rejected,(e=>Object.assign(Object.assign({},e),{isFetching:!0})))}}),xs=Ps("deviceCredentials/doGetDeviceCredentials",((e,t)=>{let{extra:r}=t;return us(void 0,void 0,void 0,(function*(){try{return yield r.services.credentialsService.getCredentials()}catch(e){console.error(e)}}))})),Is=e=>e.deviceCredentials;gs([pe(ws,Is,((e,t)=>!(!e||t.isFetching||t.data)))],((e,t)=>{let{dispatch:r}=e;t&&r(xs())}));class Ms{constructor(e,t){this._socket=Yr(e,{path:"/protocol/socket.io/v4",randomizationFactor:.5,reconnectionDelay:250,reconnectionDelayMax:5e3,timeout:5e3,transports:["websocket"],withCredentials:!0,...t}),this._socket.io.on("reconnect",(()=>{this._socket.sendBuffer=[]})),this._socket.io.on("reconnect_attempt",(()=>{this._wasConnectedUsingWebsocket?(this._socket.io.opts.transports=["websocket"],"safari"!==si.browserDetails.browser&&delete this._wasConnectedUsingWebsocket):this._socket.io.opts.transports=["websocket","polling"]})),this._socket.on("connect",(()=>{"websocket"===this.getTransport()&&(this._wasConnectedUsingWebsocket=!0)}))}connect(){this.isConnected()||this.isConnecting()||this._socket.open()}disconnect(){this._socket.disconnect()}disconnectOnConnect(){this._socket.once("connect",(()=>{this._socket.disconnect()}))}emit(){this._socket.emit.apply(this._socket,arguments)}emitIfConnected(e,t){this.isConnected()&&this.emit(e,t)}getTransport(){return this._socket&&this._socket.io&&this._socket.io.engine&&this._socket.io.engine.transport&&this._socket.io.engine.transport.name}getManager(){return this._socket.io}isConnecting(){return this._socket&&this._socket.connecting}isConnected(){return this._socket&&this._socket.connected}on(e,t){return this._socket.on(e,t),()=>{this._socket.off(e,t)}}once(e,t){this._socket.once(e,t)}off(e,t){this._socket.off(e,t)}}const Ls=Xe({name:"signalConnection",initialState:{deviceIdentified:!1,isIdentifyingDevice:!1,status:"",socket:null},reducers:{socketConnecting:e=>Object.assign(Object.assign({},e),{status:"connecting"}),socketConnected:(e,t)=>Object.assign(Object.assign({},e),{socket:t.payload,status:"connected"}),socketDisconnected:e=>Object.assign(Object.assign({},e),{status:"disconnected"}),socketReconnecting:e=>Object.assign(Object.assign({},e),{status:"reconnect"}),deviceIdentifying:e=>Object.assign(Object.assign({},e),{isIdentifyingDevice:!0}),deviceIdentified:e=>Object.assign(Object.assign({},e),{deviceIdentified:!0,isIdentifyingDevice:!1})}}),{deviceIdentifying:js,deviceIdentified:As,socketConnected:Ns,socketConnecting:Fs,socketDisconnected:zs}=Ls.actions,Bs=()=>(e,t)=>{if(Js(t()))return;e(Fs());const r=function(){const e=new URL("wss://signal.appearin.net").origin;return new Ms(e,{autoConnect:!1})}();r.on("connect",(()=>e(Ns(r)))),r.on("device_identified",(()=>e(As()))),r.getManager().on("reconnect",(()=>e(qs()))),function(e,t){e.on("room_joined",(e=>t(Ds.roomJoined(e)))),e.on("new_client",(e=>t(Ds.newClient(e)))),e.on("client_left",(e=>t(Ds.clientLeft(e)))),e.on("audio_enabled",(e=>t(Ds.audioEnabled(e)))),e.on("video_enabled",(e=>t(Ds.videoEnabled(e)))),e.on("client_metadata_received",(e=>t(Ds.clientMetadataReceived(e)))),e.on("chat_message",(e=>t(Ds.chatMessage(e)))),e.on("disconnect",(()=>t(Ds.disconnect()))),e.on("room_knocked",(e=>t(Ds.roomKnocked(e)))),e.on("room_session_ended",(e=>t(Ds.roomSessionEnded(e)))),e.on("knocker_left",(e=>t(Ds.knockerLeft(e)))),e.on("knock_handled",(e=>t(Ds.knockHandled(e)))),e.on("screenshare_started",(e=>t(Ds.screenshareStarted(e)))),e.on("screenshare_stopped",(e=>t(Ds.screenshareStopped(e)))),e.on("cloud_recording_started",(e=>t(Ds.cloudRecordingStarted(e)))),e.on("cloud_recording_stopped",(()=>t(Ds.cloudRecordingStopped()))),e.on("streaming_stopped",(()=>t(Ds.streamingStopped())))}(r,e),r.connect()},Us=e=>{let{deviceCredentials:t}=e;return(e,r)=>{const n=r(),i=Js(n);i&&(i.emit("identify_device",{deviceCredentials:t}),e(js()))}},Vs=()=>(e,t)=>{const r=Hs(t()).socket;null===r||void 0===r||r.emit("leave_room"),null===r||void 0===r||r.disconnect(),e(zs())},qs=()=>(e,t)=>{const r=Is(t());e(Ws()),r.data&&e(Us({deviceCredentials:r.data}))},{socketReconnecting:Ws}=Ls.actions,Hs=e=>e.signalConnection,Gs=e=>e.signalConnection.deviceIdentified,Ks=e=>e.signalConnection.status,Js=e=>e.signalConnection.socket;ms({actionCreator:bs,effect:(e,t)=>{let{dispatch:r}=t;r(Vs())}});gs([pe(ws,Ks,((e,t)=>!(!e||!["","reconnect"].includes(t))))],((e,t)=>{let{dispatch:r}=e;t&&r(Bs())}));const $s=pe(Is,Ks,Gs,(e=>e.signalConnection.isIdentifyingDevice),((e,t,r,n)=>!(!e.data||"connected"!==t||r||n)));gs([$s,Is],((e,t,r)=>{let{dispatch:n}=e;t&&r.data&&n(Us({deviceCredentials:r.data}))}));const Qs=Xe({name:"chat",initialState:{chatMessages:[]},reducers:{},extraReducers(e){e.addCase(Ds.chatMessage,((e,t)=>{const r={senderId:t.payload.senderId,timestamp:t.payload.timestamp,text:t.payload.text};return Object.assign(Object.assign({},e),{chatMessages:[...e.chatMessages,r]})}))}}),Xs=e=>(t,r)=>{const n=r(),i=Hs(n).socket;null===i||void 0===i||i.emit("chat_message",{text:e.text})},Ys=Xe({name:"cloudRecording",initialState:{isRecording:!1,error:null,startedAt:void 0},reducers:{recordingRequestStarted:e=>Object.assign(Object.assign({},e),{status:"requested"})},extraReducers:e=>{e.addCase(Ds.cloudRecordingStopped,(e=>Object.assign(Object.assign({},e),{isRecording:!1,status:void 0}))),e.addCase(Ds.cloudRecordingStarted,((e,t)=>{const{payload:r}=t;return r.error?Object.assign(Object.assign({},e),{isRecording:!1,status:"error",error:r.error}):e})),e.addCase(Ds.newClient,((e,t)=>{let{payload:r}=t;var n;const{client:i}=r;return"recorder"===(null===(n=i.role)||void 0===n?void 0:n.roleName)?Object.assign(Object.assign({},e),{isRecording:!0,status:"recording",startedAt:i.startedCloudRecordingAt?new Date(i.startedCloudRecordingAt).getTime():(new Date).getTime()}):e}))}}),{recordingRequestStarted:Zs}=Ys.actions,eo=()=>(e,t)=>{const r=t(),n=Hs(r).socket,i=ro(r);i&&["recording","requested"].includes(i)||(null===n||void 0===n||n.emit("start_recording",{recording:"cloud"}),e(Zs()))},to=()=>(e,t)=>{const r=t(),n=Hs(r).socket;null===n||void 0===n||n.emit("stop_recording")},ro=e=>e.cloudRecording.status,no="safari"===si.browserDetails.browser,io=e=>e.split(/[^\d]/g).map((e=>parseInt(e,10)));function ao(e){let{devices:t,videoId:r,audioId:n,options:i,type:a="ideal"}=e;const s=t.filter((e=>"audioinput"===e.kind)),o=t.filter((e=>"videoinput"===e.kind)),c=!n||!s.some((e=>e.deviceId===n)),d=!r||!o.some((e=>e.deviceId===r)),l=function(e){let{disableAEC:t,disableAGC:r,hd:n,lax:i,lowDataMode:a,preferredDeviceIds:s,resolution:o,simulcast:c,widescreen:d}=e,l=480,u=240,p=15;n&&(l=i||no?720:{min:360,ideal:720}),c&&(!1===n?(l=360,u=270):u=360,p=30);const h={audio:{...s.audioId&&{deviceId:s.audioId}},video:{...s.videoId?{deviceId:s.videoId}:{facingMode:"user"},height:a?u:l,...a&&{frameRate:p}}};if(i)return h.audio.deviceId||(h.audio=!0),delete h.video.facingMode,h;if(o){const[e,t,r]=io(o);e&&(h.video.width={exact:e}),t&&(h.video.height={exact:t}),r&&(h.video.frameRate={exact:r}),delete h.video.facingMode}else h.video.aspectRatio=d?16/9:4/3;return r&&(h.audio.autoGainControl=!1),t&&(h.audio.echoCancellation=!1),h}({preferredDeviceIds:{audioId:c?null:{[a]:n},videoId:d?null:{[a]:r}},...i});return!1!==n&&s.length||delete l.audio,!1!==r&&o.length||delete l.video,l}function so(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}class oo extends Error{constructor(e){super(e.message),this.name="AssertionError",this.code="ERR_ASSERTION",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,Error.captureStackTrace&&Error.captureStackTrace(this,e.stackStartFn)}}function co(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];!function(e,t,r,n){if(!r){let i=!1;if(0===t)i=!0,n="No value argument passed to `assert.ok()`";else if(n instanceof Error)throw n;const a=new oo({actual:r,expected:!0,message:n,operator:"==",stackStartFn:e});throw a.generatedMessage=i,a}}(co,t.length,...t)}const lo=co;lo.notEqual=function e(t,r,n){if(arguments.length<2)throw new Error("'actual' and 'expected' arguments are required");t==r&&function(e){if(e.message instanceof Error)throw e.message;throw new oo(e)}({actual:t,expected:r,message:n,operator:"!=",stackStartFn:e})},lo.ok=co;var uo=so(lo);const po=/mobi/i.test(navigator.userAgent);class ho extends Error{constructor(){super(...arguments),this.name="nodevices"}}function fo(e){return e.audio||e.video?navigator.mediaDevices.getUserMedia(e).catch((t=>{const r="".concat(t,", ").concat(JSON.stringify(e,null,2));throw console.error("getUserMedia ".concat(r)),t})):Promise.reject(new ho("No provided devices"))}function mo(e,t,r,n){var i;let a={deviceId:null};if(!t){var s;if(n&&r)a.deviceId=null===(s=r.find((t=>t.deviceId===n&&t.kind===e)))||void 0===s?void 0:s.deviceId;return a}if(a.label=t.label,t.getSettings&&(a={...a,...t.getSettings()}),a.deviceId)return a;if(t.getCapabilities&&(a.deviceId=t.getCapabilities().deviceId),a.deviceId)return a;var o;t.label&&r&&(a.deviceId=null===(o=r.find((r=>t.label===r.label&&r.kind===e)))||void 0===o?void 0:o.deviceId);return a.deviceId||(a.deviceId=null===(i=t.getConstraints())||void 0===i||null===(i=i.deviceId)||void 0===i?void 0:i.exact,a.broken=1),a}function go(e,t){uo(!t||["audio","video"].includes(t),"only is invalid"),t&&"audio"!==t||e.getAudioTracks().forEach((e=>e.stop())),t&&"video"!==t||e.getVideoTracks().forEach((e=>e.stop()))}async function vo(e){let t,r,n,i,{replaceStream:a,fallback:s=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};uo(e,"constraints is required");const o=!1===e.audioId?"video":!1===e.videoId&&"audio",c=po||"video"!==o,d=ao(e),l=(e,n)=>(e.details={constraints:d,constraint:e.constraint||(null===n||void 0===n?void 0:n.constraint),newConstraints:r,fallback:s,stopTracks:c,...e!==t&&{error:String(t)}},e);c&&a&&go(a,o);try{i=await fo(d)}catch(h){if(t=h,!s)throw l(h);if("OverconstrainedError"===h.name)n={deviceId:{videoId:null,audioId:null},width:{lax:!0},height:{lax:!0},"":{videoId:null,audioId:null,lax:!0}}[h.constraint||""];else if("NotFoundError"===h.name){if(d.audio&&d.video){try{i=await fo(ao({...e,audioId:!1}))}catch(f){if("NotFoundError"!==f.name)throw l(f,h)}try{i||(i=await fo(ao({...e,videoId:!1})))}catch(f){throw l(f,h)}}}else if("NotAllowedError"===h.name||"NotReadableError"===h.name||"AbortError"===h.name)if(a&&!c)go(a,o),n=e;else if("NotAllowedError"!==h.name){var u;try{i=await fo(ao({...e,options:{...e.options,lax:!0}}))}catch(f){console.warn("Tried getting stream again with laxer constraints, but failed: ".concat(""+f))}const t=(""+h).toLowerCase(),r={audio:"audioId",video:"videoId"}[(null===(u=/(video|audio)/.exec(t))||void 0===u?void 0:u[0])||o];if(!i&&r)try{i=await fo(ao({...e,[r]:null}))}catch(f){console.warn("Re-tried ".concat(r," with no constraints, but failed: ").concat(""+f))}if(!i){const t=r?[r]:["videoId","audioId"];for(const r of t){try{i=await fo(ao({...e,[r]:!1}))}catch(f){console.warn("Re-tried without ".concat(r,", but failed: ").concat(""+f))}if(i)break}}}}if(n){r=ao({...e,...n,options:{...e.options,lax:n.lax},...{audio:{videoId:!1},video:{audioId:!1}}[o]});try{i=await fo(r)}catch(h){throw l(h,t)}}if(!i)throw l(t);let p;return a&&(c||go(a,o),p=function(e,t,r){const n=[];return r&&"audio"!==r||(n.push(...e.getAudioTracks()),t.getAudioTracks().forEach((t=>{t.replacement=!0,e.addTrack(t)}))),r&&"video"!==r||(n.push(...e.getVideoTracks()),t.getVideoTracks().forEach((t=>{t.replacement=!0,e.addTrack(t)}))),n.forEach((t=>{t.replaced=!0,e.removeTrack(t)})),n}(a,i,o),i=a),{error:t&&l(t),stream:i,replacedTracks:p}}const yo=Xe({name:"localMedia",initialState:{busyDeviceIds:[],cameraEnabled:!1,devices:[],isSettingCameraDevice:!1,isSettingMicrophoneDevice:!1,isTogglingCamera:!1,microphoneEnabled:!1,status:"",isSwitchingStream:!1},reducers:{deviceBusy:(e,t)=>e.busyDeviceIds.includes(t.payload.deviceId)?e:Object.assign(Object.assign({},e),{busyDeviceIds:[...e.busyDeviceIds,t.payload.deviceId]}),toggleCameraEnabled(e,t){var r;return Object.assign(Object.assign({},e),{cameraEnabled:null!==(r=t.payload.enabled)&&void 0!==r?r:!e.cameraEnabled})},setCurrentCameraDeviceId:(e,t)=>Object.assign(Object.assign({},e),{currentCameraDeviceId:t.payload.deviceId}),toggleMicrophoneEnabled(e,t){var r;return Object.assign(Object.assign({},e),{microphoneEnabled:null!==(r=t.payload.enabled)&&void 0!==r?r:!e.microphoneEnabled})},setCurrentMicrophoneDeviceId:(e,t)=>Object.assign(Object.assign({},e),{currentMicrophoneDeviceId:t.payload.deviceId}),setDevices:(e,t)=>Object.assign(Object.assign({},e),{devices:t.payload.devices}),setLocalMediaStream:(e,t)=>Object.assign(Object.assign({},e),{stream:t.payload.stream}),setLocalMediaOptions:(e,t)=>Object.assign(Object.assign({},e),{options:t.payload.options}),localMediaStopped:e=>Object.assign(Object.assign({},e),{status:"stopped",stream:void 0}),localStreamMetadataUpdated(e,t){const{audio:r,video:n}=t.payload;return Object.assign(Object.assign({},e),{currentCameraDeviceId:n.deviceId,currentMicrophoneDeviceId:r.deviceId,busyDeviceIds:e.busyDeviceIds.filter((e=>e!==r.deviceId&&e!==n.deviceId))})}},extraReducers:e=>{e.addCase(ys,((e,t)=>Object.assign(Object.assign({},e),{options:t.payload.localMediaOptions}))),e.addCase(Oo.pending,((e,t)=>{const{audio:r,video:n}=t.meta.arg;return Object.assign(Object.assign({},e),{isSettingCameraDevice:n,isSettingMicrophoneDevice:r})})),e.addCase(Oo.fulfilled,((e,t)=>{const{audio:r,video:n}=t.meta.arg;return Object.assign(Object.assign({},e),{isSettingCameraDevice:!n&&e.isSettingCameraDevice,isSettingMicrophoneDevice:!r&&e.isSettingMicrophoneDevice})})),e.addCase(Oo.rejected,((e,t)=>{const{audio:r,video:n}=t.meta.arg;return Object.assign(Object.assign({},e),{isSettingCameraDevice:!n&&e.isSettingCameraDevice,isSettingMicrophoneDevice:!r&&e.isSettingMicrophoneDevice,cameraDeviceError:n?t.error:e.cameraDeviceError,microphoneDeviceError:r?t.error:e.microphoneDeviceError})})),e.addCase(Eo.pending,(e=>Object.assign(Object.assign({},e),{isTogglingCamera:!0}))),e.addCase(Eo.fulfilled,(e=>Object.assign(Object.assign({},e),{isTogglingCamera:!1}))),e.addCase(xo.fulfilled,((e,t)=>Object.assign(Object.assign({},e),{devices:t.payload.devices}))),e.addCase(Mo.pending,(e=>Object.assign(Object.assign({},e),{status:"starting"}))),e.addCase(Mo.fulfilled,((e,t)=>{let r,n,{payload:{stream:i,onDeviceChange:a}}=t,s=!1,o=!1;const c=i.getAudioTracks()[0],d=i.getVideoTracks()[0];return c&&(n=c.getSettings().deviceId,o=c.enabled),d&&(s=d.enabled,r=d.getSettings().deviceId),Object.assign(Object.assign({},e),{stream:i,status:"started",currentCameraDeviceId:r,currentMicrophoneDeviceId:n,cameraEnabled:s,microphoneEnabled:o,onDeviceChange:a})})),e.addCase(Mo.rejected,((e,t)=>Object.assign(Object.assign({},e),{status:"error",startError:t.error}))),e.addCase(Io.pending,(e=>Object.assign(Object.assign({},e),{isSwitchingStream:!0}))),e.addCase(Io.fulfilled,(e=>Object.assign(Object.assign({},e),{isSwitchingStream:!1}))),e.addCase(Io.rejected,(e=>Object.assign(Object.assign({},e),{isSwitchingStream:!1})))}}),{deviceBusy:bo,setCurrentCameraDeviceId:_o,setCurrentMicrophoneDeviceId:wo,toggleCameraEnabled:So,toggleMicrophoneEnabled:Co,setLocalMediaOptions:ko,setLocalMediaStream:Ro,localMediaStopped:To,localStreamMetadataUpdated:Po}=yo.actions,Eo=Ps("localMedia/doToggleCamera",((e,t)=>{let{getState:r,rejectWithValue:n}=t;return us(void 0,void 0,void 0,(function*(){const e=r(),t=Ho(e);if(!t)return;let i=t.getVideoTracks()[0];const a=Fo(e),s=Vo(e);try{if(a)if(i)i.enabled=!0;else{const r=Ko(e),n=Ao(e);yield vo(Object.assign(Object.assign({},r),{audioId:!1,videoId:n,type:"exact"}),{replaceStream:t}),i=t.getVideoTracks()[0]}else{if(!i)return;i.enabled=!1,s&&(i.stop(),t.removeTrack(i))}t.dispatchEvent(new CustomEvent("stopresumevideo",{detail:{track:i,enable:a}}))}catch(o){return n(o)}}))})),Do=Ps("localMedia/doToggleMicrophone",((e,t)=>{let{getState:r}=t;var n;const i=r(),a=Ho(i);if(!a)return;const s=zo(i),o=null===(n=a.getAudioTracks())||void 0===n?void 0:n[0];o&&(o.enabled=s)})),Oo=Ps("localMedia/reactSetDevice",((e,t)=>{let{audio:r,video:n}=e,{getState:i,rejectWithValue:a}=t;return us(void 0,void 0,void 0,(function*(){try{const e=i(),t=Ho(e);if(!t)throw new Error("No stream");const a=!!r&&No(e),s=!!n&&Ao(e),o=Ko(e),{replacedTracks:c}=yield vo(Object.assign(Object.assign({},o),{audioId:a,videoId:s,type:"exact"}),{replaceStream:t}),d=zo(e);t.getAudioTracks().forEach((e=>e.enabled=d));const l=Fo(e);return t.getVideoTracks().forEach((e=>e.enabled=l)),{replacedTracks:c}}catch(e){return a(e)}}))})),xo=Ps("localMedia/doUpdateDeviceList",((e,t)=>{let{getState:r,dispatch:n,rejectWithValue:i}=t;return us(void 0,void 0,void 0,(function*(){var e,t;const a=r();let s=[],o=[];const c=Ho(a),d=jo(a);try{s=yield navigator.mediaDevices.enumerateDevices(),o=Bo(a);if(!(c&&!Go(a)&&s&&o&&o.find((e=>e.deviceId))))return{devices:s};const{changedDevices:u}=function(e){let{oldDevices:t,newDevices:r,currentAudioId:n,currentVideoId:i,currentSpeakerId:a}=e;const s=function(e,t){const[r,n]=[e,t].map((e=>e.filter((e=>e.kind&&e.deviceId)).reduce(((e,t)=>({...e,[t.kind]:{...e[t.kind],[t.deviceId]:t}})),{}))),i={};return e.forEach((e=>{e.kind&&e.deviceId&&(i[e.kind]||(i[e.kind]={added:{},removed:{},changed:{}}),n[e.kind]&&n[e.kind][e.deviceId]||(i[e.kind].removed[e.deviceId]=e))})),t.forEach((e=>{e.kind&&e.deviceId&&(i[e.kind]||(i[e.kind]={added:{},removed:{},changed:{}}),r[e.kind]&&r[e.kind][e.deviceId]?r[e.kind][e.deviceId].label&&r[e.kind][e.deviceId].label!==e.label&&(i[e.kind].changed[e.deviceId]=e):i[e.kind].added[e.deviceId]=e)})),i}(t,r),o={},c={};return[["audioinput",n],["videoinput",i],["audiooutput",a]].forEach((e=>{let[t,n]=e;const i=s[t];if(i){if(n){if(i.removed[n]&&(o[t]={deviceId:null},"audiooutput"===t)){const e=r.find((e=>"audiooutput"===e.kind));o[t]={deviceId:null===e||void 0===e?void 0:e.deviceId}}i.changed[n]&&(o[t]={deviceId:n})}if(Object.keys(i.added).length){const[e]=Object.keys(i.added).slice(0,1),r=i.added[e];c[t]={deviceId:r.deviceId,label:r.label,kind:r.kind}}}})),{addedDevices:c,changedDevices:o}}({oldDevices:o,newDevices:s,currentAudioId:No(a),currentVideoId:Ao(a)});let p=null===(e=u.audioinput)||void 0===e?void 0:e.deviceId,h=null===(t=u.videoinput)||void 0===t?void 0:t.deviceId;function f(e,t){const r=t?e.findIndex((e=>e.deviceId===t)):0;return(e[(r+1)%e.length]||{}).deviceId}if(void 0!==h){const m=Bo(a).filter((e=>"videoinput"===e.kind)),g=Ao(a);let v=f(m.filter((e=>!d.includes(e.deviceId))),g);v&&g!==v||(v=f(m,g)),g!==v&&(h=v)}if(void 0!==p){const y=Bo(a).filter((e=>"audioinput"===e.kind)),b=No(a);let _=f(y.filter((e=>!d.includes(e.deviceId))),b);_&&b!==_||(_=f(y,b)),b!==_&&(p=_)}return void 0===p&&void 0===h||n(Io({audioId:p,videoId:h})),{devices:s}}catch(l){return i(l)}}))})),Io=Ps("localMedia/doSwitchLocalStream",((e,t)=>{let{audioId:r,videoId:n}=e,{dispatch:i,getState:a,rejectWithValue:s}=t;return us(void 0,void 0,void 0,(function*(){const e=a(),t=Ho(e),o=Ko(e),c=!(!n||r)||!(n||!r);if(t)try{const{replacedTracks:e}=yield vo(Object.assign(Object.assign({},o),{audioId:void 0!==r&&r,videoId:void 0!==n&&n,type:"exact"}),{replaceStream:t}),a=r||n;return c&&a&&i(bo({deviceId:a})),{replacedTracks:e}}catch(d){console.error(d);const e=r||n;return c&&e&&i(bo({deviceId:e})),s(d)}}))})),Mo=Ps("localMedia/doStartLocalMedia",((e,t)=>{let{getState:n,dispatch:i,rejectWithValue:a}=t;return us(void 0,void 0,void 0,(function*(){const t=ps((()=>{i(xo())}),{delay:500});if(r.g.navigator.mediaDevices&&navigator.mediaDevices.addEventListener("devicechange",t),"getTracks"in e)return Promise.resolve({stream:e,onDeviceChange:t});if(!e.audio&&!e.video)return{stream:new MediaStream,onDeviceChange:t};i(ko({options:e}));try{yield i(xo());const r=n(),a=Ko(r),{stream:s}=yield vo(Object.assign(Object.assign({},a),{audioId:e.audio,videoId:e.video}));return{stream:s,onDeviceChange:t}}catch(s){return a(s)}}))})),Lo=()=>(e,t)=>{const n=Ho(t()),i=qo(t()).onDeviceChange;null===n||void 0===n||n.getTracks().forEach((e=>{e.stop()})),r.g.navigator.mediaDevices&&i&&navigator.mediaDevices.removeEventListener("devicechange",i),e(To())},jo=e=>e.localMedia.busyDeviceIds,Ao=e=>e.localMedia.currentCameraDeviceId,No=e=>e.localMedia.currentMicrophoneDeviceId,Fo=e=>e.localMedia.cameraEnabled,zo=e=>e.localMedia.microphoneEnabled,Bo=e=>e.localMedia.devices,Uo=e=>e.localMedia.options,Vo=pe(Uo,(e=>!!e)),qo=e=>e.localMedia,Wo=e=>e.localMedia.status,Ho=e=>e.localMedia.stream,Go=e=>e.localMedia.isSwitchingStream,Ko=pe(Bo,(e=>({devices:e,options:{disableAEC:!1,disableAGC:!1,hd:!0,lax:!1,lowDataMode:!1,simulcast:!0,widescreen:!0}}))),Jo=pe(Wo,(e=>"starting"===e)),$o=pe(Bo,jo,((e,t)=>e.filter((e=>"videoinput"===e.kind)).filter((e=>!t.includes(e.deviceId))))),Qo=pe(Bo,jo,((e,t)=>e.filter((e=>"audioinput"===e.kind)).filter((e=>!t.includes(e.deviceId))))),Xo=pe(Bo,(e=>e.filter((e=>"audiooutput"===e.kind))));gs([pe(ws,Wo,Uo,((e,t,r)=>{if(e&&""===t&&r)return r}))],((e,t)=>{let{dispatch:r}=e;t&&r(Mo(t))}));gs([pe(ws,Wo,Uo,((e,t,r)=>!e&&""!==t&&!!r))],((e,t)=>{let{dispatch:r}=e;t&&r(Lo())})),ms({predicate:(e,t,r)=>{const n=zo(r),i=zo(t);return"started"===Wo(r)&&n!==i},effect:(e,t)=>{let{dispatch:r}=t;r(Do())}}),ms({predicate:(e,t,r)=>{if(t.localMedia.isTogglingCamera)return!1;const n=Fo(r),i=Fo(t);return"started"===Wo(r)&&n!==i},effect:(e,t)=>{let{dispatch:r}=t;r(Eo())}}),ms({predicate:(e,t,r)=>{const n=Ao(r),i=Ao(t);return"started"===Wo(r)&&n!==i},effect:(e,t)=>{let{dispatch:r}=t;r(Oo({audio:!1,video:!0}))}}),ms({predicate:(e,t,r)=>{const n=No(r),i=No(t);return"started"===Wo(r)&&n!==i},effect:(e,t)=>{let{dispatch:r}=t;r(Oo({audio:!0,video:!1}))}}),ms({matcher:Ue(Mo.fulfilled,xo.fulfilled,Io.fulfilled,Io.rejected),effect:(e,t)=>{let{dispatch:r,getState:n}=t;const i=n(),a=Ho(i),s=Bo(i);if(!a)return;const o=function(e){let{audioTrack:t,videoTrack:r,devices:n,stoppedVideoTrack:i,lastAudioId:a,lastVideoId:s}=e;const o=e=>"live"===(null===e||void 0===e?void 0:e.readyState)?e:null;return r=o(r)||i,t=o(t),{video:mo("videoinput",r,n,s),audio:mo("audioinput",t,n,a)}}({audioTrack:a.getAudioTracks()[0],videoTrack:a.getVideoTracks()[0],devices:s});r(Po(o))}});const Yo={displayName:"",id:"",isAudioEnabled:!0,isVideoEnabled:!0,isLocalParticipant:!0,stream:void 0,isScreenSharing:!1,roleName:""},Zo=Ps("localParticipant/doEnableAudio",((e,t)=>{let{getState:r}=t;return us(void 0,void 0,void 0,(function*(){const t=r(),n=Hs(t).socket;return null===n||void 0===n||n.emit("enable_audio",{enabled:e.enabled}),e.enabled}))})),ec=Ps("localParticipant/doEnableVideo",((e,t)=>{let{getState:r}=t;return us(void 0,void 0,void 0,(function*(){const t=r(),n=Hs(t).socket;return null===n||void 0===n||n.emit("enable_video",{enabled:e.enabled}),e.enabled}))})),tc=Ps("localParticipant/doSetDisplayName",((e,t)=>{let{getState:r}=t;return us(void 0,void 0,void 0,(function*(){const t=r(),n=Hs(t).socket;return null===n||void 0===n||n.emit("send_client_metadata",{type:"UserData",payload:e}),e.displayName}))})),rc=Xe({name:"localParticipant",initialState:Yo,reducers:{doSetLocalParticipant:(e,t)=>Object.assign(Object.assign({},e),t.payload)},extraReducers:e=>{e.addCase(ys,((e,t)=>Object.assign(Object.assign({},e),{displayName:t.payload.displayName}))),e.addCase(Zo.fulfilled,((e,t)=>Object.assign(Object.assign({},e),{isAudioEnabled:t.payload}))),e.addCase(ec.fulfilled,((e,t)=>Object.assign(Object.assign({},e),{isVideoEnabled:t.payload}))),e.addCase(tc.fulfilled,((e,t)=>Object.assign(Object.assign({},e),{displayName:t.payload}))),e.addCase(Ds.roomJoined,((e,t)=>{var r,n;const i=null===(n=null===(r=t.payload)||void 0===r?void 0:r.room)||void 0===n?void 0:n.clients.find((e=>{var r;return e.id===(null===(r=t.payload)||void 0===r?void 0:r.selfId)}));return Object.assign(Object.assign({},e),{id:t.payload.selfId,roleName:(null===i||void 0===i?void 0:i.role.roleName)||""})}))}});rc.actions;const nc=e=>e.localParticipant,ic=e=>e.localParticipant.id;ms({actionCreator:So,effect:(e,t)=>{let{payload:r}=e,{dispatch:n,getState:i}=t;const{enabled:a}=r,{isVideoEnabled:s}=nc(i());n(ec({enabled:a||!s}))}}),ms({actionCreator:Co,effect:(e,t)=>{let{payload:r}=e,{dispatch:n,getState:i}=t;const{enabled:a}=r,{isAudioEnabled:s}=nc(i());n(Zo({enabled:a||!s}))}});const ac=Xe({name:"localScreenshare",initialState:{status:"",stream:null,error:null},reducers:{stopScreenshare:(e,t)=>Object.assign(Object.assign({},e),{status:"",stream:null})},extraReducers:e=>{e.addCase(oc.pending,(e=>Object.assign(Object.assign({},e),{status:"starting"}))),e.addCase(oc.fulfilled,((e,t)=>{let{payload:{stream:r}}=t;return Object.assign(Object.assign({},e),{status:"active",stream:r})})),e.addCase(oc.rejected,((e,t)=>{let{payload:r}=t;return Object.assign(Object.assign({},e),{error:r,status:"",stream:null})}))}}),{stopScreenshare:sc}=ac.actions,oc=Ps("localScreenshare/doStartScreenshare",((e,t)=>{let{dispatch:r,getState:n,rejectWithValue:i}=t;return us(void 0,void 0,void 0,(function*(){var e;try{const t=n(),i=dc(t);if(i)return{stream:i};const a=yield navigator.mediaDevices.getDisplayMedia(),s=()=>{r(cc())};return"oninactive"in a?a.addEventListener("inactive",s):null===(e=a.getVideoTracks()[0])||void 0===e||e.addEventListener("ended",s),{stream:a}}catch(t){return i(t)}}))})),cc=()=>(e,t)=>{const r=t(),n=dc(r);n&&(n.getTracks().forEach((e=>e.stop())),e(sc({stream:n})))},dc=e=>e.localScreenshare.stream;ms({actionCreator:To,effect:(e,t)=>{let{getState:r}=t;const n=r(),i=dc(n);i&&(null===i||void 0===i||i.getTracks().forEach((e=>{e.stop()})))}});const lc=Xe({initialState:{data:null,isFetching:!1,error:null},name:"organization",reducers:{},extraReducers:e=>{e.addCase(uc.pending,(e=>Object.assign(Object.assign({},e),{isFetching:!0}))),e.addCase(uc.fulfilled,((e,t)=>t.payload?Object.assign(Object.assign({},e),{isFetching:!1,data:t.payload}):Object.assign(Object.assign({},e),{isFetching:!0}))),e.addCase(uc.rejected,(e=>Object.assign(Object.assign({},e),{isFetching:!1,error:!0})))}}),uc=Ps("organization/doOrganizationFetch",((e,t)=>{let{extra:r,getState:n}=t;return us(void 0,void 0,void 0,(function*(){try{const e=n().app.roomUrl,t=yield r.services.fetchOrganizationFromRoomUrl(e||"");if(!t)throw new Error("Invalid room url");return t}catch(e){console.error(e)}}))})),pc=e=>{var t;return null===(t=e.organization.data)||void 0===t?void 0:t.organizationId};function hc(e){return Ee("rtcConnection/event/".concat(e))}gs([pe(ws,(e=>e.organization),Is,((e,t,r)=>!(!e||t.data||t.isFetching||t.error||r.isFetching)))],((e,t)=>{let{dispatch:r}=e;t&&r(uc())}));const fc={rtcManagerCreated:hc("rtcManagerCreated"),rtcManagerDestroyed:hc("rtcManagerDestroyed"),streamAdded:hc("streamAdded")},mc=["recorder","streamer"];function gc(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{streams:r}=e,n=ls(e,["streams"]);return Object.assign(Object.assign({},n),{stream:null,streams:r.map((e=>({id:e,state:t?"new_accept":"to_accept"}))),isLocalParticipant:!1,presentationStream:null,newJoiner:t})}function vc(e,t){const r=e.remoteParticipants.findIndex((e=>e.id===t));return{index:r,participant:e.remoteParticipants[r]}}function yc(e,t,r){const{participant:n,index:i}=vc(e,t);return n?Object.assign(Object.assign({},e),{remoteParticipants:[...e.remoteParticipants.slice(0,i),Object.assign(Object.assign({},n),r),...e.remoteParticipants.slice(i+1)]}):(console.error("Did not find client for update ".concat(t)),e)}function bc(e,t,r,n){const{participant:i}=vc(e,t);if(!i)return console.error("No client ".concat(t," found to update stream ").concat(r," ").concat(n)),e;const a=i.streams.findIndex((e=>e.id===r)),s=[...i.streams];return s[a]=Object.assign(Object.assign({},s[a]),{state:n}),yc(e,t,{streams:s})}function _c(e,t,r){const{participant:n}=vc(e,t);return!n||n.streams.find((e=>e.id===r))?(console.warn("No participant ".concat(t," or stream ").concat(r," already exists")),e):yc(e,t,{streams:[...n.streams,{id:r,state:"to_accept"}]})}const wc=Xe({name:"remoteParticipants",initialState:{remoteParticipants:[]},reducers:{streamStatusUpdated:(e,t)=>{let r=e;for(const{clientId:n,streamId:i,state:a}of t.payload)r=bc(r,n,i,a);return r},participantStreamAdded:(e,t)=>{const{clientId:r,stream:n}=t.payload;return yc(e,r,{stream:n})},participantStreamIdAdded:(e,t)=>{const{clientId:r,streamId:n}=t.payload;return _c(e,r,n)}},extraReducers:e=>{e.addCase(Ds.roomJoined,((e,t)=>{var r;if(!(null===(r=t.payload)||void 0===r?void 0:r.room))return e;const n=t.payload.selfId,{clients:i}=t.payload.room;return Object.assign(Object.assign({},e),{remoteParticipants:i.filter((e=>e.id!==n)).filter((e=>!mc.includes(e.role.roleName))).map((e=>gc(e)))})})),e.addCase(fc.streamAdded,((e,t)=>function(e,t){const{clientId:r,stream:n,streamType:i}=t;let{streamId:a}=t;const{participant:s}=vc(e,r);if(!s)return console.error("Did not find client ".concat(r," for adding stream")),e;const o=e.remoteParticipants;a||(a=n.id);const c=o.find((e=>e.id===r));if(!c)return e;const d=c.streams.find((e=>e.id===a));return c.stream&&(c.stream.id===a||c.stream.inboundId===a)||!c.stream&&"webcam"===i||!c.stream&&!i&&!d?yc(e,r,{stream:n}):yc(e,r,{presentationStream:n})}(e,t.payload))),e.addCase(Ds.newClient,((e,t)=>{const{client:r}=t.payload;return mc.includes(r.role.roleName)?e:function(e,t){const{participant:r}=vc(e,t.id);return r?(console.warn("Client already existing ".concat(t.id,". Ignoring")),e):Object.assign(Object.assign({},e),{remoteParticipants:[...e.remoteParticipants,t]})}(e,gc(r,!0))})),e.addCase(Ds.clientLeft,((e,t)=>{const{clientId:r}=t.payload;return function(e,t){return Object.assign(Object.assign({},e),{remoteParticipants:e.remoteParticipants.filter((e=>e.id!==t))})}(e,r)})),e.addCase(Ds.audioEnabled,((e,t)=>{const{clientId:r,isAudioEnabled:n}=t.payload;return yc(e,r,{isAudioEnabled:n})})),e.addCase(Ds.videoEnabled,((e,t)=>{const{clientId:r,isVideoEnabled:n}=t.payload;return yc(e,r,{isVideoEnabled:n})})),e.addCase(Ds.clientMetadataReceived,((e,t)=>{const{clientId:r,displayName:n}=t.payload.payload;return yc(e,r,{displayName:n})})),e.addCase(Ds.screenshareStarted,((e,t)=>{const{clientId:r,streamId:n}=t.payload;return _c(e,r,n)})),e.addCase(Ds.screenshareStopped,((e,t)=>{const{clientId:r,streamId:n}=t.payload;return function(e,t,r){var n,i;const{participant:a}=vc(e,t);if(!a)return console.error("No participant ".concat(t," found to remove stream ").concat(r)),e;const s=a.stream&&a.stream.id,o=(null===(n=a.presentationStream)||void 0===n?void 0:n.inboundId)||(null===(i=a.presentationStream)||void 0===i?void 0:i.id),c=a.streams.findIndex((e=>e.id===r));return yc(e,t,Object.assign(Object.assign({streams:a.streams.filter(((e,t)=>t!==c))},s===r&&{stream:null}),o===r&&{presentationStream:null}))}(e,r,n)}))}}),{participantStreamAdded:Sc,participantStreamIdAdded:Cc,streamStatusUpdated:kc}=wc.actions,Rc=e=>e.remoteParticipants.remoteParticipants,Tc=pe(dc,Rc,((e,t)=>{const r=[];e&&r.push({id:e.id,participantId:"local",hasAudioTrack:e.getAudioTracks().length>0,stream:e,isLocal:!0});for(const n of t)n.presentationStream&&r.push({id:n.presentationStream.id,participantId:n.id,hasAudioTrack:n.presentationStream.getAudioTracks().length>0,stream:n.presentationStream,isLocal:!1});return r})),Pc=Xe({initialState:{session:null,status:"initializing",error:null},name:"roomConnection",reducers:{connectionStatusChanged:(e,t)=>Object.assign(Object.assign({},e),{status:t.payload})},extraReducers:e=>{e.addCase(Ds.roomJoined,((e,t)=>{var r,n;const{error:i,isLocked:a}=t.payload;return"room_locked"===i&&a?Object.assign(Object.assign({},e),{status:"room_locked"}):Object.assign(Object.assign({},e),{status:"connected",session:null!==(n=null===(r=t.payload.room)||void 0===r?void 0:r.session)&&void 0!==n?n:null})})),e.addCase(Ds.newClient,((e,t)=>{var r,n;return Object.assign(Object.assign({},e),{session:null!==(n=null===(r=t.payload.room)||void 0===r?void 0:r.session)&&void 0!==n?n:null})})),e.addCase(Ds.roomSessionEnded,((e,t)=>{var r;return(null===(r=e.session)||void 0===r?void 0:r.id)!==t.payload.roomSessionId?e:Object.assign(Object.assign({},e),{session:null})})),e.addCase(Ws,(e=>Object.assign(Object.assign({},e),{status:"reconnect"})))}}),{connectionStatusChanged:Ec}=Pc.actions,Dc=()=>(e,t)=>{const r=t(),n=Hs(r).socket,i=Ss(r),a=Cs(r),s=ks(r),o=Rs(r),c=Ts(r),d=pc(r);null===n||void 0===n||n.emit("knock_room",{avatarUrl:null,config:{isAudioEnabled:!0,isVideoEnabled:!0},deviceCapabilities:{canScreenshare:!0},displayName:s,isCoLocated:!1,isDevicePermissionDenied:!1,kickFromOtherRooms:!1,organizationId:d,roomKey:a,roomName:i,selfId:"",userAgent:"browser-sdk:".concat(o||"unknown"),externalId:c}),e(Ec("knocking"))},Oc=()=>(e,t)=>{const r=t(),n=Hs(r).socket,i=Ss(r),a=Cs(r),s=ks(r),o=Rs(r),c=Ts(r),d=pc(r),l=Fo(t()),u=zo(t()),p=ic(t());null===n||void 0===n||n.emit("join_room",{avatarUrl:null,config:{isAudioEnabled:u,isVideoEnabled:l},deviceCapabilities:{canScreenshare:!0},displayName:s,isCoLocated:!1,isDevicePermissionDenied:!1,kickFromOtherRooms:!1,organizationId:d,roomKey:a,roomName:i,selfId:p,userAgent:"browser-sdk:".concat(o||"unknown"),externalId:c}),e(Ec("connecting"))},xc=e=>e.roomConnection.status;gs([pe([pc,xc,Gs,Wo],((e,t,r,n)=>!!("started"===n&&r&&e&&["initializing","reconnect"].includes(t))))],((e,t)=>{let{dispatch:r}=e;t&&r(Oc())})),ms({actionCreator:Ds.knockHandled,effect:(e,t)=>{let{payload:r}=e,{dispatch:n,getState:i}=t;const{clientId:a,resolution:s}=r,o=i();a===ic(o)&&("accepted"===s?(n(_s(r.metadata.roomKey)),n(Oc())):"rejected"===s&&n(Ec("knock_rejected")))}});const Ic="client_connection_status_changed",Mc="stream_added",Lc="rtc_manager_created",jc="rtc_manager_destroyed",Ac="local_stream_track_added",Nc="local_stream_track_removed",Fc="connecting",zc="connection_failed",Bc="connection_successful",Uc="connection_disconnected",Vc="fetch_mediaserver_config",qc="start_screenshare",Wc="stop_screenshare",Hc="mediaserver_config",Gc="room_joined",Kc="ice_candidate",Jc="ice_endofcandidates",$c="ready_to_receive_offer",Qc="sdp_answer",Xc="sdp_offer",Yc="camera",Zc="screen_share";class ed{constructor(e,t){uo.notEqual(e,void 0,"id is required"),uo.notEqual(t,void 0,"type is required"),this.id=""+e,this.type=t,this.isEnabled=!0,this.hasSupportForAutoSuperSize=!1,this.isAudioEnabled=!0,this.isVideoEnabled=!0,this.status=Fc}setup(e){return this.stream=e,this.streamId=e.id,this.setVideoEnabled(this.isVideoEnabled&&e.getVideoTracks().length>0),this.setAudioEnabled(this.isAudioEnabled&&e.getAudioTracks().length>0),this}setStatus(e){return this.status=e,this}setVideoEnabled(e){this.isVideoEnabled=e,this.stream&&this.stream.getVideoTracks().forEach((t=>{t.enabled=e}))}setAudioEnabled(e){this.isAudioEnabled=e,this.stream&&this.stream.getAudioTracks().forEach((t=>{t.enabled=e}))}static getCameraId(){return"0"}static getTypeFromId(e){uo.notEqual(e,void 0,"id is required");return"0"===""+e?Yc:Zc}}var td="connection_blocked_by_network",rd="microphone_not_working",nd="microphone_stopped_working",id="dominant_speaker";const ad=si.browserDetails.browser,sd=si.browserDetails.version;function od(e,t){let r=e.match(/a=ssrc-group:FID (\d+) (\d+)\r\n/),n=t.match(/a=ssrc-group:FID (\d+) (\d+)\r\n/);r||(r=e.match(/a=ssrc:(\d+) cname:(.*)\r\n/g)[1].match(/a=ssrc:(\d+)/),n=t.match(/a=ssrc:(\d+) cname:(.*)\r\n/g)[1].match(/a=ssrc:(\d+)/));for(let i=1;i<r.length;i++)t=t.replace(new RegExp(n[i],"g"),r[i]);return t}function cd(e){return"firefox"!==ad?e:Yn().splitLines(e.trim()).map((e=>e.startsWith("a=msid-semantic:")?"a=msid-semantic: WMS *":e)).join("\r\n")+"\r\n"}function dd(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console;const n=e.getSenders().find((e=>e.track&&"video"===e.track.kind));if(!n)return Promise.resolve();const i=n.getParameters();return i.encodings&&0===i.encodings.length?Promise.resolve():(i.encodings||(i.encodings=[{}]),0===t?delete i.encodings[0].maxBitrate:i.encodings[0].maxBitrate=1e3*t,n.setParameters(i).catch((e=>{r.error("setParameters err: ",e)})))}const ld=400;class ud{constructor(e){let{peerConnectionId:t,bandwidth:r,maximumTurnBandwidth:n,deprioritizeH264Encoding:i,logger:a=console}=e;this.peerConnectionId=t,this.relayCandidateSeen=!1,this.pc=null,this.wasEverConnected=!1,this.connectionStatus=null,this.stats={totalSent:0,totalRecv:0},this.bandwidth=r||0,this.maximumTurnBandwidth=n,this.pending=[],this.isOperationPending=!1,this.streamIds=[],this.streams=[],this.earlyIceCandidates=[],this.afterConnected=new Promise((e=>{this.registerConnected=e})),this.offerOptions={offerToReceiveAudio:!0,offerToReceiveVideo:!0},this._deprioritizeH264Encoding=i,this._logger=a}setAndGetPeerConnection(e){let{clientId:t,constraints:r,peerConnectionConfig:n,shouldAddLocalVideo:i}=e;return this.peerConnectionConfig=n,this.shouldAddLocalVideo=i,this.clientId=t,this.pc=new RTCPeerConnection(n,r),this.signalingState=this.pc.signalingState,this.pc.addEventListener("signalingstatechange",(()=>{if(this.signalingState!==this.pc.signalingState&&(this.signalingState=this.pc.signalingState,"stable"===this.pc.signalingState)){this.isOperationPending=!1;const e=this.pending.shift();e&&e.apply()}})),this.pc}addStream(e){this.streamIds.push(e.id),this.streams.push(e),RTCPeerConnection.prototype.addTrack?(e.getAudioTracks().forEach((t=>{this.pc.addTrack(t,e)})),e.getVideoTracks().forEach((t=>{this.pc.addTrack(t,e)}))):this.pc.addStream(e)}addTrack(e,t){t||(t=this.streams[0]),t.addTrack(e),this.pc.addTrack(e,t)}removeTrack(e){this.streams[0].removeTrack(e);const t=this.pc.getSenders().find((t=>t.track===e));t&&this.pc.removeTrack(t)}removeStream(e){for(let t=0;t<this.streamIds.length;t++)this.streamIds[t]===e.id&&(this.streamIds.splice(t,1),this.streams.splice(t,1));this.pc&&(this.pc.removeTrack?e.getTracks().forEach((e=>{const t=this.pc.getSenders().find((t=>t.track===e));t&&this.pc.removeTrack(t)})):this.pc.removeStream&&this.pc.removeStream(e))}_setRemoteDescription(e){var t;return this._deprioritizeH264Encoding&&(e.sdp=(t=e.sdp,Yn().splitSections(t).map((e=>{if("video"!==Yn().getKind(e))return e;const t=Yn().matchPrefix(e,"a=rtpmap:").map((e=>Yn().parseRtpMap(e))).filter((e=>/h264/i.test(e.name))).map((e=>""+e.payloadType));if(!t.length)return e;const r=Yn().matchPrefix(e,"m=video")[0],n=/(\s\d+)+$/i.exec(r)[0],i=[...n.split(" ").filter((e=>e&&!t.includes(e))),...t].join(" "),a=r.replace(n," "+i);return e.replace(r,a)})).join(""))),this.srdComplete=this.pc.setRemoteDescription(e),this.srdComplete.then((()=>{this.earlyIceCandidates.forEach((e=>this.pc.addIceCandidate(e))),this.earlyIceCandidates=[]}))}handleOffer(e){if(!this.canModifyPeerConnection())return new Promise((t=>{this.pending.push((()=>this.handleOffer(e).then(t)))}));this.isOperationPending=!0;let t=e.sdp;t=function(e){return"safari"!==ad&&("firefox"!==ad||sd>=63||60===sd)?e:Yn().splitLines(e.trim()).filter((e=>!e.startsWith("a=extmap:")||"urn:ietf:params:rtp-hdrext:sdes:mid"!==Yn().parseExtmap(e).uri)).join("\r\n")+"\r\n"}(t),t=cd(t);const r={type:e.type,sdp:t};let n;return this._setRemoteDescription(r).then((()=>this.pc.createAnswer())).then((e=>(n=e,this.pc.setLocalDescription(e)))).then((()=>dd(this.pc,this.bandwidth))).then((()=>n))}handleAnswer(e){if(this.pendingOffer){const t=this.pendingOffer;return delete this.pendingOffer,this.pc.setLocalDescription(t).then((()=>this.handleAnswer(e)))}let t=e.sdp;t=cd(t);const r={type:e.type,sdp:t};return this._setRemoteDescription(r).then((()=>dd(this.pc,this.bandwidth)),(e=>{this._logger.warn("Could not set remote description from remote answer: ",e)}))}addIceCandidate(e){this.srdComplete?this.srdComplete.then((()=>{"closed"!==this.pc.signalingState&&("safari"===si.browserDetails.browser&&e&&""===e.candidate||this.pc.addIceCandidate(e).catch((t=>{this._logger.warn("Failed to add ICE candidate ('%s'): %s",e?e.candidate:null,t)})))})):this.earlyIceCandidates.push(e)}canModifyPeerConnection(){return"stable"===this.pc.signalingState&&!this.isOperationPending}close(){const e=this.pc;if(e){e.oniceconnectionstatechange=null,e.onicecandidate=null,e.ontrack=null;try{e.close()}catch(t){console.warn("failures during close of session",t)}}}hasConnectedPeerConnection(){return this.pc&&"connected"===this.pc.connectionState}replaceTrack(e,t){const r=this.pc;if(!r)return!1;const n=r.getSenders();function i(r){const i=e=>e&&"id:".concat(e.id,",kind:").concat(e.kind,",state:").concat(e.readyState);this._logger.warn("".concat(r,". newTrack:").concat(i(t),", oldTrack:").concat(i(e),", sender tracks: ").concat(JSON.stringify(n.map((e=>"s ".concat(i(e.track))))),", sender first codecs: ").concat(JSON.stringify(n.map((e=>(e.getParameters().codecs||[])[0])))))}if(n.length||i("No senders!"),e||(e=(n.find((e=>e.track&&e.track.kind===t.kind))||{}).track)||i("No sender with same kind! Add new track then."),window.RTCRtpSender&&window.RTCRtpSender.prototype.replaceTrack){if(e){const r=()=>{for(let r=0;r<n.length;r++){const a=n[r],s=a.track;if(a||s||i("One of the tracks is null!"),s.id===t.id)return Promise.resolve(t);if(s.id===e.id)return n[r].replaceTrack(t)}return null};let a=r();if(a)return a;let s=null,o=null;a=new Promise(((e,t)=>{s=e,o=t}));let c=0,d=setInterval((async()=>{const e=r();if(!e)return void(3<++c&&(clearInterval(d),d=null,i("No sender track to replace"),o("No sender track to replace")));clearInterval(d),d=null;const t=await e;s(t)}),1e3);return a}const a=this.streams.find((e=>e.getTracks().find((e=>e.id===t.id))))||this.streams[0];return a?r.addTrack(t,a):(i("No stream?"),Promise.reject(new Error("replaceTrack: No stream?")))}if(!this.canModifyPeerConnection())return void this.pending.push((()=>{this.replaceTrack(e,t)}));this.isOperationPending=!0;const a=r.onnegotiationneeded;return r.onnegotiationneeded=null,this.removeTrack(e),this.addTrack(t),setTimeout((()=>{r.onnegotiationneeded=a}),0),"offer"===r.localDescription.type?r.createOffer().then((e=>(e.sdp=od(r.localDescription.sdp,e.sdp),r.setLocalDescription(e)))).then((()=>this._setRemoteDescription(r.remoteDescription))):this._setRemoteDescription(r.remoteDescription).then((()=>r.createAnswer())).then((e=>(e.sdp=od(r.localDescription.sdp,e.sdp),r.setLocalDescription(e))))}maybeRestrictRelayBandwidth(){var e;-1!==this.maximumTurnBandwidth&&(this.pc.getStats&&(e=this.pc,e.getStats(null).then((e=>{let t,r;return e.forEach((n=>{if("transport"===n.type&&n.selectedCandidatePairId){const i=e.get(n.selectedCandidatePairId);if(!i)return;return t=e.get(i.localCandidateId).candidateType,void(r=e.get(i.remoteCandidateId).candidateType)}"candidate-pair"===n.type&&n.selected&&(t=e.get(n.localCandidateId).candidateType,r=e.get(n.remoteCandidateId).candidateType)})),"relay"===t||"relayed"===t||"relay"===r||"relayed"===r}))).then((e=>{e&&0===this.bandwidth&&this.changeBandwidth(this.maximumTurnBandwidth)})))}changeBandwidth(e){e!==this.bandwidth&&(this.canModifyPeerConnection()?(this.bandwidth=e,this.pc.localDescription&&""!==this.pc.localDescription.type&&dd(this.pc,this.bandwidth)):this.pending.push((()=>this.changeBandwidth(e))))}}function pd(e){return{id:e.id,tracks:e.getTracks().map((function(e){return{id:e.id,kind:e.kind,label:e.label,enabled:e.enabled,muted:e.muted,readyState:e.readyState}}))}}var hd=function(e,t,r){var n=0,i=!!window.mozRTCPeerConnection,a=!!window.RTCIceGatherer;if(r.forEach((function(r){if(window[r+"RTCPeerConnection"]&&("webkit"!==r||!a)){var s=window[r+"RTCPeerConnection"],o=function(r,o){var c=new s(r,o),d="PC_"+n++;c.__rtcStatsId=d,r||(r={nullConfig:!0}),((r=JSON.parse(JSON.stringify(r)))&&r.iceServers||[]).forEach((function(e){delete e.credential})),r.browserType=i?"moz":a?"edge":"webkit",e("create",d,r),o&&e("constraints",d,o),c.addEventListener("icecandidate",(function(t){e("onicecandidate",d,t.candidate)})),c.addEventListener("addstream",(function(t){e("onaddstream",d,t.stream.id+" "+t.stream.getTracks().map((function(e){return e.kind+":"+e.id})))})),c.addEventListener("track",(function(t){e("ontrack",d,t.track.kind+":"+t.track.id+" "+t.streams.map((function(e){return"stream:"+e.id})))})),c.addEventListener("removestream",(function(t){e("onremovestream",d,t.stream.id+" "+t.stream.getTracks().map((function(e){return e.kind+":"+e.id})))})),c.addEventListener("signalingstatechange",(function(){e("onsignalingstatechange",d,c.signalingState)})),c.addEventListener("iceconnectionstatechange",(function(){e("oniceconnectionstatechange",d,c.iceConnectionState)})),c.addEventListener("icegatheringstatechange",(function(){e("onicegatheringstatechange",d,c.iceGatheringState)})),c.addEventListener("connectionstatechange",(function(){e("onconnectionstatechange",d,c.connectionState)})),c.addEventListener("negotiationneeded",(function(){e("onnegotiationneeded",d,void 0)})),c.addEventListener("datachannel",(function(t){e("ondatachannel",d,[t.channel.id,t.channel.label])}));var l={},u=function(){c.getStats(null).then((function(t){var r=function(e){if(!e.entries)return e;var t={};return e.forEach((function(e,r){t[r]=e})),t}(t),n=JSON.parse(JSON.stringify(r));e("getstats",d,function(e,t){t=JSON.parse(JSON.stringify(t)),Object.keys(t).forEach((function(r){var n=t[r];delete n.id,e[r]&&Object.keys(n).forEach((function(i){n[i]===e[r][i]&&delete t[r][i],(0===Object.keys(n).length||1===Object.keys(n).length&&n.timestamp)&&delete t[r]}))}));var r=-1/0;return Object.keys(t).forEach((function(e){var n=t[e];n.timestamp>r&&(r=n.timestamp)})),Object.keys(t).forEach((function(e){var n=t[e];n.timestamp===r&&(n.timestamp=0)})),t.timestamp=r,t}(l,r)),l=n}))};if(!a&&t)var p=window.setInterval((function(){"closed"!==c.signalingState?u():window.clearInterval(p)}),t);return a||c.addEventListener("connectionstatechange",(function(){"connected"!==c.connectionState&&"failed"!==c.connectionState||u()})),c};["createDataChannel","close"].forEach((function(t){var r=s.prototype[t];r&&(s.prototype[t]=function(){return e(t,this.__rtcStatsId,arguments),r.apply(this,arguments)})})),["addStream","removeStream"].forEach((function(t){var r=s.prototype[t];r&&(s.prototype[t]=function(){var n=arguments[0],i=n.getTracks().map((function(e){return e.kind+":"+e.id})).join(",");return e(t,this.__rtcStatsId,n.id+" "+i),r.apply(this,arguments)})})),["addTrack"].forEach((function(t){var r=s.prototype[t];r&&(s.prototype[t]=function(){var n=arguments[0],i=[].slice.call(arguments,1);return e(t,this.__rtcStatsId,n.kind+":"+n.id+" "+(i.map((function(e){return"stream:"+e.id})).join(";")||"-")),r.apply(this,arguments)})})),["removeTrack"].forEach((function(t){var r=s.prototype[t];r&&(s.prototype[t]=function(){var n=arguments[0].track;return e(t,this.__rtcStatsId,n?n.kind+":"+n.id:"null"),r.apply(this,arguments)})})),["createOffer","createAnswer"].forEach((function(t){var r=s.prototype[t];r&&(s.prototype[t]=function(){var n,i=this.__rtcStatsId,a=arguments;return 1===arguments.length&&"object"===typeof arguments[0]?n=arguments[0]:3===arguments.length&&"object"===typeof arguments[2]&&(n=arguments[2]),e(t,this.__rtcStatsId,n),r.apply(this,n?[n]:void 0).then((function(r){if(e(t+"OnSuccess",i,r),!(a.length>0&&"function"===typeof a[0]))return r;a[0].apply(null,[r])}),(function(r){if(e(t+"OnFailure",i,r.toString()),!(a.length>1&&"function"===typeof a[1]))throw r;a[1].apply(null,[r])}))})})),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var r=s.prototype[t];r&&(s.prototype[t]=function(){var n=this.__rtcStatsId,i=arguments;return e(t,this.__rtcStatsId,i[0]),r.apply(this,[i[0]]).then((function(){e(t+"OnSuccess",n,void 0),i.length>=2&&"function"===typeof i[1]&&i[1].apply(null,[])}),(function(r){if(e(t+"OnFailure",n,r.toString()),!(i.length>=3&&"function"===typeof i[2]))throw r;i[2].apply(null,[r])}))})})),s.generateCertificate&&Object.defineProperty(o,"generateCertificate",{get:function(){return arguments.length?s.generateCertificate.apply(null,arguments):s.generateCertificate}}),window[r+"RTCPeerConnection"]=o,window[r+"RTCPeerConnection"].prototype=s.prototype}})),r.forEach((function(t){var r=t+(t.length?"GetUserMedia":"getUserMedia");if(navigator[r]){var n=navigator[r].bind(navigator);navigator[r]=function(){e("getUserMedia",null,arguments[0]);var t=arguments[1],r=arguments[2];n(arguments[0],(function(r){e("getUserMediaOnSuccess",null,pd(r)),t&&t(r)}),(function(t){e("getUserMediaOnFailure",null,t.name),r&&r(t)}))}.bind(navigator)}})),navigator.mediaDevices&&navigator.mediaDevices.getUserMedia){var s=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);navigator.mediaDevices.getUserMedia=function(){return e("navigator.mediaDevices.getUserMedia",null,arguments[0]),s.apply(navigator.mediaDevices,arguments).then((function(t){return e("navigator.mediaDevices.getUserMediaOnSuccess",null,pd(t)),t}),(function(t){return e("navigator.mediaDevices.getUserMediaOnFailure",null,t.name),Promise.reject(t)}))}.bind(navigator.mediaDevices)}if(navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia){var o=navigator.mediaDevices.getDisplayMedia.bind(navigator.mediaDevices);navigator.mediaDevices.getDisplayMedia=function(){return e("navigator.mediaDevices.getDisplayMedia",null,arguments[0]),o.apply(navigator.mediaDevices,arguments).then((function(t){return e("navigator.mediaDevices.getDisplayMediaOnSuccess",null,pd(t)),t}),(function(t){return e("navigator.mediaDevices.getDisplayMediaOnFailure",null,t.name),Promise.reject(t)}))}.bind(navigator.mediaDevices)}},fd=so(hd);const md={id:fi(),connectionNumber:0};const gd=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:console;const r=[];let n,i,a,s,o,c,d,l=0,u=!1;const p={connected:!1,trace:function(){for(var e=arguments.length,t=new Array(e),h=0;h<e;h++)t[h]=arguments[h];if(t.push(Date.now()),"customEvent"===t[0]&&"roomSessionId"===t[2].type){const e=c&&c[2].value.roomSessionId,r=t[2].value.roomSessionId;if(c=t,u&&r&&r!==e&&n)return void n.close();r&&(u=!0)}else"customEvent"===t[0]&&"clientId"===t[2].type?a=t:"customEvent"===t[0]&&"organizationId"===t[2].type?i=t:"customEvent"===t[0]&&"displayName"===t[2].type?s=t:"customEvent"===t[0]&&"userRole"===t[2].type&&(o=t);n.readyState===WebSocket.OPEN?(l=0,n.send(JSON.stringify(t))):"getstats"===t[0]||"customEvent"===t[0]&&"insightsStats"===t[2].type||r.push(t),n.readyState===WebSocket.CLOSED&&d&&setTimeout((()=>{n.readyState===WebSocket.CLOSED&&d&&p.connect()}),1e3*l)},close:()=>{d=!1,n&&n.close()},connect:()=>{d=!0,l+=1,n&&n.close(),p.connected=!0,n=new WebSocket(e+window.location.pathname,"1.0"),n.onerror=e=>{p.connected=!1,t.warn("[RTCSTATS] WebSocket error",e)},n.onclose=e=>{p.connected=!1,t.info("[RTCSTATS] Closed ".concat(e.code))},n.onopen=()=>{for(md.connectionNumber++,n.send(JSON.stringify(["clientInfo",null,md])),i&&n.send(JSON.stringify(i)),a&&n.send(JSON.stringify(a)),c&&n.send(JSON.stringify(c)),s&&n.send(JSON.stringify(s)),o&&n.send(JSON.stringify(o));r.length;)n.send(JSON.stringify(r.shift()))}}};return p.connect(),p}("wss://rtcstats.srv.whereby.com");fd(gd.trace,1e4,[""]);const vd={sendEvent:(e,t)=>{gd.trace("customEvent",null,{type:e,value:t})},sendAudioMuted:e=>{vd.sendEvent("audio_muted",{muted:e})},sendVideoMuted:e=>{vd.sendEvent("video_muted",{muted:e})},server:gd},yd=ed.getCameraId(),bd=si.browserDetails.browser,_d=si.browserDetails.version;"firefox"===bd&&si.browserShim.shimGetDisplayMedia(window,"screen");let wd=!1;"chrome"===bd&&window.document.addEventListener("beforeunload",(()=>{wd=!0}));class Sd{constructor(e){let{selfId:t,room:r,emitter:n,serverSocket:i,webrtcProvider:a,features:s,logger:o=console}=e;uo.ok(t,"selfId is required"),uo.ok(r,"room is required"),uo.ok(n&&n.emit,"emitter is required"),uo.ok(i instanceof Ms,"serverSocket is required"),uo.ok(a,"webrtcProvider is required");const{name:c,session:d,iceServers:l,sfuServer:u,mediaserverConfigTtlSeconds:p}=r;this._selfId=t,this._roomName=c,this._roomSessionId=d&&d.id,this.peerConnections={},this.localStreams={},this.enabledLocalStreamIds=[],this._socketListenerDeregisterFunctions=[],this._localStreamDeregisterFunction=null,this._emitter=n,this._serverSocket=i,this._webrtcProvider=a,this._features=s||{},this._logger=o,this.offerOptions={offerToReceiveAudio:!0,offerToReceiveVideo:!0},this._pendingActionsForConnectedPeerConnections=[],this._audioTrackOnEnded=()=>{vd.sendEvent("audio_ended",{unloading:wd}),this._emit(nd,{})},this._updateAndScheduleMediaServersRefresh({sfuServer:u,iceServers:l.iceServers||[],mediaserverConfigTtlSeconds:p})}numberOfPeerconnections(){return Object.keys(this.peerConnections).length}numberOfRemotePeers(){return Object.values(this.peerConnections).filter((e=>e.clientId!==this._selfId)).length}_setConnectionStatus(e,t,r){const n=e.connectionStatus;n!==t&&e.peerConnectionId!==this._selfId&&(n===Uc&&t===Fc||(e.connectionStatus=t,setTimeout((()=>{this._emit(Ic,{streamIds:e.streamIds,clientId:r,status:t,previous:n})}),0)))}_setJitterBufferTarget(e){try{e.getReceivers().forEach((e=>{e.jitterBufferTarget=ld,e.playoutDelayHint=.4}))}catch(t){this._logger.error("Error during setting jitter buffer target:",t)}}_emitServerEvent(e,t,r){this._serverSocket.emit(e,t,r)}_emit(e,t){this._emitter.emit(e,t)}isInitializedWith(e){let{selfId:t,roomName:r,isSfu:n}=e;return this._selfId===t&&this._roomName===r&&n===!!this._sfuServer}supportsScreenShareAudio(){return!0}_addEnabledLocalStreamId(e){this.enabledLocalStreamIds.push(e)}_deleteEnabledLocalStreamId(e){const t=this.enabledLocalStreamIds.indexOf(e);-1!==t&&this.enabledLocalStreamIds.splice(t,1)}_getSession(e){return e in this.peerConnections?this.peerConnections[e]:null}_getOrCreateSession(e,t){let r=this.peerConnections[e];if(void 0===r){const n="safari"===bd&&_d>=14&&this._features.deprioritizeH264OnSafari;this.peerConnections[e]=r=new ud({peerConnectionId:e,bandwidth:t,maximumTurnBandwidth:this._features.unlimitedBandwidthWhenUsingRelayP2POn?-1:1280,deprioritizeH264Encoding:n})}return r}_getLocalCameraStream(){return this.localStreams[yd]}_getNonLocalCameraStreamIds(){return Object.keys(this.localStreams).filter((e=>e!==yd))}_isScreensharingLocally(){return this._getNonLocalCameraStreamIds().length>0}_getFirstLocalNonCameraStream(){const e=this._getNonLocalCameraStreamIds();return 0===e.length?null:this.localStreams[e[0]]}_transformIncomingSdp(e){return{type:e.type,sdp:e.sdpU}}_transformOutgoingSdp(e){return{type:e.type,sdpU:e.sdp}}_createSession(e){let{clientId:t,initialBandwidth:r,isOfferer:n,peerConnectionId:i,shouldAddLocalVideo:a}=e;if(!i)throw new Error("peerConnectionId is missing");if(!t)throw new Error("clientId is missing");const s=this._getOrCreateSession(i,r),o={optional:[]};"chrome"===bd&&o.optional.push({googCpuOveruseDetection:!0}),o.optional.push({rtcStatsRoomSessionId:this._roomSessionId}),o.optional.push({rtcStatsClientId:this._selfId}),o.optional.push({rtcStatsPeerId:i}),o.optional.push({rtcStatsConferenceId:this._roomName});const c={iceServers:this._iceServers};if(this._features.turnServerOverrideHost){const e=this._features.turnServerOverrideHost,t=e.indexOf(":")>0?"":":443",r=":"+e+t;c.iceServers=c.iceServers.map((e=>{const t=Object.assign({},e);return t.url&&(t.url=t.url.replace(/:[^?]*/,r)),t.urls&&(t.urls=t.urls.map((e=>e.replace(/:[^?]*/,r)))),t}))}if(this._features.useOnlyTURN){c.iceTransportPolicy="relay";const e={onlyudp:/^turn:.*transport=udp$/,onlytcp:/^turn:.*transport=tcp$/,onlytls:/^turns:.*transport=tcp$/}[this._features.useOnlyTURN];e&&(c.iceServers=c.iceServers.filter((t=>t.url&&t.url.match(e))))}"chrome"===bd&&(c.sdpSemantics="unified-plan");const d=s.setAndGetPeerConnection({constraints:o,peerConnectionConfig:c,shouldAddLocalVideo:a,clientId:t});d.ontrack=e=>{const r=e.streams[0];"default"===r.id&&0===r.getAudioTracks().length||-1===s.streamIds.indexOf(r.id)&&(s.streamIds.push(r.id),this._emit(Mc,{clientId:t,stream:r}),s.connectionStatus===Bc&&setTimeout((()=>{this._emit(Ic,{streamIds:s.streamIds,clientId:t,status:s.connectionStatus,previous:Fc})}),0))},d.oniceconnectionstatechange=()=>{let e;const r=s.connectionStatus;switch(d.iceConnectionState){case"checking":e=Fc;break;case"connected":case"completed":e=Bc,s.wasEverConnected||(this._pendingActionsForConnectedPeerConnections.forEach((e=>{"function"===typeof e&&e()})),this._pendingActionsForConnectedPeerConnections=[]),!s.wasEverConnected&&(d.iceConnectionState.match(/connected|completed/)||"chrome"===bd&&d.localDescription&&"answer"===d.localDescription.type)&&(s.wasEverConnected=!0,"false"!==this._features.bandwidth&&this.maybeRestrictRelayBandwidth(s)),s.registerConnected();break;case"disconnected":e=Uc,setTimeout((()=>{"disconnected"===d.iceConnectionState&&this._maybeRestartIce(t,s)}),2e3);break;case"failed":e=zc,r!==e&&this._maybeRestartIce(t,s),null!==s.relayCandidateSeen||s.wasEverConnected||this._emit(td);break;default:return}this._setConnectionStatus(s,e,t)},d.onconnectionstate=()=>{switch(d.connectionState){case"connected":setTimeout((()=>{(function(e){if("chrome"!==si.browserDetails.browser||si.browserDetails.browser<58||"closed"===e.signalingState)return Promise.resolve(!1);const t=e.getSenders().some((e=>e.track&&"audio"===e.track.kind)),r=e.getReceivers().some((e=>e.track&&"audio"===e.track.kind));return e.getStats(null).then((e=>{let n=!1;return e.forEach((e=>{"outbound-rtp"!==e.type||"audio"!==e.kind&&"audio"!==e.mediaType||!t?"inbound-rtp"!==e.type||"audio"!==e.kind&&"audio"!==e.mediaType||!r||0===e.bytesReceived&&(n="inbound"):0===e.bytesSent&&(n="outbound")})),n}))})(s.pc).then((e=>{!1!==e&&this._emit(rd,{failureDirection:e,clientId:t})}))}),3e3),s.registerConnected();break;case"failed":const e=zc;null!==s.relayCandidateSeen||s.wasEverConnected||this._emit(td),this._setConnectionStatus(s,e,t)}};const l=this.localStreams[yd];return a&&l&&s.addStream(l),a&&Object.keys(this.localStreams).forEach((e=>{if(e===yd)return;const t=this.localStreams[e];n?s.addStream(t):s.afterConnected.then((()=>{this._emitServerEvent(qc,{receiverId:s.clientId,streamId:t.id,hasAudioTrack:!!t.getAudioTracks().length}),this._withForcedRenegotiation(s,(()=>s.addStream(t)))}))})),s}_cleanup(e){const t=this._getSession(e);t?(t.close(),delete this.peerConnections[e]):this._logger.warn("No RTCPeerConnection in RTCManager.disconnect()",e)}_forEachPeerConnection(e){Object.keys(this.peerConnections).forEach((t=>{const r=this.peerConnections[t];e(r)}))}_addStreamToPeerConnections(e){this._forEachPeerConnection((t=>{this._withForcedRenegotiation(t,(()=>t.addStream(e)))}))}_addTrackToPeerConnections(e,t){this._forEachPeerConnection((r=>{this._withForcedRenegotiation(r,(()=>r.addTrack(e,t)))}))}_replaceTrackToPeerConnections(e,t){const r=[];return this._forEachPeerConnection((n=>{if(!n.hasConnectedPeerConnection()){this._logger.log("Session doesn't have a connected PeerConnection, adding pending action!");const i=this._pendingActionsForConnectedPeerConnections;if(!i)return void this._logger.warn("No pending action is created to repalce track, because the pending actions array is null");const a=new Promise(((r,a)=>{i.push((()=>{const i=n.replaceTrack(e,t);if(!i)return this._logger.error("replaceTrack returned false!"),void a("ReplaceTrack returned false");i.then((e=>r(e))).catch((e=>a(e)))}))}));return void r.push(a)}const i=n.replaceTrack(e,t);i?r.push(i):this._logger.error("replaceTrack returned false!")})),Promise.all(r)}_removeStreamFromPeerConnections(e){this._forEachPeerConnection((t=>{this._withForcedRenegotiation(t,(()=>t.removeStream(e)))}))}_removeTrackFromPeerConnections(e){this._forEachPeerConnection((t=>{this._withForcedRenegotiation(t,(()=>t.removeTrack(e)))}))}_addLocalStream(e,t){this._addEnabledLocalStreamId(e),this.localStreams[e]=t}_removeLocalStream(e){delete this.localStreams[e],this._deleteEnabledLocalStreamId(e)}maybeRestrictRelayBandwidth(e){e.maybeRestrictRelayBandwidth()}addNewStream(e,t){if(t!==this.localStreams[e]){if(this._addLocalStream(e,t),e===yd){this._addStreamToPeerConnections(t);const[e]=t.getAudioTracks();e&&this._startMonitoringAudioTrack(e),this._localStreamDeregisterFunction&&(this._localStreamDeregisterFunction(),this._localStreamDeregisterFunction=null);const r=e=>{const{enable:t,track:r}=e.detail;this._handleStopOrResumeVideo({enable:t,track:r})};return t.addEventListener("stopresumevideo",r),void(this._localStreamDeregisterFunction=()=>{t.removeEventListener("stopresumevideo",r)})}this._shareScreen(e,t)}}removeStream(e,t){this._removeLocalStream(e,t)}replaceTrack(e,t){return e&&"audio"===e.kind&&this._stopMonitoringAudioTrack(e),t&&"audio"===t.kind&&this._startMonitoringAudioTrack(t),this._replaceTrackToPeerConnections(e,t)}accept(e){let{clientId:t,shouldAddLocalVideo:r}=e;return this.acceptNewStream({streamId:t,clientId:t,shouldAddLocalVideo:r})}disconnectAll(){Object.keys(this.peerConnections).forEach((e=>{this.disconnect(e)})),this.peerConnections={},this._socketListenerDeregisterFunctions.forEach((e=>{e()})),this._socketListenerDeregisterFunctions=[],this._localStreamDeregisterFunction&&(this._localStreamDeregisterFunction(),this._localStreamDeregisterFunction=null)}stopOrResumeAudio(){}stopOrResumeVideo(){}_handleStopOrResumeVideo(){}fixChromeAudio(e){if("chrome"!==bd)return;const t=this._getLocalCameraStream(),r=t.getAudioTracks()[0];return r&&"ended"===r.readyState?navigator.mediaDevices.getUserMedia({audio:e}).then((e=>{const n=e.getAudioTracks()[0];return n.enabled=r.enabled,t.removeTrack(r),t.addTrack(n),this.replaceTrack(r,n)})):void 0}_updateAndScheduleMediaServersRefresh(e){let{iceServers:t,sfuServer:r,mediaserverConfigTtlSeconds:n}=e;this._iceServers=t,this._sfuServer=r,this._mediaserverConfigTtlSeconds=n,this._clearMediaServersRefresh(),n&&(this._fetchMediaServersTimer=setTimeout((()=>this._emitServerEvent(Vc)),1e3*n))}_clearMediaServersRefresh(){this._fetchMediaServersTimer&&(clearTimeout(this._fetchMediaServersTimer),this._fetchMediaServersTimer=null)}setupSocketListeners(){this._socketListenerDeregisterFunctions=[()=>this._clearMediaServersRefresh(),this._serverSocket.on(Hc,(e=>{e.error?this._logger.warn("FETCH_MEDIASERVER_CONFIG failed:",e.error):this._updateAndScheduleMediaServersRefresh(e)})),this._serverSocket.on($c,(e=>{this._connect(e.clientId)})),this._serverSocket.on(Kc,(e=>{const t=this._getSession(e.clientId);t?t.addIceCandidate(e.message):this._logger.warn("No RTCPeerConnection on ICE_CANDIDATE",e)})),this._serverSocket.on(Jc,(e=>{const t=this._getSession(e.clientId);t?t.addIceCandidate(null):this._logger.warn("No RTCPeerConnection on ICE_END_OF_CANDIDATES",e)})),this._serverSocket.on(Xc,(e=>{const t=this._getSession(e.clientId);if(!t)return void this._logger.warn("No RTCPeerConnection on SDP_OFFER",e);const r=this._transformIncomingSdp(e.message,t.pc);t.handleOffer(r).then((t=>{this._emitServerEvent(Qc,{receiverId:e.clientId,message:this._transformOutgoingSdp(t)})}))})),this._serverSocket.on(Qc,(e=>{const t=this._getSession(e.clientId);if(!t)return void this._logger.warn("No RTCPeerConnection on SDP_ANSWER",e);const r=this._transformIncomingSdp(e.message,t.pc);t.handleAnswer(r)}))]}sendAudioMutedStats(e){vd.sendEvent("audio_muted",{muted:e})}sendVideoMutedStats(e){vd.sendEvent("video_muted",{muted:e})}sendStatsCustomEvent(e,t){vd.sendEvent(e,t)}rtcStatsDisconnect(){vd.server.close()}rtcStatsReconnect(){vd.server.connected||vd.server.connect()}_startMonitoringAudioTrack(e){e.addEventListener("ended",this._audioTrackOnEnded)}_stopMonitoringAudioTrack(e){e.removeEventListener("ended",this._audioTrackOnEnded)}setRoomSessionId(e){this._roomSessionId=e}}const Cd=57600,kd=2.6041666666666665,Rd=921600,Td=1.0850694444444444;const Pd=ed.getCameraId(),Ed=si.browserDetails.browser;class Dd extends Sd{_connect(e){this.rtcStatsReconnect();let t=this._getSession(e),r=t&&t.bandwidth||0;return t?(this._logger.warn("Replacing peer session",e),this._cleanup(e)):r=this._changeBandwidthForAllClients(!0),t=this._createP2pSession(e,r,!0,!0),this._negotiatePeerConnection(e,t),Promise.resolve(t)}_maybeRestartIce(e,t){const r=t.pc;"disconnected"!==r.iceConnectionState&&"failed"!==r.iceConnectionState||"offer"===r.localDescription.type&&(t.wasEverConnected=!1,t.relayCandidateSeen=!1,this._negotiatePeerConnection(e,t,Object.assign({},this.offerOptions,{iceRestart:!0})))}_setCodecPreferences(e,t,r,n){try{e.getTransceivers().filter((e=>{var t;return"audio"===(null===e||void 0===e||null===(t=e.sender)||void 0===t||null===(t=t.track)||void 0===t?void 0:t.kind)})).forEach((e=>{if("undefined"===typeof RTCRtpSender.getCapabilities)return;const t=RTCRtpSender.getCapabilities("audio");for(let r=0;r<t.codecs.length;r++)if(n&&"audio/red"===t.codecs[r].mimeType.toLowerCase()){t.codecs.unshift(t.codecs.splice(r,1)[0]);break}"undefined"!==typeof e.setCodecPreferences&&e.setCodecPreferences(t.codecs)}));e.getTransceivers().filter((e=>{var t;return"video"===(null===e||void 0===e||null===(t=e.sender)||void 0===t||null===(t=t.track)||void 0===t?void 0:t.kind)})).forEach((e=>{if(void 0===RTCRtpSender.getCapabilities)return;const n=RTCRtpSender.getCapabilities("video");for(let i=0;i<n.codecs.length;i++){if(t&&"video/vp9"===n.codecs[i].mimeType.toLowerCase()){n.codecs.unshift(n.codecs.splice(i,1)[0]);break}if(r&&"video/av1"===n.codecs[i].mimeType.toLowerCase()){n.codecs.unshift(n.codecs.splice(i,1)[0]);break}}void 0!==e.setCodecPreferences&&e.setCodecPreferences(n.codecs)}))}catch(i){this._logger.error("Error during setting setCodecPreferences:",i)}}_negotiatePeerConnection(e,t,r){if(!t)return void this._logger.warn("No RTCPeerConnection in negotiatePeerConnection()",e);const n=t.pc;if(!t.canModifyPeerConnection())return void t.pending.push((()=>{this._negotiatePeerConnection(e,t,r)}));t.isOperationPending=!0;const{vp9On:i,av1On:a,redOn:s}=this._features;(i||a||s)&&this._setCodecPreferences(n,i,a,s),n.createOffer(r||this.offerOptions).then((r=>{(i||s)&&"firefox"===Ed&&(r.sdp=function(e,t,r){try{const n=oi.parse(e);if(Array.isArray(null===n||void 0===n?void 0:n.media)){const e=n.media.find((e=>"audio"===e.type));if(Array.isArray(null===e||void 0===e?void 0:e.rtp)){const t=e.rtp;for(let n=0;n<t.length;n++)if(r&&"red"===t[n].codec){const r=e.payloads.split(" "),i=r.indexOf(""+t[n].payload);i&&-1!==i&&i>=0&&(r.unshift(r.splice(i,1)[0]),e.payloads=r.join(" "))}}const i=n.media.find((e=>"video"===e.type));if(Array.isArray(null===i||void 0===i?void 0:i.rtp)){const e=i.rtp;for(let r=0;r<e.length;r++)if(t&&"VP9"===e[r].codec){const t=i.payloads.split(" "),n=t.indexOf(""+e[r].payload);n&&-1!==n&&n>=0&&(t.unshift(t.splice(n,1)[0]),i.payloads=t.join(" "))}}}return oi.write(n)}catch(n){console.log("setCodecPreferenceSDP error:",n)}}(r.sdp,i,s)),this._emitServerEvent(Xc,{receiverId:e,message:this._transformOutgoingSdp(r)}),"chrome"===Ed&&n.getSenders().filter((e=>e.track&&"video"===e.track.kind)).length>=2?t.pendingOffer=r:n.setLocalDescription(r).catch((e=>{this._logger.warn("RTCPeerConnection.setLocalDescription() failed with local offer",e)}))})).catch((e=>{this._logger.warn("RTCPeerConnection.createOffer() failed to create local offer",e)}))}_withForcedRenegotiation(e,t){const r=e.pc,n=r.onnegotationneeded;r.onnegotiationneeded=null,t(),this._negotiatePeerConnection(e.clientId,e),setTimeout((()=>r.onnegotiationneeded=n),0)}_changeBandwidthForAllClients(e){let t=this.numberOfPeerconnections();if(e&&(t+=1),0===t)return 0;t>7&&(t=7);let r=this._features.bandwidth?parseInt(this._features.bandwidth,10):{1:this._features.cap2pBitrate?1e3:0,2:this._features.highP2PBandwidth?768:384,3:this._features.highP2PBandwidth?512:256,4:192,5:128,6:128,7:64}[t];if(void 0===r)return 0;if(this._features.adjustBitratesFromResolution){const e=this._getLocalCameraStream();if(e){const t=e&&e.getVideoTracks()[0];if(t){const{width:e,height:n,frameRate:i}=t.getSettings();if(e&&n&&i){const t=Math.round(function(e,t,r){let n=e*t;n<Cd&&(n=Cd),n>Rd&&(n=Rd);let i=kd;n>Rd?i=Td:n>Cd&&(i+=-17582143775720163e-22*(n-Cd));let a=e*t*i;return r<=15?a*=.7:r<=24&&(a*=.9),a}(e,n,i)/1e3);r=Math.min(t,r||t)}}}}return this._features.higherP2PBitrates&&(r*=1.5),this._forEachPeerConnection((e=>{e.changeBandwidth(r)})),r}_createP2pSession(e,t,r,n){const i=this._createSession({peerConnectionId:e,clientId:e,initialBandwidth:t,shouldAddLocalVideo:r,isOfferer:n}),a=i.pc;this._features.increaseIncomingMediaBufferOn&&this._setJitterBufferTarget(a);const s=this.localStreams[Pd];return r&&s&&!s.getVideoTracks().length&&this._stoppedVideoTrack&&a.addTrack(this._stoppedVideoTrack,s),a.onicecandidate=t=>{t.candidate?(i.relayCandidateSeen=i.relayCandidateSeen||"relay"===t.candidate.type,this._emitServerEvent(Kc,{receiverId:e,message:t.candidate})):this._emitServerEvent(Jc,{receiverId:e})},a.onnegotiationneeded=()=>{"new"!==a.iceConnectionState&&i.connectionStatus&&this._negotiatePeerConnection(e,i)},i}acceptNewStream(e){let{streamId:t,clientId:r,shouldAddLocalVideo:n}=e,i=this._getSession(r);if(i&&t!==r)return i;let a=i&&i.bandwidth||0;return i?(this._logger.warn("Replacing peer session",r),this._cleanup(r)):a=this._changeBandwidthForAllClients(!0),i=this._createP2pSession(r,a,n),this._emitServerEvent($c,{receiverId:r}),i}disconnect(e){this._cleanup(e),this._changeBandwidthForAllClients(!1);0===this.numberOfPeerconnections()&&setTimeout((()=>{0===this.numberOfPeerconnections()&&this.rtcStatsDisconnect()}),6e4)}updateStreamResolution(){}stopOrResumeAudio(){}_handleStopOrResumeVideo(e){let{enable:t,track:r}=e;t?this._stoppedVideoTrack?(this._replaceTrackToPeerConnections(this._stoppedVideoTrack,r),delete this._stoppedVideoTrack):this._addTrackToPeerConnections(r):this._stoppedVideoTrack=r}stopOrResumeVideo(e,t){if(["chrome","safari"].includes(Ed))if(!1===t)setTimeout((()=>{e.getVideoTracks().forEach((r=>{!1===r.enabled&&(r.stop(),e.removeTrack(r),this._emit(Nc,{stream:e,track:r}),this._handleStopOrResumeVideo({enable:t,track:r}))}))}),5e3);else if(0===e.getVideoTracks().length){const r=this._webrtcProvider.getMediaConstraints().video;if(!r)return;navigator.mediaDevices.getUserMedia({video:r}).then((r=>{const n=r.getVideoTracks()[0];e.addTrack(n),this._emit(Ac,{streamId:e.id,tracks:[n],screenShare:!1}),this._handleStopOrResumeVideo({enable:t,track:n})}))}}_shareScreen(e,t){this._emitServerEvent(qc,{streamId:e,hasAudioTrack:!!t.getAudioTracks().length}),this._addStreamToPeerConnections(t)}removeStream(e,t,r){super.removeStream(e,t),this._removeStreamFromPeerConnections(t),this._emitServerEvent(Wc,{streamId:e,requestedByClientId:r})}}class Od{static parse(e){let t;try{t=JSON.parse(e)}catch(r){return}if("object"===typeof t&&!Array.isArray(t))return t.request?Od._handleRequest(t):t.response?Od._handleResponse(t):t.message?Od._handleMessage(t):void 0}static _handleRequest(e){const t={request:!0};if("string"===typeof e.method&&"number"===typeof e.id)return t.id=e.id,t.method=e.method,t.data=e.data||{},t}static _handleResponse(e){const t={response:!0};if("number"===typeof e.id)return t.id=e.id,e.ok?(t.ok=!0,t.data=e.data||{}):(t.ok=!1,t.errorCode=e.errorCode,t.errorReason=e.errorReason),t}static _handleMessage(e){const t={message:!0};if("string"===typeof e.method)return t.method=e.method,t.data=e.data||{},t}static createRequest(e,t){return{request:!0,id:Math.round(1e7*Math.random()),method:e,data:t||{}}}static createSuccessResponse(e,t){return{response:!0,id:e.id,ok:!0,data:t||{}}}static createErrorResponse(e,t,r){return{response:!0,id:e.id,errorCode:t,errorReason:r}}static createMessage(e,t){return{message:!0,method:e,data:t||{}}}}class xd extends gi.EventEmitter{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"whereby-sfu#v4";super(),this.wsUrl=e,this.logger=t,this.protocol=r,this.sents=new Map,this._setupSocket()}_setupSocket(){this.socket=new WebSocket(this.wsUrl,this.protocol),this.socket.onopen=this._onOpen.bind(this),this.socket.onmessage=this._onMessage.bind(this),this.socket.onclose=this._onClose.bind(this),this.socket.onerror=this._onError.bind(this)}_tearDown(){this.socket.onopen=null,this.socket.onmessage=null,this.socket.onclose=null,this.socket.onerror=null,this.socket=null,this.sents.forEach((e=>e.close())),this.emit("close")}close(){var e;null===(e=this.socket)||void 0===e||e.close()}_onOpen(){this.logger.log("VegaConnectionManager: Connected"),this.emit("open")}_onMessage(e){const t=Od.parse(e.data);this.logger.log("VegaConnectionManager: Received message",t),null!==t&&void 0!==t&&t.response?this._handleResponse(t):null!==t&&void 0!==t&&t.message&&this.emit("message",t)}_onClose(){this.logger.log("VegaConnectionManager: Disconnected"),this._tearDown()}_onError(e){this.logger.log("VegaConnectionManager: Error",e)}_handleResponse(e){const t=this.sents.get(e.id);if(e.ok)t.resolve(e.data);else{const r=new Error(e.errorReason);t.reject(r)}}send(e){try{this.socket.send(JSON.stringify(e))}catch(t){}}message(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=Od.createMessage(e,t);this.send(r)}request(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1500*(15+.1*this.sents.size);const n=Od.createRequest(e,t);return this.send(n),new Promise(((e,t)=>{const i={id:n.id,method:n.method,resolve:t=>{this.sents.delete(n.id)&&(clearTimeout(i.timer),e(t))},reject:e=>{this.sents.delete(n.id)&&(clearTimeout(i.timer),t(e))},timer:setTimeout((()=>{this.sents.delete(n.id)&&t(new Error("request timeout"))}),r),close:()=>{clearTimeout(i.timer),t(new Error("transport closed"))}};this.sents.set(n.id,i)}))}}const Id={codecOptions:{opusDtx:!0,opusFec:!0},encodings:[{dtx:!0}]},Md={codecOptions:{videoGoogleStartBitrate:500},encodings:[{scaleResolutionDownBy:4,maxBitrate:15e4},{scaleResolutionDownBy:2,maxBitrate:5e5},{scaleResolutionDownBy:1,maxBitrate:1e6}]},Ld={codecOptions:{videoGoogleStartBitrate:500},encodings:[{scaleResolutionDownBy:2,maxBitrate:15e4},{scaleResolutionDownBy:1,maxBitrate:5e5}]},jd={codecOptions:{videoGoogleStartBitrate:500},encodings:[{scalabilityMode:"L3T2_KEY"}]},Ad={encodings:[{}]},Nd={encodings:[{scaleResolutionDownBy:2,dtx:!0,maxBitrate:5e5},{scaleResolutionDownBy:1,dtx:!0,maxBitrate:15e5}]},Fd={encodings:[{dtx:!0}]},zd=(e,t,r)=>{const{lowDataModeEnabled:n,simulcastScreenshareOn:i,vp9On:a}=r;return"audio"===e?Id:t?a?Fd:i?Nd:Ad:a?jd:n?Ld:Md},Bd=()=>{let e=(0,mi.detectDevice)()||(/applecoremedia|applewebkit|safari/i.test(navigator.userAgent)?"Safari12":void 0);return/iphone|ipad/i.test(navigator.userAgent)&&(e="Safari12"),e};var Ud=Object.freeze({__proto__:null,KalmanFilter:class{constructor(){let{R:e=.01,Q:t=2,A:r=1.1,B:n=1,C:i=1.2}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{R:.01,Q:2,A:1.1,B:1,C:1.2};this.R=e,this.Q=t,this.A=r,this.C=i,this.B=n,this.cov=NaN,this.x=NaN}filter(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(isNaN(this.x))this.x=1/this.C*e,this.cov=1/this.C*this.Q*(1/this.C);else{const r=this.predict(t),n=this.uncertainty(),i=n*this.C*(1/(this.C*n*this.C+this.Q));this.x=r+i*(e-this.C*r),this.cov=n-i*this.C*n}return this.x}predict(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.A*this.x+this.B*e}uncertainty(){return this.A*this.cov*this.A+this.R}lastMeasurement(){return this.x}setMeasurementNoise(e){this.Q=e}setProcessNoise(e){this.R=e}},calculateStd:e=>{const t=e.reduce(((e,t)=>e+t),0)/e.length;return e.reduce(((e,r)=>e.concat((r-t)**2)),[]).reduce(((e,t)=>e+t),0)/e.length},createACFCalculator:()=>{let e=-1,t=0,r=0;return n=>{const i=n.reduce(((e,t)=>e+t),0)/n.length;if(e=e<0?i:.95*e+.05*i,++r<2)return t=i,0;const a=(i-e)*(t-e);return t=i,a}},standardDeviation:e=>{const t=e.reduce(((e,t)=>e+t),0)/e.length;return{mean:t,SD:Math.sqrt(e.reduce(((e,r)=>e+(r-t)**2),0)/e.length)}},variance:function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=e.reduce(((e,t)=>e+t),0)/e.length;return e.reduce(((e,t)=>e.concat((t-r)**2)),[]).reduce(((e,t)=>e+t),0)/(e.length-(t?0:1))}});const Vd={minDecibels:-80,maxDecibels:-10,smoothingTimeConstant:.8,aggSize:1,sampleRate:10,reportRate:2,bins:32,bands:[[0,1,2,3],[4,5,6,7]],separateTrack:{autoGainControl:!1,noiseSupression:!1},binFormula:"bin",scoreFormula:"300 * bands[1].avg / Math.max(bands[1].avg + bands[0].avg, 0.01)",outFormula:"score"};const qd=si.browserDetails.browser;let Wd=!1;const Hd=fi(),Gd=fi();"chrome"===qd&&window.document.addEventListener("beforeunload",(()=>Wd=!0));class Kd{constructor(e){let{selfId:t,room:r,emitter:n,serverSocket:i,webrtcProvider:a,features:s,eventClaim:o,logger:c=console}=e;uo.ok(t,"selfId is required"),uo.ok(r,"room is required"),uo.ok(n&&n.emit,"emitter is required"),uo.ok(i instanceof Ms,"serverSocket is required"),uo.ok(a,"webrtcProvider is required");const{session:d,iceServers:l,sfuServer:u,mediaserverConfigTtlSeconds:p}=r;this._selfId=t,this._room=r,this._roomSessionId=null===d||void 0===d?void 0:d.id,this._emitter=n,this._serverSocket=i,this._webrtcProvider=a,this._features=s||{},this._eventClaim=o,this._logger=c,this._vegaConnection=null,this._micAnalyser=null,this._micAnalyserDebugger=null,this._mediasoupDevice=new mi.Device({handlerName:Bd()}),this._routerRtpCapabilities=null,this._sendTransport=null,this._receiveTransport=null,this._clientStates=new Map,this._streamIdToVideoConsumerId=new Map,this._consumers=new Map,this._dataConsumers=new Map,this._localStreamDeregisterFunction=null,this._micTrack=null,this._webcamTrack=null,this._screenVideoTrack=null,this._screenAudioTrack=null,this._micProducer=null,this._micProducerPromise=null,this._micPaused=!1,this._micScoreProducer=null,this._micScoreProducerPromise=null,this._webcamProducer=null,this._webcamProducerPromise=null,this._webcamPaused=!1,this._screenVideoProducer=null,this._screenVideoProducerPromise=null,this._screenAudioProducer=null,this._screenAudioProducerPromise=null,this._sndTransportIceRestartPromise=null,this._rcvTransportIceRestartPromise=null,this._colocation=null,this._stopCameraTimeout=null,this._audioTrackOnEnded=()=>{vd.sendEvent("audio_ended",{unloading:Wd}),this._emitToPWA(nd,{})},this._updateAndScheduleMediaServersRefresh({sfuServer:u,iceServers:l.iceServers||[],mediaserverConfigTtlSeconds:p}),this._socketListenerDeregisterFunctions=[],this._reconnect=!0,this._reconnectTimeOut=null}_updateAndScheduleMediaServersRefresh(e){var t,r;let{iceServers:n,sfuServer:i,mediaserverConfigTtlSeconds:a}=e;this._iceServers=n,this._sfuServer=i,this._mediaserverConfigTtlSeconds=a,null===(t=this._sendTransport)||void 0===t||t.updateIceServers({iceServers:this._iceServers}),null===(r=this._receiveTransport)||void 0===r||r.updateIceServers({iceServers:this._iceServers}),this._clearMediaServersRefresh(),a&&(this._fetchMediaServersTimer=setTimeout((()=>this._emitToSignal(Vc)),1e3*a))}_clearMediaServersRefresh(){this._fetchMediaServersTimer&&(clearTimeout(this._fetchMediaServersTimer),this._fetchMediaServersTimer=null)}setupSocketListeners(){this._socketListenerDeregisterFunctions.push((()=>this._clearMediaServersRefresh()),this._serverSocket.on(Hc,(e=>{e.error?this._logger.warn("FETCH_MEDIASERVER_CONFIG failed:",e.error):this._updateAndScheduleMediaServersRefresh(e)})),this._serverSocket.on(Gc,(()=>{this._screenVideoTrack&&this._emitScreenshareStarted()}))),this._connect()}_emitScreenshareStarted(){this._emitToSignal(qc,{streamId:Gd,hasAudioTrack:Boolean(this._screenAudioTrack)})}_connect(){const e=this._features.sfuServerOverrideHost||[this._sfuServer.url],t=new URLSearchParams({clientId:this._selfId,organizationId:this._room.organizationId,roomName:this._room.name,eventClaim:this._room.isClaimed?this._eventClaim:null,lowBw:!0}).toString(),r="wss://".concat(e,"?").concat(t);this._vegaConnection=new xd(r,this._logger),this._vegaConnection.on("open",(()=>this._join())),this._vegaConnection.on("close",(()=>this._onClose())),this._vegaConnection.on("message",(e=>this._onMessage(e)))}_onClose(){var e,t;this._logger.debug("_onClose()"),null===(e=this._sendTransport)||void 0===e||e.close(),null===(t=this._receiveTransport)||void 0===t||t.close(),this._sendTransport=null,this._receiveTransport=null,this._streamIdToVideoConsumerId.clear(),this._reconnect&&(this._reconnectTimeOut=setTimeout((()=>this._connect()),1e3))}async _join(){this._logger.debug("join()");try{const{routerRtpCapabilities:e}=await this._vegaConnection.request("getCapabilities");this._routerRtpCapabilities||(((e,t)=>{const{vp9On:r,h264On:n}=t;if(r){const{preferredPayloadType:t}=e.codecs.find((e=>"video/vp9"===e.mimeType.toLowerCase())),{preferredPayloadType:r}=e.codecs.find((e=>"video/rtx"===e.mimeType.toLowerCase()&&e.parameters.apt===t));e.codecs=e.codecs.filter((e=>"audio"===e.kind||e.preferredPayloadType===t||e.preferredPayloadType===r))}else if(n){const{preferredPayloadType:t}=e.codecs.find((e=>"video/h264"===e.mimeType.toLowerCase())),{preferredPayloadType:r}=e.codecs.find((e=>"video/rtx"===e.mimeType.toLowerCase()&&e.parameters.apt===t));e.codecs=e.codecs.filter((e=>"audio"===e.kind||e.preferredPayloadType===t||e.preferredPayloadType===r))}})(e,this._features),this._routerRtpCapabilities=e,await this._mediasoupDevice.load({routerRtpCapabilities:e})),this._vegaConnection.message("setCapabilities",{rtpCapabilities:this._mediasoupDevice.rtpCapabilities}),this._colocation&&this._vegaConnection.message("setColocation",{colocation:this._colocation}),await Promise.all([this._createTransport(!0),this._createTransport(!1)]);const t=[];!this._micTrack||this._micProducer||this._micProducerPromise||t.push(this._internalSendMic()),!this._webcamTrack||this._webcamProducer||this._webcamProducerPromise||t.push(this._internalSendWebcam()),!this._screenVideoTrack||this._screenVideoProducer||this._screenVideoProducerPromise||t.push(this._internalSendScreenVideo()),!this._screenAudioTrack||this._screenAudioProducer||this._screenAudioProducerPromise||t.push(this._internalSendScreenAudio()),await Promise.all(t)}catch(e){this._logger.error("_join() [error:%o]",e)}}async _createTransport(e){const t=e?"createSendTransport":"createRecvTransport",r=await this._vegaConnection.request("createTransport",{producing:e,consuming:!e,enableTcp:!0,enableUdp:!0,preferUdp:!0,sctpParameters:{enableSctp:!0,numSctpStreams:{OS:1024,MIS:1024},maxSctpMessageSize:262144,sctpSendBufferSize:262144}});r.iceServers=this._iceServers,((e,t)=>{if(!t.useOnlyTURN)return;e.iceTransportPolicy="relay";const r={onlyudp:/^turn:.*transport=udp$/,onlytcp:/^turn:.*transport=tcp$/,onlytls:/^turns:.*transport=tcp$/}[t.useOnlyTURN];r&&(e.iceServers=e.iceServers.filter((e=>e.url&&e.url.match(r))))})(r,this._features);const n=this._mediasoupDevice[t](r),i=async t=>{if(this._logger.debug("Transport ConnectionStateChanged ".concat(t)),"disconnected"===t||"failed"===t)if(e){if(this._sndTransportIceRestartPromise)return;this._sndTransportIceRestartPromise=this._restartIce(n).finally((()=>{this._sndTransportIceRestartPromise=null}))}else{if(this._rcvTransportIceRestartPromise)return;this._rcvTransportIceRestartPromise=this._restartIce(n).finally((()=>{this._rcvTransportIceRestartPromise=null}))}};n.on("connect",((e,t)=>{var r;let{dtlsParameters:i}=e;null===(r=this._vegaConnection)||void 0===r||r.message("connectTransport",{transportId:n.id,dtlsParameters:i}),t()})).on("connectionstatechange",i),n.observer.once("close",(()=>{n.removeListener(i)})),e?(n.on("produce",(async(e,t,r)=>{let{kind:i,rtpParameters:a,appData:s}=e;try{var o;const{paused:e}=s,{id:r}=await(null===(o=this._vegaConnection)||void 0===o?void 0:o.request("produce",{transportId:n.id,kind:i,rtpParameters:a,paused:e,appData:s}));t({id:r})}catch(c){r(c)}})),n.on("producedata",(async(e,t,r)=>{let{appData:i,sctpStreamParameters:a}=e;try{var s;const{id:e}=await(null===(s=this._vegaConnection)||void 0===s?void 0:s.request("produceData",{transportId:n.id,sctpStreamParameters:a,appData:i}));t({id:e})}catch(o){r(o)}})),this._sendTransport=n):this._receiveTransport=n}async _restartIce(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!e||!("closed"in e)||!("connectionState"in e))return void this._logger.debug("_restartIce: No transport or property closed or connectionState!");if(e.closed)return void this._logger.debug("_restartIce: Transport is closed!");if("disconnected"!==e.connectionState&&"failed"!==e.connectionState)return void this._logger.debug("_restartIce: Connection is healthy ICE restart no loneger needed!");const{iceRestartStarted:r}=e.appData,n=Date.now();if(Number.isFinite(r)&&n-r<3500)return;if(e.appData.iceRestartStarted=n,5<=t)return void this._logger.debug("_restartIce: Reached restart ICE  maximum retry count!");if(!this._vegaConnection)return void this._logger.debug("_restartIce: Connection is undefined");const{iceParameters:i}=await this._vegaConnection.request("restartIce",{transportId:e.id});this._logger.debug("_restartIce: ICE restart iceParameters received from SFU: ",i);const a=await e.restartIce({iceParameters:i}).then((()=>null)).catch((e=>e));if(a)switch(this._logger.error("_restartIce: ICE restart failed: ".concat(a)),a.message){case"missing transportId":case"no such transport":break;default:await new Promise((e=>{setTimeout((()=>{e()}),Math.min(3500*2**t,6e4))})),await this._restartIce(e,t+1)}else await new Promise((e=>{setTimeout((()=>{e()}),6e4*Math.min(8,t+1))})),"failed"!==e.connectionState&&"disconnected"!==e.connectionState||await this._restartIce(e,t+1)}async _internalSendMic(){this._logger.debug("_internalSendMic()"),this._micProducerPromise=(async()=>{try{if(!this._micTrack||!this._sendTransport||this._micProducer)return void(this._micProducerPromise=null);const e=this._micPaused,t=await this._sendTransport.produce({track:this._micTrack,disableTrackOnPause:!1,stopTracks:!1,...zd("audio",!1,this._features),appData:{streamId:Hd,sourceClientId:this._selfId,screenShare:!1,source:"mic",paused:e}});e?t.pause():t.resume(),this._micProducer=t,t.observer.once("close",(()=>{var e;this._logger.debug('micProducer "close" event'),t.appData.localClosed&&(null===(e=this._vegaConnection)||void 0===e||e.message("closeProducers",{producerIds:[t.id]})),this._micProducer=null,this._micProducerPromise=null})),this._micTrack!==this._micProducer.track&&await this._replaceMicTrack(),this._micPaused!==this._micProducer.paused&&this._pauseResumeMic()}catch(e){this._logger.error("micProducer failed:%o",e)}finally{this._micProducerPromise=null,this._micTrack||(this._stopProducer(this._micProducer),this._micProducer=null)}})()}async _internalSetupMicScore(){this._logger.debug("_internalSetupMicScore()"),this._micScoreProducerPromise=(async()=>{try{if(!this._micProducer||!this._colocation||this._micScoreProducer)return void(this._micScoreProducerPromise=null);const e=await this._sendTransport.produceData({ordered:!1,maxPacketLifeTime:3e3,label:"micscore",appData:{producerId:this._micProducer.id,clientId:this._selfId}});this._micScoreProducer=e,e.observer.once("close",(()=>{var t;(this._logger.debug('micScoreProducer "close" event'),e.appData.localClosed)&&(null===(t=this._vegaConnection)||void 0===t||t.message("closeDataProducers",{dataProducerIds:[e.id]}));this._micScoreProducer=null,this._micScoreProducerPromise=null}))}catch(e){this._logger.error("micScoreProducer failed:%o",e)}finally{this._micScoreProducerPromise=null,this._micProducer&&this._colocation||this._stopMicScoreProducer()}})()}_stopMicScoreProducer(){this._stopProducer(this._micScoreProducer),this._micScoreProducer=null}async _replaceMicTrack(){var e;(this._logger.debug("_replaceMicTrack()"),this._micTrack&&this._micProducer&&!this._micProducer.closed)&&(this._micProducer.track!==this._micTrack&&(await this._micProducer.replaceTrack({track:this._micTrack}),null===(e=this._micAnalyser)||void 0===e||e.setTrack(this._micTrack),await this._replaceMicTrack()))}_pauseResumeMic(){if(this._logger.debug("_pauseResumeMic()"),this._micProducer&&!this._micProducer.closed&&this._micPaused!==this._micProducer.paused){var e,t;if(this._micPaused)this._micProducer.pause(),null===(e=this._vegaConnection)||void 0===e||e.message("pauseProducers",{producerIds:[this._micProducer.id]});else this._micProducer.resume(),null===(t=this._vegaConnection)||void 0===t||t.message("resumeProducers",{producerIds:[this._micProducer.id]});this._pauseResumeMic()}}async _sendMic(e){return this._logger.debug("_sendMic() [track:%o]",e),this._micTrack=e,this._micProducer?await this._replaceMicTrack():this._micProducerPromise?void 0:this._sendTransport?await this._internalSendMic():void 0}_sendMicScore(e){if(!isNaN(e)&&isFinite(e))if(this._micScoreProducer){if(this._micScoreProducer.closed)return void this._stopMicScoreProducer();try{this._micScoreProducer.send(JSON.stringify({score:e}))}catch(t){console.error("_sendMicScore failed [error:%o]",t)}}else!this._micScoreProducerPromise&&this._micProducer&&this._colocation&&0!==e&&this._internalSetupMicScore()}async _internalSendWebcam(){this._logger.debug("_internalSendWebcam()"),this._webcamProducerPromise=(async()=>{try{if(!this._webcamTrack||!this._sendTransport||this._webcamProducer)return void(this._webcamProducerPromise=null);const e=this._webcamPaused,t=await this._sendTransport.produce({track:this._webcamTrack,disableTrackOnPause:!1,stopTracks:!1,...zd("video",!1,this._features),appData:{streamId:Hd,sourceClientId:this._selfId,screenShare:!1,source:"webcam",paused:e}});e?t.pause():t.resume(),this._webcamProducer=t,t.observer.once("close",(()=>{var e;this._logger.debug('webcamProducer "close" event'),t.appData.localClosed&&(null===(e=this._vegaConnection)||void 0===e||e.message("closeProducers",{producerIds:[t.id]})),this._webcamProducer=null,this._webcamProducerPromise=null})),this._webcamTrack!==this._webcamProducer.track&&await this._replaceWebcamTrack(),this._webcamPaused!==this._webcamProducer.paused&&this._pauseResumeWebcam()}catch(e){this._logger.error("webcamProducer failed:%o",e)}finally{this._webcamProducerPromise=null,this._webcamTrack||(await this._stopProducer(this._webcamProducer),this._webcamProducer=null)}})()}async _replaceWebcamTrack(){this._logger.debug("_replaceWebcamTrack()"),this._webcamTrack&&this._webcamProducer&&!this._webcamProducer.closed&&this._webcamProducer.track!==this._webcamTrack&&(await this._webcamProducer.replaceTrack({track:this._webcamTrack}),await this._replaceWebcamTrack())}_pauseResumeWebcam(){if(this._logger.debug("_pauseResumeWebcam()"),this._webcamProducer&&!this._webcamProducer.closed&&this._webcamPaused!==this._webcamProducer.paused){var e,t;if(this._webcamPaused)this._webcamProducer.pause(),null===(e=this._vegaConnection)||void 0===e||e.message("pauseProducers",{producerIds:[this._webcamProducer.id]});else this._webcamProducer.resume(),null===(t=this._vegaConnection)||void 0===t||t.message("resumeProducers",{producerIds:[this._webcamProducer.id]});this._pauseResumeWebcam()}}async _sendWebcam(e){return this._logger.debug("_sendWebcam() [track:%o]",e),this._webcamTrack=e,this._webcamProducer?await this._replaceWebcamTrack():this._webcamProducerPromise?void 0:this._sendTransport?await this._internalSendWebcam():void 0}async _internalSendScreenVideo(){this._logger.debug("_internalSendScreenVideo()"),this._screenVideoProducerPromise=(async()=>{try{if(!this._screenVideoTrack||!this._sendTransport||this._screenVideoProducer)return void(this._screenVideoProducerPromise=null);const e=await this._sendTransport.produce({track:this._screenVideoTrack,disableTrackOnPause:!1,stopTracks:!1,...zd("video",!0,this._features),appData:{streamId:Gd,sourceClientId:this._selfId,screenShare:!0,source:"screenvideo",paused:!1}});this._screenVideoProducer=e,e.observer.once("close",(()=>{var t;this._logger.debug('screenVideoProducer "close" event'),e.appData.localClosed&&(null===(t=this._vegaConnection)||void 0===t||t.message("closeProducers",{producerIds:[e.id]})),this._screenVideoProducer=null,this._screenVideoProducerPromise=null})),this._screenVideoTrack!==this._screenVideoProducer.track&&await this._replaceScreenVideoTrack()}catch(e){this._logger.error("screenVideoProducer failed:%o",e)}finally{this._screenVideoProducerPromise=null,this._screenVideoTrack||(await this._stopProducer(this._screenVideoProducer),this._screenVideoProducer=null)}})()}async _replaceScreenVideoTrack(){this._logger.debug("_replaceScreenVideoTrack()"),this._screenVideoTrack&&this._screenVideoProducer&&!this._screenVideoProducer.closed&&this._screenVideoProducer.track!==this._screenVideoTrack&&(await this._screenVideoProducer.replaceTrack({track:this._screenVideoTrack}),await this._replaceScreenVideoTrack())}async _sendScreenVideo(e){return this._logger.debug("_sendScreenVideo() [track:%o]",e),this._screenVideoTrack=e,this._screenVideoProducer?await this._replaceScreenVideoTrack():this._screenVideoProducerPromise?void 0:this._sendTransport?await this._internalSendScreenVideo():void 0}async _internalSendScreenAudio(){this._logger.debug("_internalSendScreenAudio()"),this._screenAudioProducerPromise=(async()=>{try{if(!this._screenAudioTrack||!this._sendTransport||this._screenAudioProducer)return void(this._screenAudioProducerPromise=null);const e=await this._sendTransport.produce({track:this._screenAudioTrack,disableTrackOnPause:!1,stopTracks:!1,...zd("video",!0,this._features),appData:{streamId:Gd,sourceClientId:this._selfId,screenShare:!0,source:"screenaudio",paused:!1}});this._screenAudioProducer=e,e.observer.once("close",(()=>{var t;this._logger.debug('screenAudioProducer "close" event'),e.appData.localClosed&&(null===(t=this._vegaConnection)||void 0===t||t.message("closeProducers",{producerIds:[e.id]})),this._screenAudioProducer=null,this._screenAudioProducerPromise=null})),this._screenAudioTrack!==this._screenAudioProducer.track&&await this._replaceScreenAudioTrack()}catch(e){this._logger.error("screenAudioProducer failed:%o",e)}finally{this._screenAudioProducerPromise=null,this._screenAudioTrack||(await this._stopProducer(this._screenAudioProducer),this._screenAudioProducer=null)}})()}async _replaceScreenAudioTrack(){this._logger.debug("_replaceScreenAudioTrack()"),this._screenAudioTrack&&this._screenAudioProducer&&!this._screenAudioProducer.closed&&this._screenAudioProducer.track!==this._screenAudioTrack&&(await this._screenAudioProducer.replaceTrack({track:this._screenAudioTrack}),await this._replaceScreenAudioTrack())}async _sendScreenAudio(e){return this._logger.debug("_sendScreenAudio() [track:%o]",e),this._screenAudioTrack=e,this._screenAudioProducer?await this._replaceScreenAudioTrack():this._screenAudioProducerPromise?void 0:this._sendTransport?await this._internalSendScreenAudio():void 0}_stopProducer(e){this._logger.debug("_stopProducer()"),e&&!e.closed&&(e.appData.localClosed=!0,e.close())}isInitializedWith(e){let{selfId:t,roomName:r,isSfu:n}=e;return this._selfId===t&&this._room.name===r&&Boolean(n)}setEventClaim(e){var t;this._eventClaim=e,null===(t=this._vegaConnection)||void 0===t||t.message("eventClaim",{eventClaim:e})}setColocation(e){var t;this._colocation=e,null===(t=this._vegaConnection)||void 0===t||t.message("setColocation",{colocation:e}),e||!this._micScoreProducer||this._micScoreProducerPromise||this._stopMicScoreProducer(),this._syncMicAnalyser(),vd.sendEvent("colocation_changed",{colocation:e})}setRoomSessionId(e){this._roomSessionId=e}disconnect(e,t,r){if(this._logger.debug("disconnect() [clientIdOrStreamId:%s, eventClaim:%s]",e,r),this._clientStates.has(e)){const t=this._clientStates.get(e);t.hasAcceptedWebcamStream=!1,t.hasAcceptedScreenStream=!1,this._syncIncomingStreamsWithPWA(e)}var n;r&&(this._eventClaim=r,null===(n=this._vegaConnection)||void 0===n||n.message("eventClaim",{eventClaim:r}))}replaceTrack(e,t){e&&"audio"===e.kind&&this._stopMonitoringAudioTrack(e),"audio"===t.kind&&(this._startMonitoringAudioTrack(t),this._micTrack=t,this._replaceMicTrack()),"video"===t.kind&&(this._webcamTrack=t,this._replaceWebcamTrack())}removeStream(e,t,r){this._logger.debug("removeStream() [streamId:%s, requestedByClientId:%s]",e,r),this._emitToSignal(Wc,{streamId:Gd,requestedByClientId:r}),this._stopProducer(this._screenVideoProducer),this._screenVideoProducer=null,this._screenVideoTrack=null,this._stopProducer(this._screenAudioProducer),this._screenAudioProducer=null,this._screenAudioTrack=null}_onMicAnalyserScoreUpdated(e){var t,r;null===(t=this._micAnalyserDebugger)||void 0===t||null===(r=t.onScoreUpdated)||void 0===r||r.call(t,e),this._sendMicScore(this._micPaused?0:e.out)}addNewStream(e,t,r,n){if("0"===e){this._micPaused=r,this._webcamPaused=n;const e=t.getVideoTracks()[0],i=t.getAudioTracks()[0];e&&this._sendWebcam(e),i&&(this._sendMic(i),this._syncMicAnalyser(),this._startMonitoringAudioTrack(i)),this._localStreamDeregisterFunction&&(this._localStreamDeregisterFunction(),this._localStreamDeregisterFunction=null);const a=e=>{const{enable:t,track:r}=e.detail;this._webcamPaused=!t,this._pauseResumeWebcam(),this._handleStopOrResumeVideo({enable:t,track:r})};t.addEventListener("stopresumevideo",a),this._localStreamDeregisterFunction=()=>{t.removeEventListener("stopresumevideo",a)}}else{const e=t.getVideoTracks()[0],r=t.getAudioTracks()[0];e&&this._sendScreenVideo(e),r&&this._sendScreenAudio(r),this._emitScreenshareStarted()}}_syncMicAnalyser(){if(!this._micTrack||!this._colocation||this._micAnalyser)return this._micAnalyser&&!this._colocation?(this._micAnalyser.close(),void(this._micAnalyser=null)):void 0;this._micAnalyser=function(e){let{micTrack:t,params:r,onScoreUpdated:n}=e;const i=new AudioContext;let a=null,s=null,o=null,c=!1;const d=async e=>{if(o&&c&&o.stop(),c=!1,e&&r.separateTrack)try{var t;e=(await navigator.mediaDevices.getUserMedia({audio:{deviceId:null===(t=o)||void 0===t?void 0:t.getSettings().deviceId,...r.separateTrack},video:!1})).getAudioTracks()[0],c=!0}catch(n){console.warn("unable to fetch new track for colocation speaker analysis, using current",n)}if(o=e,s&&(s.disconnect(),s=null),e){const t=new MediaStream([e]);s=i.createMediaStreamSource(t),s.connect(a)}};let l;const u=e=>{if(clearInterval(l),r={...Vd,...e},!a||a.fftSize!==2*r.bins){let e=null;a&&(e=o,d(null)),a=i.createAnalyser(),a.fftSize=2*r.bins,e&&d(e)}const t=new Uint8Array(a.frequencyBinCount),s=[];a.minDecibels=r.minDecibels,a.maxDecibels=r.maxDecibels,a.smoothingTimeConstant=r.smoothingTimeConstant;const c=r.initScript&&new Function("f","setTrack","lastTrack",r.initScript.join("\n")),u=r.scoreScript&&new Function("bins","g","f",r.scoreScript.join("\n")),p=r.scoreFormula&&new Function("bands","return ".concat(r.scoreFormula)),h=r.outFormula&&new Function("score","avg","max","scores","return ".concat(r.outFormula)),f=r.binFormula&&new Function("bin","index","return ".concat(r.binFormula));let m=0;const g=c&&c(Ud,d,o);l=setInterval((()=>{a.getByteFrequencyData(t);let e=0;if(p){const n=r.bands.map((e=>{const r=e.map((e=>f(t[e]/255,e)));return{avg:r.reduce(((e,t)=>e+t),0)/e.length,min:r.reduce(((e,t)=>Math.min(e,t/255)),Number.MAX_VALUE),max:r.reduce(((e,t)=>Math.max(e,t/255)),0)}}));e=p(n)||0}else u&&(e=u(t,g,Ud),isNaN(e)&&(e=0));if(s.push(e),s.length>r.aggSize&&s.shift(),m++,m>=r.reportRate){m=0;const r=s.reduce(((e,t)=>Math.max(e,t)),0),i=s.reduce(((e,t)=>e+t),0)/s.length,a=h(e,i,r,s);n({bins:t,score:e,max:r,avg:i,out:a})}}),1e3/r.sampleRate)};return u(r),d(t),{setParams:u,setTrack:d,close(){d(null),clearInterval(l),i.close()}}}({micTrack:this._micTrack,onScoreUpdated:this._onMicAnalyserScoreUpdated.bind(this)})}stopOrResumeAudio(e,t){this._logger.debug("stopOrResumeAudio() [enabled:%s]",t),this._micPaused=!t,this._pauseResumeMic()}_handleStopOrResumeVideo(e){let{enable:t,track:r}=e;t?this._sendWebcam(r):this._webcamProducer&&!this._webcamProducer.closed&&this._webcamProducer.track===r&&(this._stopProducer(this._webcamProducer),this._webcamProducer=null,this._webcamTrack=null)}stopOrResumeVideo(e,t){if(this._logger.debug("stopOrResumeVideo() [enable:%s]",t),this._webcamPaused=!t,this._pauseResumeWebcam(),["chrome","safari"].includes(qd))if(t){if(0===e.getVideoTracks().length){const r=this._webrtcProvider.getMediaConstraints().video;navigator.mediaDevices.getUserMedia({video:r}).then((r=>{const n=r.getVideoTracks()[0];e.addTrack(n),this._emitToPWA(Ac,{streamId:e.id,tracks:[n],screenShare:!1}),this._handleStopOrResumeVideo({enable:t,track:n})}))}}else clearTimeout(this._stopCameraTimeout),this._stopCameraTimeout=setTimeout((()=>{e.getVideoTracks().forEach((r=>{!1===r.enabled&&(r.stop(),e.removeTrack(r),this._emitToPWA(Nc,{stream:e,track:r}),this._handleStopOrResumeVideo({enable:t,track:r}))}))}),5e3)}supportsScreenShareAudio(){return!0}acceptNewStream(e){let{streamId:t,clientId:r}=e;this._logger.debug("acceptNewStream()",{streamId:t,clientId:r}),this.rtcStatsReconnect();const n=this._getOrCreateClientState(r);t!==r?(n.hasAcceptedScreenStream=!0,n.hasEmittedScreenStream=!1):(n.hasAcceptedWebcamStream=!0,n.hasEmittedWebcamStream=!1),this._syncIncomingStreamsWithPWA(r)}updateStreamResolution(e,t,r){var n;let{width:i,height:a}=r;this._logger.debug("updateStreamResolution()",{streamId:e,width:i,height:a});const s=this._streamIdToVideoConsumerId.get(e),o=this._consumers.get(s);if(!o)return;let c=0;this._consumers.forEach((e=>{var t,r;e._closed||e._paused||"webcam"!==(null===(t=e._appData)||void 0===t?void 0:t.source)&&"screenvideo"!==(null===(r=e._appData)||void 0===r?void 0:r.source)||c++}));let d=2;/T3/.test((null===(n=o._rtpParameters)||void 0===n||null===(n=n.encodings)||void 0===n||null===(n=n[0])||void 0===n?void 0:n.scalabilityMode)||"")&&(d=3);const l=Math.max(i,a);let u=l>=480?l>=960?2:1:0,p=d-1;var h;(l<100&&(p=Math.max(d-2,0)),c>8&&0===u&&(p=Math.max(d-2,0)),c<4&&l>300&&0===u&&(u=1),o.appData.spatialLayer!==u||o.appData.temporalLayer!==p)&&(o.appData.spatialLayer=u,o.appData.temporalLayer=p,null===(h=this._vegaConnection)||void 0===h||h.message("setConsumersPreferredLayers",{consumerIds:[s],spatialLayer:u,temporalLayer:p}))}disconnectAll(){var e,t,r,n;this._reconnect=!1,this._reconnectTimeOut&&(clearTimeout(this._reconnectTimeOut),this._reconnectTimeOut=null),this._socketListenerDeregisterFunctions.forEach((e=>{e()})),this._localStreamDeregisterFunction&&(this._localStreamDeregisterFunction(),this._localStreamDeregisterFunction=null),this._socketListenerDeregisterFunctions=[],null===(e=this._vegaConnection)||void 0===e||e.removeAllListeners(),null===(t=this._vegaConnection)||void 0===t||t.close(),null===(r=this._sendTransport)||void 0===r||r.close(),null===(n=this._receiveTransport)||void 0===n||n.close(),this._micTrack=null,this._webcamTrack=null,this._screenVideoTrack=null,this._screenAudioTrack=null,this._streamIdToVideoConsumerId.clear(),this._mediasoupDevice=null}sendAudioMutedStats(e){vd.sendEvent("audio_muted",{muted:e})}sendVideoMutedStats(e){vd.sendEvent("video_muted",{muted:e})}sendStatsCustomEvent(e,t){vd.sendEvent(e,t)}rtcStatsDisconnect(){vd.server.close()}rtcStatsReconnect(){vd.server.connected||vd.server.connect()}_startMonitoringAudioTrack(e){e.addEventListener("ended",this._audioTrackOnEnded)}_stopMonitoringAudioTrack(e){e.removeEventListener("ended",this._audioTrackOnEnded)}async _onMessage(e){const{method:t,data:r}=e;return Promise.resolve().then((()=>{switch(t){case"consumerReady":return this._onConsumerReady(r);case"consumerClosed":return this._onConsumerClosed(r);case"consumerPaused":return this._onConsumerPaused(r);case"consumerResumed":return this._onConsumerResumed(r);case"dataConsumerReady":return this._onDataConsumerReady(r);case"dataConsumerClosed":return this._onDataConsumerClosed(r);case"dominantSpeaker":return this._onDominantSpeaker(r);default:return void this._logger.debug('unknown message method "'.concat(t,'"'))}})).catch((e=>{console.error('"message" failed [error:%o]',e)}))}async _onConsumerReady(e){this._logger.debug("_onConsumerReady()",{id:e.id,producerId:e.producerId});const t=await this._receiveTransport.consume(e);if(t.pause(),t.appData.localPaused=!0,t.appData.spatialLayer=2,this._consumers.set(t.id,t),t.observer.once("close",(()=>{this._consumers.delete(t.id),this._consumerClosedCleanup(t)})),this._features.increaseIncomingMediaBufferOn&&t.rtpReceiver)try{t.rtpReceiver.jitterBufferTarget=ld,t.rtpReceiver.playoutDelayHint=.4}catch(o){this._logger.error("Error during setting jitter buffer target:",o)}const{sourceClientId:r,screenShare:n,streamId:i}=t.appData,a=this._getOrCreateClientState(r);n?(a.hasEmittedScreenStream=!1,a.screenShareStreamId=i):(a.hasEmittedWebcamStream=!1,a.camStreamId=i);let s=n?a.screenStream:a.webcamStream;s&&s.inboundId===i||(s=new MediaStream,s.inboundId=i,n?a.screenStream=s:a.webcamStream=s),"video"===t.kind&&this._streamIdToVideoConsumerId.set(s.id,t.id),s.addTrack(t.track),this._syncIncomingStreamsWithPWA(r)}async _onConsumerClosed(e){var t;let{consumerId:r,reason:n}=e;this._logger.debug("_onConsumerClosed()",{consumerId:r,reason:n}),null===(t=this._consumers.get(r))||void 0===t||t.close()}_onConsumerPaused(e){let{consumerId:t}=e;this._logger.debug("_onConsumerPaused()",{consumerId:t});const r=this._consumers.get(t);r&&(r.appData.remotePaused=!0,r.pause())}_onConsumerResumed(e){let{consumerId:t}=e;this._logger.debug("_onConsumerResumed()",{consumerId:t});const r=this._consumers.get(t);r&&(r.appData.remotePaused=!1,r.appData.localPaused||r.resume())}async _onDataConsumerReady(e){this._logger.debug("_onDataConsumerReady()",{id:e.id,producerId:e.producerId});const t=await this._receiveTransport.consumeData(e);this._dataConsumers.set(t.id,t),t.once("close",(()=>{this._dataConsumers.delete(t.id)}));const{clientId:r}=t.appData;t.on("message",(e=>{if(!this._micAnalyserDebugger)return;if("string"!==typeof e)return;const{score:r}=JSON.parse(e);var n;r&&(null===(n=this._micAnalyserDebugger)||void 0===n||n.onConsumerScore(t.appData.clientId,r))})),this._syncIncomingStreamsWithPWA(r)}async _onDataConsumerClosed(e){let{dataConsumerId:t,reason:r}=e;this._logger.debug("_onDataConsumerClosed()",{dataConsumerId:t,reason:r});const n=this._dataConsumers.get(t);null===n||void 0===n||n.close()}_onDominantSpeaker(e){let{consumerId:t}=e;const r=this._consumers.get(t);if(!r)return;const{sourceClientId:n}=r.appData;this._emitToPWA(id,{clientId:n})}_consumerClosedCleanup(e){const{sourceClientId:t,screenShare:r}=e.appData,n=this._getOrCreateClientState(t),i=r?n.screenStream:n.webcamStream;i&&(i.removeTrack(e.track),0===i.getTracks().length&&(this._streamIdToVideoConsumerId.delete(i.id),r?(n.screenStream=null,n.hasEmittedScreenStream=!1,n.screenShareStreamId=null):(n.hasEmittedWebcamStream=!1,n.camStreamId=null)))}_syncIncomingStreamsWithPWA(e){const t=this._getOrCreateClientState(e),{webcamStream:r,screenStream:n,hasEmittedWebcamStream:i,hasEmittedScreenStream:a,hasAcceptedWebcamStream:s,hasAcceptedScreenStream:o,screenShareStreamId:c,camStreamId:d}=t,l=[],u=[];var p,h;(this._consumers.forEach((t=>{if(t.appData.sourceClientId!==e)return;const r=t.appData.screenShare?o:s;!t.appData.localPaused!==r&&(r?(t.appData.remotePaused||t.resume(),t.appData.localPaused=!1,u.push(t.id)):(t.pause(),t.appData.localPaused=!0,l.push(t.id)))})),l.length>0)&&(null===(p=this._vegaConnection)||void 0===p||p.message("pauseConsumers",{consumerIds:l}));u.length>0&&(null===(h=this._vegaConnection)||void 0===h||h.message("resumeConsumers",{consumerIds:u}));r&&!i&&s&&(this._emitToPWA(Mc,{clientId:e,stream:r,streamId:d,streamType:"webcam"}),t.hasEmittedWebcamStream=!0),n&&!a&&o&&(this._emitToPWA(Mc,{clientId:e,stream:n,streamId:c,streamType:"screenshare"}),t.hasEmittedScreenStream=!0)}_getOrCreateClientState(e){let t=this._clientStates.get(e);return t||(t={hasAcceptedWebcamStream:!1,hasAcceptedScreenStream:!1,hasEmittedWebcamStream:!1,hasEmittedScreenStream:!1,webcamStream:null,screenStream:null,screenShareStreamId:null,camStreamId:null},this._clientStates.set(e,t)),t}_emitToPWA(e,t){this._emitter.emit(e,t)}_emitToSignal(e,t,r){this._serverSocket.emit(e,t,r)}shouldAcceptStreamsFromBothSides(){return!0}setMicAnalyserDebugger(e){this._micAnalyserDebugger=e}setMicAnalyserParams(e){var t;null===(t=this._micAnalyser)||void 0===t||t.setParams(e)}}class Jd{constructor(e){let{emitter:t,serverSocket:r,webrtcProvider:n,features:i}=e;this.emitter=t,this.currentManager=null,r.on(Gc,(e=>{let{room:a,selfId:s,error:o,eventClaim:c}=e;if(o)return;const d={selfId:s,room:a,emitter:t,serverSocket:r,webrtcProvider:n,features:i,eventClaim:c},l=!!a.sfuServer;if(this.currentManager){if(this.currentManager.isInitializedWith({selfId:s,roomName:a.name,isSfu:l}))return void(this.currentManager.setEventClaim&&c&&this.currentManager.setEventClaim(c));this.currentManager.disconnectAll(),t.emit(jc)}let u=null;u=l?new Kd(d):new Dd(d),u.setupSocketListeners(),t.emit(Lc,{rtcManager:u}),this.currentManager=u}))}stopRtcManager(){this.currentManager&&(this.currentManager.disconnectAll(),this.emitter.emit(jc))}}const $d=e=>({emit:(t,r)=>{"rtc_manager_created"===t?e(dl(r)):"stream_added"===t?e(fc.streamAdded(r)):"rtc_manager_destroyed"===t&&e(rl())}}),Qd={dispatcherCreated:!1,error:null,isCreatingDispatcher:!1,reportedStreamResolutions:{},rtcManager:null,rtcManagerDispatcher:null,rtcManagerInitialized:!1,status:"",isAcceptingStreams:!1},Xd=Xe({name:"rtcConnection",initialState:Qd,reducers:{isAcceptingStreams:(e,t)=>Object.assign(Object.assign({},e),{isAcceptingStreams:t.payload}),resolutionReported:(e,t)=>{const{streamId:r,width:n,height:i}=t.payload;return Object.assign(Object.assign({},e),{reportedStreamResolutions:Object.assign(Object.assign({},e.reportedStreamResolutions),{[r]:{width:n,height:i}})})},rtcDisconnected:()=>Object.assign({},Qd),rtcDispatcherCreated:(e,t)=>Object.assign(Object.assign({},e),{dispatcherCreated:!0,rtcManagerDispatcher:t.payload}),rtcManagerCreated:(e,t)=>Object.assign(Object.assign({},e),{rtcManager:t.payload,status:"ready"}),rtcManagerDestroyed:e=>Object.assign(Object.assign({},e),{rtcManager:null}),rtcManagerInitialized:e=>Object.assign(Object.assign({},e),{rtcManagerInitialized:!0})},extraReducers:e=>{e.addCase(Ws,(e=>Object.assign(Object.assign({},e),{status:"reconnect"}))),e.addCase(Ds.roomJoined,(e=>Object.assign(Object.assign({},e),{status:"reconnect"===e.status?"ready":e.status})))}}),{resolutionReported:Yd,rtcDispatcherCreated:Zd,rtcDisconnected:el,rtcManagerCreated:tl,rtcManagerDestroyed:rl,rtcManagerInitialized:nl,isAcceptingStreams:il}=Xd.actions,al=()=>(e,t)=>{const r=t(),n=Hs(r).socket,i=ul(r).rtcManagerDispatcher,a=Fo(r),s=zo(r);if(i)return;const o={getMediaConstraints:()=>({audio:s,video:a}),deferrable:e=>!e},c=new Jd({emitter:$d(e),serverSocket:n,logger:console,webrtcProvider:o,features:{lowDataModeEnabled:!1,sfuServerOverrideHost:void 0,turnServerOverrideHost:void 0,useOnlyTURN:void 0,vp9On:!1,h264On:!1,simulcastScreenshareOn:!1}});e(Zd(c))},sl=()=>(e,t)=>{const{rtcManager:r}=ul(t());r&&r.disconnectAll(),e(el())},ol=e=>(t,r)=>{var n;t(il(!0));const i=r(),a=ul(i).rtcManager,s=Rc(i);if(!a)throw new Error("No rtc manager");const o=null===(n=a.shouldAcceptStreamsFromBothSides)||void 0===n?void 0:n.call(a),c=[];for(const{clientId:d,streamId:l,state:u}of e){if(s.find((e=>e.id===d))){if("to_accept"===u||"new_accept"===u&&o||"old_accept"===u&&!o)a.acceptNewStream({streamId:"0"===l?d:l,clientId:d,shouldAddLocalVideo:"0"===l,activeBreakout:false});else if("new_accept"===u||"old_accept"===u);else if("to_unaccept"===u)null===a||void 0===a||a.disconnect("0"===l?d:l,false);else if("done_accept"!==u)continue;c.push({clientId:d,streamId:l,state:u.replace(/to_|new_|old_/,"done_")})}}t(kc(c)),t(il(!1))},cl=e=>{let{streamId:t,width:r,height:n}=e;return(e,i)=>{const{reportedStreamResolutions:a,rtcManager:s}=ul(i()),o=Ho(i());if(!s||(null===o||void 0===o?void 0:o.id)===t)return;const c=a[t];c&&c.width===r&&c.height===n||s.updateStreamResolution(t,null,{width:r||1,height:n||1}),e(Yd({streamId:t,width:r,height:n}))}},dl=e=>t=>{const{rtcManager:r}=e;t(tl(r))},ll=()=>(e,t)=>{const r=Ho(t()),n=ul(t()).rtcManager,i=Fo(t()),a=zo(t());r&&n&&n.addNewStream("0",r,!a,!i),e(nl())},ul=e=>e.rtcConnection,pl=e=>e.rtcConnection.rtcManagerInitialized,hl=e=>e.rtcConnection.status;ms({actionCreator:Oo.fulfilled,effect:(e,t)=>{let{payload:r}=e,{getState:n}=t;const{replacedTracks:i}=r,{rtcManager:a}=ul(n()),s=Ho(n());null===i||void 0===i||i.forEach((e=>{((e,t)=>{const r=null===s||void 0===s?void 0:s.getTracks().find((t=>t.kind===e));r&&(null===a||void 0===a||a.replaceTrack(t,r))})(e.kind,e)}))}}),ms({actionCreator:oc.fulfilled,effect:(e,t)=>{let{payload:r}=e,{getState:n}=t;const{stream:i}=r,{rtcManager:a}=ul(n());null===a||void 0===a||a.addNewStream(i.id,i,!1,!0)}}),ms({actionCreator:sc,effect:(e,t)=>{let{payload:r}=e,{getState:n}=t;const{stream:i}=r,{rtcManager:a}=ul(n());null===a||void 0===a||a.removeStream(i.id,i,null)}});gs([pe((e=>e.rtcConnection.dispatcherCreated),(e=>e.rtcConnection.isCreatingDispatcher),Js,((e,t,r)=>!(e||t||!r)))],((e,t)=>{let{dispatch:r}=e;t&&r(al())}));const fl=pe((e=>e.rtcConnection.rtcManager),pl,Wo,((e,t,r)=>!("started"!==r||!e||t)));gs([fl],((e,t)=>{let{dispatch:r}=e;t&&r(ll())}));gs([pe(hl,ws,((e,t)=>!t&&!["","disconnected"].includes(e)))],((e,t)=>{let{dispatch:r}=e;t&&r(sl())}));const ml=pe(hl,Rc,((e,t)=>{if("ready"!==e)return[];const r=[];for(const n of t){const{streams:e,id:t,newJoiner:i}=n;for(let n=0;n<e.length;n++){const a=e[n].id;"done_accept"!==e[n].state&&r.push({clientId:t,streamId:a,state:"".concat(i&&"0"===a?"new":"to","_accept")})}}return r}));gs([ml,e=>e.rtcConnection.isAcceptingStreams],((e,t,r)=>{let{dispatch:n}=e;0<t.length&&!r&&n(ol(t))}));const gl={audioEnabled:{action:Zo.fulfilled,rtcEventName:"audioEnabled",getValue:e=>zo(e),getOutput:e=>({enabled:e})},videoEnabled:{action:ec.fulfilled,rtcEventName:"videoEnabled",getValue:e=>Fo(e),getOutput:e=>({enabled:e})},localStream:{action:Oo.fulfilled,rtcEventName:"localStream",getValue:e=>{var t;return null===(t=Ho(e))||void 0===t?void 0:t.getTracks().map((e=>({id:e.id,kind:e.kind,label:e.label})))},getOutput:e=>({stream:e})},localScreenshareStream:{action:oc.fulfilled,rtcEventName:"localScreenshareStream",getValue:e=>{var t;return null===(t=dc(e))||void 0===t?void 0:t.getTracks().map((e=>({id:e.id,kind:e.kind,label:e.label})))},getOutput:e=>({tracks:e})},localScreenshareStreamStopped:{action:sc,rtcEventName:"localScreenshareStream",getValue:()=>()=>null,getOutput:()=>({})},displayName:{action:tc.fulfilled,rtcEventName:"displayName",getValue:e=>ks(e),getOutput:e=>({displayName:e})},clientId:{action:null,rtcEventName:"clientId",getValue:e=>ic(e),getOutput:e=>({clientId:e})},deviceId:{action:null,rtcEventName:"deviceId",getValue:e=>(e=>{var t,r;return null===(r=null===(t=e.deviceCredentials.data)||void 0===t?void 0:t.credentials)||void 0===r?void 0:r.uuid})(e),getOutput:e=>({deviceId:e})},externalId:{action:null,rtcEventName:"externalId",getValue:e=>Ts(e),getOutput:e=>({externalId:e})},organizationId:{action:null,rtcEventName:"organizationId",getValue:e=>pc(e),getOutput:e=>({organizationId:e})},signalConnectionStatus:{action:null,rtcEventName:"signalConnectionStatus",getValue:e=>Ks(e),getOutput:e=>({status:e})},roomSessionId:{action:null,rtcEventName:"roomSessionId",getValue:e=>(e=>{var t;return null===(t=e.roomConnection.session)||void 0===t?void 0:t.id})(e),getOutput:e=>({roomSessionId:e})},rtcConnectionStatus:{action:null,rtcEventName:"rtcConnectionStatus",getValue:e=>hl(e),getOutput:e=>({status:e})},userRole:{action:null,rtcEventName:"userRole",getValue:e=>(e=>e.localParticipant.roleName)(e),getOutput:e=>({userRole:e})}},vl=Object.values(gl).map((e=>{let{action:t}=e;return t})).filter((e=>null!==e)),yl=e=>"object"===typeof e?JSON.stringify(e):e,bl=Xe({initialState:{reportedValues:{}},name:"rtcAnalytics",reducers:{updateReportedValues:(e,t)=>Object.assign(Object.assign({},e),{reportedValues:Object.assign(Object.assign({},e.reportedValues),{[t.payload.rtcEventName]:t.payload.value})})}}),_l=()=>(e,t)=>{const r=t(),n=ul(r).rtcManager;n&&(n.sendStatsCustomEvent("insightsStats",{_time:Date.now(),ls:0,lr:0,bs:0,br:0,cpu:0}),Object.values(gl).forEach((t=>{let{rtcEventName:i,getValue:a,getOutput:s}=t;var o;const c=a(r),d=Object.assign(Object.assign({},s(c)),{_time:Date.now()}),l=yl(c);(null===(o=r.rtcAnalytics.reportedValues)||void 0===o?void 0:o[i])!==l&&(n.sendStatsCustomEvent(i,d),e(wl({rtcEventName:i,value:c})))})))},{updateReportedValues:wl}=bl.actions;ms({matcher:Ue(...vl),effect:(e,t)=>{let{type:r}=e,{getState:n,dispatch:i}=t;var a;const s=n(),o=ul(s).rtcManager;if(!o)return;const c=Object.values(gl).find((e=>{let{action:t}=e;return(null===t||void 0===t?void 0:t.type)===r}));if(!c)return;const{getValue:d,getOutput:l,rtcEventName:u}=c,p=d(s),h=yl(p),f=Object.assign(Object.assign({},l(p)),{_time:Date.now()});(null===(a=s.rtcAnalytics.reportedValues)||void 0===a?void 0:a[u])!==h&&(o.sendStatsCustomEvent(u,f),i(wl({rtcEventName:u,value:p})))}}),gs([pl],((e,t)=>{let{dispatch:r}=e;t&&r(_l())}));const Sl=Xe({name:"streaming",initialState:{isStreaming:!1,error:null,startedAt:void 0},reducers:{doHandleStreamingStarted:e=>Object.assign(Object.assign({},e),{isStreaming:!0,error:null,startedAt:(new Date).getTime()}),doHandleStreamingStopped:e=>Object.assign(Object.assign({},e),{isStreaming:!1})}});Sl.actions;const Cl=Xe({name:"waitingParticipants",initialState:{waitingParticipants:[]},reducers:{},extraReducers:e=>{e.addCase(Ds.roomJoined,((e,t)=>{let{payload:r}=t;var n;return(null===(n=r.room)||void 0===n?void 0:n.knockers.length)?Object.assign(Object.assign({},e),{waitingParticipants:r.room.knockers.map((e=>({id:e.clientId,displayName:e.displayName})))}):e})),e.addCase(Ds.roomKnocked,((e,t)=>{const{clientId:r,displayName:n}=t.payload;return Object.assign(Object.assign({},e),{waitingParticipants:[...e.waitingParticipants,{id:r,displayName:n}]})})),e.addCase(Ds.knockerLeft,((e,t)=>{const{clientId:r}=t.payload;return Object.assign(Object.assign({},e),{waitingParticipants:e.waitingParticipants.filter((e=>e.id!==r))})}))}}),kl=e=>(t,r)=>{const{participantId:n}=e,i=r(),a=Js(i);null===a||void 0===a||a.emit("handle_knock",{action:"accept",clientId:n,response:{}})},Rl=e=>(t,r)=>{const{participantId:n}=e,i=r(),a=Js(i);null===a||void 0===a||a.emit("handle_knock",{action:"reject",clientId:n,response:{}})};var Tl;const Pl=null!==(Tl="true"==={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_IS_DEV)&&void 0!==Tl&&Tl,El=_e({app:vs.reducer,chat:Qs.reducer,cloudRecording:Ys.reducer,deviceCredentials:Os.reducer,localMedia:yo.reducer,localParticipant:rc.reducer,localScreenshare:ac.reducer,organization:lc.reducer,remoteParticipants:wc.reducer,roomConnection:Pc.reducer,rtcAnalytics:bl.reducer,rtcConnection:Xd.reducer,signalConnection:Ls.reducer,streaming:Sl.reducer,waitingParticipants:Cl.reducer}),Dl=e=>{let{preloadedState:t,injectServices:r}=e;return Ne({devTools:Pl,reducer:El,middleware:e=>e({thunk:{extraArgument:{services:r}},serializableCheck:!1}).prepend(fs.middleware),preloadedState:t})},Ol=(e,t,r)=>{let n;function i(){const i=t(e.getState());i!==n&&(n=i,r(n))}const a=e.subscribe(i);return i(),a},xl=[{pattern:/^(?:([^.]+)[.])?(server:?\d*)/,separator:"."},{pattern:/^(?:([^.]+)[.])?(localhost:?\d*)/,separator:"."},{pattern:/^(?:([^.]+)[.])?((\d+[.]){3}:?\d*)$/,separator:"."},{pattern:/^(?:([^.]+)-)?(ip-[^.]*[.](?:hereby[.]dev|rfc1918[.]disappear[.]at)(?::\d+|))$/,separator:"-"},{pattern:/^(?:([^.]+)[.])?((:?[^.]+[.]){1,}[^.]+)$/,separator:"."}];function Il(){let{host:e="whereby.com",protocol:t="https:"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r="",n=e,i=".";for(const{separator:s,pattern:o}of xl){const t=o.exec(e);if(t){r=t[1]||"",n=t[2],i=s;break}}const a=r?"".concat(r).concat(i).concat(n):n;return{domain:n,domainWithSeparator:"".concat(i).concat(n),organizationDomain:a,organization:"".concat(t,"//").concat(a),service:"".concat(t,"//").concat(n),subdomain:r}}Il(window&&window.location);class Ml{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.data=void 0===e.data?{}:e.data,this.headers=e.headers||{},this.status=e.status||200,this.statusText=e.statusText||"OK",this.url=e.url||null}}function Ll(e,t){return uo.ok(e,"".concat(t," is required")),e}function jl(e,t){return uo.ok("boolean"===typeof e,"".concat(t,"<boolean> is required")),e}function Al(e,t){return uo.ok("number"===typeof e,"".concat(t,"<number> is required")),e}function Nl(e,t){return uo.ok("string"===typeof e,"".concat(t,"<string> is required")),e}function Fl(e,t,r){const n=r||t.name[0].toLowerCase()+t.name.substring(1);return uo.ok(e instanceof t,"".concat(n,"<").concat(t.name,"> is required")),e}function zl(e,t){return uo.ok(Array.isArray(e),"".concat(t,"<array> is required")),e}function Bl(e,t){if(null===e||void 0===e||"object"!==typeof e||Array.isArray(e))throw new Error("".concat(t," must be a record. ").concat(JSON.stringify(e)));return e}function Ul(e,t,r){Nl(t,"name"),function(e,t,r,n){Nl(r,"name");const i=n||"".concat(r," must be null or of type ").concat(t);uo.ok(null===e||typeof e===t,i)}(e,"string",t,r)}function Vl(e){let{baseUrl:t,url:r}=e;return t?t+r:r}class ql{constructor(e){let{baseUrl:t}=e;Nl(t,"baseUrl"),this._baseUrl=t}_requestAxios(e,t){const r=Object.assign({},t,{url:e,baseURL:this._baseUrl});return ds.request(r)}request(e,t){return Nl(e,"url"),uo.ok("/"===e[0],'url<String> only accepts relative URLs beginning with "/".'),uo.ok(t,"options are required"),this._requestAxios(e,t).then((e=>{const{data:t,headers:r,status:n,statusText:i,config:a}=e,s=a&&a.url?Vl({baseUrl:a.baseURL,url:a.url}):null;return new Ml({data:t,headers:r,status:n,statusText:i,url:s})})).catch((e=>{const t=e.response;if(!t)throw new Error("Could not make the request.");const{data:r,headers:n,status:i,statusText:a,config:s}=t,o=s&&s.url?Vl({baseUrl:s.baseURL,url:s.url}):null;return Promise.reject(new Ml({data:r,headers:n,status:i,statusText:a,url:o}))}))}}class Wl{constructor(e){let{httpClient:t}=e;uo.ok(t,"httpClient is required"),this._httpClient=t}static dataToFormData(e){uo.ok(e,"data is required");const t=new FormData;return Object.keys(e).forEach((r=>{const n=e[r];t.append(r,n)})),t}request(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=Object.assign(t.headers||{},{"Content-Type":void 0});return this._httpClient.request(e,Object.assign(t,{headers:r,transformRequest:Wl.dataToFormData}))}}let Hl;Hl="object"===typeof window?window.btoa||bi():"object"===typeof r.g&&r.g.btoa||bi();const Gl=()=>Promise.resolve(null);class Kl{constructor(e){let{httpClient:t,fetchDeviceCredentials:r}=e;this._httpClient=t,this._fetchDeviceCredentials=r}request(e,t){return this._fetchDeviceCredentials().then((r=>{const n=Object.assign({},t.headers,function(e){if(e&&e.credentials){const t="".concat(e.credentials.uuid,":").concat(e.hmac);return{Authorization:"Basic ".concat(Hl(t))}}return{}}(r),{"X-Appearin-Device-Platform":"web"}),i=Object.assign({},t,{headers:n});return this._httpClient.request(e,i)}))}}class Jl{constructor(){let{baseUrl:e="https://api.appearin.net",fetchDeviceCredentials:t=Gl}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.authenticatedHttpClient=new Kl({httpClient:new ql({baseUrl:e}),fetchDeviceCredentials:t}),this.authenticatedFormDataHttpClient=new Wl({httpClient:this.authenticatedHttpClient})}request(e,t){return Nl(e,"url"),uo.ok("/"===e[0],'url<String> only accepts relative URLs beginning with "/".'),uo.ok(t,"options are required"),this.authenticatedHttpClient.request(e,t)}requestMultipart(e,t){return Nl(e,"url"),uo.ok("/"===e[0],'url<String> only accepts relative URLs beginning with "/".'),uo.ok(t,"options are required"),this.authenticatedFormDataHttpClient.request(e,t)}}function $l(e,t){return Nl(Bl(e,"data")[t],t)}const Ql=(Xl=$l,(e,t)=>{const r=Bl(e,"data")[t];return null===r||void 0===r?null:Xl(e,t)});var Xl;function Yl(e,t,r){return function(e,t){return zl(Bl(e,"data")[t],t)}(e,t).map((e=>r(e)))}class Zl{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;this.credentials={uuid:e},this.hmac=t,this.userId=r}toJson(){return Object.assign({credentials:this.credentials,hmac:this.hmac},this.userId&&{userId:this.userId})}static fromJson(e){return new Zl($l(function(e,t){const r=Bl(e,"data")[t];return void 0===r?null:r}(e,"credentials"),"uuid"),$l(e,"hmac"),Ql(e,"userId")||void 0)}}class eu{constructor(e){let{apiClient:t}=e;this._apiClient=t}getCredentials(){return this._apiClient.request("/devices",{method:"post"}).then((e=>{let{data:t}=e;return Zl.fromJson(t)})).catch((e=>{if(e.response&&404===e.response.status)return null;throw e}))}}class tu{constructor(e,t){this._key=e,this._chromeStorage=t}loadOrDefault(e){return new Promise((t=>{this._chromeStorage.get(this._key,(r=>{t(r[this._key]||e)}))}))}save(e){return new Promise((t=>{this._chromeStorage.set({[this._key]:e},(()=>{t()}))}))}}class ru{constructor(e,t){Ll(t,"localStorage"),this._key=Nl(e,"key"),this._localStorage=t}loadOrDefault(e){try{const r=this._localStorage.getItem(this._key);if(r)try{return Promise.resolve(JSON.parse(r))}catch(t){}return Promise.resolve(e)}catch(t){return console.warn("Error getting access to storage. Are cookies blocked?",t),Promise.resolve(e)}}save(e){try{return this._localStorage.setItem(this._key,JSON.stringify(e)),Promise.resolve()}catch(t){return console.warn("Error getting access to storage. Are cookies blocked?",t),Promise.reject(t)}}}let nu;try{nu=self.localStorage}catch(Iu){nu={getItem:()=>{},key:()=>{},setItem:()=>{},removeItem:()=>{},hasOwnProperty:()=>{},length:0}}var iu=nu;const au="credentials_saved";class su extends(vi()){constructor(e){let{deviceService:t,credentialsStore:r}=e;super(),this._deviceService=t,this._credentialsStore=r}static create(e){let{baseUrl:t,storeName:r="CredentialsStorage",storeType:n="localStorage"}=e;const i=new eu({apiClient:new Jl({baseUrl:t})});let a=null;if("localStorage"===n)a=new ru(r,iu);else{if("chromeStorage"!==n)throw new Error("Unknown store type: ".concat(n));a=new tu(r,window.chrome.storage.local)}return new su({deviceService:i,credentialsStore:a})}_fetchNewCredentialsFromApi(){const e=this._credentialsStore;return new Promise((t=>{const r=()=>{this._deviceService.getCredentials().then((r=>e.save(r?r.toJson():null).then((()=>t(r))))).catch((()=>{setTimeout(r,2e3)}))};r()}))}getCurrentCredentials(){return this._credentialsStore.loadOrDefault(null).then((e=>e?Zl.fromJson(e):null))}getCredentials(){return this.credentialsPromise||(this.credentialsPromise=this.getCurrentCredentials().then((e=>e||this._fetchNewCredentialsFromApi()))),this.credentialsPromise}saveCredentials(e){return this.credentialsPromise=void 0,this._credentialsStore.save(e.toJson()).then((()=>(this.emit(au,e),e)))}setUserId(e){return this.getCurrentCredentials().then((t=>{t||console.error("Illegal state: no credentials to set user id for.");if(null===t||t.userId!==e)return this._credentialsStore.save(Object.assign({},null===t||void 0===t?void 0:t.toJson(),{userId:e}))})).then((()=>{}))}}class ou{constructor(e){let{isExhausted:t,renewsAt:r,totalMinutesLimit:n,totalMinutesUsed:i}=e;this.isExhausted=t,this.renewsAt=r,this.totalMinutesLimit=n,this.totalMinutesUsed=i}static fromJson(e){return new ou({isExhausted:jl(e.isExhausted,"isExhausted"),renewsAt:new Date(Nl(e.renewsAt,"renewsAt")),totalMinutesLimit:Al(e.totalMinutesLimit,"totalMinutesLimit"),totalMinutesUsed:Al(e.totalMinutesUsed,"totalMinutesUsed")})}}class cu{constructor(e){let{basePlanId:t,embeddedFreeTierStatus:r,isDeactivated:n,isOnTrial:i,onTrialUntil:a,trialStatus:s}=e;this.basePlanId=t,this.isDeactivated=n,this.isOnTrial=i,this.onTrialUntil=a||null,this.trialStatus=s||null,this.embeddedFreeTierStatus=r||null}static fromJson(e){return new cu({basePlanId:"string"===typeof e.basePlanId?e.basePlanId:null,isDeactivated:jl(e.isDeactivated,"isDeactivated"),isOnTrial:jl(e.isOnTrial,"isOnTrial"),onTrialUntil:"string"===typeof e.onTrialUntil?new Date(e.onTrialUntil):null,trialStatus:"string"===typeof e.trialStatus?e.trialStatus:null,embeddedFreeTierStatus:e.embeddedFreeTierStatus?ou.fromJson(e.embeddedFreeTierStatus):null})}}function du(e){return null!==e&&void 0!==e}function lu(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{maxNumberOfInvitationsAndUsers:du(null===e||void 0===e?void 0:e.maxNumberOfInvitationsAndUsers)?Number(null===e||void 0===e?void 0:e.maxNumberOfInvitationsAndUsers):null,maxNumberOfClaimedRooms:du(null===e||void 0===e?void 0:e.maxNumberOfClaimedRooms)?Number(null===e||void 0===e?void 0:e.maxNumberOfClaimedRooms):null,maxRoomLimitPerOrganization:du(null===e||void 0===e?void 0:e.maxRoomLimitPerOrganization)?Number(null===e||void 0===e?void 0:e.maxRoomLimitPerOrganization):null,trialMinutesLimit:du(null===e||void 0===e?void 0:e.trialMinutesLimit)?Number(null===e||void 0===e?void 0:e.trialMinutesLimit):null,includedUnits:du(null===e||void 0===e?void 0:e.includedUnits)?Number(null===e||void 0===e?void 0:e.includedUnits):null}}class uu{constructor(e){this.logoImageUrl=null,this.roomBackgroundImageUrl=null,this.roomBackgroundThumbnailUrl=null,this.roomKnockPageBackgroundImageUrl=null,this.roomKnockPageBackgroundThumbnailUrl=null,this.preferences=null,this.onboardingSurvey=null,this.type=null,Fl(e,Object,"properties"),Nl(e.organizationId,"organizationId"),Nl(e.organizationName,"organizationName"),Nl(e.subdomain,"subdomain"),Fl(e.permissions,Object,"permissions"),Fl(e.limits,Object,"limits"),this.organizationId=e.organizationId,this.organizationName=e.organizationName,this.subdomain=e.subdomain,this.permissions=e.permissions,this.limits=e.limits,this.account=e.account?new cu(e.account):null,this.logoImageUrl=e.logoImageUrl,this.roomBackgroundImageUrl=e.roomBackgroundImageUrl,this.roomBackgroundThumbnailUrl=e.roomBackgroundThumbnailUrl,this.roomKnockPageBackgroundImageUrl=e.roomKnockPageBackgroundImageUrl,this.roomKnockPageBackgroundThumbnailUrl=e.roomKnockPageBackgroundThumbnailUrl,this.preferences=e.preferences,this.onboardingSurvey=e.onboardingSurvey,this.type=e.type}static fromJson(e){const t=Fl(e,Object,"data"),r=(null===t||void 0===t?void 0:t.preferences)||{},n=(null===t||void 0===t?void 0:t.onboardingSurvey)||null,i=Fl(t.permissions,Object,"permissions");return new uu({organizationId:Nl(t.organizationId,"organizationId"),organizationName:Nl(t.organizationName,"organizationName"),subdomain:Nl(t.subdomain,"subdomain"),permissions:i,limits:lu(Fl(t.limits,Object,"limits")),account:t.account?cu.fromJson(t.account):null,logoImageUrl:"string"===typeof t.logoImageUrl?t.logoImageUrl:null,roomBackgroundImageUrl:"string"===typeof t.roomBackgroundImageUrl?t.roomBackgroundImageUrl:null,roomBackgroundThumbnailUrl:"string"===typeof t.roomBackgroundThumbnailUrl?t.roomBackgroundThumbnailUrl:null,roomKnockPageBackgroundImageUrl:"string"===typeof t.roomKnockPageBackgroundImageUrl?t.roomKnockPageBackgroundImageUrl:null,roomKnockPageBackgroundThumbnailUrl:"string"===typeof t.roomKnockPageBackgroundThumbnailUrl?t.roomKnockPageBackgroundThumbnailUrl:null,preferences:r,onboardingSurvey:n,type:"string"===typeof t.type?t.type:null})}}uu.GLOBAL_ORGANIZATION_ID="1";class pu{constructor(e){let{apiClient:t}=e;this._apiClient=t}createOrganization(e){let{organizationName:t,subdomain:r,owner:n}=e;const{displayName:i,consents:a}=n||{},s="email"in n?{value:n.email,verificationCode:Nl(n.verificationCode,"owner.verificationCode")}:null,o="idToken"in n?n.idToken:null;if(Nl(r,"subdomain"),Nl(t,"organizationName"),Nl(i,"owner.displayName"),uo.ok(s||o,"owner.email or owner.idToken is required"),a){zl(a,"consents");for(const{consentRevisionId:e,action:t}of a)Nl(e,"consentRevisionId"),Ul(t,"action")}return this._apiClient.request("/organizations",{method:"POST",data:{organizationName:t,type:"private",subdomain:r,owner:Object.assign(Object.assign(Object.assign(Object.assign({},s&&{email:s}),o&&{idToken:o}),a&&{consents:a}),{displayName:i})}}).then((e=>{let{data:t}=e;return $l(t,"organizationId")}))}getOrganizationBySubdomain(e){return Nl(e,"subdomain"),this._apiClient.request("/organization-subdomains/".concat(encodeURIComponent(e),"/?fields=permissions,account,onboardingSurvey"),{method:"GET"}).then((e=>{let{data:t}=e;return uu.fromJson(t)})).catch((e=>{if(e instanceof Ml){if(404===e.status)return null;throw new Error(e.statusText)}throw e}))}getOrganizationByOrganizationId(e){return Nl(e,"organizationId"),this._apiClient.request("/organizations/".concat(encodeURIComponent(e),"?fields=permissions,account"),{method:"GET"}).then((e=>{let{data:t}=e;return uu.fromJson(t)})).catch((e=>{if(e instanceof Ml){if(404===e.status)return null;throw new Error(e.statusText)}throw e}))}getOrganizationsByContactPoint(e){const{code:t}=e,r="email"in e?e.email:null,n="phoneNumber"in e?e.phoneNumber:null;uo.ok((r||n)&&!(r&&n),"either email or phoneNumber is required"),Nl(t,"code");const i=r?{type:"email",value:r}:{type:"phoneNumber",value:n};return this._apiClient.request("/organization-queries",{method:"POST",data:{contactPoint:i,code:t}}).then((e=>{let{data:t}=e;return Yl(t,"organizations",(e=>uu.fromJson(e)))}))}getOrganizationsByIdToken(e){let{idToken:t}=e;return Nl(t,"idToken"),this._apiClient.request("/organization-queries",{method:"POST",data:{idToken:t}}).then((e=>{let{data:t}=e;return Yl(t,"organizations",(e=>uu.fromJson(Object.assign({permissions:{},limits:{}},Bl(e,"organization")))))}))}getOrganizationsByLoggedInUser(){return this._apiClient.request("/user/organizations",{method:"GET"}).then((e=>{let{data:t}=e;return Yl(t,"organizations",(e=>uu.fromJson(Object.assign({permissions:{},limits:{}},Bl(e,"organization")))))}))}getSubdomainAvailability(e){return Nl(e,"subdomain"),this._apiClient.request("/organization-subdomains/".concat(encodeURIComponent(e),"/availability"),{method:"GET"}).then((e=>{let{data:t}=e;return Fl(t,Object,"data"),{status:$l(t,"status")}}))}updatePreferences(e){let{organizationId:t,preferences:r}=e;return Ll(t,"organizationId"),Ll(r,"preferences"),this._apiClient.request("/organizations/".concat(encodeURIComponent(t),"/preferences"),{method:"PATCH",data:r}).then((()=>{}))}deleteOrganization(e){let{organizationId:t}=e;return Ll(t,"organizationId"),this._apiClient.request("/organizations/".concat(encodeURIComponent(t)),{method:"DELETE"}).then((()=>{}))}}class hu{constructor(e){let{organizationService:t,subdomain:r}=e;this._organizationService=t,this._subdomain=r,this._organizationPromise=null}initOrganization(){return this.fetchOrganization().then((()=>{}))}fetchOrganization(){return this._organizationPromise||(this._organizationPromise=this._organizationService.getOrganizationBySubdomain(this._subdomain)),this._organizationPromise}}const fu="https://api.whereby.dev";function mu(){const e=su.create({baseUrl:fu}),t=new Jl({fetchDeviceCredentials:e.getCredentials.bind(e),baseUrl:fu}),r=new pu({apiClient:t});return{credentialsService:e,apiClient:t,organizationService:r,fetchOrganizationFromRoomUrl:e=>{const t=Il({host:new URL(e).host});return new hu({organizationService:r,subdomain:t.subdomain}).fetchOrganization()}}}const gu=pe((e=>e.chat.chatMessages),(e=>e.cloudRecording),nc,Ho,Rc,Tc,xc,(e=>e.streaming),(e=>e.waitingParticipants.waitingParticipants),((e,t,r,n,i,a,s,o,c)=>({chatMessages:e,cloudRecording:t.isRecording?{status:"recording"}:void 0,localScreenshareStatus:r.isScreenSharing?"active":void 0,localParticipant:Object.assign(Object.assign({},r),{stream:n}),remoteParticipants:i,screenshares:a,connectionStatus:s,liveStream:o.isStreaming?{status:"streaming",startedAt:o.startedAt}:void 0,waitingParticipants:c}))),vu="2.0.0",yu={chatMessages:[],remoteParticipants:[],connectionStatus:"initializing",screenshares:[],waitingParticipants:[]},bu={localMediaOptions:{audio:!0,video:!0}};function _u(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:bu;const[r]=c.useState((()=>{if(t.localMedia)return t.localMedia.store;const e=mu();return Dl({injectServices:e})})),[n,i]=c.useState(),[a,s]=c.useState(yu);c.useEffect((()=>{const n=Ol(r,gu,s),i=new URL(e),a=new URLSearchParams(i.search).get("roomKey");return r.dispatch(ys({displayName:t.displayName||"Guest",localMediaOptions:t.localMedia?void 0:t.localMediaOptions,roomKey:a,roomUrl:e,sdkVersion:vu,externalId:t.externalId||null})),()=>{n(),r.dispatch(bs())}}),[]),c.useEffect((()=>{r&&!n&&i((()=>e=>c.createElement(hs,Object.assign({},e,{onResize:e=>{let{stream:t,width:n,height:i}=e;r.dispatch(cl({streamId:t.id,width:n,height:i}))}}))))}),[r,n]);const o=c.useCallback((e=>r.dispatch(Xs({text:e}))),[r]),d=c.useCallback((()=>r.dispatch(Dc())),[r]),l=c.useCallback((e=>r.dispatch(tc({displayName:e}))),[r]);return{state:a,actions:{sendChatMessage:o,knock:d,setDisplayName:l,toggleCamera:c.useCallback((e=>r.dispatch(So({enabled:e}))),[r]),toggleMicrophone:c.useCallback((e=>r.dispatch(Co({enabled:e}))),[r]),acceptWaitingParticipant:c.useCallback((e=>r.dispatch(kl({participantId:e}))),[r]),rejectWaitingParticipant:c.useCallback((e=>r.dispatch(Rl({participantId:e}))),[r]),startCloudRecording:c.useCallback((()=>r.dispatch(eo())),[r]),startScreenshare:c.useCallback((()=>r.dispatch(oc())),[r]),stopCloudRecording:c.useCallback((()=>r.dispatch(to())),[r]),stopScreenshare:c.useCallback((()=>r.dispatch(cc())),[r])},components:{VideoView:n||hs},_ref:r}}pe((e=>e.localMedia.cameraDeviceError),$o,Ao,No,(e=>e.localMedia.isSettingCameraDevice),(e=>e.localMedia.isSettingMicrophoneDevice),Jo,Ho,(e=>e.localMedia.microphoneDeviceError),Qo,Xo,(e=>e.localMedia.startError),((e,t,r,n,i,a,s,o,c,d,l,u)=>({cameraDeviceError:e,cameraDevices:t,currentCameraDeviceId:r,currentMicrophoneDeviceId:n,isSettingCameraDevice:i,isSettingMicrophoneDevice:a,isStarting:s,localStream:o,microphoneDeviceError:c,microphoneDevices:d,speakerDevices:l,startError:u})));var wu=r(2496);function Su(e){let{children:t,variant:r,isActive:n=!0,...i}=e;const{alt:a,activeBgColor:s,bgColor:o,iconSource:c,offIcon:d}=function(e){switch(e){case"camera":return{alt:"camera",activeBgColor:"#2F66F71A",bgColor:"#F26B4D",iconSource:"/camera.svg",offIcon:"/cam-off.svg"};case"microphone":return{alt:"microphone",activeBgColor:"#03AB191A",bgColor:"#F26B4D",iconSource:"/microphone.svg",offIcon:"/mic-off.svg"};case"share":return{alt:"share",activeBgColor:"#F26B4D",bgColor:"#FDC7451A",iconSource:"/share.svg",offIcon:"/share.svg"};default:return{alt:"camera",activeBgColor:"#F26B4D",bgColor:"#2F66F71A",iconSource:"/camera.svg",offIcon:"/cam-off.svg"}}}(r);return(0,wu.jsxs)("div",{className:"icon-button-wrapper",children:[(0,wu.jsx)("button",{className:"icon-button",...i,style:{backgroundColor:n?s:o},children:n?(0,wu.jsx)("img",{src:c,alt:a}):(0,wu.jsx)("img",{src:d,alt:a})}),t]})}function Cu(){const[e,t]=(0,c.useState)({width:0,height:0}),r=(0,c.useRef)(null);return(0,c.useEffect)((()=>{function e(){const e=r.current;if(e){const r=window.getComputedStyle(e);t({width:parseInt(r.width,10),height:parseInt(r.height,10)})}}return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)}),[]),[r,e]}const ku=e=>{let{remoteParticipants:t,VideoView:r}=e;const[n,{width:i,height:a}]=Cu(),[s,o]=(0,c.useState)({}),[d,l]=(0,c.useState)({});return(0,c.useEffect)((()=>{let e="repeat(3, 1fr)",r="1fr",s="100px",c="100px";const d=t.length,u=.95;if(console.log("Number OF pArticipants is : "+d),1===d)s=c="".concat(a>i?i*u:a*u,"px"),console.log("one participant");else if(2===d)if(a>i)e="1fr",r="repeat(2, 1fr)",s=c="".concat(a/2*u,"px"),console.log("two participant : vertical "+e+"and "+r);else{e="repeat(2, 1fr)",r="1fr";const t=i/2;s=c="".concat(t<a?t*u:a*u,"px"),console.log("two participant : horiz "+e+"and "+r)}else if(3===d||4===d)if(a>i)e="repeat(2, 1fr)",r="repeat(2, 1fr)",s=c="".concat(a/2*u,"px"),console.log("three to four participant : square "+e+"and "+r);else if(3===d){const t=i/3,n=a/2;t<n?(e="repeat(2, 1fr)",r="repeat(2, 1fr)",s=c="".concat(n*u,"px"),console.log("three participant : square "+e+"and "+r)):(e="repeat(3, 1fr)",r="1fr",s=c="".concat(t<a?t*u:a*u,"px"),console.log("three participant : horiz "+e+"and "+r))}else{const t=i/4,n=a/2;t<n?(e="repeat(2, 1fr)",r="repeat(2, 1fr)",s=c="".concat(n*u,"px"),console.log("four participant : square "+e+"and "+r)):(e="repeat(4, 1fr)",r="1fr",s=c="".concat(t<a?t*u:a*u,"px"),console.log("four participant : horiz "+e+"and "+r))}else if(5===d||6===d)if(a>i)e="repeat(2, 1fr)",r="repeat(3, 1fr)",s=c="".concat(a/3*u,"px"),console.log("2 by 3 grid vertical");else{const t=i/3,n=a/2,o=a/3;t>o?(e="repeat(3, 1fr)",r="repeat(2, 1fr)",s=c="".concat(t>n?n*u:t*u,"px"),console.log("2 by 3 grid horizontal")):(e="repeat(2, 1fr)",r="repeat(3, 1fr)",s=c="".concat(o*u,"px"),console.log("2 by 3 grid vertical"))}else d>=6&&(a>i?(e="repeat(2, 1fr)",r="repeat(4, 1fr)",s=c="".concat(a/4*u,"px"),console.log("2 by 4 grid vertical")):i/4>a/4?(e="repeat(4, 1fr)",r="repeat(2, 1fr)",s=c="".concat(i/4>a/2?a/2*u:i/4*u,"px"),console.log("2 by 4 grid horizontal")):(e="repeat(2, 1fr)",r="repeat(4, 1fr)",s=c="".concat(i/4*u,"px"),console.log("2 by 4 grid vertical")));o({display:"grid",gridTemplateColumns:e,gridTemplateRows:r,gridGap:"1vw"}),l({width:s,height:c}),n.offsetHeight}),[i,a,t]),(0,wu.jsx)("div",{className:"grid-container topbar-child-common",ref:n,children:(0,wu.jsx)("div",{id:"allpeople-grid",style:s,children:t.map(((e,t)=>(0,wu.jsx)("div",{className:"grid-item",style:d,children:(0,wu.jsx)("div",{className:"other-div",children:(0,wu.jsx)(r,{stream:e.stream})})},t)))})})};function Ru(e){let{roomUrl:t,displayName:r}=e;const[n,i]=c.useState(!1),[a,s]=c.useState(!0),[o,d]=c.useState(!0),[l,u]=c.useState(!1),[p,h]=c.useState(!1),[f,m]=c.useState(0),[g,v]=Cu(),[y,b]=Cu(),[_,w]=c.useState({}),[S,C]=c.useState({}),k=_u(t,{localMediaOptions:{audio:!0,video:!0}}),{actions:R,components:T,state:P}=k,{VideoView:E}=T,{localParticipant:D,remoteParticipants:O,screenshares:x}=P,{toggleCamera:I,toggleMicrophone:M,startScreenshare:L,stopScreenshare:j}=R;const A=()=>{m(0),setTimeout((()=>h(!1)),2e3)};return c.useEffect((()=>{if(p){const e=setTimeout(A,2e3);return()=>clearTimeout(e)}}),[p]),c.useEffect((()=>{b.height>b.width?(w({height:"".concat(.95*b.width,"px"),width:"".concat(.95*b.width,"px")}),C({flexDirection:"column"})):(w({height:"".concat(.95*b.height,"px"),width:"".concat(.95*b.height,"px")}),C({flexDirection:"row"}))}),[b]),(0,wu.jsxs)("div",{className:"topbar-container",children:[(0,wu.jsx)(ku,{remoteParticipants:O,VideoView:E}),(0,wu.jsx)("div",{className:"innerSpace topbar-child-common"}),(0,wu.jsxs)("div",{ref:y,className:"self-container topbar-child-common",onMouseEnter:()=>{h(!0),m(1)},onMouseLeave:A,children:[(0,wu.jsx)("div",{ref:g,style:_,className:"self-div",children:(null===D||void 0===D?void 0:D.stream)&&(0,wu.jsx)(E,{muted:!0,stream:D.stream})}),p&&(0,wu.jsxs)("div",{className:"buttons",style:{...S,opacity:f},children:[(0,wu.jsx)(Su,{variant:"camera",isActive:a,onClick:()=>{s((e=>!e)),I()}}),(0,wu.jsx)(Su,{variant:"microphone",isActive:o,onClick:()=>{d((e=>!e)),M()}})]})]})]})}const Tu=function(){return(0,wu.jsx)("p",{children:"parameters missing"})},Pu=new URLSearchParams(window.location.search),Eu=Pu.get("roomUrl"),Du=Pu.get("displayName")||"guest",Ou=document.getElementById("root");d.createRoot(Ou).render((0,wu.jsx)(c.StrictMode,{children:Eu?(0,wu.jsx)(Ru,{roomUrl:Eu,displayName:Du}):(0,wu.jsx)(Tu,{})}))})()})();
//# sourceMappingURL=main.7e0427d8.js.map